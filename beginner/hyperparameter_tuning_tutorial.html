
<!DOCTYPE html>

<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Hyperparameter tuning with Ray Tune — PyTorch Tutorials 1.7.1 documentation</title>
<link href="../_static/css/theme.css" rel="stylesheet" type="text/css"/>
<!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
<link href="../_static/copybutton.css" rel="stylesheet" type="text/css"/>
<link href="../_static/gallery.css" rel="stylesheet" type="text/css"/>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="../intermediate/pruning_tutorial.html" rel="next" title="Pruning Tutorial"/>
<link href="profiler.html" rel="prev" title="Profiling your PyTorch Module"/>
<script src="../_static/js/modernizr.min.js"></script>
<!-- Preload the theme fonts -->
<link as="font" crossorigin="anonymous" href="../_static/fonts/FreightSans/freight-sans-book.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="../_static/fonts/FreightSans/freight-sans-medium.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="../_static/fonts/FreightSans/freight-sans-bold.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" rel="preload" type="font/woff2"/>
<!-- Preload the katex fonts -->
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" rel="preload" type="font/woff2"/>
</head>
<div class="container-fluid header-holder tutorials-header" id="header-holder">
<div class="container">
<div class="header-container">
<a aria-label="PyTorch" class="header-logo" href="https://pytorch.org/"></a>
<div class="main-menu">
<ul>
<li>
<a href="https://pytorch.org/get-started">Get Started</a>
</li>
<li>
<a href="https://pytorch.org/ecosystem">Ecosystem</a>
</li>
<li>
<a href="https://pytorch.org/mobile">Mobile</a>
</li>
<li>
<a href="https://pytorch.org/blog/">Blog</a>
</li>
<li class="active">
<a href="https://pytorch.org/tutorials">Tutorials</a>
</li>
<li>
<div class="resources-dropdown" data-toggle="resources-dropdown" id="resourcesDropdownButton">
<a class="resource-option with-down-orange-arrow">
                Docs
              </a>
<div class="resources-dropdown-menu">
<a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/docs/stable/index.html">
<span class="dropdown-title">PyTorch</span>
<p></p>
</a>
<a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/audio/stable/index.html">
<span class="dropdown-title">torchaudio</span>
<p></p>
</a>
<a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/text/stable/index.html">
<span class="dropdown-title">torchtext</span>
<p></p>
</a>
<a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/docs/stable/torchvision/">
<span class="dropdown-title">torchvision</span>
<p></p>
</a>
<a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/elastic/">
<span class="dropdown-title">TorchElastic</span>
<p></p>
</a>
<a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/serve/">
<span class="dropdown-title">TorchServe</span>
<p></p>
</a>
<a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/xla">
<span class="dropdown-title">PyTorch on XLA Devices</span>
<p></p>
</a>
</div>
</div></li>
<li>
<div class="resources-dropdown" data-toggle="resources-dropdown" id="resourcesDropdownButton">
<a class="resource-option with-down-arrow">
                Resources
              </a>
<div class="resources-dropdown-menu">
<a class="nav-dropdown-item" href="https://pytorch.org/features">
<span class="dropdown-title">About</span>
<p>Learn about PyTorch’s features and capabilities</p>
</a>
<a class="nav-dropdown-item" href="https://pytorch.org/#community-module">
<span class="dropdown-title">Community</span>
<p>Join the PyTorch developer community to contribute, learn, and get your questions answered.</p>
</a>
<a class="nav-dropdown-item" href="https://pytorch.org/resources">
<span class="dropdown-title">Developer Resources</span>
<p>Find resources and get questions answered</p>
</a>
<a class="nav-dropdown-item" href="https://discuss.pytorch.org/" target="_blank">
<span class="dropdown-title">Forums</span>
<p>A place to discuss PyTorch code, issues, install, research</p>
</a>
<a class="nav-dropdown-item" href="https://pytorch.org/hub">
<span class="dropdown-title">Models (Beta)</span>
<p>Discover, publish, and reuse pre-trained models</p>
</a>
</div>
</div>
</li>
<li>
<a href="https://github.com/pytorch/pytorch">Github</a>
</li>
</ul>
</div>
<a class="main-menu-open-button" data-behavior="open-mobile-menu" href="#"></a>
</div>
</div>
</div>
<body class="pytorch-body">
<div class="table-of-contents-link-wrapper">
<span>Table of Contents</span>
<a class="toggle-table-of-contents" data-behavior="toggle-table-of-contents" href="#"></a>
</div>
<nav class="pytorch-left-menu" data-toggle="wy-nav-shift" id="pytorch-left-menu">
<div class="pytorch-side-scroll">
<div aria-label="main navigation" class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation">
<div class="pytorch-left-menu-search">
<div class="version">
                  1.7.1
                </div>
<div role="search">
<form action="../search.html" class="wy-form" id="rtd-search-form" method="get">
<input name="q" placeholder="Search Tutorials" type="text"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
</div>
</div>
<p class="caption"><span class="caption-text">PyTorch Recipes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../recipes/recipes_index.html">See All Recipes</a></li>
</ul>
<p class="caption"><span class="caption-text">Learning PyTorch</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="deep_learning_60min_blitz.html">Deep Learning with PyTorch: A 60 Minute Blitz</a></li>
<li class="toctree-l1"><a class="reference internal" href="pytorch_with_examples.html">Learning PyTorch with Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="nn_tutorial.html">What is <cite>torch.nn</cite> <em>really</em>?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/tensorboard_tutorial.html">Visualizing Models, Data, and Training with TensorBoard</a></li>
</ul>
<p class="caption"><span class="caption-text">Image/Video</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/torchvision_tutorial.html">TorchVision Object Detection Finetuning Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="transfer_learning_tutorial.html">Transfer Learning for Computer Vision Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="fgsm_tutorial.html">Adversarial Example Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="dcgan_faces_tutorial.html">DCGAN Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Audio</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="audio_preprocessing_tutorial.html">Audio I/O and Pre-Processing with torchaudio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/speech_command_recognition_with_torchaudio.html">SyntaxError</a></li>
</ul>
<p class="caption"><span class="caption-text">Text</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="transformer_tutorial.html">Sequence-to-Sequence Modeling with nn.Transformer and TorchText</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/char_rnn_classification_tutorial.html">NLP From Scratch: Classifying Names with a Character-Level RNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/char_rnn_generation_tutorial.html">NLP From Scratch: Generating Names with a Character-Level RNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/seq2seq_translation_tutorial.html">NLP From Scratch: Translation with a Sequence to Sequence Network and Attention</a></li>
<li class="toctree-l1"><a class="reference internal" href="text_sentiment_ngrams_tutorial.html">Text Classification with TorchText</a></li>
<li class="toctree-l1"><a class="reference internal" href="torchtext_translation_tutorial.html">Language Translation with TorchText</a></li>
</ul>
<p class="caption"><span class="caption-text">Reinforcement Learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/reinforcement_q_learning.html">Reinforcement Learning (DQN) Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/mario_rl_tutorial.html">Train a Mario-playing RL Agent</a></li>
</ul>
<p class="caption"><span class="caption-text">Deploying PyTorch Models in Production</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/flask_rest_api_tutorial.html">Deploying PyTorch in Python via a REST API with Flask</a></li>
<li class="toctree-l1"><a class="reference internal" href="Intro_to_TorchScript_tutorial.html">Introduction to TorchScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/cpp_export.html">Loading a TorchScript Model in C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/super_resolution_with_onnxruntime.html">(optional) Exporting a Model from PyTorch to ONNX and Running it using ONNX Runtime</a></li>
</ul>
<p class="caption"><span class="caption-text">Frontend APIs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/named_tensor_tutorial.html">(prototype) Introduction to Named Tensors in PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/memory_format_tutorial.html">(beta) Channels Last Memory Format in PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/cpp_frontend.html">Using the PyTorch C++ Frontend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/cpp_extension.html">Custom C++ and CUDA Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/torch_script_custom_ops.html">Extending TorchScript with Custom C++ Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/torch_script_custom_classes.html">Extending TorchScript with Custom C++ Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/torch-script-parallelism.html">Dynamic Parallelism in TorchScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/cpp_autograd.html">Autograd in C++ Frontend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/dispatcher.html">Registering a Dispatched Operator in C++</a></li>
</ul>
<p class="caption"><span class="caption-text">Model Optimization</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="profiler.html">Profiling your PyTorch Module</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Hyperparameter tuning with Ray Tune</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/pruning_tutorial.html">Pruning Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/dynamic_quantization_tutorial.html">(beta) Dynamic Quantization on an LSTM Word Language Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/dynamic_quantization_bert_tutorial.html">(beta) Dynamic Quantization on BERT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/static_quantization_tutorial.html">(beta) Static Quantization with Eager Mode in PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/quantized_transfer_learning_tutorial.html">(beta) Quantized Transfer Learning for Computer Vision Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Parallel and Distributed Training</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dist_overview.html">PyTorch Distributed Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/model_parallel_tutorial.html">Single-Machine Model Parallel Best Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/ddp_tutorial.html">Getting Started with Distributed Data Parallel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/dist_tuto.html">Writing Distributed Applications with PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/rpc_tutorial.html">Getting Started with Distributed RPC Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/rpc_param_server_tutorial.html">Implementing a Parameter Server Using Distributed RPC Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/dist_pipeline_parallel_tutorial.html">Distributed Pipeline Parallelism Using RPC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/rpc_async_execution.html">Implementing Batch RPC Processing Using Asynchronous Executions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/rpc_ddp_tutorial.html">Combining Distributed DataParallel with Distributed RPC Framework</a></li>
</ul>
</div>
</div>
</nav>
<div class="pytorch-container">
<div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
<div class="pytorch-breadcrumbs-wrapper">
<div aria-label="breadcrumbs navigation" role="navigation">
<ul class="pytorch-breadcrumbs">
<li>
<a href="../index.html">
          
            Tutorials
          
        </a> &gt;
      </li>
<li>Hyperparameter tuning with Ray Tune</li>
<li class="pytorch-breadcrumbs-aside">
<a href="../_sources/beginner/hyperparameter_tuning_tutorial.rst.txt" rel="nofollow"><img src="../_static/images/view-page-source-icon.svg"/></a>
</li>
</ul>
</div>
</div>
<div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
</div>
<section class="pytorch-content-wrap" data-toggle="wy-nav-shift" id="pytorch-content-wrap">
<div class="pytorch-content-left">
<div class="pytorch-call-to-action-links">
<div id="tutorial-type">beginner/hyperparameter_tuning_tutorial</div>
<div id="google-colab-link">
<img class="call-to-action-img" src="../_static/images/pytorch-colab.svg"/>
<div class="call-to-action-desktop-view">Run in Google Colab</div>
<div class="call-to-action-mobile-view">Colab</div>
</div>
<div id="download-notebook-link">
<img class="call-to-action-notebook-img" src="../_static/images/pytorch-download.svg"/>
<div class="call-to-action-desktop-view">Download Notebook</div>
<div class="call-to-action-mobile-view">Notebook</div>
</div>
<div id="github-view-link">
<img class="call-to-action-img" src="../_static/images/pytorch-github.svg"/>
<div class="call-to-action-desktop-view">View on GitHub</div>
<div class="call-to-action-mobile-view">GitHub</div>
</div>
</div>
<div class="rst-content">
<div class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<article class="pytorch-article" id="pytorch-article" itemprop="articleBody">
<div class="sphx-glr-download-link-note admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Click <a class="reference internal" href="#sphx-glr-download-beginner-hyperparameter-tuning-tutorial-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="hyperparameter-tuning-with-ray-tune">
<span id="sphx-glr-beginner-hyperparameter-tuning-tutorial-py"></span><h1>Hyperparameter tuning with Ray Tune<a class="headerlink" href="#hyperparameter-tuning-with-ray-tune" title="Permalink to this headline">¶</a></h1>
<p>Hyperparameter tuning can make the difference between an average model and a highly
accurate one. Often simple things like choosing a different learning rate or changing
a network layer size can have a dramatic impact on your model performance.</p>
<p>Fortunately, there are tools that help with finding the best combination of parameters.
<a class="reference external" href="https://docs.ray.io/en/latest/tune.html">Ray Tune</a> is an industry standard tool for
distributed hyperparameter tuning. Ray Tune includes the latest hyperparameter search
algorithms, integrates with TensorBoard and other analysis libraries, and natively
supports distributed training through <a class="reference external" href="https://ray.io/">Ray’s distributed machine learning engine</a>.</p>
<p>In this tutorial, we will show you how to integrate Ray Tune into your PyTorch
training workflow. We will extend <a class="reference external" href="https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html">this tutorial from the PyTorch documentation</a> for training
a CIFAR10 image classifier.</p>
<p>As you will see, we only need to add some slight modifications. In particular, we
need to</p>
<ol class="arabic simple">
<li>wrap data loading and training in functions,</li>
<li>make some network parameters configurable,</li>
<li>add checkpointing (optional),</li>
<li>and define the search space for the model tuning</li>
</ol>
<div class="line-block">
<div class="line"><br/></div>
</div>
<p>To run this tutorial, please make sure the following packages are
installed:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">ray[tune]</span></code>: Distributed hyperparameter tuning library</li>
<li><code class="docutils literal notranslate"><span class="pre">torchvision</span></code>: For the data transformers</li>
</ul>
<div class="section" id="setup-imports">
<h2>Setup / Imports<a class="headerlink" href="#setup-imports" title="Permalink to this headline">¶</a></h2>
<p>Let’s start with the imports:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">random_split</span>
<span class="kn">import</span> <span class="nn">torchvision</span>
<span class="kn">import</span> <span class="nn">torchvision.transforms</span> <span class="k">as</span> <span class="nn">transforms</span>
<span class="kn">from</span> <span class="nn">ray</span> <span class="kn">import</span> <span class="n">tune</span>
<span class="kn">from</span> <span class="nn">ray.tune</span> <span class="kn">import</span> <span class="n">CLIReporter</span>
<span class="kn">from</span> <span class="nn">ray.tune.schedulers</span> <span class="kn">import</span> <span class="n">ASHAScheduler</span>
</pre></div>
</div>
<p>Most of the imports are needed for building the PyTorch model. Only the last three
imports are for Ray Tune.</p>
</div>
<div class="section" id="data-loaders">
<h2>Data loaders<a class="headerlink" href="#data-loaders" title="Permalink to this headline">¶</a></h2>
<p>We wrap the data loaders in their own function and pass a global data directory.
This way we can share a data directory between different trials.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="n">data_dir</span><span class="o">=</span><span class="s2">"./data"</span><span class="p">):</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="p">])</span>

    <span class="n">trainset</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">(</span>
        <span class="n">root</span><span class="o">=</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>

    <span class="n">testset</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">(</span>
        <span class="n">root</span><span class="o">=</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">trainset</span><span class="p">,</span> <span class="n">testset</span>
</pre></div>
</div>
</div>
<div class="section" id="configurable-neural-network">
<h2>Configurable neural network<a class="headerlink" href="#configurable-neural-network" title="Permalink to this headline">¶</a></h2>
<p>We can only tune those parameters that are configurable. In this example, we can specify
the layer sizes of the fully connected layers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l1</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">l2</span><span class="o">=</span><span class="mi">84</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Net</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pool</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">16</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
</div>
<div class="section" id="the-train-function">
<h2>The train function<a class="headerlink" href="#the-train-function" title="Permalink to this headline">¶</a></h2>
<p>Now it gets interesting, because we introduce some changes to the example <a class="reference external" href="https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html">from the PyTorch
documentation</a>.</p>
<p>We wrap the training script in a function <code class="docutils literal notranslate"><span class="pre">train_cifar(config,</span> <span class="pre">checkpoint_dir=None,</span> <span class="pre">data_dir=None)</span></code>.
As you can guess, the <code class="docutils literal notranslate"><span class="pre">config</span></code> parameter will receive the hyperparameters we would like to
train with. The <code class="docutils literal notranslate"><span class="pre">checkpoint_dir</span></code> parameter is used to restore checkpoints. The <code class="docutils literal notranslate"><span class="pre">data_dir</span></code> specifies
the directory where we load and store the data, so multiple runs can share the same data source.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">"l1"</span><span class="p">],</span> <span class="n">config</span><span class="p">[</span><span class="s2">"l2"</span><span class="p">])</span>

<span class="k">if</span> <span class="n">checkpoint_dir</span><span class="p">:</span>
    <span class="n">model_state</span><span class="p">,</span> <span class="n">optimizer_state</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">checkpoint_dir</span><span class="p">,</span> <span class="s2">"checkpoint"</span><span class="p">))</span>
    <span class="n">net</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">model_state</span><span class="p">)</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">optimizer_state</span><span class="p">)</span>
</pre></div>
</div>
<p>The learning rate of the optimizer is made configurable, too:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s2">"lr"</span><span class="p">],</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
</pre></div>
</div>
<p>We also split the training data into a training and validation subset. We thus train on
80% of the data and calculate the validation loss on the remaining 20%. The batch sizes
with which we iterate through the training and test sets are configurable as well.</p>
<div class="section" id="adding-multi-gpu-support-with-dataparallel">
<h3>Adding (multi) GPU support with DataParallel<a class="headerlink" href="#adding-multi-gpu-support-with-dataparallel" title="Permalink to this headline">¶</a></h3>
<p>Image classification benefits largely from GPUs. Luckily, we can continue to use
PyTorch’s abstractions in Ray Tune. Thus, we can wrap our model in <code class="docutils literal notranslate"><span class="pre">nn.DataParallel</span></code>
to support data parallel training on multiple GPUs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="s2">"cpu"</span>
<span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
    <span class="n">device</span> <span class="o">=</span> <span class="s2">"cuda:0"</span>
    <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">device_count</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">DataParallel</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
<p>By using a <code class="docutils literal notranslate"><span class="pre">device</span></code> variable we make sure that training also works when we have
no GPUs available. PyTorch requires us to send our data to the GPU memory explicitly,
like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trainloader</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
    <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
<p>The code now supports training on CPUs, on a single GPU, and on multiple GPUs. Notably, Ray
also supports <a class="reference external" href="https://docs.ray.io/en/master/using-ray-with-gpus.html#fractional-gpus">fractional GPUs</a>
so we can share GPUs among trials, as long as the model still fits on the GPU memory. We’ll come back
to that later.</p>
</div>
<div class="section" id="communicating-with-ray-tune">
<h3>Communicating with Ray Tune<a class="headerlink" href="#communicating-with-ray-tune" title="Permalink to this headline">¶</a></h3>
<p>The most interesting part is the communication with Ray Tune:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">tune</span><span class="o">.</span><span class="n">checkpoint_dir</span><span class="p">(</span><span class="n">epoch</span><span class="p">)</span> <span class="k">as</span> <span class="n">checkpoint_dir</span><span class="p">:</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">checkpoint_dir</span><span class="p">,</span> <span class="s2">"checkpoint"</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">((</span><span class="n">net</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()),</span> <span class="n">path</span><span class="p">)</span>

<span class="n">tune</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="p">(</span><span class="n">val_loss</span> <span class="o">/</span> <span class="n">val_steps</span><span class="p">),</span> <span class="n">accuracy</span><span class="o">=</span><span class="n">correct</span> <span class="o">/</span> <span class="n">total</span><span class="p">)</span>
</pre></div>
</div>
<p>Here we first save a checkpoint and then report some metrics back to Ray Tune. Specifically,
we send the validation loss and accuracy back to Ray Tune. Ray Tune can then use these metrics
to decide which hyperparameter configuration lead to the best results. These metrics
can also be used to stop bad performing trials early in order to avoid wasting
resources on those trials.</p>
<p>The checkpoint saving is optional, however, it is necessary if we wanted to use advanced
schedulers like
<a class="reference external" href="https://docs.ray.io/en/master/tune/tutorials/tune-advanced-tutorial.html">Population Based Training</a>.
Also, by saving the checkpoint we can later load the trained models and validate them
on a test set.</p>
</div>
<div class="section" id="full-training-function">
<h3>Full training function<a class="headerlink" href="#full-training-function" title="Permalink to this headline">¶</a></h3>
<p>The full code example looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">train_cifar</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">checkpoint_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">"l1"</span><span class="p">],</span> <span class="n">config</span><span class="p">[</span><span class="s2">"l2"</span><span class="p">])</span>

    <span class="n">device</span> <span class="o">=</span> <span class="s2">"cpu"</span>
    <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s2">"cuda:0"</span>
        <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">device_count</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">DataParallel</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
    <span class="n">net</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

    <span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s2">"lr"</span><span class="p">],</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">checkpoint_dir</span><span class="p">:</span>
        <span class="n">model_state</span><span class="p">,</span> <span class="n">optimizer_state</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">checkpoint_dir</span><span class="p">,</span> <span class="s2">"checkpoint"</span><span class="p">))</span>
        <span class="n">net</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">model_state</span><span class="p">)</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">optimizer_state</span><span class="p">)</span>

    <span class="n">trainset</span><span class="p">,</span> <span class="n">testset</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>

    <span class="n">test_abs</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">trainset</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
    <span class="n">train_subset</span><span class="p">,</span> <span class="n">val_subset</span> <span class="o">=</span> <span class="n">random_split</span><span class="p">(</span>
        <span class="n">trainset</span><span class="p">,</span> <span class="p">[</span><span class="n">test_abs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">trainset</span><span class="p">)</span> <span class="o">-</span> <span class="n">test_abs</span><span class="p">])</span>

    <span class="n">trainloader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">train_subset</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">"batch_size"</span><span class="p">]),</span>
        <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">num_workers</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">valloader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">val_subset</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">"batch_size"</span><span class="p">]),</span>
        <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">num_workers</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>  <span class="c1"># loop over the dataset multiple times</span>
        <span class="n">running_loss</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">epoch_steps</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trainloader</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="c1"># get the inputs; data is a list of [inputs, labels]</span>
            <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span>
            <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

            <span class="c1"># zero the parameter gradients</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>

            <span class="c1"># forward + backward + optimize</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

            <span class="c1"># print statistics</span>
            <span class="n">running_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
            <span class="n">epoch_steps</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2000</span> <span class="o">==</span> <span class="mi">1999</span><span class="p">:</span>  <span class="c1"># print every 2000 mini-batches</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">"[</span><span class="si">%d</span><span class="s2">, </span><span class="si">%5d</span><span class="s2">] loss: </span><span class="si">%.3f</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                                                <span class="n">running_loss</span> <span class="o">/</span> <span class="n">epoch_steps</span><span class="p">))</span>
                <span class="n">running_loss</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c1"># Validation loss</span>
        <span class="n">val_loss</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">val_steps</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">valloader</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
                <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span>
                <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

                <span class="n">outputs</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">predicted</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">outputs</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">total</span> <span class="o">+=</span> <span class="n">labels</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">correct</span> <span class="o">+=</span> <span class="p">(</span><span class="n">predicted</span> <span class="o">==</span> <span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

                <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
                <span class="n">val_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
                <span class="n">val_steps</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">with</span> <span class="n">tune</span><span class="o">.</span><span class="n">checkpoint_dir</span><span class="p">(</span><span class="n">epoch</span><span class="p">)</span> <span class="k">as</span> <span class="n">checkpoint_dir</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">checkpoint_dir</span><span class="p">,</span> <span class="s2">"checkpoint"</span><span class="p">)</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">((</span><span class="n">net</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()),</span> <span class="n">path</span><span class="p">)</span>

        <span class="n">tune</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="p">(</span><span class="n">val_loss</span> <span class="o">/</span> <span class="n">val_steps</span><span class="p">),</span> <span class="n">accuracy</span><span class="o">=</span><span class="n">correct</span> <span class="o">/</span> <span class="n">total</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Finished Training"</span><span class="p">)</span>
</pre></div>
</div>
<p>As you can see, most of the code is adapted directly from the original example.</p>
</div>
</div>
<div class="section" id="test-set-accuracy">
<h2>Test set accuracy<a class="headerlink" href="#test-set-accuracy" title="Permalink to this headline">¶</a></h2>
<p>Commonly the performance of a machine learning model is tested on a hold-out test
set with data that has not been used for training the model. We also wrap this in a
function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_accuracy</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">"cpu"</span><span class="p">):</span>
    <span class="n">trainset</span><span class="p">,</span> <span class="n">testset</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">()</span>

    <span class="n">testloader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">testset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">testloader</span><span class="p">:</span>
            <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span>
            <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">predicted</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">outputs</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">total</span> <span class="o">+=</span> <span class="n">labels</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">correct</span> <span class="o">+=</span> <span class="p">(</span><span class="n">predicted</span> <span class="o">==</span> <span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">correct</span> <span class="o">/</span> <span class="n">total</span>
</pre></div>
</div>
<p>The function also expects a <code class="docutils literal notranslate"><span class="pre">device</span></code> parameter, so we can do the
test set validation on a GPU.</p>
</div>
<div class="section" id="configuring-the-search-space">
<h2>Configuring the search space<a class="headerlink" href="#configuring-the-search-space" title="Permalink to this headline">¶</a></h2>
<p>Lastly, we need to define Ray Tune’s search space. Here is an example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"l1"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">sample_from</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="mi">2</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)),</span>
    <span class="s2">"l2"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">sample_from</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="mi">2</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)),</span>
    <span class="s2">"lr"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">),</span>
    <span class="s2">"batch_size"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">])</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">tune.sample_from()</span></code> function makes it possible to define your own sample
methods to obtain hyperparameters. In this example, the <code class="docutils literal notranslate"><span class="pre">l1</span></code> and <code class="docutils literal notranslate"><span class="pre">l2</span></code> parameters
should be powers of 2 between 4 and 256, so either 4, 8, 16, 32, 64, 128, or 256.
The <code class="docutils literal notranslate"><span class="pre">lr</span></code> (learning rate) should be uniformly sampled between 0.0001 and 0.1. Lastly,
the batch size is a choice between 2, 4, 8, and 16.</p>
<p>At each trial, Ray Tune will now randomly sample a combination of parameters from these
search spaces. It will then train a number of models in parallel and find the best
performing one among these. We also use the <code class="docutils literal notranslate"><span class="pre">ASHAScheduler</span></code> which will terminate bad
performing trials early.</p>
<p>We wrap the <code class="docutils literal notranslate"><span class="pre">train_cifar</span></code> function with <code class="docutils literal notranslate"><span class="pre">functools.partial</span></code> to set the constant
<code class="docutils literal notranslate"><span class="pre">data_dir</span></code> parameter. We can also tell Ray Tune what resources should be
available for each trial:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gpus_per_trial</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c1"># ...</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">tune</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">partial</span><span class="p">(</span><span class="n">train_cifar</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="n">data_dir</span><span class="p">),</span>
    <span class="n">resources_per_trial</span><span class="o">=</span><span class="p">{</span><span class="s2">"cpu"</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">"gpu"</span><span class="p">:</span> <span class="n">gpus_per_trial</span><span class="p">},</span>
    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
    <span class="n">num_samples</span><span class="o">=</span><span class="n">num_samples</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span>
    <span class="n">progress_reporter</span><span class="o">=</span><span class="n">reporter</span><span class="p">,</span>
    <span class="n">checkpoint_at_end</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>You can specify the number of CPUs, which are then available e.g.
to increase the <code class="docutils literal notranslate"><span class="pre">num_workers</span></code> of the PyTorch <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> instances. The selected
number of GPUs are made visible to PyTorch in each trial. Trials do not have access to
GPUs that haven’t been requested for them - so you don’t have to care about two trials
using the same set of resources.</p>
<p>Here we can also specify fractional GPUs, so something like <code class="docutils literal notranslate"><span class="pre">gpus_per_trial=0.5</span></code> is
completely valid. The trials will then share GPUs among each other.
You just have to make sure that the models still fit in the GPU memory.</p>
<p>After training the models, we will find the best performing one and load the trained
network from the checkpoint file. We then obtain the test set accuracy and report
everything by printing.</p>
<p>The full main function looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">num_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_num_epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gpus_per_trial</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">"./data"</span><span class="p">)</span>
    <span class="n">load_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
    <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"l1"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">sample_from</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)),</span>
        <span class="s2">"l2"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">sample_from</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)),</span>
        <span class="s2">"lr"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">),</span>
        <span class="s2">"batch_size"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">])</span>
    <span class="p">}</span>
    <span class="n">scheduler</span> <span class="o">=</span> <span class="n">ASHAScheduler</span><span class="p">(</span>
        <span class="n">metric</span><span class="o">=</span><span class="s2">"loss"</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">"min"</span><span class="p">,</span>
        <span class="n">max_t</span><span class="o">=</span><span class="n">max_num_epochs</span><span class="p">,</span>
        <span class="n">grace_period</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">reduction_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">reporter</span> <span class="o">=</span> <span class="n">CLIReporter</span><span class="p">(</span>
        <span class="c1"># parameter_columns=["l1", "l2", "lr", "batch_size"],</span>
        <span class="n">metric_columns</span><span class="o">=</span><span class="p">[</span><span class="s2">"loss"</span><span class="p">,</span> <span class="s2">"accuracy"</span><span class="p">,</span> <span class="s2">"training_iteration"</span><span class="p">])</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">tune</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
        <span class="n">partial</span><span class="p">(</span><span class="n">train_cifar</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="n">data_dir</span><span class="p">),</span>
        <span class="n">resources_per_trial</span><span class="o">=</span><span class="p">{</span><span class="s2">"cpu"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">"gpu"</span><span class="p">:</span> <span class="n">gpus_per_trial</span><span class="p">},</span>
        <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
        <span class="n">num_samples</span><span class="o">=</span><span class="n">num_samples</span><span class="p">,</span>
        <span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span>
        <span class="n">progress_reporter</span><span class="o">=</span><span class="n">reporter</span><span class="p">)</span>

    <span class="n">best_trial</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_best_trial</span><span class="p">(</span><span class="s2">"loss"</span><span class="p">,</span> <span class="s2">"min"</span><span class="p">,</span> <span class="s2">"last"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Best trial config: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">best_trial</span><span class="o">.</span><span class="n">config</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Best trial final validation loss: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">best_trial</span><span class="o">.</span><span class="n">last_result</span><span class="p">[</span><span class="s2">"loss"</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Best trial final validation accuracy: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">best_trial</span><span class="o">.</span><span class="n">last_result</span><span class="p">[</span><span class="s2">"accuracy"</span><span class="p">]))</span>

    <span class="n">best_trained_model</span> <span class="o">=</span> <span class="n">Net</span><span class="p">(</span><span class="n">best_trial</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">"l1"</span><span class="p">],</span> <span class="n">best_trial</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">"l2"</span><span class="p">])</span>
    <span class="n">device</span> <span class="o">=</span> <span class="s2">"cpu"</span>
    <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s2">"cuda:0"</span>
        <span class="k">if</span> <span class="n">gpus_per_trial</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">best_trained_model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">DataParallel</span><span class="p">(</span><span class="n">best_trained_model</span><span class="p">)</span>
    <span class="n">best_trained_model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

    <span class="n">best_checkpoint_dir</span> <span class="o">=</span> <span class="n">best_trial</span><span class="o">.</span><span class="n">checkpoint</span><span class="o">.</span><span class="n">value</span>
    <span class="n">model_state</span><span class="p">,</span> <span class="n">optimizer_state</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">best_checkpoint_dir</span><span class="p">,</span> <span class="s2">"checkpoint"</span><span class="p">))</span>
    <span class="n">best_trained_model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">model_state</span><span class="p">)</span>

    <span class="n">test_acc</span> <span class="o">=</span> <span class="n">test_accuracy</span><span class="p">(</span><span class="n">best_trained_model</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Best trial test set accuracy: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">test_acc</span><span class="p">))</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="c1"># You can change the number of GPUs per trial here:</span>
    <span class="n">main</span><span class="p">(</span><span class="n">num_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_num_epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gpus_per_trial</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz
Extracting /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data
Files already downloaded and verified
== Status ==
Memory usage on this node: 4.0/240.1 GiB
Using AsyncHyperBand: num_stopped=0
Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: None
Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 1/10 (1 RUNNING)
+---------------------+----------+-------+--------------+------+------+-----------+
| Trial name          | status   | loc   |   batch_size |   l1 |   l2 |        lr |
|---------------------+----------+-------+--------------+------+------+-----------|
| DEFAULT_03296_00000 | RUNNING  |       |            2 |   32 |    4 | 0.0585813 |
+---------------------+----------+-------+--------------+------+------+-----------+


[2m[36m(pid=1508)[0m Files already downloaded and verified
[2m[36m(pid=1565)[0m Files already downloaded and verified
[2m[36m(pid=1567)[0m Files already downloaded and verified
[2m[36m(pid=1557)[0m Files already downloaded and verified
[2m[36m(pid=1574)[0m Files already downloaded and verified
[2m[36m(pid=1556)[0m Files already downloaded and verified
[2m[36m(pid=1552)[0m Files already downloaded and verified
[2m[36m(pid=1572)[0m Files already downloaded and verified
[2m[36m(pid=1558)[0m Files already downloaded and verified
[2m[36m(pid=1494)[0m Files already downloaded and verified
[2m[36m(pid=1508)[0m Files already downloaded and verified
[2m[36m(pid=1565)[0m Files already downloaded and verified
[2m[36m(pid=1567)[0m Files already downloaded and verified
[2m[36m(pid=1557)[0m Files already downloaded and verified
[2m[36m(pid=1574)[0m Files already downloaded and verified
[2m[36m(pid=1556)[0m Files already downloaded and verified
[2m[36m(pid=1552)[0m Files already downloaded and verified
[2m[36m(pid=1572)[0m Files already downloaded and verified
[2m[36m(pid=1558)[0m Files already downloaded and verified
[2m[36m(pid=1494)[0m Files already downloaded and verified
[2m[36m(pid=1508)[0m [1,  2000] loss: 2.369
[2m[36m(pid=1567)[0m [1,  2000] loss: 2.194
[2m[36m(pid=1565)[0m [1,  2000] loss: 2.086
[2m[36m(pid=1574)[0m [1,  2000] loss: 2.254
[2m[36m(pid=1494)[0m [1,  2000] loss: 2.172
[2m[36m(pid=1557)[0m [1,  2000] loss: 2.305
[2m[36m(pid=1572)[0m [1,  2000] loss: 1.993
[2m[36m(pid=1558)[0m [1,  2000] loss: 2.012
[2m[36m(pid=1552)[0m [1,  2000] loss: 2.073
[2m[36m(pid=1556)[0m [1,  2000] loss: 1.993
[2m[36m(pid=1567)[0m [1,  4000] loss: 1.091
[2m[36m(pid=1508)[0m [1,  4000] loss: 1.181
[2m[36m(pid=1565)[0m [1,  4000] loss: 0.980
Result for DEFAULT_03296_00008:
  accuracy: 0.2871
  date: 2020-12-30_14-12-41
  done: false
  experiment_id: f8f051b4192a444886d779a5648ef8f1
  experiment_tag: 8_batch_size=16,l1=64,l2=16,lr=0.033903
  hostname: e9d3e4cebf23
  iterations_since_restore: 1
  loss: 1.9409204601287842
  node_ip: 172.17.0.2
  pid: 1556
  should_checkpoint: true
  time_since_restore: 27.148682594299316
  time_this_iter_s: 27.148682594299316
  time_total_s: 27.148682594299316
  timestamp: 1609337561
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 03296_00008

[2m[36m(pid=1574)[0m [1,  4000] loss: 0.973
== Status ==
Memory usage on this node: 9.2/240.1 GiB
Using AsyncHyperBand: num_stopped=0
Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -1.9409204601287842
Resources requested: 20/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (10 RUNNING)
+---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status   | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00000 | RUNNING  |                 |            2 |   32 |    4 | 0.0585813   |         |            |                      |
| DEFAULT_03296_00001 | RUNNING  |                 |            2 |   16 |    4 | 0.00539896  |         |            |                      |
| DEFAULT_03296_00002 | RUNNING  |                 |            4 |    4 |   64 | 0.0070063   |         |            |                      |
| DEFAULT_03296_00003 | RUNNING  |                 |            8 |   64 |  128 | 0.00245474  |         |            |                      |
| DEFAULT_03296_00004 | RUNNING  |                 |            4 |    8 |   16 | 0.00114723  |         |            |                      |
| DEFAULT_03296_00005 | RUNNING  |                 |            8 |    8 |    4 | 0.00083459  |         |            |                      |
| DEFAULT_03296_00006 | RUNNING  |                 |            4 |   64 |  128 | 0.00100853  |         |            |                      |
| DEFAULT_03296_00007 | RUNNING  |                 |            8 |   16 |    8 | 0.00336708  |         |            |                      |
| DEFAULT_03296_00008 | RUNNING  | 172.17.0.2:1556 |           16 |   64 |   16 | 0.0339027   | 1.94092 |     0.2871 |                    1 |
| DEFAULT_03296_00009 | RUNNING  |                 |            8 |   64 |  256 | 0.000997983 |         |            |                      |
+---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1494)[0m [1,  4000] loss: 0.906
[2m[36m(pid=1557)[0m [1,  4000] loss: 1.151
[2m[36m(pid=1558)[0m [1,  4000] loss: 0.853
[2m[36m(pid=1572)[0m [1,  4000] loss: 0.796
[2m[36m(pid=1552)[0m [1,  4000] loss: 0.850
[2m[36m(pid=1567)[0m [1,  6000] loss: 0.767
[2m[36m(pid=1508)[0m [1,  6000] loss: 0.790
[2m[36m(pid=1565)[0m [1,  6000] loss: 0.651
[2m[36m(pid=1574)[0m [1,  6000] loss: 0.581
[2m[36m(pid=1494)[0m [1,  6000] loss: 0.546
Result for DEFAULT_03296_00005:
  accuracy: 0.0976
  date: 2020-12-30_14-12-55
  done: true
  experiment_id: b0cf8df190d74eb48e3b78a93150c10e
  experiment_tag: 5_batch_size=8,l1=8,l2=4,lr=0.00083459
  hostname: e9d3e4cebf23
  iterations_since_restore: 1
  loss: 2.302846802711487
  node_ip: 172.17.0.2
  pid: 1557
  should_checkpoint: true
  time_since_restore: 41.78256106376648
  time_this_iter_s: 41.78256106376648
  time_total_s: 41.78256106376648
  timestamp: 1609337575
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 03296_00005

== Status ==
Memory usage on this node: 9.2/240.1 GiB
Using AsyncHyperBand: num_stopped=1
Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -2.1218836314201353
Resources requested: 20/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (10 RUNNING)
+---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status   | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00000 | RUNNING  |                 |            2 |   32 |    4 | 0.0585813   |         |            |                      |
| DEFAULT_03296_00001 | RUNNING  |                 |            2 |   16 |    4 | 0.00539896  |         |            |                      |
| DEFAULT_03296_00002 | RUNNING  |                 |            4 |    4 |   64 | 0.0070063   |         |            |                      |
| DEFAULT_03296_00003 | RUNNING  |                 |            8 |   64 |  128 | 0.00245474  |         |            |                      |
| DEFAULT_03296_00004 | RUNNING  |                 |            4 |    8 |   16 | 0.00114723  |         |            |                      |
| DEFAULT_03296_00005 | RUNNING  | 172.17.0.2:1557 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
| DEFAULT_03296_00006 | RUNNING  |                 |            4 |   64 |  128 | 0.00100853  |         |            |                      |
| DEFAULT_03296_00007 | RUNNING  |                 |            8 |   16 |    8 | 0.00336708  |         |            |                      |
| DEFAULT_03296_00008 | RUNNING  | 172.17.0.2:1556 |           16 |   64 |   16 | 0.0339027   | 1.94092 |     0.2871 |                    1 |
| DEFAULT_03296_00009 | RUNNING  |                 |            8 |   64 |  256 | 0.000997983 |         |            |                      |
+---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_03296_00007:
  accuracy: 0.3958
  date: 2020-12-30_14-12-56
  done: false
  experiment_id: 320de7058aaa4b5da391e34fc6843937
  experiment_tag: 7_batch_size=8,l1=16,l2=8,lr=0.0033671
  hostname: e9d3e4cebf23
  iterations_since_restore: 1
  loss: 1.6307632396697997
  node_ip: 172.17.0.2
  pid: 1558
  should_checkpoint: true
  time_since_restore: 42.056872844696045
  time_this_iter_s: 42.056872844696045
  time_total_s: 42.056872844696045
  timestamp: 1609337576
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 03296_00007

Result for DEFAULT_03296_00003:
  accuracy: 0.4612
  date: 2020-12-30_14-12-56
  done: false
  experiment_id: 822322b44fa44ebf896d1af2c07ecb4f
  experiment_tag: 3_batch_size=8,l1=64,l2=128,lr=0.0024547
  hostname: e9d3e4cebf23
  iterations_since_restore: 1
  loss: 1.4712337703227998
  node_ip: 172.17.0.2
  pid: 1572
  should_checkpoint: true
  time_since_restore: 42.302258253097534
  time_this_iter_s: 42.302258253097534
  time_total_s: 42.302258253097534
  timestamp: 1609337576
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 03296_00003

Result for DEFAULT_03296_00009:
  accuracy: 0.4376
  date: 2020-12-30_14-12-57
  done: false
  experiment_id: dbf205b2d6eb43cd9db6bc9addab4deb
  experiment_tag: 9_batch_size=8,l1=64,l2=256,lr=0.00099798
  hostname: e9d3e4cebf23
  iterations_since_restore: 1
  loss: 1.5720118633270264
  node_ip: 172.17.0.2
  pid: 1552
  should_checkpoint: true
  time_since_restore: 43.39799976348877
  time_this_iter_s: 43.39799976348877
  time_total_s: 43.39799976348877
  timestamp: 1609337577
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 03296_00009

[2m[36m(pid=1556)[0m [2,  2000] loss: 2.000
[2m[36m(pid=1567)[0m [1,  8000] loss: 0.577
[2m[36m(pid=1508)[0m [1,  8000] loss: 0.593
[2m[36m(pid=1565)[0m [1,  8000] loss: 0.492
[2m[36m(pid=1574)[0m [1,  8000] loss: 0.412
Result for DEFAULT_03296_00008:
  accuracy: 0.2175
  date: 2020-12-30_14-13-05
  done: false
  experiment_id: f8f051b4192a444886d779a5648ef8f1
  experiment_tag: 8_batch_size=16,l1=64,l2=16,lr=0.033903
  hostname: e9d3e4cebf23
  iterations_since_restore: 2
  loss: 2.0801231365203856
  node_ip: 172.17.0.2
  pid: 1556
  should_checkpoint: true
  time_since_restore: 51.12830376625061
  time_this_iter_s: 23.979621171951294
  time_total_s: 51.12830376625061
  timestamp: 1609337585
  timesteps_since_restore: 0
  training_iteration: 2
  trial_id: 03296_00008

== Status ==
Memory usage on this node: 8.7/240.1 GiB
Using AsyncHyperBand: num_stopped=1
Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -2.0801231365203856 | Iter 1.000: -1.6307632396697997
Resources requested: 18/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (9 RUNNING, 1 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00000 | RUNNING    |                 |            2 |   32 |    4 | 0.0585813   |         |            |                      |
| DEFAULT_03296_00001 | RUNNING    |                 |            2 |   16 |    4 | 0.00539896  |         |            |                      |
| DEFAULT_03296_00002 | RUNNING    |                 |            4 |    4 |   64 | 0.0070063   |         |            |                      |
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.47123 |     0.4612 |                    1 |
| DEFAULT_03296_00004 | RUNNING    |                 |            4 |    8 |   16 | 0.00114723  |         |            |                      |
| DEFAULT_03296_00006 | RUNNING    |                 |            4 |   64 |  128 | 0.00100853  |         |            |                      |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.63076 |     0.3958 |                    1 |
| DEFAULT_03296_00008 | RUNNING    | 172.17.0.2:1556 |           16 |   64 |   16 | 0.0339027   | 2.08012 |     0.2175 |                    2 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.57201 |     0.4376 |                    1 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1494)[0m [1,  8000] loss: 0.388
[2m[36m(pid=1558)[0m [2,  2000] loss: 1.524
[2m[36m(pid=1572)[0m [2,  2000] loss: 1.415
[2m[36m(pid=1552)[0m [2,  2000] loss: 1.497
[2m[36m(pid=1567)[0m [1, 10000] loss: 0.462
[2m[36m(pid=1508)[0m [1, 10000] loss: 0.474
[2m[36m(pid=1565)[0m [1, 10000] loss: 0.392
[2m[36m(pid=1574)[0m [1, 10000] loss: 0.315
[2m[36m(pid=1494)[0m [1, 10000] loss: 0.299
[2m[36m(pid=1556)[0m [3,  2000] loss: 2.082
[2m[36m(pid=1558)[0m [2,  4000] loss: 0.746
[2m[36m(pid=1572)[0m [2,  4000] loss: 0.688
Result for DEFAULT_03296_00002:
  accuracy: 0.2422
  date: 2020-12-30_14-13-23
  done: true
  experiment_id: 3f815a3721744a21b98601d81cd334c6
  experiment_tag: 2_batch_size=4,l1=4,l2=64,lr=0.0070063
  hostname: e9d3e4cebf23
  iterations_since_restore: 1
  loss: 1.9997045428276061
  node_ip: 172.17.0.2
  pid: 1565
  should_checkpoint: true
  time_since_restore: 69.8024389743805
  time_this_iter_s: 69.8024389743805
  time_total_s: 69.8024389743805
  timestamp: 1609337603
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 03296_00002

== Status ==
Memory usage on this node: 8.7/240.1 GiB
Using AsyncHyperBand: num_stopped=2
Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -2.0801231365203856 | Iter 1.000: -1.7858418498992918
Resources requested: 18/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (9 RUNNING, 1 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00000 | RUNNING    |                 |            2 |   32 |    4 | 0.0585813   |         |            |                      |
| DEFAULT_03296_00001 | RUNNING    |                 |            2 |   16 |    4 | 0.00539896  |         |            |                      |
| DEFAULT_03296_00002 | RUNNING    | 172.17.0.2:1565 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.47123 |     0.4612 |                    1 |
| DEFAULT_03296_00004 | RUNNING    |                 |            4 |    8 |   16 | 0.00114723  |         |            |                      |
| DEFAULT_03296_00006 | RUNNING    |                 |            4 |   64 |  128 | 0.00100853  |         |            |                      |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.63076 |     0.3958 |                    1 |
| DEFAULT_03296_00008 | RUNNING    | 172.17.0.2:1556 |           16 |   64 |   16 | 0.0339027   | 2.08012 |     0.2175 |                    2 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.57201 |     0.4376 |                    1 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1567)[0m [1, 12000] loss: 0.385
Result for DEFAULT_03296_00004:
  accuracy: 0.4224
  date: 2020-12-30_14-13-23
  done: false
  experiment_id: 469e18f3272846dc8214b74569894dad
  experiment_tag: 4_batch_size=4,l1=8,l2=16,lr=0.0011472
  hostname: e9d3e4cebf23
  iterations_since_restore: 1
  loss: 1.53906819126606
  node_ip: 172.17.0.2
  pid: 1574
  should_checkpoint: true
  time_since_restore: 69.98822259902954
  time_this_iter_s: 69.98822259902954
  time_total_s: 69.98822259902954
  timestamp: 1609337603
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 03296_00004

[2m[36m(pid=1552)[0m [2,  4000] loss: 0.715
[2m[36m(pid=1508)[0m [1, 12000] loss: 0.395
Result for DEFAULT_03296_00006:
  accuracy: 0.4739
  date: 2020-12-30_14-13-25
  done: false
  experiment_id: 9587a66ed6bf4053abde0dbc66ae6de4
  experiment_tag: 6_batch_size=4,l1=64,l2=128,lr=0.0010085
  hostname: e9d3e4cebf23
  iterations_since_restore: 1
  loss: 1.449243952256441
  node_ip: 172.17.0.2
  pid: 1494
  should_checkpoint: true
  time_since_restore: 71.45399832725525
  time_this_iter_s: 71.45399832725525
  time_total_s: 71.45399832725525
  timestamp: 1609337605
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 03296_00006

Result for DEFAULT_03296_00008:
  accuracy: 0.1696
  date: 2020-12-30_14-13-28
  done: false
  experiment_id: f8f051b4192a444886d779a5648ef8f1
  experiment_tag: 8_batch_size=16,l1=64,l2=16,lr=0.033903
  hostname: e9d3e4cebf23
  iterations_since_restore: 3
  loss: 2.144767059326172
  node_ip: 172.17.0.2
  pid: 1556
  should_checkpoint: true
  time_since_restore: 74.17046117782593
  time_this_iter_s: 23.042157411575317
  time_total_s: 74.17046117782593
  timestamp: 1609337608
  timesteps_since_restore: 0
  training_iteration: 3
  trial_id: 03296_00008

Result for DEFAULT_03296_00007:
  accuracy: 0.4491
  date: 2020-12-30_14-13-33
  done: false
  experiment_id: 320de7058aaa4b5da391e34fc6843937
  experiment_tag: 7_batch_size=8,l1=16,l2=8,lr=0.0033671
  hostname: e9d3e4cebf23
  iterations_since_restore: 2
  loss: 1.5351894567966462
  node_ip: 172.17.0.2
  pid: 1558
  should_checkpoint: true
  time_since_restore: 79.2859537601471
  time_this_iter_s: 37.22908091545105
  time_total_s: 79.2859537601471
  timestamp: 1609337613
  timesteps_since_restore: 0
  training_iteration: 2
  trial_id: 03296_00007

== Status ==
Memory usage on this node: 8.1/240.1 GiB
Using AsyncHyperBand: num_stopped=2
Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.807656296658516 | Iter 1.000: -1.601387551498413
Resources requested: 16/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00000 | RUNNING    |                 |            2 |   32 |    4 | 0.0585813   |         |            |                      |
| DEFAULT_03296_00001 | RUNNING    |                 |            2 |   16 |    4 | 0.00539896  |         |            |                      |
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.47123 |     0.4612 |                    1 |
| DEFAULT_03296_00004 | RUNNING    | 172.17.0.2:1574 |            4 |    8 |   16 | 0.00114723  | 1.53907 |     0.4224 |                    1 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.44924 |     0.4739 |                    1 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.53519 |     0.4491 |                    2 |
| DEFAULT_03296_00008 | RUNNING    | 172.17.0.2:1556 |           16 |   64 |   16 | 0.0339027   | 2.14477 |     0.1696 |                    3 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.57201 |     0.4376 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_03296_00003:
  accuracy: 0.5152
  date: 2020-12-30_14-13-33
  done: false
  experiment_id: 822322b44fa44ebf896d1af2c07ecb4f
  experiment_tag: 3_batch_size=8,l1=64,l2=128,lr=0.0024547
  hostname: e9d3e4cebf23
  iterations_since_restore: 2
  loss: 1.349548639178276
  node_ip: 172.17.0.2
  pid: 1572
  should_checkpoint: true
  time_since_restore: 79.67694044113159
  time_this_iter_s: 37.37468218803406
  time_total_s: 79.67694044113159
  timestamp: 1609337613
  timesteps_since_restore: 0
  training_iteration: 2
  trial_id: 03296_00003

[2m[36m(pid=1567)[0m [1, 14000] loss: 0.330
[2m[36m(pid=1574)[0m [2,  2000] loss: 1.545
[2m[36m(pid=1508)[0m [1, 14000] loss: 0.339
Result for DEFAULT_03296_00009:
  accuracy: 0.512
  date: 2020-12-30_14-13-35
  done: false
  experiment_id: dbf205b2d6eb43cd9db6bc9addab4deb
  experiment_tag: 9_batch_size=8,l1=64,l2=256,lr=0.00099798
  hostname: e9d3e4cebf23
  iterations_since_restore: 2
  loss: 1.3910934066295624
  node_ip: 172.17.0.2
  pid: 1552
  should_checkpoint: true
  time_since_restore: 81.8223671913147
  time_this_iter_s: 38.42436742782593
  time_total_s: 81.8223671913147
  timestamp: 1609337615
  timesteps_since_restore: 0
  training_iteration: 2
  trial_id: 03296_00009

[2m[36m(pid=1494)[0m [2,  2000] loss: 1.422
[2m[36m(pid=1556)[0m [4,  2000] loss: 2.152
[2m[36m(pid=1567)[0m [1, 16000] loss: 0.288
[2m[36m(pid=1558)[0m [3,  2000] loss: 1.421
[2m[36m(pid=1574)[0m [2,  4000] loss: 0.747
[2m[36m(pid=1508)[0m [1, 16000] loss: 0.297
[2m[36m(pid=1572)[0m [3,  2000] loss: 1.270
[2m[36m(pid=1494)[0m [2,  4000] loss: 0.693
[2m[36m(pid=1552)[0m [3,  2000] loss: 1.321
Result for DEFAULT_03296_00008:
  accuracy: 0.0981
  date: 2020-12-30_14-13-51
  done: false
  experiment_id: f8f051b4192a444886d779a5648ef8f1
  experiment_tag: 8_batch_size=16,l1=64,l2=16,lr=0.033903
  hostname: e9d3e4cebf23
  iterations_since_restore: 4
  loss: 2.3082515102386476
  node_ip: 172.17.0.2
  pid: 1556
  should_checkpoint: true
  time_since_restore: 97.49902105331421
  time_this_iter_s: 23.32855987548828
  time_total_s: 97.49902105331421
  timestamp: 1609337631
  timesteps_since_restore: 0
  training_iteration: 4
  trial_id: 03296_00008

== Status ==
Memory usage on this node: 8.1/240.1 GiB
Using AsyncHyperBand: num_stopped=2
Bracket: Iter 8.000: None | Iter 4.000: -2.3082515102386476 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.601387551498413
Resources requested: 16/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00000 | RUNNING    |                 |            2 |   32 |    4 | 0.0585813   |         |            |                      |
| DEFAULT_03296_00001 | RUNNING    |                 |            2 |   16 |    4 | 0.00539896  |         |            |                      |
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.34955 |     0.5152 |                    2 |
| DEFAULT_03296_00004 | RUNNING    | 172.17.0.2:1574 |            4 |    8 |   16 | 0.00114723  | 1.53907 |     0.4224 |                    1 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.44924 |     0.4739 |                    1 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.53519 |     0.4491 |                    2 |
| DEFAULT_03296_00008 | RUNNING    | 172.17.0.2:1556 |           16 |   64 |   16 | 0.0339027   | 2.30825 |     0.0981 |                    4 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.39109 |     0.512  |                    2 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1567)[0m [1, 18000] loss: 0.256
[2m[36m(pid=1508)[0m [1, 18000] loss: 0.264
[2m[36m(pid=1574)[0m [2,  6000] loss: 0.491
[2m[36m(pid=1558)[0m [3,  4000] loss: 0.707
[2m[36m(pid=1494)[0m [2,  6000] loss: 0.448
[2m[36m(pid=1572)[0m [3,  4000] loss: 0.634
[2m[36m(pid=1552)[0m [3,  4000] loss: 0.643
[2m[36m(pid=1567)[0m [1, 20000] loss: 0.231
[2m[36m(pid=1508)[0m [1, 20000] loss: 0.237
[2m[36m(pid=1574)[0m [2,  8000] loss: 0.365
[2m[36m(pid=1556)[0m [5,  2000] loss: 2.304
Result for DEFAULT_03296_00007:
  accuracy: 0.5
  date: 2020-12-30_14-14-09
  done: false
  experiment_id: 320de7058aaa4b5da391e34fc6843937
  experiment_tag: 7_batch_size=8,l1=16,l2=8,lr=0.0033671
  hostname: e9d3e4cebf23
  iterations_since_restore: 3
  loss: 1.396343655014038
  node_ip: 172.17.0.2
  pid: 1558
  should_checkpoint: true
  time_since_restore: 115.0183892250061
  time_this_iter_s: 35.73243546485901
  time_total_s: 115.0183892250061
  timestamp: 1609337649
  timesteps_since_restore: 0
  training_iteration: 3
  trial_id: 03296_00007

== Status ==
Memory usage on this node: 8.1/240.1 GiB
Using AsyncHyperBand: num_stopped=2
Bracket: Iter 8.000: None | Iter 4.000: -2.3082515102386476 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.601387551498413
Resources requested: 16/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00000 | RUNNING    |                 |            2 |   32 |    4 | 0.0585813   |         |            |                      |
| DEFAULT_03296_00001 | RUNNING    |                 |            2 |   16 |    4 | 0.00539896  |         |            |                      |
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.34955 |     0.5152 |                    2 |
| DEFAULT_03296_00004 | RUNNING    | 172.17.0.2:1574 |            4 |    8 |   16 | 0.00114723  | 1.53907 |     0.4224 |                    1 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.44924 |     0.4739 |                    1 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.39634 |     0.5    |                    3 |
| DEFAULT_03296_00008 | RUNNING    | 172.17.0.2:1556 |           16 |   64 |   16 | 0.0339027   | 2.30825 |     0.0981 |                    4 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.39109 |     0.512  |                    2 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_03296_00003:
  accuracy: 0.5667
  date: 2020-12-30_14-14-09
  done: false
  experiment_id: 822322b44fa44ebf896d1af2c07ecb4f
  experiment_tag: 3_batch_size=8,l1=64,l2=128,lr=0.0024547
  hostname: e9d3e4cebf23
  iterations_since_restore: 3
  loss: 1.2357164273500443
  node_ip: 172.17.0.2
  pid: 1572
  should_checkpoint: true
  time_since_restore: 115.78500461578369
  time_this_iter_s: 36.1080641746521
  time_total_s: 115.78500461578369
  timestamp: 1609337649
  timesteps_since_restore: 0
  training_iteration: 3
  trial_id: 03296_00003

[2m[36m(pid=1494)[0m [2,  8000] loss: 0.333
Result for DEFAULT_03296_00009:
  accuracy: 0.5562
  date: 2020-12-30_14-14-12
  done: false
  experiment_id: dbf205b2d6eb43cd9db6bc9addab4deb
  experiment_tag: 9_batch_size=8,l1=64,l2=256,lr=0.00099798
  hostname: e9d3e4cebf23
  iterations_since_restore: 3
  loss: 1.2507093260765076
  node_ip: 172.17.0.2
  pid: 1552
  should_checkpoint: true
  time_since_restore: 118.86277365684509
  time_this_iter_s: 37.040406465530396
  time_total_s: 118.86277365684509
  timestamp: 1609337652
  timesteps_since_restore: 0
  training_iteration: 3
  trial_id: 03296_00009

Result for DEFAULT_03296_00008:
  accuracy: 0.1037
  date: 2020-12-30_14-14-15
  done: false
  experiment_id: f8f051b4192a444886d779a5648ef8f1
  experiment_tag: 8_batch_size=16,l1=64,l2=16,lr=0.033903
  hostname: e9d3e4cebf23
  iterations_since_restore: 5
  loss: 2.2855286724090575
  node_ip: 172.17.0.2
  pid: 1556
  should_checkpoint: true
  time_since_restore: 121.27236533164978
  time_this_iter_s: 23.77334427833557
  time_total_s: 121.27236533164978
  timestamp: 1609337655
  timesteps_since_restore: 0
  training_iteration: 5
  trial_id: 03296_00008

== Status ==
Memory usage on this node: 8.1/240.1 GiB
Using AsyncHyperBand: num_stopped=2
Bracket: Iter 8.000: None | Iter 4.000: -2.3082515102386476 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.601387551498413
Resources requested: 16/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00000 | RUNNING    |                 |            2 |   32 |    4 | 0.0585813   |         |            |                      |
| DEFAULT_03296_00001 | RUNNING    |                 |            2 |   16 |    4 | 0.00539896  |         |            |                      |
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.23572 |     0.5667 |                    3 |
| DEFAULT_03296_00004 | RUNNING    | 172.17.0.2:1574 |            4 |    8 |   16 | 0.00114723  | 1.53907 |     0.4224 |                    1 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.44924 |     0.4739 |                    1 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.39634 |     0.5    |                    3 |
| DEFAULT_03296_00008 | RUNNING    | 172.17.0.2:1556 |           16 |   64 |   16 | 0.0339027   | 2.28553 |     0.1037 |                    5 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.25071 |     0.5562 |                    3 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1574)[0m [2, 10000] loss: 0.284
Result for DEFAULT_03296_00001:
  accuracy: 0.1006
  date: 2020-12-30_14-14-19
  done: true
  experiment_id: dada23b3e62142c699c0ea78a0979598
  experiment_tag: 1_batch_size=2,l1=16,l2=4,lr=0.005399
  hostname: e9d3e4cebf23
  iterations_since_restore: 1
  loss: 2.309279034614563
  node_ip: 172.17.0.2
  pid: 1567
  should_checkpoint: true
  time_since_restore: 125.98925518989563
  time_this_iter_s: 125.98925518989563
  time_total_s: 125.98925518989563
  timestamp: 1609337659
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 03296_00001

[2m[36m(pid=1494)[0m [2, 10000] loss: 0.259
Result for DEFAULT_03296_00000:
  accuracy: 0.0992
  date: 2020-12-30_14-14-21
  done: true
  experiment_id: e24fd11f5c4e4227ae50adb406bd1060
  experiment_tag: 0_batch_size=2,l1=32,l2=4,lr=0.058581
  hostname: e9d3e4cebf23
  iterations_since_restore: 1
  loss: 2.4060286116600036
  node_ip: 172.17.0.2
  pid: 1508
  should_checkpoint: true
  time_since_restore: 128.0140986442566
  time_this_iter_s: 128.0140986442566
  time_total_s: 128.0140986442566
  timestamp: 1609337661
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 03296_00000

== Status ==
Memory usage on this node: 7.5/240.1 GiB
Using AsyncHyperBand: num_stopped=4
Bracket: Iter 8.000: None | Iter 4.000: -2.3082515102386476 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 14/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (7 RUNNING, 3 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00000 | RUNNING    | 172.17.0.2:1508 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.23572 |     0.5667 |                    3 |
| DEFAULT_03296_00004 | RUNNING    | 172.17.0.2:1574 |            4 |    8 |   16 | 0.00114723  | 1.53907 |     0.4224 |                    1 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.44924 |     0.4739 |                    1 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.39634 |     0.5    |                    3 |
| DEFAULT_03296_00008 | RUNNING    | 172.17.0.2:1556 |           16 |   64 |   16 | 0.0339027   | 2.28553 |     0.1037 |                    5 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.25071 |     0.5562 |                    3 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1558)[0m [4,  2000] loss: 1.356
[2m[36m(pid=1572)[0m [4,  2000] loss: 1.174
[2m[36m(pid=1552)[0m [4,  2000] loss: 1.212
Result for DEFAULT_03296_00004:
  accuracy: 0.4376
  date: 2020-12-30_14-14-26
  done: true
  experiment_id: 469e18f3272846dc8214b74569894dad
  experiment_tag: 4_batch_size=4,l1=8,l2=16,lr=0.0011472
  hostname: e9d3e4cebf23
  iterations_since_restore: 2
  loss: 1.5392350439488889
  node_ip: 172.17.0.2
  pid: 1574
  should_checkpoint: true
  time_since_restore: 132.64356470108032
  time_this_iter_s: 62.65534210205078
  time_total_s: 132.64356470108032
  timestamp: 1609337666
  timesteps_since_restore: 0
  training_iteration: 2
  trial_id: 03296_00004

Result for DEFAULT_03296_00006:
  accuracy: 0.5338
  date: 2020-12-30_14-14-28
  done: false
  experiment_id: 9587a66ed6bf4053abde0dbc66ae6de4
  experiment_tag: 6_batch_size=4,l1=64,l2=128,lr=0.0010085
  hostname: e9d3e4cebf23
  iterations_since_restore: 2
  loss: 1.3051375747293235
  node_ip: 172.17.0.2
  pid: 1494
  should_checkpoint: true
  time_since_restore: 134.8871455192566
  time_this_iter_s: 63.43314719200134
  time_total_s: 134.8871455192566
  timestamp: 1609337668
  timesteps_since_restore: 0
  training_iteration: 2
  trial_id: 03296_00006

== Status ==
Memory usage on this node: 6.5/240.1 GiB
Using AsyncHyperBand: num_stopped=5
Bracket: Iter 8.000: None | Iter 4.000: -2.3082515102386476 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.23572 |     0.5667 |                    3 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.30514 |     0.5338 |                    2 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.39634 |     0.5    |                    3 |
| DEFAULT_03296_00008 | RUNNING    | 172.17.0.2:1556 |           16 |   64 |   16 | 0.0339027   | 2.28553 |     0.1037 |                    5 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.25071 |     0.5562 |                    3 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1556)[0m [6,  2000] loss: 2.217
[2m[36m(pid=1558)[0m [4,  4000] loss: 0.679
[2m[36m(pid=1572)[0m [4,  4000] loss: 0.598
[2m[36m(pid=1552)[0m [4,  4000] loss: 0.594
Result for DEFAULT_03296_00008:
  accuracy: 0.1363
  date: 2020-12-30_14-14-37
  done: false
  experiment_id: f8f051b4192a444886d779a5648ef8f1
  experiment_tag: 8_batch_size=16,l1=64,l2=16,lr=0.033903
  hostname: e9d3e4cebf23
  iterations_since_restore: 6
  loss: 2.22849623336792
  node_ip: 172.17.0.2
  pid: 1556
  should_checkpoint: true
  time_since_restore: 143.70224905014038
  time_this_iter_s: 22.4298837184906
  time_total_s: 143.70224905014038
  timestamp: 1609337677
  timesteps_since_restore: 0
  training_iteration: 6
  trial_id: 03296_00008

== Status ==
Memory usage on this node: 6.4/240.1 GiB
Using AsyncHyperBand: num_stopped=5
Bracket: Iter 8.000: None | Iter 4.000: -2.3082515102386476 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.23572 |     0.5667 |                    3 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.30514 |     0.5338 |                    2 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.39634 |     0.5    |                    3 |
| DEFAULT_03296_00008 | RUNNING    | 172.17.0.2:1556 |           16 |   64 |   16 | 0.0339027   | 2.2285  |     0.1363 |                    6 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.25071 |     0.5562 |                    3 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1494)[0m [3,  2000] loss: 1.233
Result for DEFAULT_03296_00007:
  accuracy: 0.522
  date: 2020-12-30_14-14-43
  done: false
  experiment_id: 320de7058aaa4b5da391e34fc6843937
  experiment_tag: 7_batch_size=8,l1=16,l2=8,lr=0.0033671
  hostname: e9d3e4cebf23
  iterations_since_restore: 4
  loss: 1.3535629096984862
  node_ip: 172.17.0.2
  pid: 1558
  should_checkpoint: true
  time_since_restore: 149.3781702518463
  time_this_iter_s: 34.35978102684021
  time_total_s: 149.3781702518463
  timestamp: 1609337683
  timesteps_since_restore: 0
  training_iteration: 4
  trial_id: 03296_00007

== Status ==
Memory usage on this node: 6.5/240.1 GiB
Using AsyncHyperBand: num_stopped=5
Bracket: Iter 8.000: None | Iter 4.000: -1.8309072099685668 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.23572 |     0.5667 |                    3 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.30514 |     0.5338 |                    2 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.35356 |     0.522  |                    4 |
| DEFAULT_03296_00008 | RUNNING    | 172.17.0.2:1556 |           16 |   64 |   16 | 0.0339027   | 2.2285  |     0.1363 |                    6 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.25071 |     0.5562 |                    3 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_03296_00003:
  accuracy: 0.5645
  date: 2020-12-30_14-14-44
  done: false
  experiment_id: 822322b44fa44ebf896d1af2c07ecb4f
  experiment_tag: 3_batch_size=8,l1=64,l2=128,lr=0.0024547
  hostname: e9d3e4cebf23
  iterations_since_restore: 4
  loss: 1.2387280549645423
  node_ip: 172.17.0.2
  pid: 1572
  should_checkpoint: true
  time_since_restore: 150.3350305557251
  time_this_iter_s: 34.550025939941406
  time_total_s: 150.3350305557251
  timestamp: 1609337684
  timesteps_since_restore: 0
  training_iteration: 4
  trial_id: 03296_00003

Result for DEFAULT_03296_00009:
  accuracy: 0.585
  date: 2020-12-30_14-14-47
  done: false
  experiment_id: dbf205b2d6eb43cd9db6bc9addab4deb
  experiment_tag: 9_batch_size=8,l1=64,l2=256,lr=0.00099798
  hostname: e9d3e4cebf23
  iterations_since_restore: 4
  loss: 1.2005118184685708
  node_ip: 172.17.0.2
  pid: 1552
  should_checkpoint: true
  time_since_restore: 153.93575382232666
  time_this_iter_s: 35.07298016548157
  time_total_s: 153.93575382232666
  timestamp: 1609337687
  timesteps_since_restore: 0
  training_iteration: 4
  trial_id: 03296_00009

[2m[36m(pid=1494)[0m [3,  4000] loss: 0.624
[2m[36m(pid=1556)[0m [7,  2000] loss: 2.183
[2m[36m(pid=1558)[0m [5,  2000] loss: 1.308
[2m[36m(pid=1572)[0m [5,  2000] loss: 1.126
[2m[36m(pid=1494)[0m [3,  6000] loss: 0.401
Result for DEFAULT_03296_00008:
  accuracy: 0.1587
  date: 2020-12-30_14-14-59
  done: false
  experiment_id: f8f051b4192a444886d779a5648ef8f1
  experiment_tag: 8_batch_size=16,l1=64,l2=16,lr=0.033903
  hostname: e9d3e4cebf23
  iterations_since_restore: 7
  loss: 2.1796198247909544
  node_ip: 172.17.0.2
  pid: 1556
  should_checkpoint: true
  time_since_restore: 165.6822624206543
  time_this_iter_s: 21.980013370513916
  time_total_s: 165.6822624206543
  timestamp: 1609337699
  timesteps_since_restore: 0
  training_iteration: 7
  trial_id: 03296_00008

== Status ==
Memory usage on this node: 6.5/240.1 GiB
Using AsyncHyperBand: num_stopped=5
Bracket: Iter 8.000: None | Iter 4.000: -1.2961454823315144 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.23873 |     0.5645 |                    4 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.30514 |     0.5338 |                    2 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.35356 |     0.522  |                    4 |
| DEFAULT_03296_00008 | RUNNING    | 172.17.0.2:1556 |           16 |   64 |   16 | 0.0339027   | 2.17962 |     0.1587 |                    7 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.20051 |     0.585  |                    4 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1552)[0m [5,  2000] loss: 1.131
[2m[36m(pid=1558)[0m [5,  4000] loss: 0.664
[2m[36m(pid=1572)[0m [5,  4000] loss: 0.553
[2m[36m(pid=1494)[0m [3,  8000] loss: 0.306
[2m[36m(pid=1552)[0m [5,  4000] loss: 0.566
[2m[36m(pid=1556)[0m [8,  2000] loss: 2.256
Result for DEFAULT_03296_00007:
  accuracy: 0.5075
  date: 2020-12-30_14-15-16
  done: false
  experiment_id: 320de7058aaa4b5da391e34fc6843937
  experiment_tag: 7_batch_size=8,l1=16,l2=8,lr=0.0033671
  hostname: e9d3e4cebf23
  iterations_since_restore: 5
  loss: 1.4132022142410279
  node_ip: 172.17.0.2
  pid: 1558
  should_checkpoint: true
  time_since_restore: 182.42687964439392
  time_this_iter_s: 33.04870939254761
  time_total_s: 182.42687964439392
  timestamp: 1609337716
  timesteps_since_restore: 0
  training_iteration: 5
  trial_id: 03296_00007

== Status ==
Memory usage on this node: 6.5/240.1 GiB
Using AsyncHyperBand: num_stopped=5
Bracket: Iter 8.000: None | Iter 4.000: -1.2961454823315144 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.23873 |     0.5645 |                    4 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.30514 |     0.5338 |                    2 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.4132  |     0.5075 |                    5 |
| DEFAULT_03296_00008 | RUNNING    | 172.17.0.2:1556 |           16 |   64 |   16 | 0.0339027   | 2.17962 |     0.1587 |                    7 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.20051 |     0.585  |                    4 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_03296_00003:
  accuracy: 0.579
  date: 2020-12-30_14-15-17
  done: false
  experiment_id: 822322b44fa44ebf896d1af2c07ecb4f
  experiment_tag: 3_batch_size=8,l1=64,l2=128,lr=0.0024547
  hostname: e9d3e4cebf23
  iterations_since_restore: 5
  loss: 1.1988090345859528
  node_ip: 172.17.0.2
  pid: 1572
  should_checkpoint: true
  time_since_restore: 183.76491284370422
  time_this_iter_s: 33.429882287979126
  time_total_s: 183.76491284370422
  timestamp: 1609337717
  timesteps_since_restore: 0
  training_iteration: 5
  trial_id: 03296_00003

[2m[36m(pid=1494)[0m [3, 10000] loss: 0.245
Result for DEFAULT_03296_00008:
  accuracy: 0.0989
  date: 2020-12-30_14-15-21
  done: false
  experiment_id: f8f051b4192a444886d779a5648ef8f1
  experiment_tag: 8_batch_size=16,l1=64,l2=16,lr=0.033903
  hostname: e9d3e4cebf23
  iterations_since_restore: 8
  loss: 2.3115828071594238
  node_ip: 172.17.0.2
  pid: 1556
  should_checkpoint: true
  time_since_restore: 187.44086170196533
  time_this_iter_s: 21.758599281311035
  time_total_s: 187.44086170196533
  timestamp: 1609337721
  timesteps_since_restore: 0
  training_iteration: 8
  trial_id: 03296_00008

Result for DEFAULT_03296_00009:
  accuracy: 0.5928
  date: 2020-12-30_14-15-21
  done: false
  experiment_id: dbf205b2d6eb43cd9db6bc9addab4deb
  experiment_tag: 9_batch_size=8,l1=64,l2=256,lr=0.00099798
  hostname: e9d3e4cebf23
  iterations_since_restore: 5
  loss: 1.1915179872393609
  node_ip: 172.17.0.2
  pid: 1552
  should_checkpoint: true
  time_since_restore: 187.9410252571106
  time_this_iter_s: 34.005271434783936
  time_total_s: 187.9410252571106
  timestamp: 1609337721
  timesteps_since_restore: 0
  training_iteration: 5
  trial_id: 03296_00009

== Status ==
Memory usage on this node: 6.4/240.1 GiB
Using AsyncHyperBand: num_stopped=5
Bracket: Iter 8.000: -2.3115828071594238 | Iter 4.000: -1.2961454823315144 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.19881 |     0.579  |                    5 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.30514 |     0.5338 |                    2 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.4132  |     0.5075 |                    5 |
| DEFAULT_03296_00008 | RUNNING    | 172.17.0.2:1556 |           16 |   64 |   16 | 0.0339027   | 2.31158 |     0.0989 |                    8 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.19152 |     0.5928 |                    5 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_03296_00006:
  accuracy: 0.564
  date: 2020-12-30_14-15-26
  done: false
  experiment_id: 9587a66ed6bf4053abde0dbc66ae6de4
  experiment_tag: 6_batch_size=4,l1=64,l2=128,lr=0.0010085
  hostname: e9d3e4cebf23
  iterations_since_restore: 3
  loss: 1.224259606975317
  node_ip: 172.17.0.2
  pid: 1494
  should_checkpoint: true
  time_since_restore: 192.65237498283386
  time_this_iter_s: 57.76522946357727
  time_total_s: 192.65237498283386
  timestamp: 1609337726
  timesteps_since_restore: 0
  training_iteration: 3
  trial_id: 03296_00006

[2m[36m(pid=1558)[0m [6,  2000] loss: 1.277
[2m[36m(pid=1572)[0m [6,  2000] loss: 1.058
[2m[36m(pid=1552)[0m [6,  2000] loss: 1.069
[2m[36m(pid=1556)[0m [9,  2000] loss: 2.308
[2m[36m(pid=1494)[0m [4,  2000] loss: 1.149
[2m[36m(pid=1558)[0m [6,  4000] loss: 0.647
[2m[36m(pid=1572)[0m [6,  4000] loss: 0.550
Result for DEFAULT_03296_00008:
  accuracy: 0.0984
  date: 2020-12-30_14-15-43
  done: false
  experiment_id: f8f051b4192a444886d779a5648ef8f1
  experiment_tag: 8_batch_size=16,l1=64,l2=16,lr=0.033903
  hostname: e9d3e4cebf23
  iterations_since_restore: 9
  loss: 2.306162158584595
  node_ip: 172.17.0.2
  pid: 1556
  should_checkpoint: true
  time_since_restore: 209.08903789520264
  time_this_iter_s: 21.648176193237305
  time_total_s: 209.08903789520264
  timestamp: 1609337743
  timesteps_since_restore: 0
  training_iteration: 9
  trial_id: 03296_00008

== Status ==
Memory usage on this node: 6.5/240.1 GiB
Using AsyncHyperBand: num_stopped=5
Bracket: Iter 8.000: -2.3115828071594238 | Iter 4.000: -1.2961454823315144 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.19881 |     0.579  |                    5 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.22426 |     0.564  |                    3 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.4132  |     0.5075 |                    5 |
| DEFAULT_03296_00008 | RUNNING    | 172.17.0.2:1556 |           16 |   64 |   16 | 0.0339027   | 2.30616 |     0.0984 |                    9 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.19152 |     0.5928 |                    5 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1552)[0m [6,  4000] loss: 0.541
[2m[36m(pid=1494)[0m [4,  4000] loss: 0.576
Result for DEFAULT_03296_00007:
  accuracy: 0.542
  date: 2020-12-30_14-15-49
  done: false
  experiment_id: 320de7058aaa4b5da391e34fc6843937
  experiment_tag: 7_batch_size=8,l1=16,l2=8,lr=0.0033671
  hostname: e9d3e4cebf23
  iterations_since_restore: 6
  loss: 1.3261785034418105
  node_ip: 172.17.0.2
  pid: 1558
  should_checkpoint: true
  time_since_restore: 215.44987154006958
  time_this_iter_s: 33.02299189567566
  time_total_s: 215.44987154006958
  timestamp: 1609337749
  timesteps_since_restore: 0
  training_iteration: 6
  trial_id: 03296_00007

== Status ==
Memory usage on this node: 6.5/240.1 GiB
Using AsyncHyperBand: num_stopped=5
Bracket: Iter 8.000: -2.3115828071594238 | Iter 4.000: -1.2961454823315144 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.19881 |     0.579  |                    5 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.22426 |     0.564  |                    3 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.32618 |     0.542  |                    6 |
| DEFAULT_03296_00008 | RUNNING    | 172.17.0.2:1556 |           16 |   64 |   16 | 0.0339027   | 2.30616 |     0.0984 |                    9 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.19152 |     0.5928 |                    5 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_03296_00003:
  accuracy: 0.5697
  date: 2020-12-30_14-15-51
  done: false
  experiment_id: 822322b44fa44ebf896d1af2c07ecb4f
  experiment_tag: 3_batch_size=8,l1=64,l2=128,lr=0.0024547
  hostname: e9d3e4cebf23
  iterations_since_restore: 6
  loss: 1.2281599939823151
  node_ip: 172.17.0.2
  pid: 1572
  should_checkpoint: true
  time_since_restore: 217.55756831169128
  time_this_iter_s: 33.79265546798706
  time_total_s: 217.55756831169128
  timestamp: 1609337751
  timesteps_since_restore: 0
  training_iteration: 6
  trial_id: 03296_00003

Result for DEFAULT_03296_00009:
  accuracy: 0.6023
  date: 2020-12-30_14-15-56
  done: false
  experiment_id: dbf205b2d6eb43cd9db6bc9addab4deb
  experiment_tag: 9_batch_size=8,l1=64,l2=256,lr=0.00099798
  hostname: e9d3e4cebf23
  iterations_since_restore: 6
  loss: 1.1513233571887016
  node_ip: 172.17.0.2
  pid: 1552
  should_checkpoint: true
  time_since_restore: 222.3908851146698
  time_this_iter_s: 34.449859857559204
  time_total_s: 222.3908851146698
  timestamp: 1609337756
  timesteps_since_restore: 0
  training_iteration: 6
  trial_id: 03296_00009

== Status ==
Memory usage on this node: 6.4/240.1 GiB
Using AsyncHyperBand: num_stopped=5
Bracket: Iter 8.000: -2.3115828071594238 | Iter 4.000: -1.2961454823315144 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.22816 |     0.5697 |                    6 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.22426 |     0.564  |                    3 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.32618 |     0.542  |                    6 |
| DEFAULT_03296_00008 | RUNNING    | 172.17.0.2:1556 |           16 |   64 |   16 | 0.0339027   | 2.30616 |     0.0984 |                    9 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.15132 |     0.6023 |                    6 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1494)[0m [4,  6000] loss: 0.370
[2m[36m(pid=1556)[0m [10,  2000] loss: 2.308
[2m[36m(pid=1558)[0m [7,  2000] loss: 1.279
[2m[36m(pid=1572)[0m [7,  2000] loss: 1.012
Result for DEFAULT_03296_00008:
  accuracy: 0.1013
  date: 2020-12-30_14-16-05
  done: true
  experiment_id: f8f051b4192a444886d779a5648ef8f1
  experiment_tag: 8_batch_size=16,l1=64,l2=16,lr=0.033903
  hostname: e9d3e4cebf23
  iterations_since_restore: 10
  loss: 2.305484518432617
  node_ip: 172.17.0.2
  pid: 1556
  should_checkpoint: true
  time_since_restore: 231.12457656860352
  time_this_iter_s: 22.03553867340088
  time_total_s: 231.12457656860352
  timestamp: 1609337765
  timesteps_since_restore: 0
  training_iteration: 10
  trial_id: 03296_00008

== Status ==
Memory usage on this node: 6.5/240.1 GiB
Using AsyncHyperBand: num_stopped=6
Bracket: Iter 8.000: -2.3115828071594238 | Iter 4.000: -1.2961454823315144 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.22816 |     0.5697 |                    6 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.22426 |     0.564  |                    3 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.32618 |     0.542  |                    6 |
| DEFAULT_03296_00008 | RUNNING    | 172.17.0.2:1556 |           16 |   64 |   16 | 0.0339027   | 2.30548 |     0.1013 |                   10 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.15132 |     0.6023 |                    6 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1494)[0m [4,  8000] loss: 0.289
[2m[36m(pid=1552)[0m [7,  2000] loss: 1.013
[2m[36m(pid=1558)[0m [7,  4000] loss: 0.636
[2m[36m(pid=1572)[0m [7,  4000] loss: 0.530
[2m[36m(pid=1494)[0m [4, 10000] loss: 0.229
[2m[36m(pid=1552)[0m [7,  4000] loss: 0.515
Result for DEFAULT_03296_00007:
  accuracy: 0.5476
  date: 2020-12-30_14-16-22
  done: false
  experiment_id: 320de7058aaa4b5da391e34fc6843937
  experiment_tag: 7_batch_size=8,l1=16,l2=8,lr=0.0033671
  hostname: e9d3e4cebf23
  iterations_since_restore: 7
  loss: 1.3080403475046158
  node_ip: 172.17.0.2
  pid: 1558
  should_checkpoint: true
  time_since_restore: 248.2233362197876
  time_this_iter_s: 32.77346467971802
  time_total_s: 248.2233362197876
  timestamp: 1609337782
  timesteps_since_restore: 0
  training_iteration: 7
  trial_id: 03296_00007

== Status ==
Memory usage on this node: 5.9/240.1 GiB
Using AsyncHyperBand: num_stopped=6
Bracket: Iter 8.000: -2.3115828071594238 | Iter 4.000: -1.2961454823315144 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.22816 |     0.5697 |                    6 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.22426 |     0.564  |                    3 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.30804 |     0.5476 |                    7 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.15132 |     0.6023 |                    6 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
| DEFAULT_03296_00008 | TERMINATED |                 |           16 |   64 |   16 | 0.0339027   | 2.30548 |     0.1013 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_03296_00006:
  accuracy: 0.5918
  date: 2020-12-30_14-16-24
  done: false
  experiment_id: 9587a66ed6bf4053abde0dbc66ae6de4
  experiment_tag: 6_batch_size=4,l1=64,l2=128,lr=0.0010085
  hostname: e9d3e4cebf23
  iterations_since_restore: 4
  loss: 1.1928406420856714
  node_ip: 172.17.0.2
  pid: 1494
  should_checkpoint: true
  time_since_restore: 250.20746040344238
  time_this_iter_s: 57.55508542060852
  time_total_s: 250.20746040344238
  timestamp: 1609337784
  timesteps_since_restore: 0
  training_iteration: 4
  trial_id: 03296_00006

Result for DEFAULT_03296_00003:
  accuracy: 0.5749
  date: 2020-12-30_14-16-24
  done: false
  experiment_id: 822322b44fa44ebf896d1af2c07ecb4f
  experiment_tag: 3_batch_size=8,l1=64,l2=128,lr=0.0024547
  hostname: e9d3e4cebf23
  iterations_since_restore: 7
  loss: 1.2229655149698258
  node_ip: 172.17.0.2
  pid: 1572
  should_checkpoint: true
  time_since_restore: 250.72909355163574
  time_this_iter_s: 33.17152523994446
  time_total_s: 250.72909355163574
  timestamp: 1609337784
  timesteps_since_restore: 0
  training_iteration: 7
  trial_id: 03296_00003

Result for DEFAULT_03296_00009:
  accuracy: 0.5985
  date: 2020-12-30_14-16-30
  done: false
  experiment_id: dbf205b2d6eb43cd9db6bc9addab4deb
  experiment_tag: 9_batch_size=8,l1=64,l2=256,lr=0.00099798
  hostname: e9d3e4cebf23
  iterations_since_restore: 7
  loss: 1.147949186360836
  node_ip: 172.17.0.2
  pid: 1552
  should_checkpoint: true
  time_since_restore: 256.70115637779236
  time_this_iter_s: 34.31027126312256
  time_total_s: 256.70115637779236
  timestamp: 1609337790
  timesteps_since_restore: 0
  training_iteration: 7
  trial_id: 03296_00009

== Status ==
Memory usage on this node: 5.8/240.1 GiB
Using AsyncHyperBand: num_stopped=6
Bracket: Iter 8.000: -2.3115828071594238 | Iter 4.000: -1.2387280549645423 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.22297 |     0.5749 |                    7 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.19284 |     0.5918 |                    4 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.30804 |     0.5476 |                    7 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.14795 |     0.5985 |                    7 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
| DEFAULT_03296_00008 | TERMINATED |                 |           16 |   64 |   16 | 0.0339027   | 2.30548 |     0.1013 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1558)[0m [8,  2000] loss: 1.229
[2m[36m(pid=1494)[0m [5,  2000] loss: 1.058
[2m[36m(pid=1572)[0m [8,  2000] loss: 0.993
[2m[36m(pid=1552)[0m [8,  2000] loss: 0.969
[2m[36m(pid=1494)[0m [5,  4000] loss: 0.542
[2m[36m(pid=1558)[0m [8,  4000] loss: 0.630
[2m[36m(pid=1572)[0m [8,  4000] loss: 0.514
[2m[36m(pid=1552)[0m [8,  4000] loss: 0.497
[2m[36m(pid=1494)[0m [5,  6000] loss: 0.361
Result for DEFAULT_03296_00007:
  accuracy: 0.5385
  date: 2020-12-30_14-16-54
  done: false
  experiment_id: 320de7058aaa4b5da391e34fc6843937
  experiment_tag: 7_batch_size=8,l1=16,l2=8,lr=0.0033671
  hostname: e9d3e4cebf23
  iterations_since_restore: 8
  loss: 1.319343625473976
  node_ip: 172.17.0.2
  pid: 1558
  should_checkpoint: true
  time_since_restore: 280.26783418655396
  time_this_iter_s: 32.04449796676636
  time_total_s: 280.26783418655396
  timestamp: 1609337814
  timesteps_since_restore: 0
  training_iteration: 8
  trial_id: 03296_00007

== Status ==
Memory usage on this node: 5.9/240.1 GiB
Using AsyncHyperBand: num_stopped=6
Bracket: Iter 8.000: -1.8154632163167 | Iter 4.000: -1.2387280549645423 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.22297 |     0.5749 |                    7 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.19284 |     0.5918 |                    4 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.31934 |     0.5385 |                    8 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.14795 |     0.5985 |                    7 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
| DEFAULT_03296_00008 | TERMINATED |                 |           16 |   64 |   16 | 0.0339027   | 2.30548 |     0.1013 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_03296_00003:
  accuracy: 0.5838
  date: 2020-12-30_14-16-57
  done: false
  experiment_id: 822322b44fa44ebf896d1af2c07ecb4f
  experiment_tag: 3_batch_size=8,l1=64,l2=128,lr=0.0024547
  hostname: e9d3e4cebf23
  iterations_since_restore: 8
  loss: 1.2109691176772117
  node_ip: 172.17.0.2
  pid: 1572
  should_checkpoint: true
  time_since_restore: 283.21693754196167
  time_this_iter_s: 32.48784399032593
  time_total_s: 283.21693754196167
  timestamp: 1609337817
  timesteps_since_restore: 0
  training_iteration: 8
  trial_id: 03296_00003

Result for DEFAULT_03296_00009:
  accuracy: 0.5998
  date: 2020-12-30_14-17-03
  done: false
  experiment_id: dbf205b2d6eb43cd9db6bc9addab4deb
  experiment_tag: 9_batch_size=8,l1=64,l2=256,lr=0.00099798
  hostname: e9d3e4cebf23
  iterations_since_restore: 8
  loss: 1.1422294127702712
  node_ip: 172.17.0.2
  pid: 1552
  should_checkpoint: true
  time_since_restore: 289.8305673599243
  time_this_iter_s: 33.12941098213196
  time_total_s: 289.8305673599243
  timestamp: 1609337823
  timesteps_since_restore: 0
  training_iteration: 8
  trial_id: 03296_00009

== Status ==
Memory usage on this node: 5.9/240.1 GiB
Using AsyncHyperBand: num_stopped=6
Bracket: Iter 8.000: -1.265156371575594 | Iter 4.000: -1.2387280549645423 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.21097 |     0.5838 |                    8 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.19284 |     0.5918 |                    4 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.31934 |     0.5385 |                    8 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.14223 |     0.5998 |                    8 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
| DEFAULT_03296_00008 | TERMINATED |                 |           16 |   64 |   16 | 0.0339027   | 2.30548 |     0.1013 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1494)[0m [5,  8000] loss: 0.268
[2m[36m(pid=1558)[0m [9,  2000] loss: 1.219
[2m[36m(pid=1572)[0m [9,  2000] loss: 0.958
[2m[36m(pid=1494)[0m [5, 10000] loss: 0.217
[2m[36m(pid=1552)[0m [9,  2000] loss: 0.943
[2m[36m(pid=1558)[0m [9,  4000] loss: 0.628
[2m[36m(pid=1572)[0m [9,  4000] loss: 0.507
Result for DEFAULT_03296_00006:
  accuracy: 0.5968
  date: 2020-12-30_14-17-20
  done: false
  experiment_id: 9587a66ed6bf4053abde0dbc66ae6de4
  experiment_tag: 6_batch_size=4,l1=64,l2=128,lr=0.0010085
  hostname: e9d3e4cebf23
  iterations_since_restore: 5
  loss: 1.1733069326624275
  node_ip: 172.17.0.2
  pid: 1494
  should_checkpoint: true
  time_since_restore: 306.64333271980286
  time_this_iter_s: 56.435872316360474
  time_total_s: 306.64333271980286
  timestamp: 1609337840
  timesteps_since_restore: 0
  training_iteration: 5
  trial_id: 03296_00006

== Status ==
Memory usage on this node: 5.9/240.1 GiB
Using AsyncHyperBand: num_stopped=6
Bracket: Iter 8.000: -1.265156371575594 | Iter 4.000: -1.2387280549645423 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.21097 |     0.5838 |                    8 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.17331 |     0.5968 |                    5 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.31934 |     0.5385 |                    8 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.14223 |     0.5998 |                    8 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
| DEFAULT_03296_00008 | TERMINATED |                 |           16 |   64 |   16 | 0.0339027   | 2.30548 |     0.1013 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_03296_00007:
  accuracy: 0.5287
  date: 2020-12-30_14-17-26
  done: false
  experiment_id: 320de7058aaa4b5da391e34fc6843937
  experiment_tag: 7_batch_size=8,l1=16,l2=8,lr=0.0033671
  hostname: e9d3e4cebf23
  iterations_since_restore: 9
  loss: 1.3596353966832162
  node_ip: 172.17.0.2
  pid: 1558
  should_checkpoint: true
  time_since_restore: 312.34441614151
  time_this_iter_s: 32.076581954956055
  time_total_s: 312.34441614151
  timestamp: 1609337846
  timesteps_since_restore: 0
  training_iteration: 9
  trial_id: 03296_00007

== Status ==
Memory usage on this node: 5.9/240.1 GiB
Using AsyncHyperBand: num_stopped=6
Bracket: Iter 8.000: -1.265156371575594 | Iter 4.000: -1.2387280549645423 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.21097 |     0.5838 |                    8 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.17331 |     0.5968 |                    5 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.35964 |     0.5287 |                    9 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.14223 |     0.5998 |                    8 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
| DEFAULT_03296_00008 | TERMINATED |                 |           16 |   64 |   16 | 0.0339027   | 2.30548 |     0.1013 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1552)[0m [9,  4000] loss: 0.481
Result for DEFAULT_03296_00003:
  accuracy: 0.5829
  date: 2020-12-30_14-17-29
  done: false
  experiment_id: 822322b44fa44ebf896d1af2c07ecb4f
  experiment_tag: 3_batch_size=8,l1=64,l2=128,lr=0.0024547
  hostname: e9d3e4cebf23
  iterations_since_restore: 9
  loss: 1.2088120109081268
  node_ip: 172.17.0.2
  pid: 1572
  should_checkpoint: true
  time_since_restore: 315.80778884887695
  time_this_iter_s: 32.59085130691528
  time_total_s: 315.80778884887695
  timestamp: 1609337849
  timesteps_since_restore: 0
  training_iteration: 9
  trial_id: 03296_00003

[2m[36m(pid=1494)[0m [6,  2000] loss: 1.023
Result for DEFAULT_03296_00009:
  accuracy: 0.6212
  date: 2020-12-30_14-17-36
  done: false
  experiment_id: dbf205b2d6eb43cd9db6bc9addab4deb
  experiment_tag: 9_batch_size=8,l1=64,l2=256,lr=0.00099798
  hostname: e9d3e4cebf23
  iterations_since_restore: 9
  loss: 1.1075249377608298
  node_ip: 172.17.0.2
  pid: 1552
  should_checkpoint: true
  time_since_restore: 322.93380546569824
  time_this_iter_s: 33.103238105773926
  time_total_s: 322.93380546569824
  timestamp: 1609337856
  timesteps_since_restore: 0
  training_iteration: 9
  trial_id: 03296_00009

== Status ==
Memory usage on this node: 5.9/240.1 GiB
Using AsyncHyperBand: num_stopped=6
Bracket: Iter 8.000: -1.265156371575594 | Iter 4.000: -1.2387280549645423 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.20881 |     0.5829 |                    9 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.17331 |     0.5968 |                    5 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.35964 |     0.5287 |                    9 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.10752 |     0.6212 |                    9 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
| DEFAULT_03296_00008 | TERMINATED |                 |           16 |   64 |   16 | 0.0339027   | 2.30548 |     0.1013 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1558)[0m [10,  2000] loss: 1.218
[2m[36m(pid=1494)[0m [6,  4000] loss: 0.500
[2m[36m(pid=1572)[0m [10,  2000] loss: 0.934
[2m[36m(pid=1552)[0m [10,  2000] loss: 0.904
[2m[36m(pid=1558)[0m [10,  4000] loss: 0.615
[2m[36m(pid=1494)[0m [6,  6000] loss: 0.346
[2m[36m(pid=1572)[0m [10,  4000] loss: 0.489
Result for DEFAULT_03296_00007:
  accuracy: 0.5629
  date: 2020-12-30_14-17-58
  done: true
  experiment_id: 320de7058aaa4b5da391e34fc6843937
  experiment_tag: 7_batch_size=8,l1=16,l2=8,lr=0.0033671
  hostname: e9d3e4cebf23
  iterations_since_restore: 10
  loss: 1.2712858034849166
  node_ip: 172.17.0.2
  pid: 1558
  should_checkpoint: true
  time_since_restore: 344.31486082077026
  time_this_iter_s: 31.970444679260254
  time_total_s: 344.31486082077026
  timestamp: 1609337878
  timesteps_since_restore: 0
  training_iteration: 10
  trial_id: 03296_00007

== Status ==
Memory usage on this node: 5.9/240.1 GiB
Using AsyncHyperBand: num_stopped=7
Bracket: Iter 8.000: -1.265156371575594 | Iter 4.000: -1.2387280549645423 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00003 | RUNNING    | 172.17.0.2:1572 |            8 |   64 |  128 | 0.00245474  | 1.20881 |     0.5829 |                    9 |
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.17331 |     0.5968 |                    5 |
| DEFAULT_03296_00007 | RUNNING    | 172.17.0.2:1558 |            8 |   16 |    8 | 0.00336708  | 1.27129 |     0.5629 |                   10 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.10752 |     0.6212 |                    9 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
| DEFAULT_03296_00008 | TERMINATED |                 |           16 |   64 |   16 | 0.0339027   | 2.30548 |     0.1013 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1494)[0m [6,  8000] loss: 0.258
[2m[36m(pid=1552)[0m [10,  4000] loss: 0.464
Result for DEFAULT_03296_00003:
  accuracy: 0.5764
  date: 2020-12-30_14-18-02
  done: true
  experiment_id: 822322b44fa44ebf896d1af2c07ecb4f
  experiment_tag: 3_batch_size=8,l1=64,l2=128,lr=0.0024547
  hostname: e9d3e4cebf23
  iterations_since_restore: 10
  loss: 1.2402275148630142
  node_ip: 172.17.0.2
  pid: 1572
  should_checkpoint: true
  time_since_restore: 348.4078915119171
  time_this_iter_s: 32.60010266304016
  time_total_s: 348.4078915119171
  timestamp: 1609337882
  timesteps_since_restore: 0
  training_iteration: 10
  trial_id: 03296_00003

[2m[36m(pid=1494)[0m [6, 10000] loss: 0.209
Result for DEFAULT_03296_00009:
  accuracy: 0.6112
  date: 2020-12-30_14-18-10
  done: true
  experiment_id: dbf205b2d6eb43cd9db6bc9addab4deb
  experiment_tag: 9_batch_size=8,l1=64,l2=256,lr=0.00099798
  hostname: e9d3e4cebf23
  iterations_since_restore: 10
  loss: 1.1296584214448928
  node_ip: 172.17.0.2
  pid: 1552
  should_checkpoint: true
  time_since_restore: 356.0017988681793
  time_this_iter_s: 33.06799340248108
  time_total_s: 356.0017988681793
  timestamp: 1609337890
  timesteps_since_restore: 0
  training_iteration: 10
  trial_id: 03296_00009

== Status ==
Memory usage on this node: 4.7/240.1 GiB
Using AsyncHyperBand: num_stopped=9
Bracket: Iter 8.000: -1.265156371575594 | Iter 4.000: -1.2387280549645423 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 4/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.17331 |     0.5968 |                    5 |
| DEFAULT_03296_00009 | RUNNING    | 172.17.0.2:1552 |            8 |   64 |  256 | 0.000997983 | 1.12966 |     0.6112 |                   10 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00003 | TERMINATED |                 |            8 |   64 |  128 | 0.00245474  | 1.24023 |     0.5764 |                   10 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
| DEFAULT_03296_00007 | TERMINATED |                 |            8 |   16 |    8 | 0.00336708  | 1.27129 |     0.5629 |                   10 |
| DEFAULT_03296_00008 | TERMINATED |                 |           16 |   64 |   16 | 0.0339027   | 2.30548 |     0.1013 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_03296_00006:
  accuracy: 0.6045
  date: 2020-12-30_14-18-16
  done: false
  experiment_id: 9587a66ed6bf4053abde0dbc66ae6de4
  experiment_tag: 6_batch_size=4,l1=64,l2=128,lr=0.0010085
  hostname: e9d3e4cebf23
  iterations_since_restore: 6
  loss: 1.138285583896935
  node_ip: 172.17.0.2
  pid: 1494
  should_checkpoint: true
  time_since_restore: 361.9519519805908
  time_this_iter_s: 55.308619260787964
  time_total_s: 361.9519519805908
  timestamp: 1609337896
  timesteps_since_restore: 0
  training_iteration: 6
  trial_id: 03296_00006

== Status ==
Memory usage on this node: 4.1/240.1 GiB
Using AsyncHyperBand: num_stopped=9
Bracket: Iter 8.000: -1.265156371575594 | Iter 4.000: -1.2387280549645423 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.13829 |     0.6045 |                    6 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00003 | TERMINATED |                 |            8 |   64 |  128 | 0.00245474  | 1.24023 |     0.5764 |                   10 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
| DEFAULT_03296_00007 | TERMINATED |                 |            8 |   16 |    8 | 0.00336708  | 1.27129 |     0.5629 |                   10 |
| DEFAULT_03296_00008 | TERMINATED |                 |           16 |   64 |   16 | 0.0339027   | 2.30548 |     0.1013 |                   10 |
| DEFAULT_03296_00009 | TERMINATED |                 |            8 |   64 |  256 | 0.000997983 | 1.12966 |     0.6112 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1494)[0m [7,  2000] loss: 0.946
[2m[36m(pid=1494)[0m [7,  4000] loss: 0.489
[2m[36m(pid=1494)[0m [7,  6000] loss: 0.332
[2m[36m(pid=1494)[0m [7,  8000] loss: 0.250
[2m[36m(pid=1494)[0m [7, 10000] loss: 0.196
Result for DEFAULT_03296_00006:
  accuracy: 0.6286
  date: 2020-12-30_14-19-08
  done: false
  experiment_id: 9587a66ed6bf4053abde0dbc66ae6de4
  experiment_tag: 6_batch_size=4,l1=64,l2=128,lr=0.0010085
  hostname: e9d3e4cebf23
  iterations_since_restore: 7
  loss: 1.0875616515927016
  node_ip: 172.17.0.2
  pid: 1494
  should_checkpoint: true
  time_since_restore: 414.28674697875977
  time_this_iter_s: 52.334794998168945
  time_total_s: 414.28674697875977
  timestamp: 1609337948
  timesteps_since_restore: 0
  training_iteration: 7
  trial_id: 03296_00006

== Status ==
Memory usage on this node: 4.1/240.1 GiB
Using AsyncHyperBand: num_stopped=9
Bracket: Iter 8.000: -1.265156371575594 | Iter 4.000: -1.2387280549645423 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.08756 |     0.6286 |                    7 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00003 | TERMINATED |                 |            8 |   64 |  128 | 0.00245474  | 1.24023 |     0.5764 |                   10 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
| DEFAULT_03296_00007 | TERMINATED |                 |            8 |   16 |    8 | 0.00336708  | 1.27129 |     0.5629 |                   10 |
| DEFAULT_03296_00008 | TERMINATED |                 |           16 |   64 |   16 | 0.0339027   | 2.30548 |     0.1013 |                   10 |
| DEFAULT_03296_00009 | TERMINATED |                 |            8 |   64 |  256 | 0.000997983 | 1.12966 |     0.6112 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1494)[0m [8,  2000] loss: 0.930
[2m[36m(pid=1494)[0m [8,  4000] loss: 0.468
[2m[36m(pid=1494)[0m [8,  6000] loss: 0.321
[2m[36m(pid=1494)[0m [8,  8000] loss: 0.241
[2m[36m(pid=1494)[0m [8, 10000] loss: 0.190
Result for DEFAULT_03296_00006:
  accuracy: 0.6049
  date: 2020-12-30_14-20-01
  done: false
  experiment_id: 9587a66ed6bf4053abde0dbc66ae6de4
  experiment_tag: 6_batch_size=4,l1=64,l2=128,lr=0.0010085
  hostname: e9d3e4cebf23
  iterations_since_restore: 8
  loss: 1.1447097255289556
  node_ip: 172.17.0.2
  pid: 1494
  should_checkpoint: true
  time_since_restore: 467.0319392681122
  time_this_iter_s: 52.74519228935242
  time_total_s: 467.0319392681122
  timestamp: 1609338001
  timesteps_since_restore: 0
  training_iteration: 8
  trial_id: 03296_00006

== Status ==
Memory usage on this node: 4.1/240.1 GiB
Using AsyncHyperBand: num_stopped=9
Bracket: Iter 8.000: -1.2109691176772117 | Iter 4.000: -1.2387280549645423 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.14471 |     0.6049 |                    8 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00003 | TERMINATED |                 |            8 |   64 |  128 | 0.00245474  | 1.24023 |     0.5764 |                   10 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
| DEFAULT_03296_00007 | TERMINATED |                 |            8 |   16 |    8 | 0.00336708  | 1.27129 |     0.5629 |                   10 |
| DEFAULT_03296_00008 | TERMINATED |                 |           16 |   64 |   16 | 0.0339027   | 2.30548 |     0.1013 |                   10 |
| DEFAULT_03296_00009 | TERMINATED |                 |            8 |   64 |  256 | 0.000997983 | 1.12966 |     0.6112 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1494)[0m [9,  2000] loss: 0.878
[2m[36m(pid=1494)[0m [9,  4000] loss: 0.460
[2m[36m(pid=1494)[0m [9,  6000] loss: 0.304
[2m[36m(pid=1494)[0m [9,  8000] loss: 0.235
[2m[36m(pid=1494)[0m [9, 10000] loss: 0.187
Result for DEFAULT_03296_00006:
  accuracy: 0.6131
  date: 2020-12-30_14-20-54
  done: false
  experiment_id: 9587a66ed6bf4053abde0dbc66ae6de4
  experiment_tag: 6_batch_size=4,l1=64,l2=128,lr=0.0010085
  hostname: e9d3e4cebf23
  iterations_since_restore: 9
  loss: 1.126896638777852
  node_ip: 172.17.0.2
  pid: 1494
  should_checkpoint: true
  time_since_restore: 520.0941197872162
  time_this_iter_s: 53.062180519104004
  time_total_s: 520.0941197872162
  timestamp: 1609338054
  timesteps_since_restore: 0
  training_iteration: 9
  trial_id: 03296_00006

== Status ==
Memory usage on this node: 4.1/240.1 GiB
Using AsyncHyperBand: num_stopped=9
Bracket: Iter 8.000: -1.2109691176772117 | Iter 4.000: -1.2387280549645423 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.1269  |     0.6131 |                    9 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00003 | TERMINATED |                 |            8 |   64 |  128 | 0.00245474  | 1.24023 |     0.5764 |                   10 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
| DEFAULT_03296_00007 | TERMINATED |                 |            8 |   16 |    8 | 0.00336708  | 1.27129 |     0.5629 |                   10 |
| DEFAULT_03296_00008 | TERMINATED |                 |           16 |   64 |   16 | 0.0339027   | 2.30548 |     0.1013 |                   10 |
| DEFAULT_03296_00009 | TERMINATED |                 |            8 |   64 |  256 | 0.000997983 | 1.12966 |     0.6112 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1494)[0m [10,  2000] loss: 0.854
[2m[36m(pid=1494)[0m [10,  4000] loss: 0.445
[2m[36m(pid=1494)[0m [10,  6000] loss: 0.294
[2m[36m(pid=1494)[0m [10,  8000] loss: 0.227
[2m[36m(pid=1494)[0m [10, 10000] loss: 0.183
Result for DEFAULT_03296_00006:
  accuracy: 0.6246
  date: 2020-12-30_14-21-47
  done: true
  experiment_id: 9587a66ed6bf4053abde0dbc66ae6de4
  experiment_tag: 6_batch_size=4,l1=64,l2=128,lr=0.0010085
  hostname: e9d3e4cebf23
  iterations_since_restore: 10
  loss: 1.107969244288653
  node_ip: 172.17.0.2
  pid: 1494
  should_checkpoint: true
  time_since_restore: 573.8055233955383
  time_this_iter_s: 53.711403608322144
  time_total_s: 573.8055233955383
  timestamp: 1609338107
  timesteps_since_restore: 0
  training_iteration: 10
  trial_id: 03296_00006

== Status ==
Memory usage on this node: 4.1/240.1 GiB
Using AsyncHyperBand: num_stopped=10
Bracket: Iter 8.000: -1.2109691176772117 | Iter 4.000: -1.2387280549645423 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00006 | RUNNING    | 172.17.0.2:1494 |            4 |   64 |  128 | 0.00100853  | 1.10797 |     0.6246 |                   10 |
| DEFAULT_03296_00000 | TERMINATED |                 |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |                 |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00003 | TERMINATED |                 |            8 |   64 |  128 | 0.00245474  | 1.24023 |     0.5764 |                   10 |
| DEFAULT_03296_00004 | TERMINATED |                 |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |                 |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
| DEFAULT_03296_00007 | TERMINATED |                 |            8 |   16 |    8 | 0.00336708  | 1.27129 |     0.5629 |                   10 |
| DEFAULT_03296_00008 | TERMINATED |                 |           16 |   64 |   16 | 0.0339027   | 2.30548 |     0.1013 |                   10 |
| DEFAULT_03296_00009 | TERMINATED |                 |            8 |   64 |  256 | 0.000997983 | 1.12966 |     0.6112 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


== Status ==
Memory usage on this node: 3.9/240.1 GiB
Using AsyncHyperBand: num_stopped=10
Bracket: Iter 8.000: -1.2109691176772117 | Iter 4.000: -1.2387280549645423 | Iter 2.000: -1.4631414317131042 | Iter 1.000: -1.7858418498992918
Resources requested: 0/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-30_14-12-12
Number of trials: 10/10 (10 TERMINATED)
+---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc   |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_03296_00000 | TERMINATED |       |            2 |   32 |    4 | 0.0585813   | 2.40603 |     0.0992 |                    1 |
| DEFAULT_03296_00001 | TERMINATED |       |            2 |   16 |    4 | 0.00539896  | 2.30928 |     0.1006 |                    1 |
| DEFAULT_03296_00002 | TERMINATED |       |            4 |    4 |   64 | 0.0070063   | 1.9997  |     0.2422 |                    1 |
| DEFAULT_03296_00003 | TERMINATED |       |            8 |   64 |  128 | 0.00245474  | 1.24023 |     0.5764 |                   10 |
| DEFAULT_03296_00004 | TERMINATED |       |            4 |    8 |   16 | 0.00114723  | 1.53924 |     0.4376 |                    2 |
| DEFAULT_03296_00005 | TERMINATED |       |            8 |    8 |    4 | 0.00083459  | 2.30285 |     0.0976 |                    1 |
| DEFAULT_03296_00006 | TERMINATED |       |            4 |   64 |  128 | 0.00100853  | 1.10797 |     0.6246 |                   10 |
| DEFAULT_03296_00007 | TERMINATED |       |            8 |   16 |    8 | 0.00336708  | 1.27129 |     0.5629 |                   10 |
| DEFAULT_03296_00008 | TERMINATED |       |           16 |   64 |   16 | 0.0339027   | 2.30548 |     0.1013 |                   10 |
| DEFAULT_03296_00009 | TERMINATED |       |            8 |   64 |  256 | 0.000997983 | 1.12966 |     0.6112 |                   10 |
+---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+


Best trial config: {'l1': 64, 'l2': 128, 'lr': 0.0010085299609227899, 'batch_size': 4}
Best trial final validation loss: 1.107969244288653
Best trial final validation accuracy: 0.6246
Files already downloaded and verified
Files already downloaded and verified
Best trial test set accuracy: 0.6243
</pre></div>
</div>
<p>If you run the code, an example output could look like this:</p>
<p>Most trials have been stopped early in order to avoid wasting resources.
The best performing trial achieved a validation accuracy of about 58%, which could
be confirmed on the test set.</p>
<p>So that’s it! You can now tune the parameters of your PyTorch models.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 9 minutes  58.037 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-beginner-hyperparameter-tuning-tutorial-py">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" download="" href="../_downloads/95074cd7ce8c3e57a92e7a9c49182e6a/hyperparameter_tuning_tutorial.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">hyperparameter_tuning_tutorial.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" download="" href="../_downloads/c24b93738bc036c1b66d0387555bf69a/hyperparameter_tuning_tutorial.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">hyperparameter_tuning_tutorial.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>
</article>
</div>
<footer>
<div aria-label="footer navigation" class="rst-footer-buttons" role="navigation">
<a accesskey="n" class="btn btn-neutral float-right" href="../intermediate/pruning_tutorial.html" rel="next" title="Pruning Tutorial">Next <img class="next-page" src="../_static/images/chevron-right-orange.svg"/></a>
<a accesskey="p" class="btn btn-neutral" href="profiler.html" rel="prev" title="Profiling your PyTorch Module"><img class="previous-page" src="../_static/images/chevron-right-orange.svg"/> Previous</a>
</div>
<hr class="helpful-hr hr-top"/>
<div class="helpful-container">
<div class="helpful-question">Was this helpful?</div>
<div class="helpful-question yes-link" data-behavior="was-this-helpful-event" data-response="yes">Yes</div>
<div class="helpful-question no-link" data-behavior="was-this-helpful-event" data-response="no">No</div>
<div class="was-helpful-thank-you">Thank you</div>
</div>
<hr class="helpful-hr hr-bottom"/>
<div role="contentinfo">
<p>
        © Copyright 2017, PyTorch.

    </p>
</div>
<div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
</footer>
</div>
</div>
<div class="pytorch-content-right" id="pytorch-content-right">
<div class="pytorch-right-menu" id="pytorch-right-menu">
<div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
<ul>
<li><a class="reference internal" href="#">Hyperparameter tuning with Ray Tune</a><ul>
<li><a class="reference internal" href="#setup-imports">Setup / Imports</a></li>
<li><a class="reference internal" href="#data-loaders">Data loaders</a></li>
<li><a class="reference internal" href="#configurable-neural-network">Configurable neural network</a></li>
<li><a class="reference internal" href="#the-train-function">The train function</a><ul>
<li><a class="reference internal" href="#adding-multi-gpu-support-with-dataparallel">Adding (multi) GPU support with DataParallel</a></li>
<li><a class="reference internal" href="#communicating-with-ray-tune">Communicating with Ray Tune</a></li>
<li><a class="reference internal" href="#full-training-function">Full training function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#test-set-accuracy">Test set accuracy</a></li>
<li><a class="reference internal" href="#configuring-the-search-space">Configuring the search space</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</section>
</div>
<script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js" type="text/javascript"></script>
<script src="../_static/jquery.js" type="text/javascript"></script>
<script src="../_static/underscore.js" type="text/javascript"></script>
<script src="../_static/doctools.js" type="text/javascript"></script>
<script src="../_static/clipboard.min.js" type="text/javascript"></script>
<script src="../_static/copybutton.js" type="text/javascript"></script>
<script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<script src="../_static/js/vendor/popper.min.js" type="text/javascript"></script>
<script src="../_static/js/vendor/bootstrap.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
<script src="../_static/js/theme.js" type="text/javascript"></script>
<script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-117752657-2"></script>
<script>

  window.dataLayer = window.dataLayer || [];

  function gtag(){dataLayer.push(arguments);}

  gtag('js', new Date());
  gtag('config', 'UA-117752657-2');

</script>
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window,document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '243028289693773');
  fbq('track', 'PageView');

  $("[data-behavior='call-to-action-event']").on('click', function(){
    fbq('trackCustom', "Download", {
      tutorialTitle: $('h1:first').text(),
      downloadLink: this.href,
      tutorialLink: window.location.href,
      downloadTitle: $(this).attr("data-response")
    });

    gtag('event', 'click', {
      'event_category': 'Download',
      'event_label': $(this).attr("data-response")
    });

    gtag('event', 'click', {
      'event_category': $(this).attr("data-response"),
      'event_label': $("h1").first().text(),
      'tutorial_link': window.location.href
    });
   });

   $("[data-behavior='was-this-helpful-event']").on('click', function(){
    $(".helpful-question").hide();
    $(".was-helpful-thank-you").show();

    fbq('trackCustom', "Was this Helpful?", {
      tutorialLink: window.location.href,
      tutorialTitle: $('h1:first').text(),
      helpful: $(this).attr("data-response")
    });

    gtag('event', $(this).attr("data-response"), {
      'event_category': 'Was this Helpful?',
      'event_label': $(this).attr("data-response")
    });

    gtag('event', $(this).attr("data-response"), {
      'event_category': 'Was this Helpful?',
      'event_label': $("h1").first().text()
    });
   });

   if (location.pathname == "/") {
     $(".helpful-container").hide();
     $(".hr-bottom").hide();
   }
</script>
<noscript>
<img height="1" src="https://www.facebook.com/tr?id=243028289693773&amp;ev=PageView
  &amp;noscript=1" width="1"/>
</noscript>
<img alt="" height="1" src="https://www.googleadservices.com/pagead/conversion/795629140/?label=txkmCPmdtosBENSssfsC&amp;guid=ON&amp;script=0" style="border-style:none;" width="1"/>
<!-- Begin Footer -->
<div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
<div class="container">
<div class="row">
<div class="col-md-4 text-center">
<h2>Docs</h2>
<p>Access comprehensive developer documentation for PyTorch</p>
<a class="with-right-arrow" href="https://pytorch.org/docs/stable/index.html">View Docs</a>
</div>
<div class="col-md-4 text-center">
<h2>Tutorials</h2>
<p>Get in-depth tutorials for beginners and advanced developers</p>
<a class="with-right-arrow" href="https://pytorch.org/tutorials">View Tutorials</a>
</div>
<div class="col-md-4 text-center">
<h2>Resources</h2>
<p>Find development resources and get your questions answered</p>
<a class="with-right-arrow" href="https://pytorch.org/resources">View Resources</a>
</div>
</div>
</div>
</div>
<footer class="site-footer">
<div class="container footer-container">
<div class="footer-logo-wrapper">
<a class="footer-logo" href="https://pytorch.org/"></a>
</div>
<div class="footer-links-wrapper">
<div class="footer-links-col">
<ul>
<li class="list-title"><a href="https://pytorch.org/">PyTorch</a></li>
<li><a href="https://pytorch.org/get-started">Get Started</a></li>
<li><a href="https://pytorch.org/features">Features</a></li>
<li><a href="https://pytorch.org/ecosystem">Ecosystem</a></li>
<li><a href="https://pytorch.org/blog/">Blog</a></li>
<li><a href="https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md">Contributing</a></li>
</ul>
</div>
<div class="footer-links-col">
<ul>
<li class="list-title"><a href="https://pytorch.org/resources">Resources</a></li>
<li><a href="https://pytorch.org/tutorials">Tutorials</a></li>
<li><a href="https://pytorch.org/docs/stable/index.html">Docs</a></li>
<li><a href="https://discuss.pytorch.org" target="_blank">Discuss</a></li>
<li><a href="https://github.com/pytorch/pytorch/issues" target="_blank">Github Issues</a></li>
<li><a href="https://pytorch.org/assets/brand-guidelines/PyTorch-Brand-Guidelines.pdf" target="_blank">Brand Guidelines</a></li>
</ul>
</div>
<div class="footer-links-col follow-us-col">
<ul>
<li class="list-title">Stay Connected</li>
<li>
<div id="mc_embed_signup">
<form action="https://twitter.us14.list-manage.com/subscribe/post?u=75419c71fe0a935e53dfa4a3f&amp;id=91d0dccd39" class="email-subscribe-form validate" id="mc-embedded-subscribe-form" method="post" name="mc-embedded-subscribe-form" novalidate="" target="_blank">
<div class="email-subscribe-form-fields-wrapper" id="mc_embed_signup_scroll">
<div class="mc-field-group">
<label for="mce-EMAIL" style="display:none;">Email Address</label>
<input class="required email" id="mce-EMAIL" name="EMAIL" placeholder="Email Address" type="email" value=""/>
</div>
<div class="clear" id="mce-responses">
<div class="response" id="mce-error-response" style="display:none"></div>
<div class="response" id="mce-success-response" style="display:none"></div>
</div> <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
<div aria-hidden="true" style="position: absolute; left: -5000px;"><input name="b_75419c71fe0a935e53dfa4a3f_91d0dccd39" tabindex="-1" type="text" value=""/></div>
<div class="clear">
<input class="button email-subscribe-button" id="mc-embedded-subscribe" name="subscribe" type="submit" value=""/>
</div>
</div>
</form>
</div>
</li>
</ul>
<div class="footer-social-icons">
<a class="facebook" href="https://www.facebook.com/pytorch" target="_blank"></a>
<a class="twitter" href="https://twitter.com/pytorch" target="_blank"></a>
<a class="youtube" href="https://www.youtube.com/pytorch" target="_blank"></a>
</div>
</div>
</div>
</div>
</footer>
<div class="cookie-banner-wrapper">
<div class="container">
<p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
<img class="close-button" src="../_static/images/pytorch-x.svg">
</img></div>
</div>
<!-- End Footer -->
<!-- Begin Mobile Menu -->
<div class="mobile-main-menu">
<div class="container-fluid">
<div class="container">
<div class="mobile-main-menu-header-container">
<a aria-label="PyTorch" class="header-logo" href="https://pytorch.org/"></a>
<a class="main-menu-close-button" data-behavior="close-mobile-menu" href="#"></a>
</div>
</div>
</div>
<div class="mobile-main-menu-links-container">
<div class="main-menu">
<ul>
<li>
<a href="https://pytorch.org/get-started">Get Started</a>
</li>
<li>
<a href="https://pytorch.org/ecosystem">Ecosystem</a>
</li>
<li>
<a href="https://pytorch.org/mobile">Mobile</a>
</li>
<li>
<a href="https://pytorch.org/hub">PyTorch Hub</a>
</li>
<li>
<a href="https://pytorch.org/blog/">Blog</a>
</li>
<li class="active">
<a href="https://pytorch.org/tutorials">Tutorials</a>
</li>
<li class="resources-mobile-menu-title">
            Docs
          </li>
<ul class="resources-mobile-menu-items">
<li>
<a href="https://pytorch.org/docs/stable/index.html">PyTorch</a>
</li>
<li>
<a href="https://pytorch.org/audio/stable/index.html">torchaudio</a>
</li>
<li>
<a href="https://pytorch.org/text/stable/index.html">torchtext</a>
</li>
<li>
<a href="https://pytorch.org/docs/stable/torchvision/">torchvision</a>
</li>
<li>
<a href="https://pytorch.org/elastic/">TorchElastic</a>
</li>
<li>
<a href="https://pytorch.org/serve/">TorchServe</a>
</li>
<li>
<a href="https://pytorch.org/xla">PyTorch on XLA Devices</a>
</li>
</ul>
<li class="resources-mobile-menu-title">
            Resources
          </li>
<ul class="resources-mobile-menu-items">
<li>
<a href="https://pytorch.org/resources">Developer Resources</a>
</li>
<li>
<a href="https://pytorch.org/features">About</a>
</li>
<li>
<a href="https://pytorch.org/hub">Models (Beta)</a>
</li>
<li>
<a href="https://pytorch.org/#community-module">Community</a>
</li>
<li>
<a href="https://discuss.pytorch.org/">Forums</a>
</li>
</ul>
<li>
<a href="https://github.com/pytorch/pytorch">Github</a>
</li>
</ul>
</div>
</div>
</div>
<!-- End Mobile Menu -->
<script src="../_static/js/vendor/anchor.min.js" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>