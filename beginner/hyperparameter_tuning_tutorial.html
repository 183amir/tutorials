
<!DOCTYPE html>

<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Hyperparameter tuning with Ray Tune — PyTorch Tutorials 1.7.1 documentation</title>
<link href="../_static/css/theme.css" rel="stylesheet" type="text/css"/>
<!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
<link href="../_static/copybutton.css" rel="stylesheet" type="text/css"/>
<link href="../_static/gallery.css" rel="stylesheet" type="text/css"/>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="../intermediate/pruning_tutorial.html" rel="next" title="Pruning Tutorial"/>
<link href="../advanced/dispatcher.html" rel="prev" title="Registering a Dispatched Operator in C++"/>
<script src="../_static/js/modernizr.min.js"></script>
<!-- Preload the theme fonts -->
<link as="font" crossorigin="anonymous" href="../_static/fonts/FreightSans/freight-sans-book.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="../_static/fonts/FreightSans/freight-sans-medium.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="../_static/fonts/FreightSans/freight-sans-bold.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" rel="preload" type="font/woff2"/>
<!-- Preload the katex fonts -->
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" rel="preload" type="font/woff2"/>
</head>
<div class="container-fluid header-holder tutorials-header" id="header-holder">
<div class="container">
<div class="header-container">
<a aria-label="PyTorch" class="header-logo" href="https://pytorch.org/"></a>
<div class="main-menu">
<ul>
<li>
<a href="https://pytorch.org/get-started">Get Started</a>
</li>
<li>
<a href="https://pytorch.org/ecosystem">Ecosystem</a>
</li>
<li>
<a href="https://pytorch.org/mobile">Mobile</a>
</li>
<li>
<a href="https://pytorch.org/blog/">Blog</a>
</li>
<li class="active">
<a href="https://pytorch.org/tutorials">Tutorials</a>
</li>
<li>
<div class="resources-dropdown" data-toggle="resources-dropdown" id="resourcesDropdownButton">
<a class="resource-option with-down-orange-arrow">
                Docs
              </a>
<div class="resources-dropdown-menu">
<a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/docs/stable/index.html">
<span class="dropdown-title">PyTorch</span>
<p></p>
</a>
<a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/audio/stable/index.html">
<span class="dropdown-title">torchaudio</span>
<p></p>
</a>
<a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/text/stable/index.html">
<span class="dropdown-title">torchtext</span>
<p></p>
</a>
<a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/docs/stable/torchvision/">
<span class="dropdown-title">torchvision</span>
<p></p>
</a>
<a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/elastic/">
<span class="dropdown-title">TorchElastic</span>
<p></p>
</a>
<a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/serve/">
<span class="dropdown-title">TorchServe</span>
<p></p>
</a>
<a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/xla">
<span class="dropdown-title">PyTorch on XLA Devices</span>
<p></p>
</a>
</div>
</div></li>
<li>
<div class="resources-dropdown" data-toggle="resources-dropdown" id="resourcesDropdownButton">
<a class="resource-option with-down-arrow">
                Resources
              </a>
<div class="resources-dropdown-menu">
<a class="nav-dropdown-item" href="https://pytorch.org/features">
<span class="dropdown-title">About</span>
<p>Learn about PyTorch’s features and capabilities</p>
</a>
<a class="nav-dropdown-item" href="https://pytorch.org/#community-module">
<span class="dropdown-title">Community</span>
<p>Join the PyTorch developer community to contribute, learn, and get your questions answered.</p>
</a>
<a class="nav-dropdown-item" href="https://pytorch.org/resources">
<span class="dropdown-title">Developer Resources</span>
<p>Find resources and get questions answered</p>
</a>
<a class="nav-dropdown-item" href="https://discuss.pytorch.org/" target="_blank">
<span class="dropdown-title">Forums</span>
<p>A place to discuss PyTorch code, issues, install, research</p>
</a>
<a class="nav-dropdown-item" href="https://pytorch.org/hub">
<span class="dropdown-title">Models (Beta)</span>
<p>Discover, publish, and reuse pre-trained models</p>
</a>
</div>
</div>
</li>
<li>
<a href="https://github.com/pytorch/pytorch">Github</a>
</li>
</ul>
</div>
<a class="main-menu-open-button" data-behavior="open-mobile-menu" href="#"></a>
</div>
</div>
</div>
<body class="pytorch-body">
<div class="table-of-contents-link-wrapper">
<span>Table of Contents</span>
<a class="toggle-table-of-contents" data-behavior="toggle-table-of-contents" href="#"></a>
</div>
<nav class="pytorch-left-menu" data-toggle="wy-nav-shift" id="pytorch-left-menu">
<div class="pytorch-side-scroll">
<div aria-label="main navigation" class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation">
<div class="pytorch-left-menu-search">
<div class="version">
                  1.7.1
                </div>
<div role="search">
<form action="../search.html" class="wy-form" id="rtd-search-form" method="get">
<input name="q" placeholder="Search Tutorials" type="text"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
</div>
</div>
<p class="caption"><span class="caption-text">PyTorch Recipes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../recipes/recipes_index.html">See All Recipes</a></li>
</ul>
<p class="caption"><span class="caption-text">Learning PyTorch</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="deep_learning_60min_blitz.html">Deep Learning with PyTorch: A 60 Minute Blitz</a></li>
<li class="toctree-l1"><a class="reference internal" href="pytorch_with_examples.html">Learning PyTorch with Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="nn_tutorial.html">What is <cite>torch.nn</cite> <em>really</em>?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/tensorboard_tutorial.html">Visualizing Models, Data, and Training with TensorBoard</a></li>
</ul>
<p class="caption"><span class="caption-text">Image/Video</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/torchvision_tutorial.html">TorchVision Object Detection Finetuning Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="transfer_learning_tutorial.html">Transfer Learning for Computer Vision Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="fgsm_tutorial.html">Adversarial Example Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="dcgan_faces_tutorial.html">DCGAN Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Audio</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="audio_preprocessing_tutorial.html">Audio I/O and Pre-Processing with torchaudio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/speech_command_recognition_with_torchaudio.html">SyntaxError</a></li>
</ul>
<p class="caption"><span class="caption-text">Text</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="transformer_tutorial.html">Sequence-to-Sequence Modeling with nn.Transformer and TorchText</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/char_rnn_classification_tutorial.html">NLP From Scratch: Classifying Names with a Character-Level RNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/char_rnn_generation_tutorial.html">NLP From Scratch: Generating Names with a Character-Level RNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/seq2seq_translation_tutorial.html">NLP From Scratch: Translation with a Sequence to Sequence Network and Attention</a></li>
<li class="toctree-l1"><a class="reference internal" href="text_sentiment_ngrams_tutorial.html">Text Classification with TorchText</a></li>
<li class="toctree-l1"><a class="reference internal" href="torchtext_translation_tutorial.html">Language Translation with TorchText</a></li>
</ul>
<p class="caption"><span class="caption-text">Reinforcement Learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/reinforcement_q_learning.html">Reinforcement Learning (DQN) Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/mario_rl_tutorial.html">Train a Mario-playing RL Agent</a></li>
</ul>
<p class="caption"><span class="caption-text">Deploying PyTorch Models in Production</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/flask_rest_api_tutorial.html">Deploying PyTorch in Python via a REST API with Flask</a></li>
<li class="toctree-l1"><a class="reference internal" href="Intro_to_TorchScript_tutorial.html">Introduction to TorchScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/cpp_export.html">Loading a TorchScript Model in C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/super_resolution_with_onnxruntime.html">(optional) Exporting a Model from PyTorch to ONNX and Running it using ONNX Runtime</a></li>
</ul>
<p class="caption"><span class="caption-text">Frontend APIs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/named_tensor_tutorial.html">(prototype) Introduction to Named Tensors in PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/memory_format_tutorial.html">(beta) Channels Last Memory Format in PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/cpp_frontend.html">Using the PyTorch C++ Frontend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/cpp_extension.html">Custom C++ and CUDA Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/torch_script_custom_ops.html">Extending TorchScript with Custom C++ Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/torch_script_custom_classes.html">Extending TorchScript with Custom C++ Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/torch-script-parallelism.html">Dynamic Parallelism in TorchScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/cpp_autograd.html">Autograd in C++ Frontend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/dispatcher.html">Registering a Dispatched Operator in C++</a></li>
</ul>
<p class="caption"><span class="caption-text">Model Optimization</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Hyperparameter tuning with Ray Tune</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/pruning_tutorial.html">Pruning Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/dynamic_quantization_tutorial.html">(beta) Dynamic Quantization on an LSTM Word Language Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/dynamic_quantization_bert_tutorial.html">(beta) Dynamic Quantization on BERT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/static_quantization_tutorial.html">(beta) Static Quantization with Eager Mode in PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/quantized_transfer_learning_tutorial.html">(beta) Quantized Transfer Learning for Computer Vision Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Parallel and Distributed Training</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dist_overview.html">PyTorch Distributed Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/model_parallel_tutorial.html">Single-Machine Model Parallel Best Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/ddp_tutorial.html">Getting Started with Distributed Data Parallel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/dist_tuto.html">Writing Distributed Applications with PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/rpc_tutorial.html">Getting Started with Distributed RPC Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/rpc_param_server_tutorial.html">Implementing a Parameter Server Using Distributed RPC Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/dist_pipeline_parallel_tutorial.html">Distributed Pipeline Parallelism Using RPC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/rpc_async_execution.html">Implementing Batch RPC Processing Using Asynchronous Executions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/rpc_ddp_tutorial.html">Combining Distributed DataParallel with Distributed RPC Framework</a></li>
</ul>
</div>
</div>
</nav>
<div class="pytorch-container">
<div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
<div class="pytorch-breadcrumbs-wrapper">
<div aria-label="breadcrumbs navigation" role="navigation">
<ul class="pytorch-breadcrumbs">
<li>
<a href="../index.html">
          
            Tutorials
          
        </a> &gt;
      </li>
<li>Hyperparameter tuning with Ray Tune</li>
<li class="pytorch-breadcrumbs-aside">
<a href="../_sources/beginner/hyperparameter_tuning_tutorial.rst.txt" rel="nofollow"><img src="../_static/images/view-page-source-icon.svg"/></a>
</li>
</ul>
</div>
</div>
<div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
</div>
<section class="pytorch-content-wrap" data-toggle="wy-nav-shift" id="pytorch-content-wrap">
<div class="pytorch-content-left">
<div class="pytorch-call-to-action-links">
<div id="tutorial-type">beginner/hyperparameter_tuning_tutorial</div>
<div id="google-colab-link">
<img class="call-to-action-img" src="../_static/images/pytorch-colab.svg"/>
<div class="call-to-action-desktop-view">Run in Google Colab</div>
<div class="call-to-action-mobile-view">Colab</div>
</div>
<div id="download-notebook-link">
<img class="call-to-action-notebook-img" src="../_static/images/pytorch-download.svg"/>
<div class="call-to-action-desktop-view">Download Notebook</div>
<div class="call-to-action-mobile-view">Notebook</div>
</div>
<div id="github-view-link">
<img class="call-to-action-img" src="../_static/images/pytorch-github.svg"/>
<div class="call-to-action-desktop-view">View on GitHub</div>
<div class="call-to-action-mobile-view">GitHub</div>
</div>
</div>
<div class="rst-content">
<div class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<article class="pytorch-article" id="pytorch-article" itemprop="articleBody">
<div class="sphx-glr-download-link-note admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Click <a class="reference internal" href="#sphx-glr-download-beginner-hyperparameter-tuning-tutorial-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="hyperparameter-tuning-with-ray-tune">
<span id="sphx-glr-beginner-hyperparameter-tuning-tutorial-py"></span><h1>Hyperparameter tuning with Ray Tune<a class="headerlink" href="#hyperparameter-tuning-with-ray-tune" title="Permalink to this headline">¶</a></h1>
<p>Hyperparameter tuning can make the difference between an average model and a highly
accurate one. Often simple things like choosing a different learning rate or changing
a network layer size can have a dramatic impact on your model performance.</p>
<p>Fortunately, there are tools that help with finding the best combination of parameters.
<a class="reference external" href="https://docs.ray.io/en/latest/tune.html">Ray Tune</a> is an industry standard tool for
distributed hyperparameter tuning. Ray Tune includes the latest hyperparameter search
algorithms, integrates with TensorBoard and other analysis libraries, and natively
supports distributed training through <a class="reference external" href="https://ray.io/">Ray’s distributed machine learning engine</a>.</p>
<p>In this tutorial, we will show you how to integrate Ray Tune into your PyTorch
training workflow. We will extend <a class="reference external" href="https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html">this tutorial from the PyTorch documentation</a> for training
a CIFAR10 image classifier.</p>
<p>As you will see, we only need to add some slight modifications. In particular, we
need to</p>
<ol class="arabic simple">
<li>wrap data loading and training in functions,</li>
<li>make some network parameters configurable,</li>
<li>add checkpointing (optional),</li>
<li>and define the search space for the model tuning</li>
</ol>
<div class="line-block">
<div class="line"><br/></div>
</div>
<p>To run this tutorial, please make sure the following packages are
installed:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">ray[tune]</span></code>: Distributed hyperparameter tuning library</li>
<li><code class="docutils literal notranslate"><span class="pre">torchvision</span></code>: For the data transformers</li>
</ul>
<div class="section" id="setup-imports">
<h2>Setup / Imports<a class="headerlink" href="#setup-imports" title="Permalink to this headline">¶</a></h2>
<p>Let’s start with the imports:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">random_split</span>
<span class="kn">import</span> <span class="nn">torchvision</span>
<span class="kn">import</span> <span class="nn">torchvision.transforms</span> <span class="k">as</span> <span class="nn">transforms</span>
<span class="kn">from</span> <span class="nn">ray</span> <span class="kn">import</span> <span class="n">tune</span>
<span class="kn">from</span> <span class="nn">ray.tune</span> <span class="kn">import</span> <span class="n">CLIReporter</span>
<span class="kn">from</span> <span class="nn">ray.tune.schedulers</span> <span class="kn">import</span> <span class="n">ASHAScheduler</span>
</pre></div>
</div>
<p>Most of the imports are needed for building the PyTorch model. Only the last three
imports are for Ray Tune.</p>
</div>
<div class="section" id="data-loaders">
<h2>Data loaders<a class="headerlink" href="#data-loaders" title="Permalink to this headline">¶</a></h2>
<p>We wrap the data loaders in their own function and pass a global data directory.
This way we can share a data directory between different trials.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="n">data_dir</span><span class="o">=</span><span class="s2">"./data"</span><span class="p">):</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="p">])</span>

    <span class="n">trainset</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">(</span>
        <span class="n">root</span><span class="o">=</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>

    <span class="n">testset</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">(</span>
        <span class="n">root</span><span class="o">=</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">trainset</span><span class="p">,</span> <span class="n">testset</span>
</pre></div>
</div>
</div>
<div class="section" id="configurable-neural-network">
<h2>Configurable neural network<a class="headerlink" href="#configurable-neural-network" title="Permalink to this headline">¶</a></h2>
<p>We can only tune those parameters that are configurable. In this example, we can specify
the layer sizes of the fully connected layers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l1</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">l2</span><span class="o">=</span><span class="mi">84</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Net</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pool</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">16</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
</div>
<div class="section" id="the-train-function">
<h2>The train function<a class="headerlink" href="#the-train-function" title="Permalink to this headline">¶</a></h2>
<p>Now it gets interesting, because we introduce some changes to the example <a class="reference external" href="https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html">from the PyTorch
documentation</a>.</p>
<p>We wrap the training script in a function <code class="docutils literal notranslate"><span class="pre">train_cifar(config,</span> <span class="pre">checkpoint_dir=None,</span> <span class="pre">data_dir=None)</span></code>.
As you can guess, the <code class="docutils literal notranslate"><span class="pre">config</span></code> parameter will receive the hyperparameters we would like to
train with. The <code class="docutils literal notranslate"><span class="pre">checkpoint_dir</span></code> parameter is used to restore checkpoints. The <code class="docutils literal notranslate"><span class="pre">data_dir</span></code> specifies
the directory where we load and store the data, so multiple runs can share the same data source.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">"l1"</span><span class="p">],</span> <span class="n">config</span><span class="p">[</span><span class="s2">"l2"</span><span class="p">])</span>

<span class="k">if</span> <span class="n">checkpoint_dir</span><span class="p">:</span>
    <span class="n">model_state</span><span class="p">,</span> <span class="n">optimizer_state</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">checkpoint_dir</span><span class="p">,</span> <span class="s2">"checkpoint"</span><span class="p">))</span>
    <span class="n">net</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">model_state</span><span class="p">)</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">optimizer_state</span><span class="p">)</span>
</pre></div>
</div>
<p>The learning rate of the optimizer is made configurable, too:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s2">"lr"</span><span class="p">],</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
</pre></div>
</div>
<p>We also split the training data into a training and validation subset. We thus train on
80% of the data and calculate the validation loss on the remaining 20%. The batch sizes
with which we iterate through the training and test sets are configurable as well.</p>
<div class="section" id="adding-multi-gpu-support-with-dataparallel">
<h3>Adding (multi) GPU support with DataParallel<a class="headerlink" href="#adding-multi-gpu-support-with-dataparallel" title="Permalink to this headline">¶</a></h3>
<p>Image classification benefits largely from GPUs. Luckily, we can continue to use
PyTorch’s abstractions in Ray Tune. Thus, we can wrap our model in <code class="docutils literal notranslate"><span class="pre">nn.DataParallel</span></code>
to support data parallel training on multiple GPUs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="s2">"cpu"</span>
<span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
    <span class="n">device</span> <span class="o">=</span> <span class="s2">"cuda:0"</span>
    <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">device_count</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">DataParallel</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
<p>By using a <code class="docutils literal notranslate"><span class="pre">device</span></code> variable we make sure that training also works when we have
no GPUs available. PyTorch requires us to send our data to the GPU memory explicitly,
like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trainloader</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
    <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
<p>The code now supports training on CPUs, on a single GPU, and on multiple GPUs. Notably, Ray
also supports <a class="reference external" href="https://docs.ray.io/en/master/using-ray-with-gpus.html#fractional-gpus">fractional GPUs</a>
so we can share GPUs among trials, as long as the model still fits on the GPU memory. We’ll come back
to that later.</p>
</div>
<div class="section" id="communicating-with-ray-tune">
<h3>Communicating with Ray Tune<a class="headerlink" href="#communicating-with-ray-tune" title="Permalink to this headline">¶</a></h3>
<p>The most interesting part is the communication with Ray Tune:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">tune</span><span class="o">.</span><span class="n">checkpoint_dir</span><span class="p">(</span><span class="n">epoch</span><span class="p">)</span> <span class="k">as</span> <span class="n">checkpoint_dir</span><span class="p">:</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">checkpoint_dir</span><span class="p">,</span> <span class="s2">"checkpoint"</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">((</span><span class="n">net</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()),</span> <span class="n">path</span><span class="p">)</span>

<span class="n">tune</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="p">(</span><span class="n">val_loss</span> <span class="o">/</span> <span class="n">val_steps</span><span class="p">),</span> <span class="n">accuracy</span><span class="o">=</span><span class="n">correct</span> <span class="o">/</span> <span class="n">total</span><span class="p">)</span>
</pre></div>
</div>
<p>Here we first save a checkpoint and then report some metrics back to Ray Tune. Specifically,
we send the validation loss and accuracy back to Ray Tune. Ray Tune can then use these metrics
to decide which hyperparameter configuration lead to the best results. These metrics
can also be used to stop bad performing trials early in order to avoid wasting
resources on those trials.</p>
<p>The checkpoint saving is optional, however, it is necessary if we wanted to use advanced
schedulers like
<a class="reference external" href="https://docs.ray.io/en/master/tune/tutorials/tune-advanced-tutorial.html">Population Based Training</a>.
Also, by saving the checkpoint we can later load the trained models and validate them
on a test set.</p>
</div>
<div class="section" id="full-training-function">
<h3>Full training function<a class="headerlink" href="#full-training-function" title="Permalink to this headline">¶</a></h3>
<p>The full code example looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">train_cifar</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">checkpoint_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">"l1"</span><span class="p">],</span> <span class="n">config</span><span class="p">[</span><span class="s2">"l2"</span><span class="p">])</span>

    <span class="n">device</span> <span class="o">=</span> <span class="s2">"cpu"</span>
    <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s2">"cuda:0"</span>
        <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">device_count</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">DataParallel</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
    <span class="n">net</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

    <span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s2">"lr"</span><span class="p">],</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">checkpoint_dir</span><span class="p">:</span>
        <span class="n">model_state</span><span class="p">,</span> <span class="n">optimizer_state</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">checkpoint_dir</span><span class="p">,</span> <span class="s2">"checkpoint"</span><span class="p">))</span>
        <span class="n">net</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">model_state</span><span class="p">)</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">optimizer_state</span><span class="p">)</span>

    <span class="n">trainset</span><span class="p">,</span> <span class="n">testset</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>

    <span class="n">test_abs</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">trainset</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
    <span class="n">train_subset</span><span class="p">,</span> <span class="n">val_subset</span> <span class="o">=</span> <span class="n">random_split</span><span class="p">(</span>
        <span class="n">trainset</span><span class="p">,</span> <span class="p">[</span><span class="n">test_abs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">trainset</span><span class="p">)</span> <span class="o">-</span> <span class="n">test_abs</span><span class="p">])</span>

    <span class="n">trainloader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">train_subset</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">"batch_size"</span><span class="p">]),</span>
        <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">num_workers</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">valloader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">val_subset</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">"batch_size"</span><span class="p">]),</span>
        <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">num_workers</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>  <span class="c1"># loop over the dataset multiple times</span>
        <span class="n">running_loss</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">epoch_steps</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trainloader</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="c1"># get the inputs; data is a list of [inputs, labels]</span>
            <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span>
            <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

            <span class="c1"># zero the parameter gradients</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>

            <span class="c1"># forward + backward + optimize</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

            <span class="c1"># print statistics</span>
            <span class="n">running_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
            <span class="n">epoch_steps</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2000</span> <span class="o">==</span> <span class="mi">1999</span><span class="p">:</span>  <span class="c1"># print every 2000 mini-batches</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">"[</span><span class="si">%d</span><span class="s2">, </span><span class="si">%5d</span><span class="s2">] loss: </span><span class="si">%.3f</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                                                <span class="n">running_loss</span> <span class="o">/</span> <span class="n">epoch_steps</span><span class="p">))</span>
                <span class="n">running_loss</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c1"># Validation loss</span>
        <span class="n">val_loss</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">val_steps</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">valloader</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
                <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span>
                <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

                <span class="n">outputs</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">predicted</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">outputs</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">total</span> <span class="o">+=</span> <span class="n">labels</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">correct</span> <span class="o">+=</span> <span class="p">(</span><span class="n">predicted</span> <span class="o">==</span> <span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

                <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
                <span class="n">val_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
                <span class="n">val_steps</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">with</span> <span class="n">tune</span><span class="o">.</span><span class="n">checkpoint_dir</span><span class="p">(</span><span class="n">epoch</span><span class="p">)</span> <span class="k">as</span> <span class="n">checkpoint_dir</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">checkpoint_dir</span><span class="p">,</span> <span class="s2">"checkpoint"</span><span class="p">)</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">((</span><span class="n">net</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()),</span> <span class="n">path</span><span class="p">)</span>

        <span class="n">tune</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="p">(</span><span class="n">val_loss</span> <span class="o">/</span> <span class="n">val_steps</span><span class="p">),</span> <span class="n">accuracy</span><span class="o">=</span><span class="n">correct</span> <span class="o">/</span> <span class="n">total</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Finished Training"</span><span class="p">)</span>
</pre></div>
</div>
<p>As you can see, most of the code is adapted directly from the original example.</p>
</div>
</div>
<div class="section" id="test-set-accuracy">
<h2>Test set accuracy<a class="headerlink" href="#test-set-accuracy" title="Permalink to this headline">¶</a></h2>
<p>Commonly the performance of a machine learning model is tested on a hold-out test
set with data that has not been used for training the model. We also wrap this in a
function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_accuracy</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">"cpu"</span><span class="p">):</span>
    <span class="n">trainset</span><span class="p">,</span> <span class="n">testset</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">()</span>

    <span class="n">testloader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">testset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">testloader</span><span class="p">:</span>
            <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span>
            <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">predicted</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">outputs</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">total</span> <span class="o">+=</span> <span class="n">labels</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">correct</span> <span class="o">+=</span> <span class="p">(</span><span class="n">predicted</span> <span class="o">==</span> <span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">correct</span> <span class="o">/</span> <span class="n">total</span>
</pre></div>
</div>
<p>The function also expects a <code class="docutils literal notranslate"><span class="pre">device</span></code> parameter, so we can do the
test set validation on a GPU.</p>
</div>
<div class="section" id="configuring-the-search-space">
<h2>Configuring the search space<a class="headerlink" href="#configuring-the-search-space" title="Permalink to this headline">¶</a></h2>
<p>Lastly, we need to define Ray Tune’s search space. Here is an example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"l1"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">sample_from</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="mi">2</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)),</span>
    <span class="s2">"l2"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">sample_from</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="mi">2</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)),</span>
    <span class="s2">"lr"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">),</span>
    <span class="s2">"batch_size"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">])</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">tune.sample_from()</span></code> function makes it possible to define your own sample
methods to obtain hyperparameters. In this example, the <code class="docutils literal notranslate"><span class="pre">l1</span></code> and <code class="docutils literal notranslate"><span class="pre">l2</span></code> parameters
should be powers of 2 between 4 and 256, so either 4, 8, 16, 32, 64, 128, or 256.
The <code class="docutils literal notranslate"><span class="pre">lr</span></code> (learning rate) should be uniformly sampled between 0.0001 and 0.1. Lastly,
the batch size is a choice between 2, 4, 8, and 16.</p>
<p>At each trial, Ray Tune will now randomly sample a combination of parameters from these
search spaces. It will then train a number of models in parallel and find the best
performing one among these. We also use the <code class="docutils literal notranslate"><span class="pre">ASHAScheduler</span></code> which will terminate bad
performing trials early.</p>
<p>We wrap the <code class="docutils literal notranslate"><span class="pre">train_cifar</span></code> function with <code class="docutils literal notranslate"><span class="pre">functools.partial</span></code> to set the constant
<code class="docutils literal notranslate"><span class="pre">data_dir</span></code> parameter. We can also tell Ray Tune what resources should be
available for each trial:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gpus_per_trial</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c1"># ...</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">tune</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">partial</span><span class="p">(</span><span class="n">train_cifar</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="n">data_dir</span><span class="p">),</span>
    <span class="n">resources_per_trial</span><span class="o">=</span><span class="p">{</span><span class="s2">"cpu"</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">"gpu"</span><span class="p">:</span> <span class="n">gpus_per_trial</span><span class="p">},</span>
    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
    <span class="n">num_samples</span><span class="o">=</span><span class="n">num_samples</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span>
    <span class="n">progress_reporter</span><span class="o">=</span><span class="n">reporter</span><span class="p">,</span>
    <span class="n">checkpoint_at_end</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>You can specify the number of CPUs, which are then available e.g.
to increase the <code class="docutils literal notranslate"><span class="pre">num_workers</span></code> of the PyTorch <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> instances. The selected
number of GPUs are made visible to PyTorch in each trial. Trials do not have access to
GPUs that haven’t been requested for them - so you don’t have to care about two trials
using the same set of resources.</p>
<p>Here we can also specify fractional GPUs, so something like <code class="docutils literal notranslate"><span class="pre">gpus_per_trial=0.5</span></code> is
completely valid. The trials will then share GPUs among each other.
You just have to make sure that the models still fit in the GPU memory.</p>
<p>After training the models, we will find the best performing one and load the trained
network from the checkpoint file. We then obtain the test set accuracy and report
everything by printing.</p>
<p>The full main function looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">num_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_num_epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gpus_per_trial</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">"./data"</span><span class="p">)</span>
    <span class="n">load_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
    <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"l1"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">sample_from</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)),</span>
        <span class="s2">"l2"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">sample_from</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)),</span>
        <span class="s2">"lr"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">),</span>
        <span class="s2">"batch_size"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">])</span>
    <span class="p">}</span>
    <span class="n">scheduler</span> <span class="o">=</span> <span class="n">ASHAScheduler</span><span class="p">(</span>
        <span class="n">metric</span><span class="o">=</span><span class="s2">"loss"</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">"min"</span><span class="p">,</span>
        <span class="n">max_t</span><span class="o">=</span><span class="n">max_num_epochs</span><span class="p">,</span>
        <span class="n">grace_period</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">reduction_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">reporter</span> <span class="o">=</span> <span class="n">CLIReporter</span><span class="p">(</span>
        <span class="c1"># parameter_columns=["l1", "l2", "lr", "batch_size"],</span>
        <span class="n">metric_columns</span><span class="o">=</span><span class="p">[</span><span class="s2">"loss"</span><span class="p">,</span> <span class="s2">"accuracy"</span><span class="p">,</span> <span class="s2">"training_iteration"</span><span class="p">])</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">tune</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
        <span class="n">partial</span><span class="p">(</span><span class="n">train_cifar</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="n">data_dir</span><span class="p">),</span>
        <span class="n">resources_per_trial</span><span class="o">=</span><span class="p">{</span><span class="s2">"cpu"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">"gpu"</span><span class="p">:</span> <span class="n">gpus_per_trial</span><span class="p">},</span>
        <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
        <span class="n">num_samples</span><span class="o">=</span><span class="n">num_samples</span><span class="p">,</span>
        <span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span>
        <span class="n">progress_reporter</span><span class="o">=</span><span class="n">reporter</span><span class="p">)</span>

    <span class="n">best_trial</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_best_trial</span><span class="p">(</span><span class="s2">"loss"</span><span class="p">,</span> <span class="s2">"min"</span><span class="p">,</span> <span class="s2">"last"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Best trial config: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">best_trial</span><span class="o">.</span><span class="n">config</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Best trial final validation loss: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">best_trial</span><span class="o">.</span><span class="n">last_result</span><span class="p">[</span><span class="s2">"loss"</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Best trial final validation accuracy: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">best_trial</span><span class="o">.</span><span class="n">last_result</span><span class="p">[</span><span class="s2">"accuracy"</span><span class="p">]))</span>

    <span class="n">best_trained_model</span> <span class="o">=</span> <span class="n">Net</span><span class="p">(</span><span class="n">best_trial</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">"l1"</span><span class="p">],</span> <span class="n">best_trial</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">"l2"</span><span class="p">])</span>
    <span class="n">device</span> <span class="o">=</span> <span class="s2">"cpu"</span>
    <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s2">"cuda:0"</span>
        <span class="k">if</span> <span class="n">gpus_per_trial</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">best_trained_model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">DataParallel</span><span class="p">(</span><span class="n">best_trained_model</span><span class="p">)</span>
    <span class="n">best_trained_model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

    <span class="n">best_checkpoint_dir</span> <span class="o">=</span> <span class="n">best_trial</span><span class="o">.</span><span class="n">checkpoint</span><span class="o">.</span><span class="n">value</span>
    <span class="n">model_state</span><span class="p">,</span> <span class="n">optimizer_state</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">best_checkpoint_dir</span><span class="p">,</span> <span class="s2">"checkpoint"</span><span class="p">))</span>
    <span class="n">best_trained_model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">model_state</span><span class="p">)</span>

    <span class="n">test_acc</span> <span class="o">=</span> <span class="n">test_accuracy</span><span class="p">(</span><span class="n">best_trained_model</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Best trial test set accuracy: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">test_acc</span><span class="p">))</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="c1"># You can change the number of GPUs per trial here:</span>
    <span class="n">main</span><span class="p">(</span><span class="n">num_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_num_epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gpus_per_trial</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz
Extracting /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data
Files already downloaded and verified
== Status ==
Memory usage on this node: 4.0/240.1 GiB
Using AsyncHyperBand: num_stopped=0
Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: None
Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 1/10 (1 RUNNING)
+---------------------+----------+-------+--------------+------+------+-------------+
| Trial name          | status   | loc   |   batch_size |   l1 |   l2 |          lr |
|---------------------+----------+-------+--------------+------+------+-------------|
| DEFAULT_41983_00000 | RUNNING  |       |            2 |  256 |   16 | 0.000143215 |
+---------------------+----------+-------+--------------+------+------+-------------+


[2m[36m(pid=1489)[0m Files already downloaded and verified
[2m[36m(pid=1501)[0m Files already downloaded and verified
[2m[36m(pid=1497)[0m Files already downloaded and verified
[2m[36m(pid=1498)[0m Files already downloaded and verified
[2m[36m(pid=1506)[0m Files already downloaded and verified
[2m[36m(pid=1525)[0m Files already downloaded and verified
[2m[36m(pid=1553)[0m Files already downloaded and verified
[2m[36m(pid=1499)[0m Files already downloaded and verified
[2m[36m(pid=1500)[0m Files already downloaded and verified
[2m[36m(pid=1557)[0m Files already downloaded and verified
[2m[36m(pid=1489)[0m Files already downloaded and verified
[2m[36m(pid=1501)[0m Files already downloaded and verified
[2m[36m(pid=1497)[0m Files already downloaded and verified
[2m[36m(pid=1498)[0m Files already downloaded and verified
[2m[36m(pid=1506)[0m Files already downloaded and verified
[2m[36m(pid=1525)[0m Files already downloaded and verified
[2m[36m(pid=1553)[0m Files already downloaded and verified
[2m[36m(pid=1500)[0m Files already downloaded and verified
[2m[36m(pid=1499)[0m Files already downloaded and verified
[2m[36m(pid=1557)[0m Files already downloaded and verified
[2m[36m(pid=1525)[0m [1,  2000] loss: 2.321
[2m[36m(pid=1489)[0m [1,  2000] loss: 2.208
[2m[36m(pid=1506)[0m [1,  2000] loss: 2.314
[2m[36m(pid=1500)[0m [1,  2000] loss: 2.161
[2m[36m(pid=1498)[0m [1,  2000] loss: 2.336
[2m[36m(pid=1501)[0m [1,  2000] loss: 2.088
[2m[36m(pid=1499)[0m [1,  2000] loss: 2.141
[2m[36m(pid=1553)[0m [1,  2000] loss: 2.005
[2m[36m(pid=1497)[0m [1,  2000] loss: 2.017
[2m[36m(pid=1557)[0m [1,  2000] loss: 2.317
[2m[36m(pid=1525)[0m [1,  4000] loss: 1.162
[2m[36m(pid=1489)[0m [1,  4000] loss: 0.944
Result for DEFAULT_41983_00001:
  accuracy: 0.2513
  date: 2020-12-18_16-37-30
  done: false
  experiment_id: 35d19e04ff80473e818a1080037c60f3
  experiment_tag: 1_batch_size=16,l1=32,l2=64,lr=0.038233
  hostname: d9492ca4b767
  iterations_since_restore: 1
  loss: 2.007682324028015
  node_ip: 172.17.0.2
  pid: 1497
  should_checkpoint: true
  time_since_restore: 27.145315647125244
  time_this_iter_s: 27.145315647125244
  time_total_s: 27.145315647125244
  timestamp: 1608309450
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: '41983_00001'

== Status ==
Memory usage on this node: 9.3/240.1 GiB
Using AsyncHyperBand: num_stopped=0
Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -2.007682324028015
Resources requested: 20/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (10 RUNNING)
+---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status   | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00000 | RUNNING  |                 |            2 |  256 |   16 | 0.000143215 |         |            |                      |
| DEFAULT_41983_00001 | RUNNING  | 172.17.0.2:1497 |           16 |   32 |   64 | 0.0382327   | 2.00768 |     0.2513 |                    1 |
| DEFAULT_41983_00002 | RUNNING  |                 |            2 |   16 |    4 | 0.0199284   |         |            |                      |
| DEFAULT_41983_00003 | RUNNING  |                 |            8 |   64 |   64 | 0.00144802  |         |            |                      |
| DEFAULT_41983_00004 | RUNNING  |                 |            4 |   64 |    4 | 0.0605362   |         |            |                      |
| DEFAULT_41983_00005 | RUNNING  |                 |            4 |   16 |   64 | 0.00115067  |         |            |                      |
| DEFAULT_41983_00006 | RUNNING  |                 |            8 |  256 |   32 | 0.00167166  |         |            |                      |
| DEFAULT_41983_00007 | RUNNING  |                 |           16 |   16 |    8 | 0.000104831 |         |            |                      |
| DEFAULT_41983_00008 | RUNNING  |                 |            4 |   64 |  256 | 0.00133354  |         |            |                      |
| DEFAULT_41983_00009 | RUNNING  |                 |            8 |   64 |    4 | 0.0188509   |         |            |                      |
+---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1506)[0m [1,  4000] loss: 1.150
Result for DEFAULT_41983_00007:
  accuracy: 0.1005
  date: 2020-12-18_16-37-31
  done: true
  experiment_id: 5591b83f014942999b2104619d980ed4
  experiment_tag: 7_batch_size=16,l1=16,l2=8,lr=0.00010483
  hostname: d9492ca4b767
  iterations_since_restore: 1
  loss: 2.3100047775268555
  node_ip: 172.17.0.2
  pid: 1557
  should_checkpoint: true
  time_since_restore: 27.654589653015137
  time_this_iter_s: 27.654589653015137
  time_total_s: 27.654589653015137
  timestamp: 1608309451
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: '41983_00007'

[2m[36m(pid=1500)[0m [1,  4000] loss: 0.890
[2m[36m(pid=1498)[0m [1,  4000] loss: 1.169
[2m[36m(pid=1501)[0m [1,  4000] loss: 0.852
[2m[36m(pid=1499)[0m [1,  4000] loss: 1.049
[2m[36m(pid=1553)[0m [1,  4000] loss: 0.815
[2m[36m(pid=1525)[0m [1,  6000] loss: 0.775
[2m[36m(pid=1489)[0m [1,  6000] loss: 0.561
[2m[36m(pid=1506)[0m [1,  6000] loss: 0.759
[2m[36m(pid=1500)[0m [1,  6000] loss: 0.538
[2m[36m(pid=1498)[0m [1,  6000] loss: 0.779
Result for DEFAULT_41983_00003:
  accuracy: 0.4119
  date: 2020-12-18_16-37-45
  done: false
  experiment_id: 69635ef664e54c8da07659d6c9d15498
  experiment_tag: 3_batch_size=8,l1=64,l2=64,lr=0.001448
  hostname: d9492ca4b767
  iterations_since_restore: 1
  loss: 1.6005283608436585
  node_ip: 172.17.0.2
  pid: 1501
  should_checkpoint: true
  time_since_restore: 41.80452537536621
  time_this_iter_s: 41.80452537536621
  time_total_s: 41.80452537536621
  timestamp: 1608309465
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: '41983_00003'

== Status ==
Memory usage on this node: 8.8/240.1 GiB
Using AsyncHyperBand: num_stopped=1
Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -2.007682324028015
Resources requested: 18/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (9 RUNNING, 1 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00000 | RUNNING    |                 |            2 |  256 |   16 | 0.000143215 |         |            |                      |
| DEFAULT_41983_00001 | RUNNING    | 172.17.0.2:1497 |           16 |   32 |   64 | 0.0382327   | 2.00768 |     0.2513 |                    1 |
| DEFAULT_41983_00002 | RUNNING    |                 |            2 |   16 |    4 | 0.0199284   |         |            |                      |
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.60053 |     0.4119 |                    1 |
| DEFAULT_41983_00004 | RUNNING    |                 |            4 |   64 |    4 | 0.0605362   |         |            |                      |
| DEFAULT_41983_00005 | RUNNING    |                 |            4 |   16 |   64 | 0.00115067  |         |            |                      |
| DEFAULT_41983_00006 | RUNNING    |                 |            8 |  256 |   32 | 0.00167166  |         |            |                      |
| DEFAULT_41983_00008 | RUNNING    |                 |            4 |   64 |  256 | 0.00133354  |         |            |                      |
| DEFAULT_41983_00009 | RUNNING    |                 |            8 |   64 |    4 | 0.0188509   |         |            |                      |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_41983_00009:
  accuracy: 0.1687
  date: 2020-12-18_16-37-45
  done: true
  experiment_id: ae3ffa6ec2844f3784b28d74d945ef69
  experiment_tag: 9_batch_size=8,l1=64,l2=4,lr=0.018851
  hostname: d9492ca4b767
  iterations_since_restore: 1
  loss: 2.0431719257354737
  node_ip: 172.17.0.2
  pid: 1499
  should_checkpoint: true
  time_since_restore: 41.87753176689148
  time_this_iter_s: 41.87753176689148
  time_total_s: 41.87753176689148
  timestamp: 1608309465
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: '41983_00009'

[2m[36m(pid=1497)[0m [2,  2000] loss: 1.978
Result for DEFAULT_41983_00006:
  accuracy: 0.4577
  date: 2020-12-18_16-37-47
  done: false
  experiment_id: 4c97da77bfb042a188dd9c1b41535d60
  experiment_tag: 6_batch_size=8,l1=256,l2=32,lr=0.0016717
  hostname: d9492ca4b767
  iterations_since_restore: 1
  loss: 1.478592095899582
  node_ip: 172.17.0.2
  pid: 1553
  should_checkpoint: true
  time_since_restore: 43.56274652481079
  time_this_iter_s: 43.56274652481079
  time_total_s: 43.56274652481079
  timestamp: 1608309467
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: '41983_00006'

[2m[36m(pid=1525)[0m [1,  8000] loss: 0.581
[2m[36m(pid=1489)[0m [1,  8000] loss: 0.397
Result for DEFAULT_41983_00001:
  accuracy: 0.2643
  date: 2020-12-18_16-37-53
  done: false
  experiment_id: 35d19e04ff80473e818a1080037c60f3
  experiment_tag: 1_batch_size=16,l1=32,l2=64,lr=0.038233
  hostname: d9492ca4b767
  iterations_since_restore: 2
  loss: 1.9445493272781371
  node_ip: 172.17.0.2
  pid: 1497
  should_checkpoint: true
  time_since_restore: 49.768572092056274
  time_this_iter_s: 22.62325644493103
  time_total_s: 49.768572092056274
  timestamp: 1608309473
  timesteps_since_restore: 0
  training_iteration: 2
  trial_id: '41983_00001'

== Status ==
Memory usage on this node: 8.2/240.1 GiB
Using AsyncHyperBand: num_stopped=2
Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.9445493272781371 | Iter 1.000: -2.007682324028015
Resources requested: 16/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00000 | RUNNING    |                 |            2 |  256 |   16 | 0.000143215 |         |            |                      |
| DEFAULT_41983_00001 | RUNNING    | 172.17.0.2:1497 |           16 |   32 |   64 | 0.0382327   | 1.94455 |     0.2643 |                    2 |
| DEFAULT_41983_00002 | RUNNING    |                 |            2 |   16 |    4 | 0.0199284   |         |            |                      |
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.60053 |     0.4119 |                    1 |
| DEFAULT_41983_00004 | RUNNING    |                 |            4 |   64 |    4 | 0.0605362   |         |            |                      |
| DEFAULT_41983_00005 | RUNNING    |                 |            4 |   16 |   64 | 0.00115067  |         |            |                      |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.47859 |     0.4577 |                    1 |
| DEFAULT_41983_00008 | RUNNING    |                 |            4 |   64 |  256 | 0.00133354  |         |            |                      |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1506)[0m [1,  8000] loss: 0.553
[2m[36m(pid=1500)[0m [1,  8000] loss: 0.385
[2m[36m(pid=1498)[0m [1,  8000] loss: 0.584
[2m[36m(pid=1501)[0m [2,  2000] loss: 1.525
[2m[36m(pid=1553)[0m [2,  2000] loss: 1.444
[2m[36m(pid=1525)[0m [1, 10000] loss: 0.465
[2m[36m(pid=1489)[0m [1, 10000] loss: 0.306
[2m[36m(pid=1506)[0m [1, 10000] loss: 0.425
[2m[36m(pid=1500)[0m [1, 10000] loss: 0.295
[2m[36m(pid=1498)[0m [1, 10000] loss: 0.467
[2m[36m(pid=1497)[0m [3,  2000] loss: 1.970
[2m[36m(pid=1501)[0m [2,  4000] loss: 0.726
Result for DEFAULT_41983_00005:
  accuracy: 0.4578
  date: 2020-12-18_16-38-11
  done: false
  experiment_id: c65b0504602d4d70a5920e06da689170
  experiment_tag: 5_batch_size=4,l1=16,l2=64,lr=0.0011507
  hostname: d9492ca4b767
  iterations_since_restore: 1
  loss: 1.5054601410388946
  node_ip: 172.17.0.2
  pid: 1489
  should_checkpoint: true
  time_since_restore: 68.3221504688263
  time_this_iter_s: 68.3221504688263
  time_total_s: 68.3221504688263
  timestamp: 1608309491
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: '41983_00005'

== Status ==
Memory usage on this node: 8.2/240.1 GiB
Using AsyncHyperBand: num_stopped=2
Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.9445493272781371 | Iter 1.000: -1.8041053424358369
Resources requested: 16/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00000 | RUNNING    |                 |            2 |  256 |   16 | 0.000143215 |         |            |                      |
| DEFAULT_41983_00001 | RUNNING    | 172.17.0.2:1497 |           16 |   32 |   64 | 0.0382327   | 1.94455 |     0.2643 |                    2 |
| DEFAULT_41983_00002 | RUNNING    |                 |            2 |   16 |    4 | 0.0199284   |         |            |                      |
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.60053 |     0.4119 |                    1 |
| DEFAULT_41983_00004 | RUNNING    |                 |            4 |   64 |    4 | 0.0605362   |         |            |                      |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.50546 |     0.4578 |                    1 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.47859 |     0.4577 |                    1 |
| DEFAULT_41983_00008 | RUNNING    |                 |            4 |   64 |  256 | 0.00133354  |         |            |                      |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1525)[0m [1, 12000] loss: 0.388
[2m[36m(pid=1553)[0m [2,  4000] loss: 0.689
Result for DEFAULT_41983_00008:
  accuracy: 0.4799
  date: 2020-12-18_16-38-13
  done: false
  experiment_id: 47d302572e62477284d790b0a9d74a10
  experiment_tag: 8_batch_size=4,l1=64,l2=256,lr=0.0013335
  hostname: d9492ca4b767
  iterations_since_restore: 1
  loss: 1.4361508112311363
  node_ip: 172.17.0.2
  pid: 1500
  should_checkpoint: true
  time_since_restore: 70.049471616745
  time_this_iter_s: 70.049471616745
  time_total_s: 70.049471616745
  timestamp: 1608309493
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: '41983_00008'

Result for DEFAULT_41983_00001:
  accuracy: 0.2704
  date: 2020-12-18_16-38-15
  done: false
  experiment_id: 35d19e04ff80473e818a1080037c60f3
  experiment_tag: 1_batch_size=16,l1=32,l2=64,lr=0.038233
  hostname: d9492ca4b767
  iterations_since_restore: 3
  loss: 1.964276408958435
  node_ip: 172.17.0.2
  pid: 1497
  should_checkpoint: true
  time_since_restore: 71.86783599853516
  time_this_iter_s: 22.099263906478882
  time_total_s: 71.86783599853516
  timestamp: 1608309495
  timesteps_since_restore: 0
  training_iteration: 3
  trial_id: '41983_00001'

[2m[36m(pid=1506)[0m [1, 12000] loss: 0.341
Result for DEFAULT_41983_00004:
  accuracy: 0.1013
  date: 2020-12-18_16-38-15
  done: true
  experiment_id: 6cbba278288c4595afb4d6e17be7172f
  experiment_tag: 4_batch_size=4,l1=64,l2=4,lr=0.060536
  hostname: d9492ca4b767
  iterations_since_restore: 1
  loss: 2.332652166748047
  node_ip: 172.17.0.2
  pid: 1498
  should_checkpoint: true
  time_since_restore: 72.21561288833618
  time_this_iter_s: 72.21561288833618
  time_total_s: 72.21561288833618
  timestamp: 1608309495
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: '41983_00004'

Result for DEFAULT_41983_00003:
  accuracy: 0.4884
  date: 2020-12-18_16-38-21
  done: false
  experiment_id: 69635ef664e54c8da07659d6c9d15498
  experiment_tag: 3_batch_size=8,l1=64,l2=64,lr=0.001448
  hostname: d9492ca4b767
  iterations_since_restore: 2
  loss: 1.4323053330898285
  node_ip: 172.17.0.2
  pid: 1501
  should_checkpoint: true
  time_since_restore: 78.02023935317993
  time_this_iter_s: 36.21571397781372
  time_total_s: 78.02023935317993
  timestamp: 1608309501
  timesteps_since_restore: 0
  training_iteration: 2
  trial_id: '41983_00003'

== Status ==
Memory usage on this node: 7.6/240.1 GiB
Using AsyncHyperBand: num_stopped=3
Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.6884273301839827 | Iter 1.000: -1.8041053424358369
Resources requested: 14/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (7 RUNNING, 3 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00000 | RUNNING    |                 |            2 |  256 |   16 | 0.000143215 |         |            |                      |
| DEFAULT_41983_00001 | RUNNING    | 172.17.0.2:1497 |           16 |   32 |   64 | 0.0382327   | 1.96428 |     0.2704 |                    3 |
| DEFAULT_41983_00002 | RUNNING    |                 |            2 |   16 |    4 | 0.0199284   |         |            |                      |
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.43231 |     0.4884 |                    2 |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.50546 |     0.4578 |                    1 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.47859 |     0.4577 |                    1 |
| DEFAULT_41983_00008 | RUNNING    | 172.17.0.2:1500 |            4 |   64 |  256 | 0.00133354  | 1.43615 |     0.4799 |                    1 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1489)[0m [2,  2000] loss: 1.467
[2m[36m(pid=1525)[0m [1, 14000] loss: 0.332
Result for DEFAULT_41983_00006:
  accuracy: 0.4936
  date: 2020-12-18_16-38-24
  done: false
  experiment_id: 4c97da77bfb042a188dd9c1b41535d60
  experiment_tag: 6_batch_size=8,l1=256,l2=32,lr=0.0016717
  hostname: d9492ca4b767
  iterations_since_restore: 2
  loss: 1.3865098380088807
  node_ip: 172.17.0.2
  pid: 1553
  should_checkpoint: true
  time_since_restore: 80.67606377601624
  time_this_iter_s: 37.113317251205444
  time_total_s: 80.67606377601624
  timestamp: 1608309504
  timesteps_since_restore: 0
  training_iteration: 2
  trial_id: '41983_00006'

[2m[36m(pid=1500)[0m [2,  2000] loss: 1.414
[2m[36m(pid=1506)[0m [1, 14000] loss: 0.286
[2m[36m(pid=1497)[0m [4,  2000] loss: 1.968
[2m[36m(pid=1525)[0m [1, 16000] loss: 0.291
[2m[36m(pid=1489)[0m [2,  4000] loss: 0.715
[2m[36m(pid=1501)[0m [3,  2000] loss: 1.339
[2m[36m(pid=1500)[0m [2,  4000] loss: 0.694
[2m[36m(pid=1506)[0m [1, 16000] loss: 0.244
Result for DEFAULT_41983_00001:
  accuracy: 0.2643
  date: 2020-12-18_16-38-48
  done: false
  experiment_id: 35d19e04ff80473e818a1080037c60f3
  experiment_tag: 1_batch_size=16,l1=32,l2=64,lr=0.038233
  hostname: d9492ca4b767
  iterations_since_restore: 4
  loss: 1.9609540832519532
  node_ip: 172.17.0.2
  pid: 1497
  should_checkpoint: true
  time_since_restore: 104.76762628555298
  time_this_iter_s: 32.89979028701782
  time_total_s: 104.76762628555298
  timestamp: 1608309528
  timesteps_since_restore: 0
  training_iteration: 4
  trial_id: '41983_00001'

== Status ==
Memory usage on this node: 7.6/240.1 GiB
Using AsyncHyperBand: num_stopped=3
Bracket: Iter 8.000: None | Iter 4.000: -1.9609540832519532 | Iter 2.000: -1.4323053330898285 | Iter 1.000: -1.8041053424358369
Resources requested: 14/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (7 RUNNING, 3 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00000 | RUNNING    |                 |            2 |  256 |   16 | 0.000143215 |         |            |                      |
| DEFAULT_41983_00001 | RUNNING    | 172.17.0.2:1497 |           16 |   32 |   64 | 0.0382327   | 1.96095 |     0.2643 |                    4 |
| DEFAULT_41983_00002 | RUNNING    |                 |            2 |   16 |    4 | 0.0199284   |         |            |                      |
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.43231 |     0.4884 |                    2 |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.50546 |     0.4578 |                    1 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.38651 |     0.4936 |                    2 |
| DEFAULT_41983_00008 | RUNNING    | 172.17.0.2:1500 |            4 |   64 |  256 | 0.00133354  | 1.43615 |     0.4799 |                    1 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1553)[0m [3,  2000] loss: 1.269
[2m[36m(pid=1525)[0m [1, 18000] loss: 0.258
[2m[36m(pid=1489)[0m [2,  6000] loss: 0.470
[2m[36m(pid=1500)[0m [2,  6000] loss: 0.458
[2m[36m(pid=1501)[0m [3,  4000] loss: 0.653
[2m[36m(pid=1506)[0m [1, 18000] loss: 0.210
[2m[36m(pid=1553)[0m [3,  4000] loss: 0.620
[2m[36m(pid=1497)[0m [5,  2000] loss: 1.988
[2m[36m(pid=1525)[0m [1, 20000] loss: 0.233
[2m[36m(pid=1489)[0m [2,  8000] loss: 0.346
Result for DEFAULT_41983_00003:
  accuracy: 0.5537
  date: 2020-12-18_16-39-08
  done: false
  experiment_id: 69635ef664e54c8da07659d6c9d15498
  experiment_tag: 3_batch_size=8,l1=64,l2=64,lr=0.001448
  hostname: d9492ca4b767
  iterations_since_restore: 3
  loss: 1.2543991813898085
  node_ip: 172.17.0.2
  pid: 1501
  should_checkpoint: true
  time_since_restore: 124.78227615356445
  time_this_iter_s: 46.76203680038452
  time_total_s: 124.78227615356445
  timestamp: 1608309548
  timesteps_since_restore: 0
  training_iteration: 3
  trial_id: '41983_00003'

== Status ==
Memory usage on this node: 7.6/240.1 GiB
Using AsyncHyperBand: num_stopped=3
Bracket: Iter 8.000: None | Iter 4.000: -1.9609540832519532 | Iter 2.000: -1.4323053330898285 | Iter 1.000: -1.8041053424358369
Resources requested: 14/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (7 RUNNING, 3 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00000 | RUNNING    |                 |            2 |  256 |   16 | 0.000143215 |         |            |                      |
| DEFAULT_41983_00001 | RUNNING    | 172.17.0.2:1497 |           16 |   32 |   64 | 0.0382327   | 1.96095 |     0.2643 |                    4 |
| DEFAULT_41983_00002 | RUNNING    |                 |            2 |   16 |    4 | 0.0199284   |         |            |                      |
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.2544  |     0.5537 |                    3 |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.50546 |     0.4578 |                    1 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.38651 |     0.4936 |                    2 |
| DEFAULT_41983_00008 | RUNNING    | 172.17.0.2:1500 |            4 |   64 |  256 | 0.00133354  | 1.43615 |     0.4799 |                    1 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1500)[0m [2,  8000] loss: 0.335
[2m[36m(pid=1506)[0m [1, 20000] loss: 0.179
Result for DEFAULT_41983_00001:
  accuracy: 0.2465
  date: 2020-12-18_16-39-10
  done: false
  experiment_id: 35d19e04ff80473e818a1080037c60f3
  experiment_tag: 1_batch_size=16,l1=32,l2=64,lr=0.038233
  hostname: d9492ca4b767
  iterations_since_restore: 5
  loss: 1.9668469608306884
  node_ip: 172.17.0.2
  pid: 1497
  should_checkpoint: true
  time_since_restore: 126.52767062187195
  time_this_iter_s: 21.76004433631897
  time_total_s: 126.52767062187195
  timestamp: 1608309550
  timesteps_since_restore: 0
  training_iteration: 5
  trial_id: '41983_00001'

Result for DEFAULT_41983_00006:
  accuracy: 0.5629
  date: 2020-12-18_16-39-12
  done: false
  experiment_id: 4c97da77bfb042a188dd9c1b41535d60
  experiment_tag: 6_batch_size=8,l1=256,l2=32,lr=0.0016717
  hostname: d9492ca4b767
  iterations_since_restore: 3
  loss: 1.225965170621872
  node_ip: 172.17.0.2
  pid: 1553
  should_checkpoint: true
  time_since_restore: 128.4416139125824
  time_this_iter_s: 47.76555013656616
  time_total_s: 128.4416139125824
  timestamp: 1608309552
  timesteps_since_restore: 0
  training_iteration: 3
  trial_id: '41983_00006'

[2m[36m(pid=1489)[0m [2, 10000] loss: 0.275
Result for DEFAULT_41983_00002:
  accuracy: 0.0989
  date: 2020-12-18_16-39-18
  done: true
  experiment_id: 89f1e1abc55c4e2d86150f7b818499dc
  experiment_tag: 2_batch_size=2,l1=16,l2=4,lr=0.019928
  hostname: d9492ca4b767
  iterations_since_restore: 1
  loss: 2.31474293179512
  node_ip: 172.17.0.2
  pid: 1525
  should_checkpoint: true
  time_since_restore: 135.13942313194275
  time_this_iter_s: 135.13942313194275
  time_total_s: 135.13942313194275
  timestamp: 1608309558
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: '41983_00002'

== Status ==
Memory usage on this node: 7.6/240.1 GiB
Using AsyncHyperBand: num_stopped=4
Bracket: Iter 8.000: None | Iter 4.000: -1.9609540832519532 | Iter 2.000: -1.4323053330898285 | Iter 1.000: -2.007682324028015
Resources requested: 14/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (7 RUNNING, 3 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00000 | RUNNING    |                 |            2 |  256 |   16 | 0.000143215 |         |            |                      |
| DEFAULT_41983_00001 | RUNNING    | 172.17.0.2:1497 |           16 |   32 |   64 | 0.0382327   | 1.96685 |     0.2465 |                    5 |
| DEFAULT_41983_00002 | RUNNING    | 172.17.0.2:1525 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.2544  |     0.5537 |                    3 |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.50546 |     0.4578 |                    1 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.22597 |     0.5629 |                    3 |
| DEFAULT_41983_00008 | RUNNING    | 172.17.0.2:1500 |            4 |   64 |  256 | 0.00133354  | 1.43615 |     0.4799 |                    1 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1500)[0m [2, 10000] loss: 0.265
[2m[36m(pid=1501)[0m [4,  2000] loss: 1.227
Result for DEFAULT_41983_00000:
  accuracy: 0.3511
  date: 2020-12-18_16-39-22
  done: false
  experiment_id: 3e6eb2982cbc4af38a581aa7ae637d37
  experiment_tag: 0_batch_size=2,l1=256,l2=16,lr=0.00014322
  hostname: d9492ca4b767
  iterations_since_restore: 1
  loss: 1.7616181128382682
  node_ip: 172.17.0.2
  pid: 1506
  should_checkpoint: true
  time_since_restore: 139.38412022590637
  time_this_iter_s: 139.38412022590637
  time_total_s: 139.38412022590637
  timestamp: 1608309562
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: '41983_00000'

Result for DEFAULT_41983_00005:
  accuracy: 0.5245
  date: 2020-12-18_16-39-23
  done: false
  experiment_id: c65b0504602d4d70a5920e06da689170
  experiment_tag: 5_batch_size=4,l1=16,l2=64,lr=0.0011507
  hostname: d9492ca4b767
  iterations_since_restore: 2
  loss: 1.3256076559722423
  node_ip: 172.17.0.2
  pid: 1489
  should_checkpoint: true
  time_since_restore: 140.0702428817749
  time_this_iter_s: 71.74809241294861
  time_total_s: 140.0702428817749
  timestamp: 1608309563
  timesteps_since_restore: 0
  training_iteration: 2
  trial_id: '41983_00005'

[2m[36m(pid=1553)[0m [4,  2000] loss: 1.150
[2m[36m(pid=1497)[0m [6,  2000] loss: 1.981
Result for DEFAULT_41983_00008:
  accuracy: 0.518
  date: 2020-12-18_16-39-26
  done: false
  experiment_id: 47d302572e62477284d790b0a9d74a10
  experiment_tag: 8_batch_size=4,l1=64,l2=256,lr=0.0013335
  hostname: d9492ca4b767
  iterations_since_restore: 2
  loss: 1.3545562279462815
  node_ip: 172.17.0.2
  pid: 1500
  should_checkpoint: true
  time_since_restore: 143.2379252910614
  time_this_iter_s: 73.1884536743164
  time_total_s: 143.2379252910614
  timestamp: 1608309566
  timesteps_since_restore: 0
  training_iteration: 2
  trial_id: '41983_00008'

== Status ==
Memory usage on this node: 7.1/240.1 GiB
Using AsyncHyperBand: num_stopped=4
Bracket: Iter 8.000: None | Iter 4.000: -1.9609540832519532 | Iter 2.000: -1.3865098380088807 | Iter 1.000: -1.8846502184331415
Resources requested: 12/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00000 | RUNNING    | 172.17.0.2:1506 |            2 |  256 |   16 | 0.000143215 | 1.76162 |     0.3511 |                    1 |
| DEFAULT_41983_00001 | RUNNING    | 172.17.0.2:1497 |           16 |   32 |   64 | 0.0382327   | 1.96685 |     0.2465 |                    5 |
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.2544  |     0.5537 |                    3 |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.32561 |     0.5245 |                    2 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.22597 |     0.5629 |                    3 |
| DEFAULT_41983_00008 | RUNNING    | 172.17.0.2:1500 |            4 |   64 |  256 | 0.00133354  | 1.35456 |     0.518  |                    2 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_41983_00001:
  accuracy: 0.1806
  date: 2020-12-18_16-39-31
  done: false
  experiment_id: 35d19e04ff80473e818a1080037c60f3
  experiment_tag: 1_batch_size=16,l1=32,l2=64,lr=0.038233
  hostname: d9492ca4b767
  iterations_since_restore: 6
  loss: 2.177041880226135
  node_ip: 172.17.0.2
  pid: 1497
  should_checkpoint: true
  time_since_restore: 148.12223625183105
  time_this_iter_s: 21.594565629959106
  time_total_s: 148.12223625183105
  timestamp: 1608309571
  timesteps_since_restore: 0
  training_iteration: 6
  trial_id: '41983_00001'

[2m[36m(pid=1501)[0m [4,  4000] loss: 0.605
[2m[36m(pid=1506)[0m [2,  2000] loss: 1.751
[2m[36m(pid=1489)[0m [3,  2000] loss: 1.322
[2m[36m(pid=1553)[0m [4,  4000] loss: 0.564
[2m[36m(pid=1500)[0m [3,  2000] loss: 1.275
Result for DEFAULT_41983_00003:
  accuracy: 0.567
  date: 2020-12-18_16-39-43
  done: false
  experiment_id: 69635ef664e54c8da07659d6c9d15498
  experiment_tag: 3_batch_size=8,l1=64,l2=64,lr=0.001448
  hostname: d9492ca4b767
  iterations_since_restore: 4
  loss: 1.2262581626415252
  node_ip: 172.17.0.2
  pid: 1501
  should_checkpoint: true
  time_since_restore: 159.93550038337708
  time_this_iter_s: 35.15322422981262
  time_total_s: 159.93550038337708
  timestamp: 1608309583
  timesteps_since_restore: 0
  training_iteration: 4
  trial_id: '41983_00003'

== Status ==
Memory usage on this node: 7.0/240.1 GiB
Using AsyncHyperBand: num_stopped=4
Bracket: Iter 8.000: None | Iter 4.000: -1.5936061229467393 | Iter 2.000: -1.3865098380088807 | Iter 1.000: -1.8846502184331415
Resources requested: 12/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00000 | RUNNING    | 172.17.0.2:1506 |            2 |  256 |   16 | 0.000143215 | 1.76162 |     0.3511 |                    1 |
| DEFAULT_41983_00001 | RUNNING    | 172.17.0.2:1497 |           16 |   32 |   64 | 0.0382327   | 2.17704 |     0.1806 |                    6 |
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.22626 |     0.567  |                    4 |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.32561 |     0.5245 |                    2 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.22597 |     0.5629 |                    3 |
| DEFAULT_41983_00008 | RUNNING    | 172.17.0.2:1500 |            4 |   64 |  256 | 0.00133354  | 1.35456 |     0.518  |                    2 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1506)[0m [2,  4000] loss: 0.841
[2m[36m(pid=1489)[0m [3,  4000] loss: 0.654
[2m[36m(pid=1497)[0m [7,  2000] loss: 2.009
Result for DEFAULT_41983_00006:
  accuracy: 0.5704
  date: 2020-12-18_16-39-47
  done: false
  experiment_id: 4c97da77bfb042a188dd9c1b41535d60
  experiment_tag: 6_batch_size=8,l1=256,l2=32,lr=0.0016717
  hostname: d9492ca4b767
  iterations_since_restore: 4
  loss: 1.1918274035215377
  node_ip: 172.17.0.2
  pid: 1553
  should_checkpoint: true
  time_since_restore: 164.02265572547913
  time_this_iter_s: 35.58104181289673
  time_total_s: 164.02265572547913
  timestamp: 1608309587
  timesteps_since_restore: 0
  training_iteration: 4
  trial_id: '41983_00006'

[2m[36m(pid=1500)[0m [3,  4000] loss: 0.625
Result for DEFAULT_41983_00001:
  accuracy: 0.2457
  date: 2020-12-18_16-39-53
  done: false
  experiment_id: 35d19e04ff80473e818a1080037c60f3
  experiment_tag: 1_batch_size=16,l1=32,l2=64,lr=0.038233
  hostname: d9492ca4b767
  iterations_since_restore: 7
  loss: 1.9737936767578126
  node_ip: 172.17.0.2
  pid: 1497
  should_checkpoint: true
  time_since_restore: 169.51864624023438
  time_this_iter_s: 21.39640998840332
  time_total_s: 169.51864624023438
  timestamp: 1608309593
  timesteps_since_restore: 0
  training_iteration: 7
  trial_id: '41983_00001'

== Status ==
Memory usage on this node: 7.1/240.1 GiB
Using AsyncHyperBand: num_stopped=4
Bracket: Iter 8.000: None | Iter 4.000: -1.2262581626415252 | Iter 2.000: -1.3865098380088807 | Iter 1.000: -1.8846502184331415
Resources requested: 12/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00000 | RUNNING    | 172.17.0.2:1506 |            2 |  256 |   16 | 0.000143215 | 1.76162 |     0.3511 |                    1 |
| DEFAULT_41983_00001 | RUNNING    | 172.17.0.2:1497 |           16 |   32 |   64 | 0.0382327   | 1.97379 |     0.2457 |                    7 |
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.22626 |     0.567  |                    4 |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.32561 |     0.5245 |                    2 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.19183 |     0.5704 |                    4 |
| DEFAULT_41983_00008 | RUNNING    | 172.17.0.2:1500 |            4 |   64 |  256 | 0.00133354  | 1.35456 |     0.518  |                    2 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1506)[0m [2,  6000] loss: 0.549
[2m[36m(pid=1489)[0m [3,  6000] loss: 0.442
[2m[36m(pid=1501)[0m [5,  2000] loss: 1.146
[2m[36m(pid=1500)[0m [3,  6000] loss: 0.417
[2m[36m(pid=1553)[0m [5,  2000] loss: 1.039
[2m[36m(pid=1506)[0m [2,  8000] loss: 0.409
[2m[36m(pid=1489)[0m [3,  8000] loss: 0.322
[2m[36m(pid=1501)[0m [5,  4000] loss: 0.573
[2m[36m(pid=1497)[0m [8,  2000] loss: 2.000
[2m[36m(pid=1500)[0m [3,  8000] loss: 0.312
[2m[36m(pid=1553)[0m [5,  4000] loss: 0.528
[2m[36m(pid=1506)[0m [2, 10000] loss: 0.319
Result for DEFAULT_41983_00001:
  accuracy: 0.2424
  date: 2020-12-18_16-40-14
  done: false
  experiment_id: 35d19e04ff80473e818a1080037c60f3
  experiment_tag: 1_batch_size=16,l1=32,l2=64,lr=0.038233
  hostname: d9492ca4b767
  iterations_since_restore: 8
  loss: 1.9713235443115233
  node_ip: 172.17.0.2
  pid: 1497
  should_checkpoint: true
  time_since_restore: 190.76135993003845
  time_this_iter_s: 21.242713689804077
  time_total_s: 190.76135993003845
  timestamp: 1608309614
  timesteps_since_restore: 0
  training_iteration: 8
  trial_id: '41983_00001'

== Status ==
Memory usage on this node: 7.1/240.1 GiB
Using AsyncHyperBand: num_stopped=4
Bracket: Iter 8.000: -1.9713235443115233 | Iter 4.000: -1.2262581626415252 | Iter 2.000: -1.3865098380088807 | Iter 1.000: -1.8846502184331415
Resources requested: 12/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00000 | RUNNING    | 172.17.0.2:1506 |            2 |  256 |   16 | 0.000143215 | 1.76162 |     0.3511 |                    1 |
| DEFAULT_41983_00001 | RUNNING    | 172.17.0.2:1497 |           16 |   32 |   64 | 0.0382327   | 1.97132 |     0.2424 |                    8 |
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.22626 |     0.567  |                    4 |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.32561 |     0.5245 |                    2 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.19183 |     0.5704 |                    4 |
| DEFAULT_41983_00008 | RUNNING    | 172.17.0.2:1500 |            4 |   64 |  256 | 0.00133354  | 1.35456 |     0.518  |                    2 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1489)[0m [3, 10000] loss: 0.261
Result for DEFAULT_41983_00003:
  accuracy: 0.5872
  date: 2020-12-18_16-40-17
  done: false
  experiment_id: 69635ef664e54c8da07659d6c9d15498
  experiment_tag: 3_batch_size=8,l1=64,l2=64,lr=0.001448
  hostname: d9492ca4b767
  iterations_since_restore: 5
  loss: 1.1729925964713097
  node_ip: 172.17.0.2
  pid: 1501
  should_checkpoint: true
  time_since_restore: 194.27530217170715
  time_this_iter_s: 34.33980178833008
  time_total_s: 194.27530217170715
  timestamp: 1608309617
  timesteps_since_restore: 0
  training_iteration: 5
  trial_id: '41983_00003'

[2m[36m(pid=1500)[0m [3, 10000] loss: 0.250
Result for DEFAULT_41983_00005:
  accuracy: 0.5424
  date: 2020-12-18_16-40-21
  done: false
  experiment_id: c65b0504602d4d70a5920e06da689170
  experiment_tag: 5_batch_size=4,l1=16,l2=64,lr=0.0011507
  hostname: d9492ca4b767
  iterations_since_restore: 3
  loss: 1.2733654954075813
  node_ip: 172.17.0.2
  pid: 1489
  should_checkpoint: true
  time_since_restore: 198.17972826957703
  time_this_iter_s: 58.109485387802124
  time_total_s: 198.17972826957703
  timestamp: 1608309621
  timesteps_since_restore: 0
  training_iteration: 3
  trial_id: '41983_00005'

== Status ==
Memory usage on this node: 7.0/240.1 GiB
Using AsyncHyperBand: num_stopped=4
Bracket: Iter 8.000: -1.9713235443115233 | Iter 4.000: -1.2262581626415252 | Iter 2.000: -1.3865098380088807 | Iter 1.000: -1.8846502184331415
Resources requested: 12/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00000 | RUNNING    | 172.17.0.2:1506 |            2 |  256 |   16 | 0.000143215 | 1.76162 |     0.3511 |                    1 |
| DEFAULT_41983_00001 | RUNNING    | 172.17.0.2:1497 |           16 |   32 |   64 | 0.0382327   | 1.97132 |     0.2424 |                    8 |
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.17299 |     0.5872 |                    5 |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.27337 |     0.5424 |                    3 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.19183 |     0.5704 |                    4 |
| DEFAULT_41983_00008 | RUNNING    | 172.17.0.2:1500 |            4 |   64 |  256 | 0.00133354  | 1.35456 |     0.518  |                    2 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_41983_00006:
  accuracy: 0.6026
  date: 2020-12-18_16-40-23
  done: false
  experiment_id: 4c97da77bfb042a188dd9c1b41535d60
  experiment_tag: 6_batch_size=8,l1=256,l2=32,lr=0.0016717
  hostname: d9492ca4b767
  iterations_since_restore: 5
  loss: 1.13131513286829
  node_ip: 172.17.0.2
  pid: 1553
  should_checkpoint: true
  time_since_restore: 199.57294392585754
  time_this_iter_s: 35.55028820037842
  time_total_s: 199.57294392585754
  timestamp: 1608309623
  timesteps_since_restore: 0
  training_iteration: 5
  trial_id: '41983_00006'

[2m[36m(pid=1506)[0m [2, 12000] loss: 0.269
Result for DEFAULT_41983_00008:
  accuracy: 0.5542
  date: 2020-12-18_16-40-26
  done: false
  experiment_id: 47d302572e62477284d790b0a9d74a10
  experiment_tag: 8_batch_size=4,l1=64,l2=256,lr=0.0013335
  hostname: d9492ca4b767
  iterations_since_restore: 3
  loss: 1.2683511516928674
  node_ip: 172.17.0.2
  pid: 1500
  should_checkpoint: true
  time_since_restore: 202.51062870025635
  time_this_iter_s: 59.272703409194946
  time_total_s: 202.51062870025635
  timestamp: 1608309626
  timesteps_since_restore: 0
  training_iteration: 3
  trial_id: '41983_00008'

[2m[36m(pid=1497)[0m [9,  2000] loss: 1.994
[2m[36m(pid=1501)[0m [6,  2000] loss: 1.076
[2m[36m(pid=1489)[0m [4,  2000] loss: 1.260
[2m[36m(pid=1506)[0m [2, 14000] loss: 0.225
Result for DEFAULT_41983_00001:
  accuracy: 0.256
  date: 2020-12-18_16-40-35
  done: false
  experiment_id: 35d19e04ff80473e818a1080037c60f3
  experiment_tag: 1_batch_size=16,l1=32,l2=64,lr=0.038233
  hostname: d9492ca4b767
  iterations_since_restore: 9
  loss: 1.9453628118515014
  node_ip: 172.17.0.2
  pid: 1497
  should_checkpoint: true
  time_since_restore: 212.01103115081787
  time_this_iter_s: 21.24967122077942
  time_total_s: 212.01103115081787
  timestamp: 1608309635
  timesteps_since_restore: 0
  training_iteration: 9
  trial_id: '41983_00001'

== Status ==
Memory usage on this node: 7.1/240.1 GiB
Using AsyncHyperBand: num_stopped=4
Bracket: Iter 8.000: -1.9713235443115233 | Iter 4.000: -1.2262581626415252 | Iter 2.000: -1.3865098380088807 | Iter 1.000: -1.8846502184331415
Resources requested: 12/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00000 | RUNNING    | 172.17.0.2:1506 |            2 |  256 |   16 | 0.000143215 | 1.76162 |     0.3511 |                    1 |
| DEFAULT_41983_00001 | RUNNING    | 172.17.0.2:1497 |           16 |   32 |   64 | 0.0382327   | 1.94536 |     0.256  |                    9 |
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.17299 |     0.5872 |                    5 |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.27337 |     0.5424 |                    3 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.13132 |     0.6026 |                    5 |
| DEFAULT_41983_00008 | RUNNING    | 172.17.0.2:1500 |            4 |   64 |  256 | 0.00133354  | 1.26835 |     0.5542 |                    3 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1553)[0m [6,  2000] loss: 0.959
[2m[36m(pid=1500)[0m [4,  2000] loss: 1.161
[2m[36m(pid=1489)[0m [4,  4000] loss: 0.619
[2m[36m(pid=1501)[0m [6,  4000] loss: 0.548
[2m[36m(pid=1506)[0m [2, 16000] loss: 0.196
[2m[36m(pid=1500)[0m [4,  4000] loss: 0.597
[2m[36m(pid=1553)[0m [6,  4000] loss: 0.492
[2m[36m(pid=1497)[0m [10,  2000] loss: 2.001
[2m[36m(pid=1489)[0m [4,  6000] loss: 0.417
Result for DEFAULT_41983_00003:
  accuracy: 0.5913
  date: 2020-12-18_16-40-52
  done: false
  experiment_id: 69635ef664e54c8da07659d6c9d15498
  experiment_tag: 3_batch_size=8,l1=64,l2=64,lr=0.001448
  hostname: d9492ca4b767
  iterations_since_restore: 6
  loss: 1.1639269631028175
  node_ip: 172.17.0.2
  pid: 1501
  should_checkpoint: true
  time_since_restore: 229.27343106269836
  time_this_iter_s: 34.99812889099121
  time_total_s: 229.27343106269836
  timestamp: 1608309652
  timesteps_since_restore: 0
  training_iteration: 6
  trial_id: '41983_00003'

== Status ==
Memory usage on this node: 7.1/240.1 GiB
Using AsyncHyperBand: num_stopped=4
Bracket: Iter 8.000: -1.9713235443115233 | Iter 4.000: -1.2262581626415252 | Iter 2.000: -1.3865098380088807 | Iter 1.000: -1.8846502184331415
Resources requested: 12/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00000 | RUNNING    | 172.17.0.2:1506 |            2 |  256 |   16 | 0.000143215 | 1.76162 |     0.3511 |                    1 |
| DEFAULT_41983_00001 | RUNNING    | 172.17.0.2:1497 |           16 |   32 |   64 | 0.0382327   | 1.94536 |     0.256  |                    9 |
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.16393 |     0.5913 |                    6 |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.27337 |     0.5424 |                    3 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.13132 |     0.6026 |                    5 |
| DEFAULT_41983_00008 | RUNNING    | 172.17.0.2:1500 |            4 |   64 |  256 | 0.00133354  | 1.26835 |     0.5542 |                    3 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1506)[0m [2, 18000] loss: 0.173
Result for DEFAULT_41983_00001:
  accuracy: 0.2222
  date: 2020-12-18_16-40-56
  done: true
  experiment_id: 35d19e04ff80473e818a1080037c60f3
  experiment_tag: 1_batch_size=16,l1=32,l2=64,lr=0.038233
  hostname: d9492ca4b767
  iterations_since_restore: 10
  loss: 1.98775143699646
  node_ip: 172.17.0.2
  pid: 1497
  should_checkpoint: true
  time_since_restore: 233.0212426185608
  time_this_iter_s: 21.01021146774292
  time_total_s: 233.0212426185608
  timestamp: 1608309656
  timesteps_since_restore: 0
  training_iteration: 10
  trial_id: '41983_00001'

[2m[36m(pid=1500)[0m [4,  6000] loss: 0.390
Result for DEFAULT_41983_00006:
  accuracy: 0.6
  date: 2020-12-18_16-40-58
  done: false
  experiment_id: 4c97da77bfb042a188dd9c1b41535d60
  experiment_tag: 6_batch_size=8,l1=256,l2=32,lr=0.0016717
  hostname: d9492ca4b767
  iterations_since_restore: 6
  loss: 1.1528082183361053
  node_ip: 172.17.0.2
  pid: 1553
  should_checkpoint: true
  time_since_restore: 234.5458528995514
  time_this_iter_s: 34.97290897369385
  time_total_s: 234.5458528995514
  timestamp: 1608309658
  timesteps_since_restore: 0
  training_iteration: 6
  trial_id: '41983_00006'

== Status ==
Memory usage on this node: 6.5/240.1 GiB
Using AsyncHyperBand: num_stopped=5
Bracket: Iter 8.000: -1.9713235443115233 | Iter 4.000: -1.2262581626415252 | Iter 2.000: -1.3865098380088807 | Iter 1.000: -1.8846502184331415
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00000 | RUNNING    | 172.17.0.2:1506 |            2 |  256 |   16 | 0.000143215 | 1.76162 |     0.3511 |                    1 |
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.16393 |     0.5913 |                    6 |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.27337 |     0.5424 |                    3 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.15281 |     0.6    |                    6 |
| DEFAULT_41983_00008 | RUNNING    | 172.17.0.2:1500 |            4 |   64 |  256 | 0.00133354  | 1.26835 |     0.5542 |                    3 |
| DEFAULT_41983_00001 | TERMINATED |                 |           16 |   32 |   64 | 0.0382327   | 1.98775 |     0.2222 |                   10 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1489)[0m [4,  8000] loss: 0.316
[2m[36m(pid=1506)[0m [2, 20000] loss: 0.153
[2m[36m(pid=1501)[0m [7,  2000] loss: 1.030
[2m[36m(pid=1500)[0m [4,  8000] loss: 0.296
[2m[36m(pid=1553)[0m [7,  2000] loss: 0.871
[2m[36m(pid=1489)[0m [4, 10000] loss: 0.252
[2m[36m(pid=1501)[0m [7,  4000] loss: 0.529
Result for DEFAULT_41983_00000:
  accuracy: 0.4404
  date: 2020-12-18_16-41-17
  done: true
  experiment_id: 3e6eb2982cbc4af38a581aa7ae637d37
  experiment_tag: 0_batch_size=2,l1=256,l2=16,lr=0.00014322
  hostname: d9492ca4b767
  iterations_since_restore: 2
  loss: 1.5249778030723333
  node_ip: 172.17.0.2
  pid: 1506
  should_checkpoint: true
  time_since_restore: 253.89495825767517
  time_this_iter_s: 114.5108380317688
  time_total_s: 253.89495825767517
  timestamp: 1608309677
  timesteps_since_restore: 0
  training_iteration: 2
  trial_id: '41983_00000'

== Status ==
Memory usage on this node: 6.4/240.1 GiB
Using AsyncHyperBand: num_stopped=6
Bracket: Iter 8.000: -1.9713235443115233 | Iter 4.000: -1.2262581626415252 | Iter 2.000: -1.4094075855493546 | Iter 1.000: -1.8846502184331415
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00000 | RUNNING    | 172.17.0.2:1506 |            2 |  256 |   16 | 0.000143215 | 1.52498 |     0.4404 |                    2 |
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.16393 |     0.5913 |                    6 |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.27337 |     0.5424 |                    3 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.15281 |     0.6    |                    6 |
| DEFAULT_41983_00008 | RUNNING    | 172.17.0.2:1500 |            4 |   64 |  256 | 0.00133354  | 1.26835 |     0.5542 |                    3 |
| DEFAULT_41983_00001 | TERMINATED |                 |           16 |   32 |   64 | 0.0382327   | 1.98775 |     0.2222 |                   10 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1500)[0m [4, 10000] loss: 0.233
Result for DEFAULT_41983_00005:
  accuracy: 0.5638
  date: 2020-12-18_16-41-19
  done: false
  experiment_id: c65b0504602d4d70a5920e06da689170
  experiment_tag: 5_batch_size=4,l1=16,l2=64,lr=0.0011507
  hostname: d9492ca4b767
  iterations_since_restore: 4
  loss: 1.2175759935855865
  node_ip: 172.17.0.2
  pid: 1489
  should_checkpoint: true
  time_since_restore: 255.57695293426514
  time_this_iter_s: 57.39722466468811
  time_total_s: 255.57695293426514
  timestamp: 1608309679
  timesteps_since_restore: 0
  training_iteration: 4
  trial_id: '41983_00005'

[2m[36m(pid=1553)[0m [7,  4000] loss: 0.459
Result for DEFAULT_41983_00008:
  accuracy: 0.5648
  date: 2020-12-18_16-41-24
  done: true
  experiment_id: 47d302572e62477284d790b0a9d74a10
  experiment_tag: 8_batch_size=4,l1=64,l2=256,lr=0.0013335
  hostname: d9492ca4b767
  iterations_since_restore: 4
  loss: 1.241454353987053
  node_ip: 172.17.0.2
  pid: 1500
  should_checkpoint: true
  time_since_restore: 261.2711501121521
  time_this_iter_s: 58.76052141189575
  time_total_s: 261.2711501121521
  timestamp: 1608309684
  timesteps_since_restore: 0
  training_iteration: 4
  trial_id: '41983_00008'

== Status ==
Memory usage on this node: 5.9/240.1 GiB
Using AsyncHyperBand: num_stopped=7
Bracket: Iter 8.000: -1.9713235443115233 | Iter 4.000: -1.2262581626415252 | Iter 2.000: -1.4094075855493546 | Iter 1.000: -1.8846502184331415
Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.16393 |     0.5913 |                    6 |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.21758 |     0.5638 |                    4 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.15281 |     0.6    |                    6 |
| DEFAULT_41983_00008 | RUNNING    | 172.17.0.2:1500 |            4 |   64 |  256 | 0.00133354  | 1.24145 |     0.5648 |                    4 |
| DEFAULT_41983_00000 | TERMINATED |                 |            2 |  256 |   16 | 0.000143215 | 1.52498 |     0.4404 |                    2 |
| DEFAULT_41983_00001 | TERMINATED |                 |           16 |   32 |   64 | 0.0382327   | 1.98775 |     0.2222 |                   10 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_41983_00003:
  accuracy: 0.6049
  date: 2020-12-18_16-41-26
  done: false
  experiment_id: 69635ef664e54c8da07659d6c9d15498
  experiment_tag: 3_batch_size=8,l1=64,l2=64,lr=0.001448
  hostname: d9492ca4b767
  iterations_since_restore: 7
  loss: 1.1317432489514352
  node_ip: 172.17.0.2
  pid: 1501
  should_checkpoint: true
  time_since_restore: 262.5349817276001
  time_this_iter_s: 33.26155066490173
  time_total_s: 262.5349817276001
  timestamp: 1608309686
  timesteps_since_restore: 0
  training_iteration: 7
  trial_id: '41983_00003'

[2m[36m(pid=1489)[0m [5,  2000] loss: 1.213
Result for DEFAULT_41983_00006:
  accuracy: 0.6078
  date: 2020-12-18_16-41-32
  done: false
  experiment_id: 4c97da77bfb042a188dd9c1b41535d60
  experiment_tag: 6_batch_size=8,l1=256,l2=32,lr=0.0016717
  hostname: d9492ca4b767
  iterations_since_restore: 7
  loss: 1.1441551375329495
  node_ip: 172.17.0.2
  pid: 1553
  should_checkpoint: true
  time_since_restore: 268.4570255279541
  time_this_iter_s: 33.91117262840271
  time_total_s: 268.4570255279541
  timestamp: 1608309692
  timesteps_since_restore: 0
  training_iteration: 7
  trial_id: '41983_00006'

== Status ==
Memory usage on this node: 5.3/240.1 GiB
Using AsyncHyperBand: num_stopped=7
Bracket: Iter 8.000: -1.9713235443115233 | Iter 4.000: -1.2262581626415252 | Iter 2.000: -1.4094075855493546 | Iter 1.000: -1.8846502184331415
Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.13174 |     0.6049 |                    7 |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.21758 |     0.5638 |                    4 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.14416 |     0.6078 |                    7 |
| DEFAULT_41983_00000 | TERMINATED |                 |            2 |  256 |   16 | 0.000143215 | 1.52498 |     0.4404 |                    2 |
| DEFAULT_41983_00001 | TERMINATED |                 |           16 |   32 |   64 | 0.0382327   | 1.98775 |     0.2222 |                   10 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00008 | TERMINATED |                 |            4 |   64 |  256 | 0.00133354  | 1.24145 |     0.5648 |                    4 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1501)[0m [8,  2000] loss: 0.992
[2m[36m(pid=1489)[0m [5,  4000] loss: 0.611
[2m[36m(pid=1553)[0m [8,  2000] loss: 0.803
[2m[36m(pid=1489)[0m [5,  6000] loss: 0.402
[2m[36m(pid=1501)[0m [8,  4000] loss: 0.501
[2m[36m(pid=1553)[0m [8,  4000] loss: 0.432
[2m[36m(pid=1489)[0m [5,  8000] loss: 0.313
Result for DEFAULT_41983_00003:
  accuracy: 0.5907
  date: 2020-12-18_16-41-58
  done: false
  experiment_id: 69635ef664e54c8da07659d6c9d15498
  experiment_tag: 3_batch_size=8,l1=64,l2=64,lr=0.001448
  hostname: d9492ca4b767
  iterations_since_restore: 8
  loss: 1.2122989603161811
  node_ip: 172.17.0.2
  pid: 1501
  should_checkpoint: true
  time_since_restore: 294.5485692024231
  time_this_iter_s: 32.013587474823
  time_total_s: 294.5485692024231
  timestamp: 1608309718
  timesteps_since_restore: 0
  training_iteration: 8
  trial_id: '41983_00003'

== Status ==
Memory usage on this node: 5.3/240.1 GiB
Using AsyncHyperBand: num_stopped=7
Bracket: Iter 8.000: -1.5918112523138523 | Iter 4.000: -1.2262581626415252 | Iter 2.000: -1.4094075855493546 | Iter 1.000: -1.8846502184331415
Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.2123  |     0.5907 |                    8 |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.21758 |     0.5638 |                    4 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.14416 |     0.6078 |                    7 |
| DEFAULT_41983_00000 | TERMINATED |                 |            2 |  256 |   16 | 0.000143215 | 1.52498 |     0.4404 |                    2 |
| DEFAULT_41983_00001 | TERMINATED |                 |           16 |   32 |   64 | 0.0382327   | 1.98775 |     0.2222 |                   10 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00008 | TERMINATED |                 |            4 |   64 |  256 | 0.00133354  | 1.24145 |     0.5648 |                    4 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_41983_00006:
  accuracy: 0.597
  date: 2020-12-18_16-42-04
  done: false
  experiment_id: 4c97da77bfb042a188dd9c1b41535d60
  experiment_tag: 6_batch_size=8,l1=256,l2=32,lr=0.0016717
  hostname: d9492ca4b767
  iterations_since_restore: 8
  loss: 1.1597471118211746
  node_ip: 172.17.0.2
  pid: 1553
  should_checkpoint: true
  time_since_restore: 301.3551392555237
  time_this_iter_s: 32.89811372756958
  time_total_s: 301.3551392555237
  timestamp: 1608309724
  timesteps_since_restore: 0
  training_iteration: 8
  trial_id: '41983_00006'

== Status ==
Memory usage on this node: 5.3/240.1 GiB
Using AsyncHyperBand: num_stopped=7
Bracket: Iter 8.000: -1.2122989603161811 | Iter 4.000: -1.2262581626415252 | Iter 2.000: -1.4094075855493546 | Iter 1.000: -1.8846502184331415
Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.2123  |     0.5907 |                    8 |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.21758 |     0.5638 |                    4 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.15975 |     0.597  |                    8 |
| DEFAULT_41983_00000 | TERMINATED |                 |            2 |  256 |   16 | 0.000143215 | 1.52498 |     0.4404 |                    2 |
| DEFAULT_41983_00001 | TERMINATED |                 |           16 |   32 |   64 | 0.0382327   | 1.98775 |     0.2222 |                   10 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00008 | TERMINATED |                 |            4 |   64 |  256 | 0.00133354  | 1.24145 |     0.5648 |                    4 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1489)[0m [5, 10000] loss: 0.243
[2m[36m(pid=1501)[0m [9,  2000] loss: 0.955
Result for DEFAULT_41983_00005:
  accuracy: 0.5697
  date: 2020-12-18_16-42-13
  done: false
  experiment_id: c65b0504602d4d70a5920e06da689170
  experiment_tag: 5_batch_size=4,l1=16,l2=64,lr=0.0011507
  hostname: d9492ca4b767
  iterations_since_restore: 5
  loss: 1.2177840457968414
  node_ip: 172.17.0.2
  pid: 1489
  should_checkpoint: true
  time_since_restore: 310.01276421546936
  time_this_iter_s: 54.435811281204224
  time_total_s: 310.01276421546936
  timestamp: 1608309733
  timesteps_since_restore: 0
  training_iteration: 5
  trial_id: '41983_00005'

== Status ==
Memory usage on this node: 5.3/240.1 GiB
Using AsyncHyperBand: num_stopped=7
Bracket: Iter 8.000: -1.2122989603161811 | Iter 4.000: -1.2262581626415252 | Iter 2.000: -1.4094075855493546 | Iter 1.000: -1.8846502184331415
Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.2123  |     0.5907 |                    8 |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.21778 |     0.5697 |                    5 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.15975 |     0.597  |                    8 |
| DEFAULT_41983_00000 | TERMINATED |                 |            2 |  256 |   16 | 0.000143215 | 1.52498 |     0.4404 |                    2 |
| DEFAULT_41983_00001 | TERMINATED |                 |           16 |   32 |   64 | 0.0382327   | 1.98775 |     0.2222 |                   10 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00008 | TERMINATED |                 |            4 |   64 |  256 | 0.00133354  | 1.24145 |     0.5648 |                    4 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1553)[0m [9,  2000] loss: 0.745
[2m[36m(pid=1501)[0m [9,  4000] loss: 0.492
[2m[36m(pid=1489)[0m [6,  2000] loss: 1.193
[2m[36m(pid=1553)[0m [9,  4000] loss: 0.396
Result for DEFAULT_41983_00003:
  accuracy: 0.6138
  date: 2020-12-18_16-42-30
  done: false
  experiment_id: 69635ef664e54c8da07659d6c9d15498
  experiment_tag: 3_batch_size=8,l1=64,l2=64,lr=0.001448
  hostname: d9492ca4b767
  iterations_since_restore: 9
  loss: 1.1224516082763671
  node_ip: 172.17.0.2
  pid: 1501
  should_checkpoint: true
  time_since_restore: 326.85297775268555
  time_this_iter_s: 32.30440855026245
  time_total_s: 326.85297775268555
  timestamp: 1608309750
  timesteps_since_restore: 0
  training_iteration: 9
  trial_id: '41983_00003'

== Status ==
Memory usage on this node: 5.3/240.1 GiB
Using AsyncHyperBand: num_stopped=7
Bracket: Iter 8.000: -1.2122989603161811 | Iter 4.000: -1.2262581626415252 | Iter 2.000: -1.4094075855493546 | Iter 1.000: -1.8846502184331415
Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.12245 |     0.6138 |                    9 |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.21778 |     0.5697 |                    5 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.15975 |     0.597  |                    8 |
| DEFAULT_41983_00000 | TERMINATED |                 |            2 |  256 |   16 | 0.000143215 | 1.52498 |     0.4404 |                    2 |
| DEFAULT_41983_00001 | TERMINATED |                 |           16 |   32 |   64 | 0.0382327   | 1.98775 |     0.2222 |                   10 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00008 | TERMINATED |                 |            4 |   64 |  256 | 0.00133354  | 1.24145 |     0.5648 |                    4 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1489)[0m [6,  4000] loss: 0.611
Result for DEFAULT_41983_00006:
  accuracy: 0.5959
  date: 2020-12-18_16-42-37
  done: false
  experiment_id: 4c97da77bfb042a188dd9c1b41535d60
  experiment_tag: 6_batch_size=8,l1=256,l2=32,lr=0.0016717
  hostname: d9492ca4b767
  iterations_since_restore: 9
  loss: 1.2170486401498317
  node_ip: 172.17.0.2
  pid: 1553
  should_checkpoint: true
  time_since_restore: 334.26183462142944
  time_this_iter_s: 32.90669536590576
  time_total_s: 334.26183462142944
  timestamp: 1608309757
  timesteps_since_restore: 0
  training_iteration: 9
  trial_id: '41983_00006'

== Status ==
Memory usage on this node: 5.3/240.1 GiB
Using AsyncHyperBand: num_stopped=7
Bracket: Iter 8.000: -1.2122989603161811 | Iter 4.000: -1.2262581626415252 | Iter 2.000: -1.4094075855493546 | Iter 1.000: -1.8846502184331415
Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.12245 |     0.6138 |                    9 |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.21778 |     0.5697 |                    5 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.21705 |     0.5959 |                    9 |
| DEFAULT_41983_00000 | TERMINATED |                 |            2 |  256 |   16 | 0.000143215 | 1.52498 |     0.4404 |                    2 |
| DEFAULT_41983_00001 | TERMINATED |                 |           16 |   32 |   64 | 0.0382327   | 1.98775 |     0.2222 |                   10 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00008 | TERMINATED |                 |            4 |   64 |  256 | 0.00133354  | 1.24145 |     0.5648 |                    4 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1501)[0m [10,  2000] loss: 0.924
[2m[36m(pid=1489)[0m [6,  6000] loss: 0.401
[2m[36m(pid=1553)[0m [10,  2000] loss: 0.693
[2m[36m(pid=1489)[0m [6,  8000] loss: 0.295
[2m[36m(pid=1501)[0m [10,  4000] loss: 0.474
[2m[36m(pid=1553)[0m [10,  4000] loss: 0.370
[2m[36m(pid=1489)[0m [6, 10000] loss: 0.237
Result for DEFAULT_41983_00003:
  accuracy: 0.6036
  date: 2020-12-18_16-43-02
  done: true
  experiment_id: 69635ef664e54c8da07659d6c9d15498
  experiment_tag: 3_batch_size=8,l1=64,l2=64,lr=0.001448
  hostname: d9492ca4b767
  iterations_since_restore: 10
  loss: 1.1853519890666009
  node_ip: 172.17.0.2
  pid: 1501
  should_checkpoint: true
  time_since_restore: 359.28058767318726
  time_this_iter_s: 32.42760992050171
  time_total_s: 359.28058767318726
  timestamp: 1608309782
  timesteps_since_restore: 0
  training_iteration: 10
  trial_id: '41983_00003'

== Status ==
Memory usage on this node: 5.3/240.1 GiB
Using AsyncHyperBand: num_stopped=8
Bracket: Iter 8.000: -1.2122989603161811 | Iter 4.000: -1.2262581626415252 | Iter 2.000: -1.4094075855493546 | Iter 1.000: -1.8846502184331415
Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00003 | RUNNING    | 172.17.0.2:1501 |            8 |   64 |   64 | 0.00144802  | 1.18535 |     0.6036 |                   10 |
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.21778 |     0.5697 |                    5 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.21705 |     0.5959 |                    9 |
| DEFAULT_41983_00000 | TERMINATED |                 |            2 |  256 |   16 | 0.000143215 | 1.52498 |     0.4404 |                    2 |
| DEFAULT_41983_00001 | TERMINATED |                 |           16 |   32 |   64 | 0.0382327   | 1.98775 |     0.2222 |                   10 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00008 | TERMINATED |                 |            4 |   64 |  256 | 0.00133354  | 1.24145 |     0.5648 |                    4 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_41983_00005:
  accuracy: 0.5505
  date: 2020-12-18_16-43-07
  done: false
  experiment_id: c65b0504602d4d70a5920e06da689170
  experiment_tag: 5_batch_size=4,l1=16,l2=64,lr=0.0011507
  hostname: d9492ca4b767
  iterations_since_restore: 6
  loss: 1.2686538695544005
  node_ip: 172.17.0.2
  pid: 1489
  should_checkpoint: true
  time_since_restore: 364.18839597702026
  time_this_iter_s: 54.1756317615509
  time_total_s: 364.18839597702026
  timestamp: 1608309787
  timesteps_since_restore: 0
  training_iteration: 6
  trial_id: '41983_00005'

Result for DEFAULT_41983_00006:
  accuracy: 0.606
  date: 2020-12-18_16-43-10
  done: true
  experiment_id: 4c97da77bfb042a188dd9c1b41535d60
  experiment_tag: 6_batch_size=8,l1=256,l2=32,lr=0.0016717
  hostname: d9492ca4b767
  iterations_since_restore: 10
  loss: 1.2271063965141773
  node_ip: 172.17.0.2
  pid: 1553
  should_checkpoint: true
  time_since_restore: 366.76350259780884
  time_this_iter_s: 32.501667976379395
  time_total_s: 366.76350259780884
  timestamp: 1608309790
  timesteps_since_restore: 0
  training_iteration: 10
  trial_id: '41983_00006'

== Status ==
Memory usage on this node: 4.7/240.1 GiB
Using AsyncHyperBand: num_stopped=9
Bracket: Iter 8.000: -1.2122989603161811 | Iter 4.000: -1.2262581626415252 | Iter 2.000: -1.4094075855493546 | Iter 1.000: -1.8846502184331415
Resources requested: 4/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.26865 |     0.5505 |                    6 |
| DEFAULT_41983_00006 | RUNNING    | 172.17.0.2:1553 |            8 |  256 |   32 | 0.00167166  | 1.22711 |     0.606  |                   10 |
| DEFAULT_41983_00000 | TERMINATED |                 |            2 |  256 |   16 | 0.000143215 | 1.52498 |     0.4404 |                    2 |
| DEFAULT_41983_00001 | TERMINATED |                 |           16 |   32 |   64 | 0.0382327   | 1.98775 |     0.2222 |                   10 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00003 | TERMINATED |                 |            8 |   64 |   64 | 0.00144802  | 1.18535 |     0.6036 |                   10 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00008 | TERMINATED |                 |            4 |   64 |  256 | 0.00133354  | 1.24145 |     0.5648 |                    4 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1489)[0m [7,  2000] loss: 1.162
[2m[36m(pid=1489)[0m [7,  4000] loss: 0.588
[2m[36m(pid=1489)[0m [7,  6000] loss: 0.395
[2m[36m(pid=1489)[0m [7,  8000] loss: 0.293
[2m[36m(pid=1489)[0m [7, 10000] loss: 0.235
Result for DEFAULT_41983_00005:
  accuracy: 0.5876
  date: 2020-12-18_16-43-59
  done: false
  experiment_id: c65b0504602d4d70a5920e06da689170
  experiment_tag: 5_batch_size=4,l1=16,l2=64,lr=0.0011507
  hostname: d9492ca4b767
  iterations_since_restore: 7
  loss: 1.1936724079191685
  node_ip: 172.17.0.2
  pid: 1489
  should_checkpoint: true
  time_since_restore: 416.2562415599823
  time_this_iter_s: 52.067845582962036
  time_total_s: 416.2562415599823
  timestamp: 1608309839
  timesteps_since_restore: 0
  training_iteration: 7
  trial_id: '41983_00005'

== Status ==
Memory usage on this node: 4.0/240.1 GiB
Using AsyncHyperBand: num_stopped=9
Bracket: Iter 8.000: -1.2122989603161811 | Iter 4.000: -1.2262581626415252 | Iter 2.000: -1.4094075855493546 | Iter 1.000: -1.8846502184331415
Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.19367 |     0.5876 |                    7 |
| DEFAULT_41983_00000 | TERMINATED |                 |            2 |  256 |   16 | 0.000143215 | 1.52498 |     0.4404 |                    2 |
| DEFAULT_41983_00001 | TERMINATED |                 |           16 |   32 |   64 | 0.0382327   | 1.98775 |     0.2222 |                   10 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00003 | TERMINATED |                 |            8 |   64 |   64 | 0.00144802  | 1.18535 |     0.6036 |                   10 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.00167166  | 1.22711 |     0.606  |                   10 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00008 | TERMINATED |                 |            4 |   64 |  256 | 0.00133354  | 1.24145 |     0.5648 |                    4 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1489)[0m [8,  2000] loss: 1.148
[2m[36m(pid=1489)[0m [8,  4000] loss: 0.572
[2m[36m(pid=1489)[0m [8,  6000] loss: 0.387
[2m[36m(pid=1489)[0m [8,  8000] loss: 0.290
[2m[36m(pid=1489)[0m [8, 10000] loss: 0.239
Result for DEFAULT_41983_00005:
  accuracy: 0.5837
  date: 2020-12-18_16-44-51
  done: false
  experiment_id: c65b0504602d4d70a5920e06da689170
  experiment_tag: 5_batch_size=4,l1=16,l2=64,lr=0.0011507
  hostname: d9492ca4b767
  iterations_since_restore: 8
  loss: 1.1810292526826263
  node_ip: 172.17.0.2
  pid: 1489
  should_checkpoint: true
  time_since_restore: 468.3747546672821
  time_this_iter_s: 52.118513107299805
  time_total_s: 468.3747546672821
  timestamp: 1608309891
  timesteps_since_restore: 0
  training_iteration: 8
  trial_id: '41983_00005'

== Status ==
Memory usage on this node: 4.0/240.1 GiB
Using AsyncHyperBand: num_stopped=9
Bracket: Iter 8.000: -1.1966641064994037 | Iter 4.000: -1.2262581626415252 | Iter 2.000: -1.4094075855493546 | Iter 1.000: -1.8846502184331415
Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.18103 |     0.5837 |                    8 |
| DEFAULT_41983_00000 | TERMINATED |                 |            2 |  256 |   16 | 0.000143215 | 1.52498 |     0.4404 |                    2 |
| DEFAULT_41983_00001 | TERMINATED |                 |           16 |   32 |   64 | 0.0382327   | 1.98775 |     0.2222 |                   10 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00003 | TERMINATED |                 |            8 |   64 |   64 | 0.00144802  | 1.18535 |     0.6036 |                   10 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.00167166  | 1.22711 |     0.606  |                   10 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00008 | TERMINATED |                 |            4 |   64 |  256 | 0.00133354  | 1.24145 |     0.5648 |                    4 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1489)[0m [9,  2000] loss: 1.123
[2m[36m(pid=1489)[0m [9,  4000] loss: 0.566
[2m[36m(pid=1489)[0m [9,  6000] loss: 0.388
[2m[36m(pid=1489)[0m [9,  8000] loss: 0.283
[2m[36m(pid=1489)[0m [9, 10000] loss: 0.232
Result for DEFAULT_41983_00005:
  accuracy: 0.5746
  date: 2020-12-18_16-45-45
  done: false
  experiment_id: c65b0504602d4d70a5920e06da689170
  experiment_tag: 5_batch_size=4,l1=16,l2=64,lr=0.0011507
  hostname: d9492ca4b767
  iterations_since_restore: 9
  loss: 1.2339198628246784
  node_ip: 172.17.0.2
  pid: 1489
  should_checkpoint: true
  time_since_restore: 521.7384965419769
  time_this_iter_s: 53.363741874694824
  time_total_s: 521.7384965419769
  timestamp: 1608309945
  timesteps_since_restore: 0
  training_iteration: 9
  trial_id: '41983_00005'

== Status ==
Memory usage on this node: 4.0/240.1 GiB
Using AsyncHyperBand: num_stopped=9
Bracket: Iter 8.000: -1.1966641064994037 | Iter 4.000: -1.2262581626415252 | Iter 2.000: -1.4094075855493546 | Iter 1.000: -1.8846502184331415
Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.23392 |     0.5746 |                    9 |
| DEFAULT_41983_00000 | TERMINATED |                 |            2 |  256 |   16 | 0.000143215 | 1.52498 |     0.4404 |                    2 |
| DEFAULT_41983_00001 | TERMINATED |                 |           16 |   32 |   64 | 0.0382327   | 1.98775 |     0.2222 |                   10 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00003 | TERMINATED |                 |            8 |   64 |   64 | 0.00144802  | 1.18535 |     0.6036 |                   10 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.00167166  | 1.22711 |     0.606  |                   10 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00008 | TERMINATED |                 |            4 |   64 |  256 | 0.00133354  | 1.24145 |     0.5648 |                    4 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1489)[0m [10,  2000] loss: 1.106
[2m[36m(pid=1489)[0m [10,  4000] loss: 0.562
[2m[36m(pid=1489)[0m [10,  6000] loss: 0.374
[2m[36m(pid=1489)[0m [10,  8000] loss: 0.283
[2m[36m(pid=1489)[0m [10, 10000] loss: 0.231
Result for DEFAULT_41983_00005:
  accuracy: 0.5663
  date: 2020-12-18_16-46-37
  done: true
  experiment_id: c65b0504602d4d70a5920e06da689170
  experiment_tag: 5_batch_size=4,l1=16,l2=64,lr=0.0011507
  hostname: d9492ca4b767
  iterations_since_restore: 10
  loss: 1.2296840837046503
  node_ip: 172.17.0.2
  pid: 1489
  should_checkpoint: true
  time_since_restore: 573.7661383152008
  time_this_iter_s: 52.02764177322388
  time_total_s: 573.7661383152008
  timestamp: 1608309997
  timesteps_since_restore: 0
  training_iteration: 10
  trial_id: '41983_00005'

== Status ==
Memory usage on this node: 4.0/240.1 GiB
Using AsyncHyperBand: num_stopped=10
Bracket: Iter 8.000: -1.1966641064994037 | Iter 4.000: -1.2262581626415252 | Iter 2.000: -1.4094075855493546 | Iter 1.000: -1.8846502184331415
Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00005 | RUNNING    | 172.17.0.2:1489 |            4 |   16 |   64 | 0.00115067  | 1.22968 |     0.5663 |                   10 |
| DEFAULT_41983_00000 | TERMINATED |                 |            2 |  256 |   16 | 0.000143215 | 1.52498 |     0.4404 |                    2 |
| DEFAULT_41983_00001 | TERMINATED |                 |           16 |   32 |   64 | 0.0382327   | 1.98775 |     0.2222 |                   10 |
| DEFAULT_41983_00002 | TERMINATED |                 |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00003 | TERMINATED |                 |            8 |   64 |   64 | 0.00144802  | 1.18535 |     0.6036 |                   10 |
| DEFAULT_41983_00004 | TERMINATED |                 |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.00167166  | 1.22711 |     0.606  |                   10 |
| DEFAULT_41983_00007 | TERMINATED |                 |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00008 | TERMINATED |                 |            4 |   64 |  256 | 0.00133354  | 1.24145 |     0.5648 |                    4 |
| DEFAULT_41983_00009 | TERMINATED |                 |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


== Status ==
Memory usage on this node: 3.9/240.1 GiB
Using AsyncHyperBand: num_stopped=10
Bracket: Iter 8.000: -1.1966641064994037 | Iter 4.000: -1.2262581626415252 | Iter 2.000: -1.4094075855493546 | Iter 1.000: -1.8846502184331415
Resources requested: 0/32 CPUs, 0/2 GPUs, 0.0/157.76 GiB heap, 0.0/49.41 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2020-12-18_16-37-02
Number of trials: 10/10 (10 TERMINATED)
+---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc   |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_41983_00000 | TERMINATED |       |            2 |  256 |   16 | 0.000143215 | 1.52498 |     0.4404 |                    2 |
| DEFAULT_41983_00001 | TERMINATED |       |           16 |   32 |   64 | 0.0382327   | 1.98775 |     0.2222 |                   10 |
| DEFAULT_41983_00002 | TERMINATED |       |            2 |   16 |    4 | 0.0199284   | 2.31474 |     0.0989 |                    1 |
| DEFAULT_41983_00003 | TERMINATED |       |            8 |   64 |   64 | 0.00144802  | 1.18535 |     0.6036 |                   10 |
| DEFAULT_41983_00004 | TERMINATED |       |            4 |   64 |    4 | 0.0605362   | 2.33265 |     0.1013 |                    1 |
| DEFAULT_41983_00005 | TERMINATED |       |            4 |   16 |   64 | 0.00115067  | 1.22968 |     0.5663 |                   10 |
| DEFAULT_41983_00006 | TERMINATED |       |            8 |  256 |   32 | 0.00167166  | 1.22711 |     0.606  |                   10 |
| DEFAULT_41983_00007 | TERMINATED |       |           16 |   16 |    8 | 0.000104831 | 2.31    |     0.1005 |                    1 |
| DEFAULT_41983_00008 | TERMINATED |       |            4 |   64 |  256 | 0.00133354  | 1.24145 |     0.5648 |                    4 |
| DEFAULT_41983_00009 | TERMINATED |       |            8 |   64 |    4 | 0.0188509   | 2.04317 |     0.1687 |                    1 |
+---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+


Best trial config: {'l1': 64, 'l2': 64, 'lr': 0.0014480165703275821, 'batch_size': 8}
Best trial final validation loss: 1.1853519890666009
Best trial final validation accuracy: 0.6036
Files already downloaded and verified
Files already downloaded and verified
Best trial test set accuracy: 0.5952
</pre></div>
</div>
<p>If you run the code, an example output could look like this:</p>
<p>Most trials have been stopped early in order to avoid wasting resources.
The best performing trial achieved a validation accuracy of about 58%, which could
be confirmed on the test set.</p>
<p>So that’s it! You can now tune the parameters of your PyTorch models.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 9 minutes  57.504 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-beginner-hyperparameter-tuning-tutorial-py">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" download="" href="../_downloads/95074cd7ce8c3e57a92e7a9c49182e6a/hyperparameter_tuning_tutorial.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">hyperparameter_tuning_tutorial.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" download="" href="../_downloads/c24b93738bc036c1b66d0387555bf69a/hyperparameter_tuning_tutorial.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">hyperparameter_tuning_tutorial.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>
</article>
</div>
<footer>
<div aria-label="footer navigation" class="rst-footer-buttons" role="navigation">
<a accesskey="n" class="btn btn-neutral float-right" href="../intermediate/pruning_tutorial.html" rel="next" title="Pruning Tutorial">Next <img class="next-page" src="../_static/images/chevron-right-orange.svg"/></a>
<a accesskey="p" class="btn btn-neutral" href="../advanced/dispatcher.html" rel="prev" title="Registering a Dispatched Operator in C++"><img class="previous-page" src="../_static/images/chevron-right-orange.svg"/> Previous</a>
</div>
<hr class="helpful-hr hr-top"/>
<div class="helpful-container">
<div class="helpful-question">Was this helpful?</div>
<div class="helpful-question yes-link" data-behavior="was-this-helpful-event" data-response="yes">Yes</div>
<div class="helpful-question no-link" data-behavior="was-this-helpful-event" data-response="no">No</div>
<div class="was-helpful-thank-you">Thank you</div>
</div>
<hr class="helpful-hr hr-bottom"/>
<div role="contentinfo">
<p>
        © Copyright 2017, PyTorch.

    </p>
</div>
<div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
</footer>
</div>
</div>
<div class="pytorch-content-right" id="pytorch-content-right">
<div class="pytorch-right-menu" id="pytorch-right-menu">
<div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
<ul>
<li><a class="reference internal" href="#">Hyperparameter tuning with Ray Tune</a><ul>
<li><a class="reference internal" href="#setup-imports">Setup / Imports</a></li>
<li><a class="reference internal" href="#data-loaders">Data loaders</a></li>
<li><a class="reference internal" href="#configurable-neural-network">Configurable neural network</a></li>
<li><a class="reference internal" href="#the-train-function">The train function</a><ul>
<li><a class="reference internal" href="#adding-multi-gpu-support-with-dataparallel">Adding (multi) GPU support with DataParallel</a></li>
<li><a class="reference internal" href="#communicating-with-ray-tune">Communicating with Ray Tune</a></li>
<li><a class="reference internal" href="#full-training-function">Full training function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#test-set-accuracy">Test set accuracy</a></li>
<li><a class="reference internal" href="#configuring-the-search-space">Configuring the search space</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</section>
</div>
<script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js" type="text/javascript"></script>
<script src="../_static/jquery.js" type="text/javascript"></script>
<script src="../_static/underscore.js" type="text/javascript"></script>
<script src="../_static/doctools.js" type="text/javascript"></script>
<script src="../_static/clipboard.min.js" type="text/javascript"></script>
<script src="../_static/copybutton.js" type="text/javascript"></script>
<script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<script src="../_static/js/vendor/popper.min.js" type="text/javascript"></script>
<script src="../_static/js/vendor/bootstrap.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
<script src="../_static/js/theme.js" type="text/javascript"></script>
<script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-117752657-2"></script>
<script>

  window.dataLayer = window.dataLayer || [];

  function gtag(){dataLayer.push(arguments);}

  gtag('js', new Date());
  gtag('config', 'UA-117752657-2');

</script>
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window,document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '243028289693773');
  fbq('track', 'PageView');

  $("[data-behavior='call-to-action-event']").on('click', function(){
    fbq('trackCustom', "Download", {
      tutorialTitle: $('h1:first').text(),
      downloadLink: this.href,
      tutorialLink: window.location.href,
      downloadTitle: $(this).attr("data-response")
    });

    gtag('event', 'click', {
      'event_category': 'Download',
      'event_label': $(this).attr("data-response")
    });

    gtag('event', 'click', {
      'event_category': $(this).attr("data-response"),
      'event_label': $("h1").first().text(),
      'tutorial_link': window.location.href
    });
   });

   $("[data-behavior='was-this-helpful-event']").on('click', function(){
    $(".helpful-question").hide();
    $(".was-helpful-thank-you").show();

    fbq('trackCustom', "Was this Helpful?", {
      tutorialLink: window.location.href,
      tutorialTitle: $('h1:first').text(),
      helpful: $(this).attr("data-response")
    });

    gtag('event', $(this).attr("data-response"), {
      'event_category': 'Was this Helpful?',
      'event_label': $(this).attr("data-response")
    });

    gtag('event', $(this).attr("data-response"), {
      'event_category': 'Was this Helpful?',
      'event_label': $("h1").first().text()
    });
   });

   if (location.pathname == "/") {
     $(".helpful-container").hide();
     $(".hr-bottom").hide();
   }
</script>
<noscript>
<img height="1" src="https://www.facebook.com/tr?id=243028289693773&amp;ev=PageView
  &amp;noscript=1" width="1"/>
</noscript>
<img alt="" height="1" src="https://www.googleadservices.com/pagead/conversion/795629140/?label=txkmCPmdtosBENSssfsC&amp;guid=ON&amp;script=0" style="border-style:none;" width="1"/>
<!-- Begin Footer -->
<div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
<div class="container">
<div class="row">
<div class="col-md-4 text-center">
<h2>Docs</h2>
<p>Access comprehensive developer documentation for PyTorch</p>
<a class="with-right-arrow" href="https://pytorch.org/docs/stable/index.html">View Docs</a>
</div>
<div class="col-md-4 text-center">
<h2>Tutorials</h2>
<p>Get in-depth tutorials for beginners and advanced developers</p>
<a class="with-right-arrow" href="https://pytorch.org/tutorials">View Tutorials</a>
</div>
<div class="col-md-4 text-center">
<h2>Resources</h2>
<p>Find development resources and get your questions answered</p>
<a class="with-right-arrow" href="https://pytorch.org/resources">View Resources</a>
</div>
</div>
</div>
</div>
<footer class="site-footer">
<div class="container footer-container">
<div class="footer-logo-wrapper">
<a class="footer-logo" href="https://pytorch.org/"></a>
</div>
<div class="footer-links-wrapper">
<div class="footer-links-col">
<ul>
<li class="list-title"><a href="https://pytorch.org/">PyTorch</a></li>
<li><a href="https://pytorch.org/get-started">Get Started</a></li>
<li><a href="https://pytorch.org/features">Features</a></li>
<li><a href="https://pytorch.org/ecosystem">Ecosystem</a></li>
<li><a href="https://pytorch.org/blog/">Blog</a></li>
<li><a href="https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md">Contributing</a></li>
</ul>
</div>
<div class="footer-links-col">
<ul>
<li class="list-title"><a href="https://pytorch.org/resources">Resources</a></li>
<li><a href="https://pytorch.org/tutorials">Tutorials</a></li>
<li><a href="https://pytorch.org/docs/stable/index.html">Docs</a></li>
<li><a href="https://discuss.pytorch.org" target="_blank">Discuss</a></li>
<li><a href="https://github.com/pytorch/pytorch/issues" target="_blank">Github Issues</a></li>
<li><a href="https://pytorch.org/assets/brand-guidelines/PyTorch-Brand-Guidelines.pdf" target="_blank">Brand Guidelines</a></li>
</ul>
</div>
<div class="footer-links-col follow-us-col">
<ul>
<li class="list-title">Stay Connected</li>
<li>
<div id="mc_embed_signup">
<form action="https://twitter.us14.list-manage.com/subscribe/post?u=75419c71fe0a935e53dfa4a3f&amp;id=91d0dccd39" class="email-subscribe-form validate" id="mc-embedded-subscribe-form" method="post" name="mc-embedded-subscribe-form" novalidate="" target="_blank">
<div class="email-subscribe-form-fields-wrapper" id="mc_embed_signup_scroll">
<div class="mc-field-group">
<label for="mce-EMAIL" style="display:none;">Email Address</label>
<input class="required email" id="mce-EMAIL" name="EMAIL" placeholder="Email Address" type="email" value=""/>
</div>
<div class="clear" id="mce-responses">
<div class="response" id="mce-error-response" style="display:none"></div>
<div class="response" id="mce-success-response" style="display:none"></div>
</div> <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
<div aria-hidden="true" style="position: absolute; left: -5000px;"><input name="b_75419c71fe0a935e53dfa4a3f_91d0dccd39" tabindex="-1" type="text" value=""/></div>
<div class="clear">
<input class="button email-subscribe-button" id="mc-embedded-subscribe" name="subscribe" type="submit" value=""/>
</div>
</div>
</form>
</div>
</li>
</ul>
<div class="footer-social-icons">
<a class="facebook" href="https://www.facebook.com/pytorch" target="_blank"></a>
<a class="twitter" href="https://twitter.com/pytorch" target="_blank"></a>
<a class="youtube" href="https://www.youtube.com/pytorch" target="_blank"></a>
</div>
</div>
</div>
</div>
</footer>
<div class="cookie-banner-wrapper">
<div class="container">
<p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
<img class="close-button" src="../_static/images/pytorch-x.svg">
</img></div>
</div>
<!-- End Footer -->
<!-- Begin Mobile Menu -->
<div class="mobile-main-menu">
<div class="container-fluid">
<div class="container">
<div class="mobile-main-menu-header-container">
<a aria-label="PyTorch" class="header-logo" href="https://pytorch.org/"></a>
<a class="main-menu-close-button" data-behavior="close-mobile-menu" href="#"></a>
</div>
</div>
</div>
<div class="mobile-main-menu-links-container">
<div class="main-menu">
<ul>
<li>
<a href="https://pytorch.org/get-started">Get Started</a>
</li>
<li>
<a href="https://pytorch.org/ecosystem">Ecosystem</a>
</li>
<li>
<a href="https://pytorch.org/mobile">Mobile</a>
</li>
<li>
<a href="https://pytorch.org/hub">PyTorch Hub</a>
</li>
<li>
<a href="https://pytorch.org/blog/">Blog</a>
</li>
<li class="active">
<a href="https://pytorch.org/tutorials">Tutorials</a>
</li>
<li class="resources-mobile-menu-title">
            Docs
          </li>
<ul class="resources-mobile-menu-items">
<li>
<a href="https://pytorch.org/docs/stable/index.html">PyTorch</a>
</li>
<li>
<a href="https://pytorch.org/audio/stable/index.html">torchaudio</a>
</li>
<li>
<a href="https://pytorch.org/text/stable/index.html">torchtext</a>
</li>
<li>
<a href="https://pytorch.org/docs/stable/torchvision/">torchvision</a>
</li>
<li>
<a href="https://pytorch.org/elastic/">TorchElastic</a>
</li>
<li>
<a href="https://pytorch.org/serve/">TorchServe</a>
</li>
<li>
<a href="https://pytorch.org/xla">PyTorch on XLA Devices</a>
</li>
</ul>
<li class="resources-mobile-menu-title">
            Resources
          </li>
<ul class="resources-mobile-menu-items">
<li>
<a href="https://pytorch.org/resources">Developer Resources</a>
</li>
<li>
<a href="https://pytorch.org/features">About</a>
</li>
<li>
<a href="https://pytorch.org/hub">Models (Beta)</a>
</li>
<li>
<a href="https://pytorch.org/#community-module">Community</a>
</li>
<li>
<a href="https://discuss.pytorch.org/">Forums</a>
</li>
</ul>
<li>
<a href="https://github.com/pytorch/pytorch">Github</a>
</li>
</ul>
</div>
</div>
</div>
<!-- End Mobile Menu -->
<script src="../_static/js/vendor/anchor.min.js" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>