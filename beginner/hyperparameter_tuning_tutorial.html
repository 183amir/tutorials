
<!DOCTYPE html>

<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Hyperparameter tuning with Ray Tune — PyTorch Tutorials 1.7.1 documentation</title>
<link href="../_static/css/theme.css" rel="stylesheet" type="text/css"/>
<!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
<link href="../_static/copybutton.css" rel="stylesheet" type="text/css"/>
<link href="../_static/gallery.css" rel="stylesheet" type="text/css"/>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="../intermediate/pruning_tutorial.html" rel="next" title="Pruning Tutorial"/>
<link href="profiler.html" rel="prev" title="Profiling your PyTorch Module"/>
<script src="../_static/js/modernizr.min.js"></script>
<!-- Preload the theme fonts -->
<link as="font" crossorigin="anonymous" href="../_static/fonts/FreightSans/freight-sans-book.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="../_static/fonts/FreightSans/freight-sans-medium.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="../_static/fonts/FreightSans/freight-sans-bold.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" rel="preload" type="font/woff2"/>
<!-- Preload the katex fonts -->
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" rel="preload" type="font/woff2"/>
</head>
<div class="container-fluid header-holder tutorials-header" id="header-holder">
<div class="container">
<div class="header-container">
<a aria-label="PyTorch" class="header-logo" href="https://pytorch.org/"></a>
<div class="main-menu">
<ul>
<li>
<a href="https://pytorch.org/get-started">Get Started</a>
</li>
<li>
<a href="https://pytorch.org/ecosystem">Ecosystem</a>
</li>
<li>
<a href="https://pytorch.org/mobile">Mobile</a>
</li>
<li>
<a href="https://pytorch.org/blog/">Blog</a>
</li>
<li class="active">
<a href="https://pytorch.org/tutorials">Tutorials</a>
</li>
<li>
<div class="resources-dropdown" data-toggle="resources-dropdown" id="resourcesDropdownButton">
<a class="resource-option with-down-orange-arrow">
                Docs
              </a>
<div class="resources-dropdown-menu">
<a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/docs/stable/index.html">
<span class="dropdown-title">PyTorch</span>
<p></p>
</a>
<a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/audio/stable/index.html">
<span class="dropdown-title">torchaudio</span>
<p></p>
</a>
<a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/text/stable/index.html">
<span class="dropdown-title">torchtext</span>
<p></p>
</a>
<a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/vision/stable/index.html">
<span class="dropdown-title">torchvision</span>
<p></p>
</a>
<a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/elastic/">
<span class="dropdown-title">TorchElastic</span>
<p></p>
</a>
<a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/serve/">
<span class="dropdown-title">TorchServe</span>
<p></p>
</a>
<a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/xla">
<span class="dropdown-title">PyTorch on XLA Devices</span>
<p></p>
</a>
</div>
</div></li>
<li>
<div class="resources-dropdown" data-toggle="resources-dropdown" id="resourcesDropdownButton">
<a class="resource-option with-down-arrow">
                Resources
              </a>
<div class="resources-dropdown-menu">
<a class="nav-dropdown-item" href="https://pytorch.org/features">
<span class="dropdown-title">About</span>
<p>Learn about PyTorch’s features and capabilities</p>
</a>
<a class="nav-dropdown-item" href="https://pytorch.org/#community-module">
<span class="dropdown-title">Community</span>
<p>Join the PyTorch developer community to contribute, learn, and get your questions answered.</p>
</a>
<a class="nav-dropdown-item" href="https://pytorch.org/resources">
<span class="dropdown-title">Developer Resources</span>
<p>Find resources and get questions answered</p>
</a>
<a class="nav-dropdown-item" href="https://discuss.pytorch.org/" target="_blank">
<span class="dropdown-title">Forums</span>
<p>A place to discuss PyTorch code, issues, install, research</p>
</a>
<a class="nav-dropdown-item" href="https://pytorch.org/hub">
<span class="dropdown-title">Models (Beta)</span>
<p>Discover, publish, and reuse pre-trained models</p>
</a>
</div>
</div>
</li>
<li>
<a href="https://github.com/pytorch/pytorch">Github</a>
</li>
</ul>
</div>
<a class="main-menu-open-button" data-behavior="open-mobile-menu" href="#"></a>
</div>
</div>
</div>
<body class="pytorch-body">
<div class="table-of-contents-link-wrapper">
<span>Table of Contents</span>
<a class="toggle-table-of-contents" data-behavior="toggle-table-of-contents" href="#"></a>
</div>
<nav class="pytorch-left-menu" data-toggle="wy-nav-shift" id="pytorch-left-menu">
<div class="pytorch-side-scroll">
<div aria-label="main navigation" class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation">
<div class="pytorch-left-menu-search">
<div class="version">
                  1.7.1
                </div>
<div role="search">
<form action="../search.html" class="wy-form" id="rtd-search-form" method="get">
<input name="q" placeholder="Search Tutorials" type="text"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
</div>
</div>
<p class="caption"><span class="caption-text">PyTorch Recipes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../recipes/recipes_index.html">See All Recipes</a></li>
</ul>
<p class="caption"><span class="caption-text">Learning PyTorch</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="deep_learning_60min_blitz.html">Deep Learning with PyTorch: A 60 Minute Blitz</a></li>
<li class="toctree-l1"><a class="reference internal" href="pytorch_with_examples.html">Learning PyTorch with Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="nn_tutorial.html">What is <cite>torch.nn</cite> <em>really</em>?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/tensorboard_tutorial.html">Visualizing Models, Data, and Training with TensorBoard</a></li>
</ul>
<p class="caption"><span class="caption-text">Image/Video</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/torchvision_tutorial.html">TorchVision Object Detection Finetuning Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="transfer_learning_tutorial.html">Transfer Learning for Computer Vision Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="fgsm_tutorial.html">Adversarial Example Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="dcgan_faces_tutorial.html">DCGAN Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Audio</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="audio_preprocessing_tutorial.html">Audio I/O and Pre-Processing with torchaudio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/speech_command_recognition_with_torchaudio.html">SyntaxError</a></li>
</ul>
<p class="caption"><span class="caption-text">Text</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="transformer_tutorial.html">Sequence-to-Sequence Modeling with nn.Transformer and TorchText</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/char_rnn_classification_tutorial.html">NLP From Scratch: Classifying Names with a Character-Level RNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/char_rnn_generation_tutorial.html">NLP From Scratch: Generating Names with a Character-Level RNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/seq2seq_translation_tutorial.html">NLP From Scratch: Translation with a Sequence to Sequence Network and Attention</a></li>
<li class="toctree-l1"><a class="reference internal" href="text_sentiment_ngrams_tutorial.html">Text Classification with TorchText</a></li>
<li class="toctree-l1"><a class="reference internal" href="torchtext_translation_tutorial.html">Language Translation with TorchText</a></li>
</ul>
<p class="caption"><span class="caption-text">Reinforcement Learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/reinforcement_q_learning.html">Reinforcement Learning (DQN) Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/mario_rl_tutorial.html">Train a Mario-playing RL Agent</a></li>
</ul>
<p class="caption"><span class="caption-text">Deploying PyTorch Models in Production</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/flask_rest_api_tutorial.html">Deploying PyTorch in Python via a REST API with Flask</a></li>
<li class="toctree-l1"><a class="reference internal" href="Intro_to_TorchScript_tutorial.html">Introduction to TorchScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/cpp_export.html">Loading a TorchScript Model in C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/super_resolution_with_onnxruntime.html">(optional) Exporting a Model from PyTorch to ONNX and Running it using ONNX Runtime</a></li>
</ul>
<p class="caption"><span class="caption-text">Frontend APIs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/named_tensor_tutorial.html">(prototype) Introduction to Named Tensors in PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/memory_format_tutorial.html">(beta) Channels Last Memory Format in PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/cpp_frontend.html">Using the PyTorch C++ Frontend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/cpp_extension.html">Custom C++ and CUDA Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/torch_script_custom_ops.html">Extending TorchScript with Custom C++ Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/torch_script_custom_classes.html">Extending TorchScript with Custom C++ Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/torch-script-parallelism.html">Dynamic Parallelism in TorchScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/cpp_autograd.html">Autograd in C++ Frontend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/dispatcher.html">Registering a Dispatched Operator in C++</a></li>
</ul>
<p class="caption"><span class="caption-text">Model Optimization</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="profiler.html">Profiling your PyTorch Module</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Hyperparameter tuning with Ray Tune</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/pruning_tutorial.html">Pruning Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/dynamic_quantization_tutorial.html">(beta) Dynamic Quantization on an LSTM Word Language Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/dynamic_quantization_bert_tutorial.html">(beta) Dynamic Quantization on BERT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/quantized_transfer_learning_tutorial.html">(beta) Quantized Transfer Learning for Computer Vision Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Parallel and Distributed Training</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dist_overview.html">PyTorch Distributed Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/model_parallel_tutorial.html">Single-Machine Model Parallel Best Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/ddp_tutorial.html">Getting Started with Distributed Data Parallel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/dist_tuto.html">Writing Distributed Applications with PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/rpc_tutorial.html">Getting Started with Distributed RPC Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/rpc_param_server_tutorial.html">Implementing a Parameter Server Using Distributed RPC Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/dist_pipeline_parallel_tutorial.html">Distributed Pipeline Parallelism Using RPC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/rpc_async_execution.html">Implementing Batch RPC Processing Using Asynchronous Executions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/rpc_ddp_tutorial.html">Combining Distributed DataParallel with Distributed RPC Framework</a></li>
</ul>
</div>
</div>
</nav>
<div class="pytorch-container">
<div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
<div class="pytorch-breadcrumbs-wrapper">
<div aria-label="breadcrumbs navigation" role="navigation">
<ul class="pytorch-breadcrumbs">
<li>
<a href="../index.html">
          
            Tutorials
          
        </a> &gt;
      </li>
<li>Hyperparameter tuning with Ray Tune</li>
<li class="pytorch-breadcrumbs-aside">
<a href="../_sources/beginner/hyperparameter_tuning_tutorial.rst.txt" rel="nofollow"><img src="../_static/images/view-page-source-icon.svg"/></a>
</li>
</ul>
</div>
</div>
<div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
</div>
<section class="pytorch-content-wrap" data-toggle="wy-nav-shift" id="pytorch-content-wrap">
<div class="pytorch-content-left">
<div class="pytorch-call-to-action-links">
<div id="tutorial-type">beginner/hyperparameter_tuning_tutorial</div>
<div id="google-colab-link">
<img class="call-to-action-img" src="../_static/images/pytorch-colab.svg"/>
<div class="call-to-action-desktop-view">Run in Google Colab</div>
<div class="call-to-action-mobile-view">Colab</div>
</div>
<div id="download-notebook-link">
<img class="call-to-action-notebook-img" src="../_static/images/pytorch-download.svg"/>
<div class="call-to-action-desktop-view">Download Notebook</div>
<div class="call-to-action-mobile-view">Notebook</div>
</div>
<div id="github-view-link">
<img class="call-to-action-img" src="../_static/images/pytorch-github.svg"/>
<div class="call-to-action-desktop-view">View on GitHub</div>
<div class="call-to-action-mobile-view">GitHub</div>
</div>
</div>
<div class="rst-content">
<div class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<article class="pytorch-article" id="pytorch-article" itemprop="articleBody">
<div class="sphx-glr-download-link-note admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Click <a class="reference internal" href="#sphx-glr-download-beginner-hyperparameter-tuning-tutorial-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="hyperparameter-tuning-with-ray-tune">
<span id="sphx-glr-beginner-hyperparameter-tuning-tutorial-py"></span><h1>Hyperparameter tuning with Ray Tune<a class="headerlink" href="#hyperparameter-tuning-with-ray-tune" title="Permalink to this headline">¶</a></h1>
<p>Hyperparameter tuning can make the difference between an average model and a highly
accurate one. Often simple things like choosing a different learning rate or changing
a network layer size can have a dramatic impact on your model performance.</p>
<p>Fortunately, there are tools that help with finding the best combination of parameters.
<a class="reference external" href="https://docs.ray.io/en/latest/tune.html">Ray Tune</a> is an industry standard tool for
distributed hyperparameter tuning. Ray Tune includes the latest hyperparameter search
algorithms, integrates with TensorBoard and other analysis libraries, and natively
supports distributed training through <a class="reference external" href="https://ray.io/">Ray’s distributed machine learning engine</a>.</p>
<p>In this tutorial, we will show you how to integrate Ray Tune into your PyTorch
training workflow. We will extend <a class="reference external" href="https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html">this tutorial from the PyTorch documentation</a> for training
a CIFAR10 image classifier.</p>
<p>As you will see, we only need to add some slight modifications. In particular, we
need to</p>
<ol class="arabic simple">
<li>wrap data loading and training in functions,</li>
<li>make some network parameters configurable,</li>
<li>add checkpointing (optional),</li>
<li>and define the search space for the model tuning</li>
</ol>
<div class="line-block">
<div class="line"><br/></div>
</div>
<p>To run this tutorial, please make sure the following packages are
installed:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">ray[tune]</span></code>: Distributed hyperparameter tuning library</li>
<li><code class="docutils literal notranslate"><span class="pre">torchvision</span></code>: For the data transformers</li>
</ul>
<div class="section" id="setup-imports">
<h2>Setup / Imports<a class="headerlink" href="#setup-imports" title="Permalink to this headline">¶</a></h2>
<p>Let’s start with the imports:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">random_split</span>
<span class="kn">import</span> <span class="nn">torchvision</span>
<span class="kn">import</span> <span class="nn">torchvision.transforms</span> <span class="k">as</span> <span class="nn">transforms</span>
<span class="kn">from</span> <span class="nn">ray</span> <span class="kn">import</span> <span class="n">tune</span>
<span class="kn">from</span> <span class="nn">ray.tune</span> <span class="kn">import</span> <span class="n">CLIReporter</span>
<span class="kn">from</span> <span class="nn">ray.tune.schedulers</span> <span class="kn">import</span> <span class="n">ASHAScheduler</span>
</pre></div>
</div>
<p>Most of the imports are needed for building the PyTorch model. Only the last three
imports are for Ray Tune.</p>
</div>
<div class="section" id="data-loaders">
<h2>Data loaders<a class="headerlink" href="#data-loaders" title="Permalink to this headline">¶</a></h2>
<p>We wrap the data loaders in their own function and pass a global data directory.
This way we can share a data directory between different trials.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="n">data_dir</span><span class="o">=</span><span class="s2">"./data"</span><span class="p">):</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="p">])</span>

    <span class="n">trainset</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">(</span>
        <span class="n">root</span><span class="o">=</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>

    <span class="n">testset</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">(</span>
        <span class="n">root</span><span class="o">=</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">trainset</span><span class="p">,</span> <span class="n">testset</span>
</pre></div>
</div>
</div>
<div class="section" id="configurable-neural-network">
<h2>Configurable neural network<a class="headerlink" href="#configurable-neural-network" title="Permalink to this headline">¶</a></h2>
<p>We can only tune those parameters that are configurable. In this example, we can specify
the layer sizes of the fully connected layers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l1</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">l2</span><span class="o">=</span><span class="mi">84</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Net</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pool</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">16</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
</div>
<div class="section" id="the-train-function">
<h2>The train function<a class="headerlink" href="#the-train-function" title="Permalink to this headline">¶</a></h2>
<p>Now it gets interesting, because we introduce some changes to the example <a class="reference external" href="https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html">from the PyTorch
documentation</a>.</p>
<p>We wrap the training script in a function <code class="docutils literal notranslate"><span class="pre">train_cifar(config,</span> <span class="pre">checkpoint_dir=None,</span> <span class="pre">data_dir=None)</span></code>.
As you can guess, the <code class="docutils literal notranslate"><span class="pre">config</span></code> parameter will receive the hyperparameters we would like to
train with. The <code class="docutils literal notranslate"><span class="pre">checkpoint_dir</span></code> parameter is used to restore checkpoints. The <code class="docutils literal notranslate"><span class="pre">data_dir</span></code> specifies
the directory where we load and store the data, so multiple runs can share the same data source.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">"l1"</span><span class="p">],</span> <span class="n">config</span><span class="p">[</span><span class="s2">"l2"</span><span class="p">])</span>

<span class="k">if</span> <span class="n">checkpoint_dir</span><span class="p">:</span>
    <span class="n">model_state</span><span class="p">,</span> <span class="n">optimizer_state</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">checkpoint_dir</span><span class="p">,</span> <span class="s2">"checkpoint"</span><span class="p">))</span>
    <span class="n">net</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">model_state</span><span class="p">)</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">optimizer_state</span><span class="p">)</span>
</pre></div>
</div>
<p>The learning rate of the optimizer is made configurable, too:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s2">"lr"</span><span class="p">],</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
</pre></div>
</div>
<p>We also split the training data into a training and validation subset. We thus train on
80% of the data and calculate the validation loss on the remaining 20%. The batch sizes
with which we iterate through the training and test sets are configurable as well.</p>
<div class="section" id="adding-multi-gpu-support-with-dataparallel">
<h3>Adding (multi) GPU support with DataParallel<a class="headerlink" href="#adding-multi-gpu-support-with-dataparallel" title="Permalink to this headline">¶</a></h3>
<p>Image classification benefits largely from GPUs. Luckily, we can continue to use
PyTorch’s abstractions in Ray Tune. Thus, we can wrap our model in <code class="docutils literal notranslate"><span class="pre">nn.DataParallel</span></code>
to support data parallel training on multiple GPUs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="s2">"cpu"</span>
<span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
    <span class="n">device</span> <span class="o">=</span> <span class="s2">"cuda:0"</span>
    <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">device_count</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">DataParallel</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
<p>By using a <code class="docutils literal notranslate"><span class="pre">device</span></code> variable we make sure that training also works when we have
no GPUs available. PyTorch requires us to send our data to the GPU memory explicitly,
like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trainloader</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
    <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
<p>The code now supports training on CPUs, on a single GPU, and on multiple GPUs. Notably, Ray
also supports <a class="reference external" href="https://docs.ray.io/en/master/using-ray-with-gpus.html#fractional-gpus">fractional GPUs</a>
so we can share GPUs among trials, as long as the model still fits on the GPU memory. We’ll come back
to that later.</p>
</div>
<div class="section" id="communicating-with-ray-tune">
<h3>Communicating with Ray Tune<a class="headerlink" href="#communicating-with-ray-tune" title="Permalink to this headline">¶</a></h3>
<p>The most interesting part is the communication with Ray Tune:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">tune</span><span class="o">.</span><span class="n">checkpoint_dir</span><span class="p">(</span><span class="n">epoch</span><span class="p">)</span> <span class="k">as</span> <span class="n">checkpoint_dir</span><span class="p">:</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">checkpoint_dir</span><span class="p">,</span> <span class="s2">"checkpoint"</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">((</span><span class="n">net</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()),</span> <span class="n">path</span><span class="p">)</span>

<span class="n">tune</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="p">(</span><span class="n">val_loss</span> <span class="o">/</span> <span class="n">val_steps</span><span class="p">),</span> <span class="n">accuracy</span><span class="o">=</span><span class="n">correct</span> <span class="o">/</span> <span class="n">total</span><span class="p">)</span>
</pre></div>
</div>
<p>Here we first save a checkpoint and then report some metrics back to Ray Tune. Specifically,
we send the validation loss and accuracy back to Ray Tune. Ray Tune can then use these metrics
to decide which hyperparameter configuration lead to the best results. These metrics
can also be used to stop bad performing trials early in order to avoid wasting
resources on those trials.</p>
<p>The checkpoint saving is optional, however, it is necessary if we wanted to use advanced
schedulers like
<a class="reference external" href="https://docs.ray.io/en/master/tune/tutorials/tune-advanced-tutorial.html">Population Based Training</a>.
Also, by saving the checkpoint we can later load the trained models and validate them
on a test set.</p>
</div>
<div class="section" id="full-training-function">
<h3>Full training function<a class="headerlink" href="#full-training-function" title="Permalink to this headline">¶</a></h3>
<p>The full code example looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">train_cifar</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">checkpoint_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">"l1"</span><span class="p">],</span> <span class="n">config</span><span class="p">[</span><span class="s2">"l2"</span><span class="p">])</span>

    <span class="n">device</span> <span class="o">=</span> <span class="s2">"cpu"</span>
    <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s2">"cuda:0"</span>
        <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">device_count</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">DataParallel</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
    <span class="n">net</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

    <span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s2">"lr"</span><span class="p">],</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">checkpoint_dir</span><span class="p">:</span>
        <span class="n">model_state</span><span class="p">,</span> <span class="n">optimizer_state</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">checkpoint_dir</span><span class="p">,</span> <span class="s2">"checkpoint"</span><span class="p">))</span>
        <span class="n">net</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">model_state</span><span class="p">)</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">optimizer_state</span><span class="p">)</span>

    <span class="n">trainset</span><span class="p">,</span> <span class="n">testset</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>

    <span class="n">test_abs</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">trainset</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
    <span class="n">train_subset</span><span class="p">,</span> <span class="n">val_subset</span> <span class="o">=</span> <span class="n">random_split</span><span class="p">(</span>
        <span class="n">trainset</span><span class="p">,</span> <span class="p">[</span><span class="n">test_abs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">trainset</span><span class="p">)</span> <span class="o">-</span> <span class="n">test_abs</span><span class="p">])</span>

    <span class="n">trainloader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">train_subset</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">"batch_size"</span><span class="p">]),</span>
        <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">num_workers</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">valloader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">val_subset</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">"batch_size"</span><span class="p">]),</span>
        <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">num_workers</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>  <span class="c1"># loop over the dataset multiple times</span>
        <span class="n">running_loss</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">epoch_steps</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trainloader</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="c1"># get the inputs; data is a list of [inputs, labels]</span>
            <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span>
            <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

            <span class="c1"># zero the parameter gradients</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>

            <span class="c1"># forward + backward + optimize</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

            <span class="c1"># print statistics</span>
            <span class="n">running_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
            <span class="n">epoch_steps</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2000</span> <span class="o">==</span> <span class="mi">1999</span><span class="p">:</span>  <span class="c1"># print every 2000 mini-batches</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">"[</span><span class="si">%d</span><span class="s2">, </span><span class="si">%5d</span><span class="s2">] loss: </span><span class="si">%.3f</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                                                <span class="n">running_loss</span> <span class="o">/</span> <span class="n">epoch_steps</span><span class="p">))</span>
                <span class="n">running_loss</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c1"># Validation loss</span>
        <span class="n">val_loss</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">val_steps</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">valloader</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
                <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span>
                <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

                <span class="n">outputs</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">predicted</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">outputs</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">total</span> <span class="o">+=</span> <span class="n">labels</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">correct</span> <span class="o">+=</span> <span class="p">(</span><span class="n">predicted</span> <span class="o">==</span> <span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

                <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
                <span class="n">val_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
                <span class="n">val_steps</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">with</span> <span class="n">tune</span><span class="o">.</span><span class="n">checkpoint_dir</span><span class="p">(</span><span class="n">epoch</span><span class="p">)</span> <span class="k">as</span> <span class="n">checkpoint_dir</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">checkpoint_dir</span><span class="p">,</span> <span class="s2">"checkpoint"</span><span class="p">)</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">((</span><span class="n">net</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()),</span> <span class="n">path</span><span class="p">)</span>

        <span class="n">tune</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="p">(</span><span class="n">val_loss</span> <span class="o">/</span> <span class="n">val_steps</span><span class="p">),</span> <span class="n">accuracy</span><span class="o">=</span><span class="n">correct</span> <span class="o">/</span> <span class="n">total</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Finished Training"</span><span class="p">)</span>
</pre></div>
</div>
<p>As you can see, most of the code is adapted directly from the original example.</p>
</div>
</div>
<div class="section" id="test-set-accuracy">
<h2>Test set accuracy<a class="headerlink" href="#test-set-accuracy" title="Permalink to this headline">¶</a></h2>
<p>Commonly the performance of a machine learning model is tested on a hold-out test
set with data that has not been used for training the model. We also wrap this in a
function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_accuracy</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">"cpu"</span><span class="p">):</span>
    <span class="n">trainset</span><span class="p">,</span> <span class="n">testset</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">()</span>

    <span class="n">testloader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">testset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">testloader</span><span class="p">:</span>
            <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span>
            <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">predicted</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">outputs</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">total</span> <span class="o">+=</span> <span class="n">labels</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">correct</span> <span class="o">+=</span> <span class="p">(</span><span class="n">predicted</span> <span class="o">==</span> <span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">correct</span> <span class="o">/</span> <span class="n">total</span>
</pre></div>
</div>
<p>The function also expects a <code class="docutils literal notranslate"><span class="pre">device</span></code> parameter, so we can do the
test set validation on a GPU.</p>
</div>
<div class="section" id="configuring-the-search-space">
<h2>Configuring the search space<a class="headerlink" href="#configuring-the-search-space" title="Permalink to this headline">¶</a></h2>
<p>Lastly, we need to define Ray Tune’s search space. Here is an example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"l1"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">sample_from</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="mi">2</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)),</span>
    <span class="s2">"l2"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">sample_from</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="mi">2</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)),</span>
    <span class="s2">"lr"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">),</span>
    <span class="s2">"batch_size"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">])</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">tune.sample_from()</span></code> function makes it possible to define your own sample
methods to obtain hyperparameters. In this example, the <code class="docutils literal notranslate"><span class="pre">l1</span></code> and <code class="docutils literal notranslate"><span class="pre">l2</span></code> parameters
should be powers of 2 between 4 and 256, so either 4, 8, 16, 32, 64, 128, or 256.
The <code class="docutils literal notranslate"><span class="pre">lr</span></code> (learning rate) should be uniformly sampled between 0.0001 and 0.1. Lastly,
the batch size is a choice between 2, 4, 8, and 16.</p>
<p>At each trial, Ray Tune will now randomly sample a combination of parameters from these
search spaces. It will then train a number of models in parallel and find the best
performing one among these. We also use the <code class="docutils literal notranslate"><span class="pre">ASHAScheduler</span></code> which will terminate bad
performing trials early.</p>
<p>We wrap the <code class="docutils literal notranslate"><span class="pre">train_cifar</span></code> function with <code class="docutils literal notranslate"><span class="pre">functools.partial</span></code> to set the constant
<code class="docutils literal notranslate"><span class="pre">data_dir</span></code> parameter. We can also tell Ray Tune what resources should be
available for each trial:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gpus_per_trial</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c1"># ...</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">tune</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">partial</span><span class="p">(</span><span class="n">train_cifar</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="n">data_dir</span><span class="p">),</span>
    <span class="n">resources_per_trial</span><span class="o">=</span><span class="p">{</span><span class="s2">"cpu"</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">"gpu"</span><span class="p">:</span> <span class="n">gpus_per_trial</span><span class="p">},</span>
    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
    <span class="n">num_samples</span><span class="o">=</span><span class="n">num_samples</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span>
    <span class="n">progress_reporter</span><span class="o">=</span><span class="n">reporter</span><span class="p">,</span>
    <span class="n">checkpoint_at_end</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>You can specify the number of CPUs, which are then available e.g.
to increase the <code class="docutils literal notranslate"><span class="pre">num_workers</span></code> of the PyTorch <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> instances. The selected
number of GPUs are made visible to PyTorch in each trial. Trials do not have access to
GPUs that haven’t been requested for them - so you don’t have to care about two trials
using the same set of resources.</p>
<p>Here we can also specify fractional GPUs, so something like <code class="docutils literal notranslate"><span class="pre">gpus_per_trial=0.5</span></code> is
completely valid. The trials will then share GPUs among each other.
You just have to make sure that the models still fit in the GPU memory.</p>
<p>After training the models, we will find the best performing one and load the trained
network from the checkpoint file. We then obtain the test set accuracy and report
everything by printing.</p>
<p>The full main function looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">num_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_num_epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gpus_per_trial</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">"./data"</span><span class="p">)</span>
    <span class="n">load_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
    <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"l1"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">sample_from</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)),</span>
        <span class="s2">"l2"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">sample_from</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)),</span>
        <span class="s2">"lr"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">),</span>
        <span class="s2">"batch_size"</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">])</span>
    <span class="p">}</span>
    <span class="n">scheduler</span> <span class="o">=</span> <span class="n">ASHAScheduler</span><span class="p">(</span>
        <span class="n">metric</span><span class="o">=</span><span class="s2">"loss"</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">"min"</span><span class="p">,</span>
        <span class="n">max_t</span><span class="o">=</span><span class="n">max_num_epochs</span><span class="p">,</span>
        <span class="n">grace_period</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">reduction_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">reporter</span> <span class="o">=</span> <span class="n">CLIReporter</span><span class="p">(</span>
        <span class="c1"># parameter_columns=["l1", "l2", "lr", "batch_size"],</span>
        <span class="n">metric_columns</span><span class="o">=</span><span class="p">[</span><span class="s2">"loss"</span><span class="p">,</span> <span class="s2">"accuracy"</span><span class="p">,</span> <span class="s2">"training_iteration"</span><span class="p">])</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">tune</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
        <span class="n">partial</span><span class="p">(</span><span class="n">train_cifar</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="n">data_dir</span><span class="p">),</span>
        <span class="n">resources_per_trial</span><span class="o">=</span><span class="p">{</span><span class="s2">"cpu"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">"gpu"</span><span class="p">:</span> <span class="n">gpus_per_trial</span><span class="p">},</span>
        <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
        <span class="n">num_samples</span><span class="o">=</span><span class="n">num_samples</span><span class="p">,</span>
        <span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span>
        <span class="n">progress_reporter</span><span class="o">=</span><span class="n">reporter</span><span class="p">)</span>

    <span class="n">best_trial</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_best_trial</span><span class="p">(</span><span class="s2">"loss"</span><span class="p">,</span> <span class="s2">"min"</span><span class="p">,</span> <span class="s2">"last"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Best trial config: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">best_trial</span><span class="o">.</span><span class="n">config</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Best trial final validation loss: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">best_trial</span><span class="o">.</span><span class="n">last_result</span><span class="p">[</span><span class="s2">"loss"</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Best trial final validation accuracy: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">best_trial</span><span class="o">.</span><span class="n">last_result</span><span class="p">[</span><span class="s2">"accuracy"</span><span class="p">]))</span>

    <span class="n">best_trained_model</span> <span class="o">=</span> <span class="n">Net</span><span class="p">(</span><span class="n">best_trial</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">"l1"</span><span class="p">],</span> <span class="n">best_trial</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">"l2"</span><span class="p">])</span>
    <span class="n">device</span> <span class="o">=</span> <span class="s2">"cpu"</span>
    <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s2">"cuda:0"</span>
        <span class="k">if</span> <span class="n">gpus_per_trial</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">best_trained_model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">DataParallel</span><span class="p">(</span><span class="n">best_trained_model</span><span class="p">)</span>
    <span class="n">best_trained_model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

    <span class="n">best_checkpoint_dir</span> <span class="o">=</span> <span class="n">best_trial</span><span class="o">.</span><span class="n">checkpoint</span><span class="o">.</span><span class="n">value</span>
    <span class="n">model_state</span><span class="p">,</span> <span class="n">optimizer_state</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">best_checkpoint_dir</span><span class="p">,</span> <span class="s2">"checkpoint"</span><span class="p">))</span>
    <span class="n">best_trained_model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">model_state</span><span class="p">)</span>

    <span class="n">test_acc</span> <span class="o">=</span> <span class="n">test_accuracy</span><span class="p">(</span><span class="n">best_trained_model</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Best trial test set accuracy: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">test_acc</span><span class="p">))</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="c1"># You can change the number of GPUs per trial here:</span>
    <span class="n">main</span><span class="p">(</span><span class="n">num_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_num_epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gpus_per_trial</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz
Extracting /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data
Files already downloaded and verified
== Status ==
Memory usage on this node: 4.0/240.1 GiB
Using AsyncHyperBand: num_stopped=0
Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: None
Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 1/10 (1 RUNNING)
+---------------------+----------+-------+--------------+------+------+-------------+
| Trial name          | status   | loc   |   batch_size |   l1 |   l2 |          lr |
|---------------------+----------+-------+--------------+------+------+-------------|
| DEFAULT_6efcc_00000 | RUNNING  |       |            4 |    8 |    8 | 0.000291261 |
+---------------------+----------+-------+--------------+------+------+-------------+


[2m[36m(pid=1568)[0m Files already downloaded and verified
[2m[36m(pid=1570)[0m Files already downloaded and verified
[2m[36m(pid=1496)[0m Files already downloaded and verified
[2m[36m(pid=1497)[0m Files already downloaded and verified
[2m[36m(pid=1558)[0m Files already downloaded and verified
[2m[36m(pid=1536)[0m Files already downloaded and verified
[2m[36m(pid=1571)[0m Files already downloaded and verified
[2m[36m(pid=1527)[0m Files already downloaded and verified
[2m[36m(pid=1556)[0m Files already downloaded and verified
[2m[36m(pid=1537)[0m Files already downloaded and verified
[2m[36m(pid=1568)[0m Files already downloaded and verified
[2m[36m(pid=1570)[0m Files already downloaded and verified
[2m[36m(pid=1496)[0m Files already downloaded and verified
[2m[36m(pid=1497)[0m Files already downloaded and verified
[2m[36m(pid=1558)[0m Files already downloaded and verified
[2m[36m(pid=1536)[0m Files already downloaded and verified
[2m[36m(pid=1571)[0m Files already downloaded and verified
[2m[36m(pid=1527)[0m Files already downloaded and verified
[2m[36m(pid=1556)[0m Files already downloaded and verified
[2m[36m(pid=1537)[0m Files already downloaded and verified
[2m[36m(pid=1558)[0m [1,  2000] loss: 2.259
[2m[36m(pid=1556)[0m [1,  2000] loss: 2.287
[2m[36m(pid=1568)[0m [1,  2000] loss: 2.312
[2m[36m(pid=1571)[0m [1,  2000] loss: 2.184
[2m[36m(pid=1536)[0m [1,  2000] loss: 2.273
[2m[36m(pid=1496)[0m [1,  2000] loss: 2.336
[2m[36m(pid=1570)[0m [1,  2000] loss: 1.896
[2m[36m(pid=1537)[0m [1,  2000] loss: 2.305
[2m[36m(pid=1527)[0m [1,  2000] loss: 2.197
[2m[36m(pid=1497)[0m [1,  2000] loss: 2.301
[2m[36m(pid=1558)[0m [1,  4000] loss: 1.097
[2m[36m(pid=1556)[0m [1,  4000] loss: 1.156
[2m[36m(pid=1568)[0m [1,  4000] loss: 1.150
[2m[36m(pid=1571)[0m [1,  4000] loss: 1.020
[2m[36m(pid=1536)[0m [1,  4000] loss: 0.988
Result for DEFAULT_6efcc_00009:
  accuracy: 0.141
  date: 2021-01-29_00-32-43
  done: false
  experiment_id: e3bee2b361b746ebb0c401e9d5c8a489
  experiment_tag: 9_batch_size=16,l1=32,l2=16,lr=0.052968
  hostname: 218c58292e4b
  iterations_since_restore: 1
  loss: 2.2266951219558715
  node_ip: 172.17.0.2
  pid: 1527
  should_checkpoint: true
  time_since_restore: 27.703131914138794
  time_this_iter_s: 27.703131914138794
  time_total_s: 27.703131914138794
  timestamp: 1611880363
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 6efcc_00009

== Status ==
Memory usage on this node: 9.3/240.1 GiB
Using AsyncHyperBand: num_stopped=0
Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -2.2266951219558715
Resources requested: 20/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (10 RUNNING)
+---------------------+----------+-----------------+--------------+------+------+-------------+--------+------------+----------------------+
| Trial name          | status   | loc             |   batch_size |   l1 |   l2 |          lr |   loss |   accuracy |   training_iteration |
|---------------------+----------+-----------------+--------------+------+------+-------------+--------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING  |                 |            4 |    8 |    8 | 0.000291261 |        |            |                      |
| DEFAULT_6efcc_00001 | RUNNING  |                 |            4 |   16 |   64 | 0.000633769 |        |            |                      |
| DEFAULT_6efcc_00002 | RUNNING  |                 |            4 |   64 |    8 | 0.0590704   |        |            |                      |
| DEFAULT_6efcc_00003 | RUNNING  |                 |            8 |   32 |  256 | 0.00914809  |        |            |                      |
| DEFAULT_6efcc_00004 | RUNNING  |                 |            2 |  256 |   64 | 0.00561739  |        |            |                      |
| DEFAULT_6efcc_00005 | RUNNING  |                 |           16 |   64 |   64 | 0.000348184 |        |            |                      |
| DEFAULT_6efcc_00006 | RUNNING  |                 |            2 |    4 |    4 | 0.00706031  |        |            |                      |
| DEFAULT_6efcc_00007 | RUNNING  |                 |            2 |    8 |  128 | 0.00830905  |        |            |                      |
| DEFAULT_6efcc_00008 | RUNNING  |                 |            8 |  128 |   32 | 0.00014301  |        |            |                      |
| DEFAULT_6efcc_00009 | RUNNING  | 172.17.0.2:1527 |           16 |   32 |   16 | 0.0529677   | 2.2267 |      0.141 |                    1 |
+---------------------+----------+-----------------+--------------+------+------+-------------+--------+------------+----------------------+


Result for DEFAULT_6efcc_00005:
  accuracy: 0.1826
  date: 2021-01-29_00-32-43
  done: true
  experiment_id: 8b6c657815c54e8fb041cc39b2f05c32
  experiment_tag: 5_batch_size=16,l1=64,l2=64,lr=0.00034818
  hostname: 218c58292e4b
  iterations_since_restore: 1
  loss: 2.2723203914642336
  node_ip: 172.17.0.2
  pid: 1497
  should_checkpoint: true
  time_since_restore: 27.801069259643555
  time_this_iter_s: 27.801069259643555
  time_total_s: 27.801069259643555
  timestamp: 1611880363
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 6efcc_00005

[2m[36m(pid=1496)[0m [1,  4000] loss: 1.169
[2m[36m(pid=1570)[0m [1,  4000] loss: 0.836
[2m[36m(pid=1537)[0m [1,  4000] loss: 1.150
[2m[36m(pid=1556)[0m [1,  6000] loss: 0.771
[2m[36m(pid=1558)[0m [1,  6000] loss: 0.723
[2m[36m(pid=1568)[0m [1,  6000] loss: 0.762
[2m[36m(pid=1536)[0m [1,  6000] loss: 0.597
[2m[36m(pid=1571)[0m [1,  6000] loss: 0.662
[2m[36m(pid=1496)[0m [1,  6000] loss: 0.778
Result for DEFAULT_6efcc_00003:
  accuracy: 0.3807
  date: 2021-01-29_00-32-57
  done: false
  experiment_id: eeb31974a3fe46d790317e81469c7e63
  experiment_tag: 3_batch_size=8,l1=32,l2=256,lr=0.0091481
  hostname: 218c58292e4b
  iterations_since_restore: 1
  loss: 1.6992178661346435
  node_ip: 172.17.0.2
  pid: 1570
  should_checkpoint: true
  time_since_restore: 41.62398600578308
  time_this_iter_s: 41.62398600578308
  time_total_s: 41.62398600578308
  timestamp: 1611880377
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 6efcc_00003

== Status ==
Memory usage on this node: 8.7/240.1 GiB
Using AsyncHyperBand: num_stopped=1
Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -2.2266951219558715
Resources requested: 18/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (9 RUNNING, 1 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    |                 |            4 |    8 |    8 | 0.000291261 |         |            |                      |
| DEFAULT_6efcc_00001 | RUNNING    |                 |            4 |   16 |   64 | 0.000633769 |         |            |                      |
| DEFAULT_6efcc_00002 | RUNNING    |                 |            4 |   64 |    8 | 0.0590704   |         |            |                      |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.69922 |     0.3807 |                    1 |
| DEFAULT_6efcc_00004 | RUNNING    |                 |            2 |  256 |   64 | 0.00561739  |         |            |                      |
| DEFAULT_6efcc_00006 | RUNNING    |                 |            2 |    4 |    4 | 0.00706031  |         |            |                      |
| DEFAULT_6efcc_00007 | RUNNING    |                 |            2 |    8 |  128 | 0.00830905  |         |            |                      |
| DEFAULT_6efcc_00008 | RUNNING    |                 |            8 |  128 |   32 | 0.00014301  |         |            |                      |
| DEFAULT_6efcc_00009 | RUNNING    | 172.17.0.2:1527 |           16 |   32 |   16 | 0.0529677   | 2.2267  |     0.141  |                    1 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_6efcc_00008:
  accuracy: 0.1469
  date: 2021-01-29_00-32-58
  done: true
  experiment_id: ae9fc3487f5e4f3ebdf10902913e8515
  experiment_tag: 8_batch_size=8,l1=128,l2=32,lr=0.00014301
  hostname: 218c58292e4b
  iterations_since_restore: 1
  loss: 2.2948299264907837
  node_ip: 172.17.0.2
  pid: 1537
  should_checkpoint: true
  time_since_restore: 43.092629194259644
  time_this_iter_s: 43.092629194259644
  time_total_s: 43.092629194259644
  timestamp: 1611880378
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 6efcc_00008

[2m[36m(pid=1527)[0m [2,  2000] loss: 2.307
[2m[36m(pid=1556)[0m [1,  8000] loss: 0.578
[2m[36m(pid=1558)[0m [1,  8000] loss: 0.572
[2m[36m(pid=1568)[0m [1,  8000] loss: 0.552
[2m[36m(pid=1536)[0m [1,  8000] loss: 0.415
[2m[36m(pid=1571)[0m [1,  8000] loss: 0.491
Result for DEFAULT_6efcc_00009:
  accuracy: 0.096
  date: 2021-01-29_00-33-06
  done: false
  experiment_id: e3bee2b361b746ebb0c401e9d5c8a489
  experiment_tag: 9_batch_size=16,l1=32,l2=16,lr=0.052968
  hostname: 218c58292e4b
  iterations_since_restore: 2
  loss: 2.314103608703613
  node_ip: 172.17.0.2
  pid: 1527
  should_checkpoint: true
  time_since_restore: 50.858458042144775
  time_this_iter_s: 23.15532612800598
  time_total_s: 50.858458042144775
  timestamp: 1611880386
  timesteps_since_restore: 0
  training_iteration: 2
  trial_id: 6efcc_00009

== Status ==
Memory usage on this node: 8.2/240.1 GiB
Using AsyncHyperBand: num_stopped=2
Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -2.314103608703613 | Iter 1.000: -2.2495077567100523
Resources requested: 16/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    |                 |            4 |    8 |    8 | 0.000291261 |         |            |                      |
| DEFAULT_6efcc_00001 | RUNNING    |                 |            4 |   16 |   64 | 0.000633769 |         |            |                      |
| DEFAULT_6efcc_00002 | RUNNING    |                 |            4 |   64 |    8 | 0.0590704   |         |            |                      |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.69922 |     0.3807 |                    1 |
| DEFAULT_6efcc_00004 | RUNNING    |                 |            2 |  256 |   64 | 0.00561739  |         |            |                      |
| DEFAULT_6efcc_00006 | RUNNING    |                 |            2 |    4 |    4 | 0.00706031  |         |            |                      |
| DEFAULT_6efcc_00007 | RUNNING    |                 |            2 |    8 |  128 | 0.00830905  |         |            |                      |
| DEFAULT_6efcc_00009 | RUNNING    | 172.17.0.2:1527 |           16 |   32 |   16 | 0.0529677   | 2.3141  |     0.096  |                    2 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1496)[0m [1,  8000] loss: 0.584
[2m[36m(pid=1570)[0m [2,  2000] loss: 1.593
[2m[36m(pid=1556)[0m [1, 10000] loss: 0.462
[2m[36m(pid=1558)[0m [1, 10000] loss: 0.463
[2m[36m(pid=1568)[0m [1, 10000] loss: 0.408
[2m[36m(pid=1536)[0m [1, 10000] loss: 0.318
[2m[36m(pid=1571)[0m [1, 10000] loss: 0.392
[2m[36m(pid=1496)[0m [1, 10000] loss: 0.467
[2m[36m(pid=1527)[0m [3,  2000] loss: 2.311
[2m[36m(pid=1570)[0m [2,  4000] loss: 0.802
[2m[36m(pid=1556)[0m [1, 12000] loss: 0.385
Result for DEFAULT_6efcc_00000:
  accuracy: 0.2381
  date: 2021-01-29_00-33-23
  done: false
  experiment_id: ddbdbb0722834bf1bef1736cca432a47
  experiment_tag: 0_batch_size=4,l1=8,l2=8,lr=0.00029126
  hostname: 218c58292e4b
  iterations_since_restore: 1
  loss: 1.945335429763794
  node_ip: 172.17.0.2
  pid: 1568
  should_checkpoint: true
  time_since_restore: 67.88855004310608
  time_this_iter_s: 67.88855004310608
  time_total_s: 67.88855004310608
  timestamp: 1611880403
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 6efcc_00000

== Status ==
Memory usage on this node: 8.1/240.1 GiB
Using AsyncHyperBand: num_stopped=2
Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -2.314103608703613 | Iter 1.000: -2.2266951219558715
Resources requested: 16/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.94534 |     0.2381 |                    1 |
| DEFAULT_6efcc_00001 | RUNNING    |                 |            4 |   16 |   64 | 0.000633769 |         |            |                      |
| DEFAULT_6efcc_00002 | RUNNING    |                 |            4 |   64 |    8 | 0.0590704   |         |            |                      |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.69922 |     0.3807 |                    1 |
| DEFAULT_6efcc_00004 | RUNNING    |                 |            2 |  256 |   64 | 0.00561739  |         |            |                      |
| DEFAULT_6efcc_00006 | RUNNING    |                 |            2 |    4 |    4 | 0.00706031  |         |            |                      |
| DEFAULT_6efcc_00007 | RUNNING    |                 |            2 |    8 |  128 | 0.00830905  |         |            |                      |
| DEFAULT_6efcc_00009 | RUNNING    | 172.17.0.2:1527 |           16 |   32 |   16 | 0.0529677   | 2.3141  |     0.096  |                    2 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1558)[0m [1, 12000] loss: 0.385
Result for DEFAULT_6efcc_00001:
  accuracy: 0.4031
  date: 2021-01-29_00-33-24
  done: false
  experiment_id: f1e7497fde49473e90c682d742c0e931
  experiment_tag: 1_batch_size=4,l1=16,l2=64,lr=0.00063377
  hostname: 218c58292e4b
  iterations_since_restore: 1
  loss: 1.5886046483635903
  node_ip: 172.17.0.2
  pid: 1536
  should_checkpoint: true
  time_since_restore: 68.868985414505
  time_this_iter_s: 68.868985414505
  time_total_s: 68.868985414505
  timestamp: 1611880404
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 6efcc_00001

Result for DEFAULT_6efcc_00002:
  accuracy: 0.1006
  date: 2021-01-29_00-33-28
  done: true
  experiment_id: 3be2dcdb70e446a4a1e3246efcba9c06
  experiment_tag: 2_batch_size=4,l1=64,l2=8,lr=0.05907
  hostname: 218c58292e4b
  iterations_since_restore: 1
  loss: 2.3431427409648897
  node_ip: 172.17.0.2
  pid: 1496
  should_checkpoint: true
  time_since_restore: 72.88971972465515
  time_this_iter_s: 72.88971972465515
  time_total_s: 72.88971972465515
  timestamp: 1611880408
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 6efcc_00002

== Status ==
Memory usage on this node: 8.2/240.1 GiB
Using AsyncHyperBand: num_stopped=3
Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -2.314103608703613 | Iter 1.000: -2.2266951219558715
Resources requested: 16/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.94534 |     0.2381 |                    1 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.5886  |     0.4031 |                    1 |
| DEFAULT_6efcc_00002 | RUNNING    | 172.17.0.2:1496 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.69922 |     0.3807 |                    1 |
| DEFAULT_6efcc_00004 | RUNNING    |                 |            2 |  256 |   64 | 0.00561739  |         |            |                      |
| DEFAULT_6efcc_00006 | RUNNING    |                 |            2 |    4 |    4 | 0.00706031  |         |            |                      |
| DEFAULT_6efcc_00007 | RUNNING    |                 |            2 |    8 |  128 | 0.00830905  |         |            |                      |
| DEFAULT_6efcc_00009 | RUNNING    | 172.17.0.2:1527 |           16 |   32 |   16 | 0.0529677   | 2.3141  |     0.096  |                    2 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_6efcc_00009:
  accuracy: 0.1041
  date: 2021-01-29_00-33-28
  done: false
  experiment_id: e3bee2b361b746ebb0c401e9d5c8a489
  experiment_tag: 9_batch_size=16,l1=32,l2=16,lr=0.052968
  hostname: 218c58292e4b
  iterations_since_restore: 3
  loss: 2.307489609527588
  node_ip: 172.17.0.2
  pid: 1527
  should_checkpoint: true
  time_since_restore: 73.31777572631836
  time_this_iter_s: 22.459317684173584
  time_total_s: 73.31777572631836
  timestamp: 1611880408
  timesteps_since_restore: 0
  training_iteration: 3
  trial_id: 6efcc_00009

[2m[36m(pid=1571)[0m [1, 12000] loss: 0.331
[2m[36m(pid=1556)[0m [1, 14000] loss: 0.330
Result for DEFAULT_6efcc_00003:
  accuracy: 0.4376
  date: 2021-01-29_00-33-33
  done: false
  experiment_id: eeb31974a3fe46d790317e81469c7e63
  experiment_tag: 3_batch_size=8,l1=32,l2=256,lr=0.0091481
  hostname: 218c58292e4b
  iterations_since_restore: 2
  loss: 1.5837318400859832
  node_ip: 172.17.0.2
  pid: 1570
  should_checkpoint: true
  time_since_restore: 77.60511922836304
  time_this_iter_s: 35.981133222579956
  time_total_s: 77.60511922836304
  timestamp: 1611880413
  timesteps_since_restore: 0
  training_iteration: 2
  trial_id: 6efcc_00003

[2m[36m(pid=1558)[0m [1, 14000] loss: 0.331
[2m[36m(pid=1568)[0m [2,  2000] loss: 1.919
[2m[36m(pid=1536)[0m [2,  2000] loss: 1.545
[2m[36m(pid=1571)[0m [1, 14000] loss: 0.279
[2m[36m(pid=1556)[0m [1, 16000] loss: 0.289
[2m[36m(pid=1558)[0m [1, 16000] loss: 0.289
[2m[36m(pid=1527)[0m [4,  2000] loss: 2.311
[2m[36m(pid=1568)[0m [2,  4000] loss: 0.926
[2m[36m(pid=1536)[0m [2,  4000] loss: 0.757
[2m[36m(pid=1570)[0m [3,  2000] loss: 1.585
Result for DEFAULT_6efcc_00009:
  accuracy: 0.0972
  date: 2021-01-29_00-33-50
  done: false
  experiment_id: e3bee2b361b746ebb0c401e9d5c8a489
  experiment_tag: 9_batch_size=16,l1=32,l2=16,lr=0.052968
  hostname: 218c58292e4b
  iterations_since_restore: 4
  loss: 2.3112536296844484
  node_ip: 172.17.0.2
  pid: 1527
  should_checkpoint: true
  time_since_restore: 95.38006472587585
  time_this_iter_s: 22.062288999557495
  time_total_s: 95.38006472587585
  timestamp: 1611880430
  timesteps_since_restore: 0
  training_iteration: 4
  trial_id: 6efcc_00009

== Status ==
Memory usage on this node: 7.6/240.1 GiB
Using AsyncHyperBand: num_stopped=3
Bracket: Iter 8.000: None | Iter 4.000: -2.3112536296844484 | Iter 2.000: -1.9489177243947982 | Iter 1.000: -2.2266951219558715
Resources requested: 14/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (7 RUNNING, 3 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.94534 |     0.2381 |                    1 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.5886  |     0.4031 |                    1 |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.58373 |     0.4376 |                    2 |
| DEFAULT_6efcc_00004 | RUNNING    |                 |            2 |  256 |   64 | 0.00561739  |         |            |                      |
| DEFAULT_6efcc_00006 | RUNNING    |                 |            2 |    4 |    4 | 0.00706031  |         |            |                      |
| DEFAULT_6efcc_00007 | RUNNING    |                 |            2 |    8 |  128 | 0.00830905  |         |            |                      |
| DEFAULT_6efcc_00009 | RUNNING    | 172.17.0.2:1527 |           16 |   32 |   16 | 0.0529677   | 2.31125 |     0.0972 |                    4 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1556)[0m [1, 18000] loss: 0.257
[2m[36m(pid=1571)[0m [1, 16000] loss: 0.249
[2m[36m(pid=1558)[0m [1, 18000] loss: 0.257
[2m[36m(pid=1568)[0m [2,  6000] loss: 0.596
[2m[36m(pid=1536)[0m [2,  6000] loss: 0.487
[2m[36m(pid=1570)[0m [3,  4000] loss: 0.813
[2m[36m(pid=1556)[0m [1, 20000] loss: 0.231
[2m[36m(pid=1558)[0m [1, 20000] loss: 0.231
[2m[36m(pid=1571)[0m [1, 18000] loss: 0.218
[2m[36m(pid=1568)[0m [2,  8000] loss: 0.433
[2m[36m(pid=1527)[0m [5,  2000] loss: 2.310
[2m[36m(pid=1536)[0m [2,  8000] loss: 0.357
Result for DEFAULT_6efcc_00003:
  accuracy: 0.3898
  date: 2021-01-29_00-34-08
  done: false
  experiment_id: eeb31974a3fe46d790317e81469c7e63
  experiment_tag: 3_batch_size=8,l1=32,l2=256,lr=0.0091481
  hostname: 218c58292e4b
  iterations_since_restore: 3
  loss: 1.6911599514484406
  node_ip: 172.17.0.2
  pid: 1570
  should_checkpoint: true
  time_since_restore: 112.77124381065369
  time_this_iter_s: 35.16612458229065
  time_total_s: 112.77124381065369
  timestamp: 1611880448
  timesteps_since_restore: 0
  training_iteration: 3
  trial_id: 6efcc_00003

== Status ==
Memory usage on this node: 7.6/240.1 GiB
Using AsyncHyperBand: num_stopped=3
Bracket: Iter 8.000: None | Iter 4.000: -2.3112536296844484 | Iter 2.000: -1.9489177243947982 | Iter 1.000: -2.2266951219558715
Resources requested: 14/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (7 RUNNING, 3 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.94534 |     0.2381 |                    1 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.5886  |     0.4031 |                    1 |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.69116 |     0.3898 |                    3 |
| DEFAULT_6efcc_00004 | RUNNING    |                 |            2 |  256 |   64 | 0.00561739  |         |            |                      |
| DEFAULT_6efcc_00006 | RUNNING    |                 |            2 |    4 |    4 | 0.00706031  |         |            |                      |
| DEFAULT_6efcc_00007 | RUNNING    |                 |            2 |    8 |  128 | 0.00830905  |         |            |                      |
| DEFAULT_6efcc_00009 | RUNNING    | 172.17.0.2:1527 |           16 |   32 |   16 | 0.0529677   | 2.31125 |     0.0972 |                    4 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_6efcc_00009:
  accuracy: 0.0972
  date: 2021-01-29_00-34-13
  done: false
  experiment_id: e3bee2b361b746ebb0c401e9d5c8a489
  experiment_tag: 9_batch_size=16,l1=32,l2=16,lr=0.052968
  hostname: 218c58292e4b
  iterations_since_restore: 5
  loss: 2.3087270225524903
  node_ip: 172.17.0.2
  pid: 1527
  should_checkpoint: true
  time_since_restore: 117.67409491539001
  time_this_iter_s: 22.29403018951416
  time_total_s: 117.67409491539001
  timestamp: 1611880453
  timesteps_since_restore: 0
  training_iteration: 5
  trial_id: 6efcc_00009

Result for DEFAULT_6efcc_00006:
  accuracy: 0.095
  date: 2021-01-29_00-34-15
  done: true
  experiment_id: 85659deabeb0483dbeeaf7cc5ac17735
  experiment_tag: 6_batch_size=2,l1=4,l2=4,lr=0.0070603
  hostname: 218c58292e4b
  iterations_since_restore: 1
  loss: 2.3067700699329374
  node_ip: 172.17.0.2
  pid: 1556
  should_checkpoint: true
  time_since_restore: 119.6422233581543
  time_this_iter_s: 119.6422233581543
  time_total_s: 119.6422233581543
  timestamp: 1611880455
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 6efcc_00006

== Status ==
Memory usage on this node: 7.6/240.1 GiB
Using AsyncHyperBand: num_stopped=4
Bracket: Iter 8.000: None | Iter 4.000: -2.3112536296844484 | Iter 2.000: -1.9489177243947982 | Iter 1.000: -2.2495077567100523
Resources requested: 14/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (7 RUNNING, 3 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.94534 |     0.2381 |                    1 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.5886  |     0.4031 |                    1 |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.69116 |     0.3898 |                    3 |
| DEFAULT_6efcc_00004 | RUNNING    |                 |            2 |  256 |   64 | 0.00561739  |         |            |                      |
| DEFAULT_6efcc_00006 | RUNNING    | 172.17.0.2:1556 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | RUNNING    |                 |            2 |    8 |  128 | 0.00830905  |         |            |                      |
| DEFAULT_6efcc_00009 | RUNNING    | 172.17.0.2:1527 |           16 |   32 |   16 | 0.0529677   | 2.30873 |     0.0972 |                    5 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1571)[0m [1, 20000] loss: 0.200
[2m[36m(pid=1568)[0m [2, 10000] loss: 0.335
Result for DEFAULT_6efcc_00007:
  accuracy: 0.102
  date: 2021-01-29_00-34-17
  done: true
  experiment_id: cb29bb76d68042f4a63e74970f999b96
  experiment_tag: 7_batch_size=2,l1=8,l2=128,lr=0.008309
  hostname: 218c58292e4b
  iterations_since_restore: 1
  loss: 2.3128401557922365
  node_ip: 172.17.0.2
  pid: 1558
  should_checkpoint: true
  time_since_restore: 121.68587136268616
  time_this_iter_s: 121.68587136268616
  time_total_s: 121.68587136268616
  timestamp: 1611880457
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 6efcc_00007

[2m[36m(pid=1536)[0m [2, 10000] loss: 0.279
[2m[36m(pid=1570)[0m [4,  2000] loss: 1.597
Result for DEFAULT_6efcc_00000:
  accuracy: 0.3815
  date: 2021-01-29_00-34-23
  done: false
  experiment_id: ddbdbb0722834bf1bef1736cca432a47
  experiment_tag: 0_batch_size=4,l1=8,l2=8,lr=0.00029126
  hostname: 218c58292e4b
  iterations_since_restore: 2
  loss: 1.647479687690735
  node_ip: 172.17.0.2
  pid: 1568
  should_checkpoint: true
  time_since_restore: 127.9381034374237
  time_this_iter_s: 60.04955339431763
  time_total_s: 127.9381034374237
  timestamp: 1611880463
  timesteps_since_restore: 0
  training_iteration: 2
  trial_id: 6efcc_00000

== Status ==
Memory usage on this node: 6.5/240.1 GiB
Using AsyncHyperBand: num_stopped=5
Bracket: Iter 8.000: None | Iter 4.000: -2.3112536296844484 | Iter 2.000: -1.647479687690735 | Iter 1.000: -2.2723203914642336
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.64748 |     0.3815 |                    2 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.5886  |     0.4031 |                    1 |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.69116 |     0.3898 |                    3 |
| DEFAULT_6efcc_00004 | RUNNING    |                 |            2 |  256 |   64 | 0.00561739  |         |            |                      |
| DEFAULT_6efcc_00009 | RUNNING    | 172.17.0.2:1527 |           16 |   32 |   16 | 0.0529677   | 2.30873 |     0.0972 |                    5 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_6efcc_00001:
  accuracy: 0.4619
  date: 2021-01-29_00-34-24
  done: false
  experiment_id: f1e7497fde49473e90c682d742c0e931
  experiment_tag: 1_batch_size=4,l1=16,l2=64,lr=0.00063377
  hostname: 218c58292e4b
  iterations_since_restore: 2
  loss: 1.4370445353150367
  node_ip: 172.17.0.2
  pid: 1536
  should_checkpoint: true
  time_since_restore: 129.34974193572998
  time_this_iter_s: 60.480756521224976
  time_total_s: 129.34974193572998
  timestamp: 1611880464
  timesteps_since_restore: 0
  training_iteration: 2
  trial_id: 6efcc_00001

[2m[36m(pid=1527)[0m [6,  2000] loss: 2.310
Result for DEFAULT_6efcc_00004:
  accuracy: 0.2611
  date: 2021-01-29_00-34-29
  done: false
  experiment_id: 9c07f916346e4cdf93beebf5f464f45e
  experiment_tag: 4_batch_size=2,l1=256,l2=64,lr=0.0056174
  hostname: 218c58292e4b
  iterations_since_restore: 1
  loss: 1.9680687033891677
  node_ip: 172.17.0.2
  pid: 1571
  should_checkpoint: true
  time_since_restore: 133.54965829849243
  time_this_iter_s: 133.54965829849243
  time_total_s: 133.54965829849243
  timestamp: 1611880469
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 6efcc_00004

== Status ==
Memory usage on this node: 6.4/240.1 GiB
Using AsyncHyperBand: num_stopped=5
Bracket: Iter 8.000: None | Iter 4.000: -2.3112536296844484 | Iter 2.000: -1.6156057638883592 | Iter 1.000: -2.2495077567100523
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.64748 |     0.3815 |                    2 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.43704 |     0.4619 |                    2 |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.69116 |     0.3898 |                    3 |
| DEFAULT_6efcc_00004 | RUNNING    | 172.17.0.2:1571 |            2 |  256 |   64 | 0.00561739  | 1.96807 |     0.2611 |                    1 |
| DEFAULT_6efcc_00009 | RUNNING    | 172.17.0.2:1527 |           16 |   32 |   16 | 0.0529677   | 2.30873 |     0.0972 |                    5 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1570)[0m [4,  4000] loss: 0.794
[2m[36m(pid=1568)[0m [3,  2000] loss: 1.663
Result for DEFAULT_6efcc_00009:
  accuracy: 0.0998
  date: 2021-01-29_00-34-34
  done: false
  experiment_id: e3bee2b361b746ebb0c401e9d5c8a489
  experiment_tag: 9_batch_size=16,l1=32,l2=16,lr=0.052968
  hostname: 218c58292e4b
  iterations_since_restore: 6
  loss: 2.30790421295166
  node_ip: 172.17.0.2
  pid: 1527
  should_checkpoint: true
  time_since_restore: 139.34196138381958
  time_this_iter_s: 21.667866468429565
  time_total_s: 139.34196138381958
  timestamp: 1611880474
  timesteps_since_restore: 0
  training_iteration: 6
  trial_id: 6efcc_00009

== Status ==
Memory usage on this node: 6.5/240.1 GiB
Using AsyncHyperBand: num_stopped=5
Bracket: Iter 8.000: None | Iter 4.000: -2.3112536296844484 | Iter 2.000: -1.6156057638883592 | Iter 1.000: -2.2495077567100523
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.64748 |     0.3815 |                    2 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.43704 |     0.4619 |                    2 |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.69116 |     0.3898 |                    3 |
| DEFAULT_6efcc_00004 | RUNNING    | 172.17.0.2:1571 |            2 |  256 |   64 | 0.00561739  | 1.96807 |     0.2611 |                    1 |
| DEFAULT_6efcc_00009 | RUNNING    | 172.17.0.2:1527 |           16 |   32 |   16 | 0.0529677   | 2.3079  |     0.0998 |                    6 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1536)[0m [3,  2000] loss: 1.362
[2m[36m(pid=1571)[0m [2,  2000] loss: 1.997
Result for DEFAULT_6efcc_00003:
  accuracy: 0.4456
  date: 2021-01-29_00-34-42
  done: false
  experiment_id: eeb31974a3fe46d790317e81469c7e63
  experiment_tag: 3_batch_size=8,l1=32,l2=256,lr=0.0091481
  hostname: 218c58292e4b
  iterations_since_restore: 4
  loss: 1.6126238625049591
  node_ip: 172.17.0.2
  pid: 1570
  should_checkpoint: true
  time_since_restore: 146.83312702178955
  time_this_iter_s: 34.061883211135864
  time_total_s: 146.83312702178955
  timestamp: 1611880482
  timesteps_since_restore: 0
  training_iteration: 4
  trial_id: 6efcc_00003

== Status ==
Memory usage on this node: 6.5/240.1 GiB
Using AsyncHyperBand: num_stopped=5
Bracket: Iter 8.000: None | Iter 4.000: -1.9619387460947038 | Iter 2.000: -1.6156057638883592 | Iter 1.000: -2.2495077567100523
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.64748 |     0.3815 |                    2 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.43704 |     0.4619 |                    2 |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.61262 |     0.4456 |                    4 |
| DEFAULT_6efcc_00004 | RUNNING    | 172.17.0.2:1571 |            2 |  256 |   64 | 0.00561739  | 1.96807 |     0.2611 |                    1 |
| DEFAULT_6efcc_00009 | RUNNING    | 172.17.0.2:1527 |           16 |   32 |   16 | 0.0529677   | 2.3079  |     0.0998 |                    6 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1568)[0m [3,  4000] loss: 0.798
[2m[36m(pid=1536)[0m [3,  4000] loss: 0.678
[2m[36m(pid=1527)[0m [7,  2000] loss: 2.310
[2m[36m(pid=1571)[0m [2,  4000] loss: 0.993
[2m[36m(pid=1568)[0m [3,  6000] loss: 0.521
[2m[36m(pid=1570)[0m [5,  2000] loss: 1.577
[2m[36m(pid=1536)[0m [3,  6000] loss: 0.449
Result for DEFAULT_6efcc_00009:
  accuracy: 0.0998
  date: 2021-01-29_00-34-55
  done: false
  experiment_id: e3bee2b361b746ebb0c401e9d5c8a489
  experiment_tag: 9_batch_size=16,l1=32,l2=16,lr=0.052968
  hostname: 218c58292e4b
  iterations_since_restore: 7
  loss: 2.305722671890259
  node_ip: 172.17.0.2
  pid: 1527
  should_checkpoint: true
  time_since_restore: 160.26986074447632
  time_this_iter_s: 20.92789936065674
  time_total_s: 160.26986074447632
  timestamp: 1611880495
  timesteps_since_restore: 0
  training_iteration: 7
  trial_id: 6efcc_00009

== Status ==
Memory usage on this node: 6.5/240.1 GiB
Using AsyncHyperBand: num_stopped=5
Bracket: Iter 8.000: None | Iter 4.000: -1.9619387460947038 | Iter 2.000: -1.6156057638883592 | Iter 1.000: -2.2495077567100523
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.64748 |     0.3815 |                    2 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.43704 |     0.4619 |                    2 |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.61262 |     0.4456 |                    4 |
| DEFAULT_6efcc_00004 | RUNNING    | 172.17.0.2:1571 |            2 |  256 |   64 | 0.00561739  | 1.96807 |     0.2611 |                    1 |
| DEFAULT_6efcc_00009 | RUNNING    | 172.17.0.2:1527 |           16 |   32 |   16 | 0.0529677   | 2.30572 |     0.0998 |                    7 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1571)[0m [2,  6000] loss: 0.657
[2m[36m(pid=1568)[0m [3,  8000] loss: 0.382
[2m[36m(pid=1536)[0m [3,  8000] loss: 0.324
[2m[36m(pid=1570)[0m [5,  4000] loss: 0.806
[2m[36m(pid=1527)[0m [8,  2000] loss: 2.311
[2m[36m(pid=1568)[0m [3, 10000] loss: 0.301
[2m[36m(pid=1571)[0m [2,  8000] loss: 0.497
[2m[36m(pid=1536)[0m [3, 10000] loss: 0.260
Result for DEFAULT_6efcc_00003:
  accuracy: 0.3846
  date: 2021-01-29_00-35-15
  done: false
  experiment_id: eeb31974a3fe46d790317e81469c7e63
  experiment_tag: 3_batch_size=8,l1=32,l2=256,lr=0.0091481
  hostname: 218c58292e4b
  iterations_since_restore: 5
  loss: 1.6937701454639436
  node_ip: 172.17.0.2
  pid: 1570
  should_checkpoint: true
  time_since_restore: 180.35938954353333
  time_this_iter_s: 33.526262521743774
  time_total_s: 180.35938954353333
  timestamp: 1611880515
  timesteps_since_restore: 0
  training_iteration: 5
  trial_id: 6efcc_00003

== Status ==
Memory usage on this node: 6.5/240.1 GiB
Using AsyncHyperBand: num_stopped=5
Bracket: Iter 8.000: None | Iter 4.000: -1.9619387460947038 | Iter 2.000: -1.6156057638883592 | Iter 1.000: -2.2495077567100523
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.64748 |     0.3815 |                    2 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.43704 |     0.4619 |                    2 |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.69377 |     0.3846 |                    5 |
| DEFAULT_6efcc_00004 | RUNNING    | 172.17.0.2:1571 |            2 |  256 |   64 | 0.00561739  | 1.96807 |     0.2611 |                    1 |
| DEFAULT_6efcc_00009 | RUNNING    | 172.17.0.2:1527 |           16 |   32 |   16 | 0.0529677   | 2.30572 |     0.0998 |                    7 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_6efcc_00009:
  accuracy: 0.0972
  date: 2021-01-29_00-35-17
  done: false
  experiment_id: e3bee2b361b746ebb0c401e9d5c8a489
  experiment_tag: 9_batch_size=16,l1=32,l2=16,lr=0.052968
  hostname: 218c58292e4b
  iterations_since_restore: 8
  loss: 2.30895093460083
  node_ip: 172.17.0.2
  pid: 1527
  should_checkpoint: true
  time_since_restore: 181.6132345199585
  time_this_iter_s: 21.343373775482178
  time_total_s: 181.6132345199585
  timestamp: 1611880517
  timesteps_since_restore: 0
  training_iteration: 8
  trial_id: 6efcc_00009

Result for DEFAULT_6efcc_00000:
  accuracy: 0.464
  date: 2021-01-29_00-35-20
  done: false
  experiment_id: ddbdbb0722834bf1bef1736cca432a47
  experiment_tag: 0_batch_size=4,l1=8,l2=8,lr=0.00029126
  hostname: 218c58292e4b
  iterations_since_restore: 3
  loss: 1.4580026160478592
  node_ip: 172.17.0.2
  pid: 1568
  should_checkpoint: true
  time_since_restore: 184.90759778022766
  time_this_iter_s: 56.969494342803955
  time_total_s: 184.90759778022766
  timestamp: 1611880520
  timesteps_since_restore: 0
  training_iteration: 3
  trial_id: 6efcc_00000

Result for DEFAULT_6efcc_00001:
  accuracy: 0.541
  date: 2021-01-29_00-35-21
  done: false
  experiment_id: f1e7497fde49473e90c682d742c0e931
  experiment_tag: 1_batch_size=4,l1=16,l2=64,lr=0.00063377
  hostname: 218c58292e4b
  iterations_since_restore: 3
  loss: 1.2651066781938076
  node_ip: 172.17.0.2
  pid: 1536
  should_checkpoint: true
  time_since_restore: 186.29183864593506
  time_this_iter_s: 56.94209671020508
  time_total_s: 186.29183864593506
  timestamp: 1611880521
  timesteps_since_restore: 0
  training_iteration: 3
  trial_id: 6efcc_00001

== Status ==
Memory usage on this node: 6.5/240.1 GiB
Using AsyncHyperBand: num_stopped=5
Bracket: Iter 8.000: -2.30895093460083 | Iter 4.000: -1.9619387460947038 | Iter 2.000: -1.6156057638883592 | Iter 1.000: -2.2495077567100523
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.458   |     0.464  |                    3 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.26511 |     0.541  |                    3 |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.69377 |     0.3846 |                    5 |
| DEFAULT_6efcc_00004 | RUNNING    | 172.17.0.2:1571 |            2 |  256 |   64 | 0.00561739  | 1.96807 |     0.2611 |                    1 |
| DEFAULT_6efcc_00009 | RUNNING    | 172.17.0.2:1527 |           16 |   32 |   16 | 0.0529677   | 2.30895 |     0.0972 |                    8 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1571)[0m [2, 10000] loss: 0.405
[2m[36m(pid=1570)[0m [6,  2000] loss: 1.610
[2m[36m(pid=1568)[0m [4,  2000] loss: 1.475
[2m[36m(pid=1536)[0m [4,  2000] loss: 1.252
[2m[36m(pid=1527)[0m [9,  2000] loss: 2.310
[2m[36m(pid=1571)[0m [2, 12000] loss: 0.329
Result for DEFAULT_6efcc_00009:
  accuracy: 0.0998
  date: 2021-01-29_00-35-38
  done: false
  experiment_id: e3bee2b361b746ebb0c401e9d5c8a489
  experiment_tag: 9_batch_size=16,l1=32,l2=16,lr=0.052968
  hostname: 218c58292e4b
  iterations_since_restore: 9
  loss: 2.310048843383789
  node_ip: 172.17.0.2
  pid: 1527
  should_checkpoint: true
  time_since_restore: 202.919513463974
  time_this_iter_s: 21.306278944015503
  time_total_s: 202.919513463974
  timestamp: 1611880538
  timesteps_since_restore: 0
  training_iteration: 9
  trial_id: 6efcc_00009

== Status ==
Memory usage on this node: 6.5/240.1 GiB
Using AsyncHyperBand: num_stopped=5
Bracket: Iter 8.000: -2.30895093460083 | Iter 4.000: -1.9619387460947038 | Iter 2.000: -1.6156057638883592 | Iter 1.000: -2.2495077567100523
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.458   |     0.464  |                    3 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.26511 |     0.541  |                    3 |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.69377 |     0.3846 |                    5 |
| DEFAULT_6efcc_00004 | RUNNING    | 172.17.0.2:1571 |            2 |  256 |   64 | 0.00561739  | 1.96807 |     0.2611 |                    1 |
| DEFAULT_6efcc_00009 | RUNNING    | 172.17.0.2:1527 |           16 |   32 |   16 | 0.0529677   | 2.31005 |     0.0998 |                    9 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1570)[0m [6,  4000] loss: 0.813
[2m[36m(pid=1568)[0m [4,  4000] loss: 0.729
[2m[36m(pid=1536)[0m [4,  4000] loss: 0.629
[2m[36m(pid=1571)[0m [2, 14000] loss: 0.283
Result for DEFAULT_6efcc_00003:
  accuracy: 0.4231
  date: 2021-01-29_00-35-49
  done: false
  experiment_id: eeb31974a3fe46d790317e81469c7e63
  experiment_tag: 3_batch_size=8,l1=32,l2=256,lr=0.0091481
  hostname: 218c58292e4b
  iterations_since_restore: 6
  loss: 1.6271210726737977
  node_ip: 172.17.0.2
  pid: 1570
  should_checkpoint: true
  time_since_restore: 213.7419240474701
  time_this_iter_s: 33.38253450393677
  time_total_s: 213.7419240474701
  timestamp: 1611880549
  timesteps_since_restore: 0
  training_iteration: 6
  trial_id: 6efcc_00003

== Status ==
Memory usage on this node: 6.5/240.1 GiB
Using AsyncHyperBand: num_stopped=5
Bracket: Iter 8.000: -2.30895093460083 | Iter 4.000: -1.9619387460947038 | Iter 2.000: -1.6156057638883592 | Iter 1.000: -2.2495077567100523
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.458   |     0.464  |                    3 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.26511 |     0.541  |                    3 |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.62712 |     0.4231 |                    6 |
| DEFAULT_6efcc_00004 | RUNNING    | 172.17.0.2:1571 |            2 |  256 |   64 | 0.00561739  | 1.96807 |     0.2611 |                    1 |
| DEFAULT_6efcc_00009 | RUNNING    | 172.17.0.2:1527 |           16 |   32 |   16 | 0.0529677   | 2.31005 |     0.0998 |                    9 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1568)[0m [4,  6000] loss: 0.481
[2m[36m(pid=1536)[0m [4,  6000] loss: 0.414
[2m[36m(pid=1527)[0m [10,  2000] loss: 2.310
Result for DEFAULT_6efcc_00009:
  accuracy: 0.0972
  date: 2021-01-29_00-35-59
  done: true
  experiment_id: e3bee2b361b746ebb0c401e9d5c8a489
  experiment_tag: 9_batch_size=16,l1=32,l2=16,lr=0.052968
  hostname: 218c58292e4b
  iterations_since_restore: 10
  loss: 2.3059265037536623
  node_ip: 172.17.0.2
  pid: 1527
  should_checkpoint: true
  time_since_restore: 224.1636860370636
  time_this_iter_s: 21.2441725730896
  time_total_s: 224.1636860370636
  timestamp: 1611880559
  timesteps_since_restore: 0
  training_iteration: 10
  trial_id: 6efcc_00009

== Status ==
Memory usage on this node: 6.5/240.1 GiB
Using AsyncHyperBand: num_stopped=6
Bracket: Iter 8.000: -2.30895093460083 | Iter 4.000: -1.9619387460947038 | Iter 2.000: -1.6156057638883592 | Iter 1.000: -2.2495077567100523
Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.458   |     0.464  |                    3 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.26511 |     0.541  |                    3 |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.62712 |     0.4231 |                    6 |
| DEFAULT_6efcc_00004 | RUNNING    | 172.17.0.2:1571 |            2 |  256 |   64 | 0.00561739  | 1.96807 |     0.2611 |                    1 |
| DEFAULT_6efcc_00009 | RUNNING    | 172.17.0.2:1527 |           16 |   32 |   16 | 0.0529677   | 2.30593 |     0.0972 |                   10 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1571)[0m [2, 16000] loss: 0.253
[2m[36m(pid=1568)[0m [4,  8000] loss: 0.353
[2m[36m(pid=1570)[0m [7,  2000] loss: 1.639
[2m[36m(pid=1536)[0m [4,  8000] loss: 0.310
[2m[36m(pid=1568)[0m [4, 10000] loss: 0.284
[2m[36m(pid=1571)[0m [2, 18000] loss: 0.221
[2m[36m(pid=1536)[0m [4, 10000] loss: 0.250
[2m[36m(pid=1570)[0m [7,  4000] loss: 0.819
Result for DEFAULT_6efcc_00000:
  accuracy: 0.4995
  date: 2021-01-29_00-36-19
  done: false
  experiment_id: ddbdbb0722834bf1bef1736cca432a47
  experiment_tag: 0_batch_size=4,l1=8,l2=8,lr=0.00029126
  hostname: 218c58292e4b
  iterations_since_restore: 4
  loss: 1.3830263492941857
  node_ip: 172.17.0.2
  pid: 1568
  should_checkpoint: true
  time_since_restore: 243.86985731124878
  time_this_iter_s: 58.96225953102112
  time_total_s: 243.86985731124878
  timestamp: 1611880579
  timesteps_since_restore: 0
  training_iteration: 4
  trial_id: 6efcc_00000

== Status ==
Memory usage on this node: 5.9/240.1 GiB
Using AsyncHyperBand: num_stopped=6
Bracket: Iter 8.000: -2.30895093460083 | Iter 4.000: -1.6126238625049591 | Iter 2.000: -1.6156057638883592 | Iter 1.000: -2.2495077567100523
Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.38303 |     0.4995 |                    4 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.26511 |     0.541  |                    3 |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.62712 |     0.4231 |                    6 |
| DEFAULT_6efcc_00004 | RUNNING    | 172.17.0.2:1571 |            2 |  256 |   64 | 0.00561739  | 1.96807 |     0.2611 |                    1 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
| DEFAULT_6efcc_00009 | TERMINATED |                 |           16 |   32 |   16 | 0.0529677   | 2.30593 |     0.0972 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_6efcc_00001:
  accuracy: 0.5498
  date: 2021-01-29_00-36-20
  done: false
  experiment_id: f1e7497fde49473e90c682d742c0e931
  experiment_tag: 1_batch_size=4,l1=16,l2=64,lr=0.00063377
  hostname: 218c58292e4b
  iterations_since_restore: 4
  loss: 1.2557326589107514
  node_ip: 172.17.0.2
  pid: 1536
  should_checkpoint: true
  time_since_restore: 244.7792067527771
  time_this_iter_s: 58.48736810684204
  time_total_s: 244.7792067527771
  timestamp: 1611880580
  timesteps_since_restore: 0
  training_iteration: 4
  trial_id: 6efcc_00001

Result for DEFAULT_6efcc_00003:
  accuracy: 0.4101
  date: 2021-01-29_00-36-24
  done: false
  experiment_id: eeb31974a3fe46d790317e81469c7e63
  experiment_tag: 3_batch_size=8,l1=32,l2=256,lr=0.0091481
  hostname: 218c58292e4b
  iterations_since_restore: 7
  loss: 1.6974258336544037
  node_ip: 172.17.0.2
  pid: 1570
  should_checkpoint: true
  time_since_restore: 249.2462227344513
  time_this_iter_s: 35.5042986869812
  time_total_s: 249.2462227344513
  timestamp: 1611880584
  timesteps_since_restore: 0
  training_iteration: 7
  trial_id: 6efcc_00003

== Status ==
Memory usage on this node: 5.9/240.1 GiB
Using AsyncHyperBand: num_stopped=6
Bracket: Iter 8.000: -2.30895093460083 | Iter 4.000: -1.4978251058995724 | Iter 2.000: -1.6156057638883592 | Iter 1.000: -2.2495077567100523
Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.38303 |     0.4995 |                    4 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.25573 |     0.5498 |                    4 |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.69743 |     0.4101 |                    7 |
| DEFAULT_6efcc_00004 | RUNNING    | 172.17.0.2:1571 |            2 |  256 |   64 | 0.00561739  | 1.96807 |     0.2611 |                    1 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
| DEFAULT_6efcc_00009 | TERMINATED |                 |           16 |   32 |   16 | 0.0529677   | 2.30593 |     0.0972 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1571)[0m [2, 20000] loss: 0.201
[2m[36m(pid=1568)[0m [5,  2000] loss: 1.383
[2m[36m(pid=1536)[0m [5,  2000] loss: 1.224
[2m[36m(pid=1570)[0m [8,  2000] loss: 1.657
Result for DEFAULT_6efcc_00004:
  accuracy: 0.2561
  date: 2021-01-29_00-36-37
  done: true
  experiment_id: 9c07f916346e4cdf93beebf5f464f45e
  experiment_tag: 4_batch_size=2,l1=256,l2=64,lr=0.0056174
  hostname: 218c58292e4b
  iterations_since_restore: 2
  loss: 1.9892219728589058
  node_ip: 172.17.0.2
  pid: 1571
  should_checkpoint: true
  time_since_restore: 261.495076417923
  time_this_iter_s: 127.94541811943054
  time_total_s: 261.495076417923
  timestamp: 1611880597
  timesteps_since_restore: 0
  training_iteration: 2
  trial_id: 6efcc_00004

== Status ==
Memory usage on this node: 5.8/240.1 GiB
Using AsyncHyperBand: num_stopped=7
Bracket: Iter 8.000: -2.30895093460083 | Iter 4.000: -1.4978251058995724 | Iter 2.000: -1.647479687690735 | Iter 1.000: -2.2495077567100523
Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.38303 |     0.4995 |                    4 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.25573 |     0.5498 |                    4 |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.69743 |     0.4101 |                    7 |
| DEFAULT_6efcc_00004 | RUNNING    | 172.17.0.2:1571 |            2 |  256 |   64 | 0.00561739  | 1.98922 |     0.2561 |                    2 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
| DEFAULT_6efcc_00009 | TERMINATED |                 |           16 |   32 |   16 | 0.0529677   | 2.30593 |     0.0972 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1568)[0m [5,  4000] loss: 0.685
[2m[36m(pid=1536)[0m [5,  4000] loss: 0.594
[2m[36m(pid=1570)[0m [8,  4000] loss: 0.844
[2m[36m(pid=1568)[0m [5,  6000] loss: 0.463
[2m[36m(pid=1536)[0m [5,  6000] loss: 0.401
Result for DEFAULT_6efcc_00003:
  accuracy: 0.4305
  date: 2021-01-29_00-36-57
  done: false
  experiment_id: eeb31974a3fe46d790317e81469c7e63
  experiment_tag: 3_batch_size=8,l1=32,l2=256,lr=0.0091481
  hostname: 218c58292e4b
  iterations_since_restore: 8
  loss: 1.703468648290634
  node_ip: 172.17.0.2
  pid: 1570
  should_checkpoint: true
  time_since_restore: 281.5056366920471
  time_this_iter_s: 32.259413957595825
  time_total_s: 281.5056366920471
  timestamp: 1611880617
  timesteps_since_restore: 0
  training_iteration: 8
  trial_id: 6efcc_00003

== Status ==
Memory usage on this node: 5.3/240.1 GiB
Using AsyncHyperBand: num_stopped=7
Bracket: Iter 8.000: -2.006209791445732 | Iter 4.000: -1.4978251058995724 | Iter 2.000: -1.647479687690735 | Iter 1.000: -2.2495077567100523
Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.38303 |     0.4995 |                    4 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.25573 |     0.5498 |                    4 |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.70347 |     0.4305 |                    8 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00004 | TERMINATED |                 |            2 |  256 |   64 | 0.00561739  | 1.98922 |     0.2561 |                    2 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
| DEFAULT_6efcc_00009 | TERMINATED |                 |           16 |   32 |   16 | 0.0529677   | 2.30593 |     0.0972 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1568)[0m [5,  8000] loss: 0.335
[2m[36m(pid=1536)[0m [5,  8000] loss: 0.299
[2m[36m(pid=1568)[0m [5, 10000] loss: 0.269
[2m[36m(pid=1536)[0m [5, 10000] loss: 0.233
[2m[36m(pid=1570)[0m [9,  2000] loss: 1.665
Result for DEFAULT_6efcc_00000:
  accuracy: 0.5252
  date: 2021-01-29_00-37-13
  done: false
  experiment_id: ddbdbb0722834bf1bef1736cca432a47
  experiment_tag: 0_batch_size=4,l1=8,l2=8,lr=0.00029126
  hostname: 218c58292e4b
  iterations_since_restore: 5
  loss: 1.3224241407990456
  node_ip: 172.17.0.2
  pid: 1568
  should_checkpoint: true
  time_since_restore: 298.41960430145264
  time_this_iter_s: 54.54974699020386
  time_total_s: 298.41960430145264
  timestamp: 1611880633
  timesteps_since_restore: 0
  training_iteration: 5
  trial_id: 6efcc_00000

== Status ==
Memory usage on this node: 5.3/240.1 GiB
Using AsyncHyperBand: num_stopped=7
Bracket: Iter 8.000: -2.006209791445732 | Iter 4.000: -1.4978251058995724 | Iter 2.000: -1.647479687690735 | Iter 1.000: -2.2495077567100523
Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.32242 |     0.5252 |                    5 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.25573 |     0.5498 |                    4 |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.70347 |     0.4305 |                    8 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00004 | TERMINATED |                 |            2 |  256 |   64 | 0.00561739  | 1.98922 |     0.2561 |                    2 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
| DEFAULT_6efcc_00009 | TERMINATED |                 |           16 |   32 |   16 | 0.0529677   | 2.30593 |     0.0972 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_6efcc_00001:
  accuracy: 0.5688
  date: 2021-01-29_00-37-14
  done: false
  experiment_id: f1e7497fde49473e90c682d742c0e931
  experiment_tag: 1_batch_size=4,l1=16,l2=64,lr=0.00063377
  hostname: 218c58292e4b
  iterations_since_restore: 5
  loss: 1.2146508452892304
  node_ip: 172.17.0.2
  pid: 1536
  should_checkpoint: true
  time_since_restore: 299.4382598400116
  time_this_iter_s: 54.6590530872345
  time_total_s: 299.4382598400116
  timestamp: 1611880634
  timesteps_since_restore: 0
  training_iteration: 5
  trial_id: 6efcc_00001

[2m[36m(pid=1570)[0m [9,  4000] loss: 0.835
[2m[36m(pid=1568)[0m [6,  2000] loss: 1.314
[2m[36m(pid=1536)[0m [6,  2000] loss: 1.143
Result for DEFAULT_6efcc_00003:
  accuracy: 0.3369
  date: 2021-01-29_00-37-29
  done: false
  experiment_id: eeb31974a3fe46d790317e81469c7e63
  experiment_tag: 3_batch_size=8,l1=32,l2=256,lr=0.0091481
  hostname: 218c58292e4b
  iterations_since_restore: 9
  loss: 1.811385777115822
  node_ip: 172.17.0.2
  pid: 1570
  should_checkpoint: true
  time_since_restore: 313.5978727340698
  time_this_iter_s: 32.092236042022705
  time_total_s: 313.5978727340698
  timestamp: 1611880649
  timesteps_since_restore: 0
  training_iteration: 9
  trial_id: 6efcc_00003

== Status ==
Memory usage on this node: 5.3/240.1 GiB
Using AsyncHyperBand: num_stopped=7
Bracket: Iter 8.000: -2.006209791445732 | Iter 4.000: -1.4978251058995724 | Iter 2.000: -1.647479687690735 | Iter 1.000: -2.2495077567100523
Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.32242 |     0.5252 |                    5 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.21465 |     0.5688 |                    5 |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.81139 |     0.3369 |                    9 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00004 | TERMINATED |                 |            2 |  256 |   64 | 0.00561739  | 1.98922 |     0.2561 |                    2 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
| DEFAULT_6efcc_00009 | TERMINATED |                 |           16 |   32 |   16 | 0.0529677   | 2.30593 |     0.0972 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1568)[0m [6,  4000] loss: 0.661
[2m[36m(pid=1536)[0m [6,  4000] loss: 0.574
[2m[36m(pid=1570)[0m [10,  2000] loss: 1.673
[2m[36m(pid=1568)[0m [6,  6000] loss: 0.443
[2m[36m(pid=1536)[0m [6,  6000] loss: 0.390
[2m[36m(pid=1570)[0m [10,  4000] loss: 0.837
[2m[36m(pid=1568)[0m [6,  8000] loss: 0.329
[2m[36m(pid=1536)[0m [6,  8000] loss: 0.293
Result for DEFAULT_6efcc_00003:
  accuracy: 0.3755
  date: 2021-01-29_00-38-01
  done: true
  experiment_id: eeb31974a3fe46d790317e81469c7e63
  experiment_tag: 3_batch_size=8,l1=32,l2=256,lr=0.0091481
  hostname: 218c58292e4b
  iterations_since_restore: 10
  loss: 1.7871136533737182
  node_ip: 172.17.0.2
  pid: 1570
  should_checkpoint: true
  time_since_restore: 345.56683254241943
  time_this_iter_s: 31.96895980834961
  time_total_s: 345.56683254241943
  timestamp: 1611880681
  timesteps_since_restore: 0
  training_iteration: 10
  trial_id: 6efcc_00003

== Status ==
Memory usage on this node: 5.3/240.1 GiB
Using AsyncHyperBand: num_stopped=8
Bracket: Iter 8.000: -2.006209791445732 | Iter 4.000: -1.4978251058995724 | Iter 2.000: -1.647479687690735 | Iter 1.000: -2.2495077567100523
Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.32242 |     0.5252 |                    5 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.21465 |     0.5688 |                    5 |
| DEFAULT_6efcc_00003 | RUNNING    | 172.17.0.2:1570 |            8 |   32 |  256 | 0.00914809  | 1.78711 |     0.3755 |                   10 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00004 | TERMINATED |                 |            2 |  256 |   64 | 0.00561739  | 1.98922 |     0.2561 |                    2 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
| DEFAULT_6efcc_00009 | TERMINATED |                 |           16 |   32 |   16 | 0.0529677   | 2.30593 |     0.0972 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


[2m[36m(pid=1568)[0m [6, 10000] loss: 0.261
[2m[36m(pid=1536)[0m [6, 10000] loss: 0.231
Result for DEFAULT_6efcc_00000:
  accuracy: 0.5409
  date: 2021-01-29_00-38-08
  done: false
  experiment_id: ddbdbb0722834bf1bef1736cca432a47
  experiment_tag: 0_batch_size=4,l1=8,l2=8,lr=0.00029126
  hostname: 218c58292e4b
  iterations_since_restore: 6
  loss: 1.286772437930107
  node_ip: 172.17.0.2
  pid: 1568
  should_checkpoint: true
  time_since_restore: 353.0361638069153
  time_this_iter_s: 54.61655950546265
  time_total_s: 353.0361638069153
  timestamp: 1611880688
  timesteps_since_restore: 0
  training_iteration: 6
  trial_id: 6efcc_00000

== Status ==
Memory usage on this node: 4.7/240.1 GiB
Using AsyncHyperBand: num_stopped=8
Bracket: Iter 8.000: -2.006209791445732 | Iter 4.000: -1.4978251058995724 | Iter 2.000: -1.647479687690735 | Iter 1.000: -2.2495077567100523
Resources requested: 4/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.28677 |     0.5409 |                    6 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.21465 |     0.5688 |                    5 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00003 | TERMINATED |                 |            8 |   32 |  256 | 0.00914809  | 1.78711 |     0.3755 |                   10 |
| DEFAULT_6efcc_00004 | TERMINATED |                 |            2 |  256 |   64 | 0.00561739  | 1.98922 |     0.2561 |                    2 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
| DEFAULT_6efcc_00009 | TERMINATED |                 |           16 |   32 |   16 | 0.0529677   | 2.30593 |     0.0972 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_6efcc_00001:
  accuracy: 0.582
  date: 2021-01-29_00-38-09
  done: false
  experiment_id: f1e7497fde49473e90c682d742c0e931
  experiment_tag: 1_batch_size=4,l1=16,l2=64,lr=0.00063377
  hostname: 218c58292e4b
  iterations_since_restore: 6
  loss: 1.1763008350759745
  node_ip: 172.17.0.2
  pid: 1536
  should_checkpoint: true
  time_since_restore: 353.6210570335388
  time_this_iter_s: 54.18279719352722
  time_total_s: 353.6210570335388
  timestamp: 1611880689
  timesteps_since_restore: 0
  training_iteration: 6
  trial_id: 6efcc_00001

[2m[36m(pid=1568)[0m [7,  2000] loss: 1.285
[2m[36m(pid=1536)[0m [7,  2000] loss: 1.097
[2m[36m(pid=1568)[0m [7,  4000] loss: 0.641
[2m[36m(pid=1536)[0m [7,  4000] loss: 0.574
[2m[36m(pid=1568)[0m [7,  6000] loss: 0.429
[2m[36m(pid=1536)[0m [7,  6000] loss: 0.374
[2m[36m(pid=1568)[0m [7,  8000] loss: 0.316
[2m[36m(pid=1536)[0m [7,  8000] loss: 0.282
[2m[36m(pid=1568)[0m [7, 10000] loss: 0.251
[2m[36m(pid=1536)[0m [7, 10000] loss: 0.228
Result for DEFAULT_6efcc_00000:
  accuracy: 0.5429
  date: 2021-01-29_00-39-01
  done: false
  experiment_id: ddbdbb0722834bf1bef1736cca432a47
  experiment_tag: 0_batch_size=4,l1=8,l2=8,lr=0.00029126
  hostname: 218c58292e4b
  iterations_since_restore: 7
  loss: 1.2688422158837318
  node_ip: 172.17.0.2
  pid: 1568
  should_checkpoint: true
  time_since_restore: 405.8869688510895
  time_this_iter_s: 52.850805044174194
  time_total_s: 405.8869688510895
  timestamp: 1611880741
  timesteps_since_restore: 0
  training_iteration: 7
  trial_id: 6efcc_00000

== Status ==
Memory usage on this node: 4.6/240.1 GiB
Using AsyncHyperBand: num_stopped=8
Bracket: Iter 8.000: -2.006209791445732 | Iter 4.000: -1.4978251058995724 | Iter 2.000: -1.647479687690735 | Iter 1.000: -2.2495077567100523
Resources requested: 4/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.26884 |     0.5429 |                    7 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.1763  |     0.582  |                    6 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00003 | TERMINATED |                 |            8 |   32 |  256 | 0.00914809  | 1.78711 |     0.3755 |                   10 |
| DEFAULT_6efcc_00004 | TERMINATED |                 |            2 |  256 |   64 | 0.00561739  | 1.98922 |     0.2561 |                    2 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
| DEFAULT_6efcc_00009 | TERMINATED |                 |           16 |   32 |   16 | 0.0529677   | 2.30593 |     0.0972 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_6efcc_00001:
  accuracy: 0.5604
  date: 2021-01-29_00-39-02
  done: false
  experiment_id: f1e7497fde49473e90c682d742c0e931
  experiment_tag: 1_batch_size=4,l1=16,l2=64,lr=0.00063377
  hostname: 218c58292e4b
  iterations_since_restore: 7
  loss: 1.21538098628819
  node_ip: 172.17.0.2
  pid: 1536
  should_checkpoint: true
  time_since_restore: 406.89876985549927
  time_this_iter_s: 53.27771282196045
  time_total_s: 406.89876985549927
  timestamp: 1611880742
  timesteps_since_restore: 0
  training_iteration: 7
  trial_id: 6efcc_00001

[2m[36m(pid=1568)[0m [8,  2000] loss: 1.236
[2m[36m(pid=1536)[0m [8,  2000] loss: 1.089
[2m[36m(pid=1568)[0m [8,  4000] loss: 0.622
[2m[36m(pid=1536)[0m [8,  4000] loss: 0.554
[2m[36m(pid=1568)[0m [8,  6000] loss: 0.421
[2m[36m(pid=1536)[0m [8,  6000] loss: 0.364
[2m[36m(pid=1568)[0m [8,  8000] loss: 0.312
[2m[36m(pid=1536)[0m [8,  8000] loss: 0.280
[2m[36m(pid=1568)[0m [8, 10000] loss: 0.242
[2m[36m(pid=1536)[0m [8, 10000] loss: 0.219
Result for DEFAULT_6efcc_00000:
  accuracy: 0.5522
  date: 2021-01-29_00-39-54
  done: false
  experiment_id: ddbdbb0722834bf1bef1736cca432a47
  experiment_tag: 0_batch_size=4,l1=8,l2=8,lr=0.00029126
  hostname: 218c58292e4b
  iterations_since_restore: 8
  loss: 1.252352828502655
  node_ip: 172.17.0.2
  pid: 1568
  should_checkpoint: true
  time_since_restore: 458.9265742301941
  time_this_iter_s: 53.039605379104614
  time_total_s: 458.9265742301941
  timestamp: 1611880794
  timesteps_since_restore: 0
  training_iteration: 8
  trial_id: 6efcc_00000

== Status ==
Memory usage on this node: 4.6/240.1 GiB
Using AsyncHyperBand: num_stopped=8
Bracket: Iter 8.000: -1.703468648290634 | Iter 4.000: -1.4978251058995724 | Iter 2.000: -1.647479687690735 | Iter 1.000: -2.2495077567100523
Resources requested: 4/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.25235 |     0.5522 |                    8 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.21538 |     0.5604 |                    7 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00003 | TERMINATED |                 |            8 |   32 |  256 | 0.00914809  | 1.78711 |     0.3755 |                   10 |
| DEFAULT_6efcc_00004 | TERMINATED |                 |            2 |  256 |   64 | 0.00561739  | 1.98922 |     0.2561 |                    2 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
| DEFAULT_6efcc_00009 | TERMINATED |                 |           16 |   32 |   16 | 0.0529677   | 2.30593 |     0.0972 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_6efcc_00001:
  accuracy: 0.5612
  date: 2021-01-29_00-39-55
  done: false
  experiment_id: f1e7497fde49473e90c682d742c0e931
  experiment_tag: 1_batch_size=4,l1=16,l2=64,lr=0.00063377
  hostname: 218c58292e4b
  iterations_since_restore: 8
  loss: 1.2346481616131961
  node_ip: 172.17.0.2
  pid: 1536
  should_checkpoint: true
  time_since_restore: 459.7065575122833
  time_this_iter_s: 52.80778765678406
  time_total_s: 459.7065575122833
  timestamp: 1611880795
  timesteps_since_restore: 0
  training_iteration: 8
  trial_id: 6efcc_00001

[2m[36m(pid=1568)[0m [9,  2000] loss: 1.204
[2m[36m(pid=1536)[0m [9,  2000] loss: 1.046
[2m[36m(pid=1568)[0m [9,  4000] loss: 0.603
[2m[36m(pid=1536)[0m [9,  4000] loss: 0.539
[2m[36m(pid=1568)[0m [9,  6000] loss: 0.408
[2m[36m(pid=1536)[0m [9,  6000] loss: 0.368
[2m[36m(pid=1568)[0m [9,  8000] loss: 0.306
[2m[36m(pid=1536)[0m [9,  8000] loss: 0.270
[2m[36m(pid=1568)[0m [9, 10000] loss: 0.245
[2m[36m(pid=1536)[0m [9, 10000] loss: 0.219
Result for DEFAULT_6efcc_00000:
  accuracy: 0.5649
  date: 2021-01-29_00-40-47
  done: false
  experiment_id: ddbdbb0722834bf1bef1736cca432a47
  experiment_tag: 0_batch_size=4,l1=8,l2=8,lr=0.00029126
  hostname: 218c58292e4b
  iterations_since_restore: 9
  loss: 1.222828230291605
  node_ip: 172.17.0.2
  pid: 1568
  should_checkpoint: true
  time_since_restore: 512.1814475059509
  time_this_iter_s: 53.254873275756836
  time_total_s: 512.1814475059509
  timestamp: 1611880847
  timesteps_since_restore: 0
  training_iteration: 9
  trial_id: 6efcc_00000

== Status ==
Memory usage on this node: 4.6/240.1 GiB
Using AsyncHyperBand: num_stopped=8
Bracket: Iter 8.000: -1.4779107383966446 | Iter 4.000: -1.4978251058995724 | Iter 2.000: -1.647479687690735 | Iter 1.000: -2.2495077567100523
Resources requested: 4/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.22283 |     0.5649 |                    9 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.23465 |     0.5612 |                    8 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00003 | TERMINATED |                 |            8 |   32 |  256 | 0.00914809  | 1.78711 |     0.3755 |                   10 |
| DEFAULT_6efcc_00004 | TERMINATED |                 |            2 |  256 |   64 | 0.00561739  | 1.98922 |     0.2561 |                    2 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
| DEFAULT_6efcc_00009 | TERMINATED |                 |           16 |   32 |   16 | 0.0529677   | 2.30593 |     0.0972 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_6efcc_00001:
  accuracy: 0.5894
  date: 2021-01-29_00-40-48
  done: false
  experiment_id: f1e7497fde49473e90c682d742c0e931
  experiment_tag: 1_batch_size=4,l1=16,l2=64,lr=0.00063377
  hostname: 218c58292e4b
  iterations_since_restore: 9
  loss: 1.163047531080246
  node_ip: 172.17.0.2
  pid: 1536
  should_checkpoint: true
  time_since_restore: 512.5719084739685
  time_this_iter_s: 52.86535096168518
  time_total_s: 512.5719084739685
  timestamp: 1611880848
  timesteps_since_restore: 0
  training_iteration: 9
  trial_id: 6efcc_00001

[2m[36m(pid=1568)[0m [10,  2000] loss: 1.188
[2m[36m(pid=1536)[0m [10,  2000] loss: 1.033
[2m[36m(pid=1568)[0m [10,  4000] loss: 0.604
[2m[36m(pid=1536)[0m [10,  4000] loss: 0.531
[2m[36m(pid=1568)[0m [10,  6000] loss: 0.399
[2m[36m(pid=1536)[0m [10,  6000] loss: 0.358
[2m[36m(pid=1568)[0m [10,  8000] loss: 0.299
[2m[36m(pid=1536)[0m [10,  8000] loss: 0.269
[2m[36m(pid=1568)[0m [10, 10000] loss: 0.236
[2m[36m(pid=1536)[0m [10, 10000] loss: 0.213
Result for DEFAULT_6efcc_00000:
  accuracy: 0.5789
  date: 2021-01-29_00-41-40
  done: true
  experiment_id: ddbdbb0722834bf1bef1736cca432a47
  experiment_tag: 0_batch_size=4,l1=8,l2=8,lr=0.00029126
  hostname: 218c58292e4b
  iterations_since_restore: 10
  loss: 1.1939951294064521
  node_ip: 172.17.0.2
  pid: 1568
  should_checkpoint: true
  time_since_restore: 565.1305408477783
  time_this_iter_s: 52.94909334182739
  time_total_s: 565.1305408477783
  timestamp: 1611880900
  timesteps_since_restore: 0
  training_iteration: 10
  trial_id: 6efcc_00000

== Status ==
Memory usage on this node: 4.6/240.1 GiB
Using AsyncHyperBand: num_stopped=9
Bracket: Iter 8.000: -1.4779107383966446 | Iter 4.000: -1.4978251058995724 | Iter 2.000: -1.647479687690735 | Iter 1.000: -2.2495077567100523
Resources requested: 4/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | RUNNING    | 172.17.0.2:1568 |            4 |    8 |    8 | 0.000291261 | 1.194   |     0.5789 |                   10 |
| DEFAULT_6efcc_00001 | RUNNING    | 172.17.0.2:1536 |            4 |   16 |   64 | 0.000633769 | 1.16305 |     0.5894 |                    9 |
| DEFAULT_6efcc_00002 | TERMINATED |                 |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00003 | TERMINATED |                 |            8 |   32 |  256 | 0.00914809  | 1.78711 |     0.3755 |                   10 |
| DEFAULT_6efcc_00004 | TERMINATED |                 |            2 |  256 |   64 | 0.00561739  | 1.98922 |     0.2561 |                    2 |
| DEFAULT_6efcc_00005 | TERMINATED |                 |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |                 |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |                 |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |                 |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
| DEFAULT_6efcc_00009 | TERMINATED |                 |           16 |   32 |   16 | 0.0529677   | 2.30593 |     0.0972 |                   10 |
+---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


Result for DEFAULT_6efcc_00001:
  accuracy: 0.6064
  date: 2021-01-29_00-41-40
  done: true
  experiment_id: f1e7497fde49473e90c682d742c0e931
  experiment_tag: 1_batch_size=4,l1=16,l2=64,lr=0.00063377
  hostname: 218c58292e4b
  iterations_since_restore: 10
  loss: 1.1226280626118184
  node_ip: 172.17.0.2
  pid: 1536
  should_checkpoint: true
  time_since_restore: 565.2203781604767
  time_this_iter_s: 52.64846968650818
  time_total_s: 565.2203781604767
  timestamp: 1611880900
  timesteps_since_restore: 0
  training_iteration: 10
  trial_id: 6efcc_00001

== Status ==
Memory usage on this node: 4.2/240.1 GiB
Using AsyncHyperBand: num_stopped=10
Bracket: Iter 8.000: -1.4779107383966446 | Iter 4.000: -1.4978251058995724 | Iter 2.000: -1.647479687690735 | Iter 1.000: -2.2495077567100523
Resources requested: 0/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-01-29_00-32-14
Number of trials: 10/10 (10 TERMINATED)
+---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+
| Trial name          | status     | loc   |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
|---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------|
| DEFAULT_6efcc_00000 | TERMINATED |       |            4 |    8 |    8 | 0.000291261 | 1.194   |     0.5789 |                   10 |
| DEFAULT_6efcc_00001 | TERMINATED |       |            4 |   16 |   64 | 0.000633769 | 1.12263 |     0.6064 |                   10 |
| DEFAULT_6efcc_00002 | TERMINATED |       |            4 |   64 |    8 | 0.0590704   | 2.34314 |     0.1006 |                    1 |
| DEFAULT_6efcc_00003 | TERMINATED |       |            8 |   32 |  256 | 0.00914809  | 1.78711 |     0.3755 |                   10 |
| DEFAULT_6efcc_00004 | TERMINATED |       |            2 |  256 |   64 | 0.00561739  | 1.98922 |     0.2561 |                    2 |
| DEFAULT_6efcc_00005 | TERMINATED |       |           16 |   64 |   64 | 0.000348184 | 2.27232 |     0.1826 |                    1 |
| DEFAULT_6efcc_00006 | TERMINATED |       |            2 |    4 |    4 | 0.00706031  | 2.30677 |     0.095  |                    1 |
| DEFAULT_6efcc_00007 | TERMINATED |       |            2 |    8 |  128 | 0.00830905  | 2.31284 |     0.102  |                    1 |
| DEFAULT_6efcc_00008 | TERMINATED |       |            8 |  128 |   32 | 0.00014301  | 2.29483 |     0.1469 |                    1 |
| DEFAULT_6efcc_00009 | TERMINATED |       |           16 |   32 |   16 | 0.0529677   | 2.30593 |     0.0972 |                   10 |
+---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+


Best trial config: {'l1': 16, 'l2': 64, 'lr': 0.0006337694451980705, 'batch_size': 4}
Best trial final validation loss: 1.1226280626118184
Best trial final validation accuracy: 0.6064
Files already downloaded and verified
Files already downloaded and verified
Best trial test set accuracy: 0.6
</pre></div>
</div>
<p>If you run the code, an example output could look like this:</p>
<p>Most trials have been stopped early in order to avoid wasting resources.
The best performing trial achieved a validation accuracy of about 58%, which could
be confirmed on the test set.</p>
<p>So that’s it! You can now tune the parameters of your PyTorch models.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 9 minutes  48.084 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-beginner-hyperparameter-tuning-tutorial-py">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" download="" href="../_downloads/95074cd7ce8c3e57a92e7a9c49182e6a/hyperparameter_tuning_tutorial.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">hyperparameter_tuning_tutorial.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" download="" href="../_downloads/c24b93738bc036c1b66d0387555bf69a/hyperparameter_tuning_tutorial.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">hyperparameter_tuning_tutorial.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>
</article>
</div>
<footer>
<div aria-label="footer navigation" class="rst-footer-buttons" role="navigation">
<a accesskey="n" class="btn btn-neutral float-right" href="../intermediate/pruning_tutorial.html" rel="next" title="Pruning Tutorial">Next <img class="next-page" src="../_static/images/chevron-right-orange.svg"/></a>
<a accesskey="p" class="btn btn-neutral" href="profiler.html" rel="prev" title="Profiling your PyTorch Module"><img class="previous-page" src="../_static/images/chevron-right-orange.svg"/> Previous</a>
</div>
<hr class="helpful-hr hr-top"/>
<div class="helpful-container">
<div class="helpful-question">Was this helpful?</div>
<div class="helpful-question yes-link" data-behavior="was-this-helpful-event" data-response="yes">Yes</div>
<div class="helpful-question no-link" data-behavior="was-this-helpful-event" data-response="no">No</div>
<div class="was-helpful-thank-you">Thank you</div>
</div>
<hr class="helpful-hr hr-bottom"/>
<div role="contentinfo">
<p>
        © Copyright 2017, PyTorch.

    </p>
</div>
<div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
</footer>
</div>
</div>
<div class="pytorch-content-right" id="pytorch-content-right">
<div class="pytorch-right-menu" id="pytorch-right-menu">
<div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
<ul>
<li><a class="reference internal" href="#">Hyperparameter tuning with Ray Tune</a><ul>
<li><a class="reference internal" href="#setup-imports">Setup / Imports</a></li>
<li><a class="reference internal" href="#data-loaders">Data loaders</a></li>
<li><a class="reference internal" href="#configurable-neural-network">Configurable neural network</a></li>
<li><a class="reference internal" href="#the-train-function">The train function</a><ul>
<li><a class="reference internal" href="#adding-multi-gpu-support-with-dataparallel">Adding (multi) GPU support with DataParallel</a></li>
<li><a class="reference internal" href="#communicating-with-ray-tune">Communicating with Ray Tune</a></li>
<li><a class="reference internal" href="#full-training-function">Full training function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#test-set-accuracy">Test set accuracy</a></li>
<li><a class="reference internal" href="#configuring-the-search-space">Configuring the search space</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</section>
</div>
<script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js" type="text/javascript"></script>
<script src="../_static/jquery.js" type="text/javascript"></script>
<script src="../_static/underscore.js" type="text/javascript"></script>
<script src="../_static/doctools.js" type="text/javascript"></script>
<script src="../_static/clipboard.min.js" type="text/javascript"></script>
<script src="../_static/copybutton.js" type="text/javascript"></script>
<script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<script src="../_static/js/vendor/popper.min.js" type="text/javascript"></script>
<script src="../_static/js/vendor/bootstrap.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
<script src="../_static/js/theme.js" type="text/javascript"></script>
<script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-117752657-2"></script>
<script>

  window.dataLayer = window.dataLayer || [];

  function gtag(){dataLayer.push(arguments);}

  gtag('js', new Date());
  gtag('config', 'UA-117752657-2');

</script>
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window,document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '243028289693773');
  fbq('track', 'PageView');

  $("[data-behavior='call-to-action-event']").on('click', function(){
    fbq('trackCustom', "Download", {
      tutorialTitle: $('h1:first').text(),
      downloadLink: this.href,
      tutorialLink: window.location.href,
      downloadTitle: $(this).attr("data-response")
    });

    gtag('event', 'click', {
      'event_category': 'Download',
      'event_label': $(this).attr("data-response")
    });

    gtag('event', 'click', {
      'event_category': $(this).attr("data-response"),
      'event_label': $("h1").first().text(),
      'tutorial_link': window.location.href
    });
   });

   $("[data-behavior='was-this-helpful-event']").on('click', function(){
    $(".helpful-question").hide();
    $(".was-helpful-thank-you").show();

    fbq('trackCustom', "Was this Helpful?", {
      tutorialLink: window.location.href,
      tutorialTitle: $('h1:first').text(),
      helpful: $(this).attr("data-response")
    });

    gtag('event', $(this).attr("data-response"), {
      'event_category': 'Was this Helpful?',
      'event_label': $(this).attr("data-response")
    });

    gtag('event', $(this).attr("data-response"), {
      'event_category': 'Was this Helpful?',
      'event_label': $("h1").first().text()
    });
   });

   if (location.pathname == "/") {
     $(".helpful-container").hide();
     $(".hr-bottom").hide();
   }
</script>
<noscript>
<img height="1" src="https://www.facebook.com/tr?id=243028289693773&amp;ev=PageView
  &amp;noscript=1" width="1"/>
</noscript>
<img alt="" height="1" src="https://www.googleadservices.com/pagead/conversion/795629140/?label=txkmCPmdtosBENSssfsC&amp;guid=ON&amp;script=0" style="border-style:none;" width="1"/>
<!-- Begin Footer -->
<div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
<div class="container">
<div class="row">
<div class="col-md-4 text-center">
<h2>Docs</h2>
<p>Access comprehensive developer documentation for PyTorch</p>
<a class="with-right-arrow" href="https://pytorch.org/docs/stable/index.html">View Docs</a>
</div>
<div class="col-md-4 text-center">
<h2>Tutorials</h2>
<p>Get in-depth tutorials for beginners and advanced developers</p>
<a class="with-right-arrow" href="https://pytorch.org/tutorials">View Tutorials</a>
</div>
<div class="col-md-4 text-center">
<h2>Resources</h2>
<p>Find development resources and get your questions answered</p>
<a class="with-right-arrow" href="https://pytorch.org/resources">View Resources</a>
</div>
</div>
</div>
</div>
<footer class="site-footer">
<div class="container footer-container">
<div class="footer-logo-wrapper">
<a class="footer-logo" href="https://pytorch.org/"></a>
</div>
<div class="footer-links-wrapper">
<div class="footer-links-col">
<ul>
<li class="list-title"><a href="https://pytorch.org/">PyTorch</a></li>
<li><a href="https://pytorch.org/get-started">Get Started</a></li>
<li><a href="https://pytorch.org/features">Features</a></li>
<li><a href="https://pytorch.org/ecosystem">Ecosystem</a></li>
<li><a href="https://pytorch.org/blog/">Blog</a></li>
<li><a href="https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md">Contributing</a></li>
</ul>
</div>
<div class="footer-links-col">
<ul>
<li class="list-title"><a href="https://pytorch.org/resources">Resources</a></li>
<li><a href="https://pytorch.org/tutorials">Tutorials</a></li>
<li><a href="https://pytorch.org/docs/stable/index.html">Docs</a></li>
<li><a href="https://discuss.pytorch.org" target="_blank">Discuss</a></li>
<li><a href="https://github.com/pytorch/pytorch/issues" target="_blank">Github Issues</a></li>
<li><a href="https://pytorch.org/assets/brand-guidelines/PyTorch-Brand-Guidelines.pdf" target="_blank">Brand Guidelines</a></li>
</ul>
</div>
<div class="footer-links-col follow-us-col">
<ul>
<li class="list-title">Stay Connected</li>
<li>
<div id="mc_embed_signup">
<form action="https://twitter.us14.list-manage.com/subscribe/post?u=75419c71fe0a935e53dfa4a3f&amp;id=91d0dccd39" class="email-subscribe-form validate" id="mc-embedded-subscribe-form" method="post" name="mc-embedded-subscribe-form" novalidate="" target="_blank">
<div class="email-subscribe-form-fields-wrapper" id="mc_embed_signup_scroll">
<div class="mc-field-group">
<label for="mce-EMAIL" style="display:none;">Email Address</label>
<input class="required email" id="mce-EMAIL" name="EMAIL" placeholder="Email Address" type="email" value=""/>
</div>
<div class="clear" id="mce-responses">
<div class="response" id="mce-error-response" style="display:none"></div>
<div class="response" id="mce-success-response" style="display:none"></div>
</div> <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
<div aria-hidden="true" style="position: absolute; left: -5000px;"><input name="b_75419c71fe0a935e53dfa4a3f_91d0dccd39" tabindex="-1" type="text" value=""/></div>
<div class="clear">
<input class="button email-subscribe-button" id="mc-embedded-subscribe" name="subscribe" type="submit" value=""/>
</div>
</div>
</form>
</div>
</li>
</ul>
<div class="footer-social-icons">
<a class="facebook" href="https://www.facebook.com/pytorch" target="_blank"></a>
<a class="twitter" href="https://twitter.com/pytorch" target="_blank"></a>
<a class="youtube" href="https://www.youtube.com/pytorch" target="_blank"></a>
</div>
</div>
</div>
</div>
</footer>
<div class="cookie-banner-wrapper">
<div class="container">
<p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
<img class="close-button" src="../_static/images/pytorch-x.svg">
</img></div>
</div>
<!-- End Footer -->
<!-- Begin Mobile Menu -->
<div class="mobile-main-menu">
<div class="container-fluid">
<div class="container">
<div class="mobile-main-menu-header-container">
<a aria-label="PyTorch" class="header-logo" href="https://pytorch.org/"></a>
<a class="main-menu-close-button" data-behavior="close-mobile-menu" href="#"></a>
</div>
</div>
</div>
<div class="mobile-main-menu-links-container">
<div class="main-menu">
<ul>
<li>
<a href="https://pytorch.org/get-started">Get Started</a>
</li>
<li>
<a href="https://pytorch.org/ecosystem">Ecosystem</a>
</li>
<li>
<a href="https://pytorch.org/mobile">Mobile</a>
</li>
<li>
<a href="https://pytorch.org/hub">PyTorch Hub</a>
</li>
<li>
<a href="https://pytorch.org/blog/">Blog</a>
</li>
<li class="active">
<a href="https://pytorch.org/tutorials">Tutorials</a>
</li>
<li class="resources-mobile-menu-title">
            Docs
          </li>
<ul class="resources-mobile-menu-items">
<li>
<a href="https://pytorch.org/docs/stable/index.html">PyTorch</a>
</li>
<li>
<a href="https://pytorch.org/audio/stable/index.html">torchaudio</a>
</li>
<li>
<a href="https://pytorch.org/text/stable/index.html">torchtext</a>
</li>
<li>
<a href="https://pytorch.org/vision/stable/index.html">torchvision</a>
</li>
<li>
<a href="https://pytorch.org/elastic/">TorchElastic</a>
</li>
<li>
<a href="https://pytorch.org/serve/">TorchServe</a>
</li>
<li>
<a href="https://pytorch.org/xla">PyTorch on XLA Devices</a>
</li>
</ul>
<li class="resources-mobile-menu-title">
            Resources
          </li>
<ul class="resources-mobile-menu-items">
<li>
<a href="https://pytorch.org/resources">Developer Resources</a>
</li>
<li>
<a href="https://pytorch.org/features">About</a>
</li>
<li>
<a href="https://pytorch.org/hub">Models (Beta)</a>
</li>
<li>
<a href="https://pytorch.org/#community-module">Community</a>
</li>
<li>
<a href="https://discuss.pytorch.org/">Forums</a>
</li>
</ul>
<li>
<a href="https://github.com/pytorch/pytorch">Github</a>
</li>
</ul>
</div>
</div>
</div>
<!-- End Mobile Menu -->
<script src="../_static/js/vendor/anchor.min.js" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>