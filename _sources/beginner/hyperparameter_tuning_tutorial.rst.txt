.. note::
    :class: sphx-glr-download-link-note

    Click :ref:`here <sphx_glr_download_beginner_hyperparameter_tuning_tutorial.py>` to download the full example code
.. rst-class:: sphx-glr-example-title

.. _sphx_glr_beginner_hyperparameter_tuning_tutorial.py:


Hyperparameter tuning with Ray Tune
===================================

Hyperparameter tuning can make the difference between an average model and a highly
accurate one. Often simple things like choosing a different learning rate or changing
a network layer size can have a dramatic impact on your model performance.

Fortunately, there are tools that help with finding the best combination of parameters.
`Ray Tune <https://docs.ray.io/en/latest/tune.html>`_ is an industry standard tool for
distributed hyperparameter tuning. Ray Tune includes the latest hyperparameter search
algorithms, integrates with TensorBoard and other analysis libraries, and natively
supports distributed training through `Ray's distributed machine learning engine
<https://ray.io/>`_.

In this tutorial, we will show you how to integrate Ray Tune into your PyTorch
training workflow. We will extend `this tutorial from the PyTorch documentation
<https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html>`_ for training
a CIFAR10 image classifier.

As you will see, we only need to add some slight modifications. In particular, we
need to

1. wrap data loading and training in functions,
2. make some network parameters configurable,
3. add checkpointing (optional),
4. and define the search space for the model tuning

|

To run this tutorial, please make sure the following packages are
installed:

-  ``ray[tune]``: Distributed hyperparameter tuning library
-  ``torchvision``: For the data transformers

Setup / Imports
---------------
Let's start with the imports:


.. code-block:: default

    from functools import partial
    import numpy as np
    import os
    import torch
    import torch.nn as nn
    import torch.nn.functional as F
    import torch.optim as optim
    from torch.utils.data import random_split
    import torchvision
    import torchvision.transforms as transforms
    from ray import tune
    from ray.tune import CLIReporter
    from ray.tune.schedulers import ASHAScheduler







Most of the imports are needed for building the PyTorch model. Only the last three
imports are for Ray Tune.

Data loaders
------------
We wrap the data loaders in their own function and pass a global data directory.
This way we can share a data directory between different trials.


.. code-block:: default



    def load_data(data_dir="./data"):
        transform = transforms.Compose([
            transforms.ToTensor(),
            transforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5))
        ])

        trainset = torchvision.datasets.CIFAR10(
            root=data_dir, train=True, download=True, transform=transform)

        testset = torchvision.datasets.CIFAR10(
            root=data_dir, train=False, download=True, transform=transform)

        return trainset, testset







Configurable neural network
---------------------------
We can only tune those parameters that are configurable. In this example, we can specify
the layer sizes of the fully connected layers:


.. code-block:: default



    class Net(nn.Module):
        def __init__(self, l1=120, l2=84):
            super(Net, self).__init__()
            self.conv1 = nn.Conv2d(3, 6, 5)
            self.pool = nn.MaxPool2d(2, 2)
            self.conv2 = nn.Conv2d(6, 16, 5)
            self.fc1 = nn.Linear(16 * 5 * 5, l1)
            self.fc2 = nn.Linear(l1, l2)
            self.fc3 = nn.Linear(l2, 10)

        def forward(self, x):
            x = self.pool(F.relu(self.conv1(x)))
            x = self.pool(F.relu(self.conv2(x)))
            x = x.view(-1, 16 * 5 * 5)
            x = F.relu(self.fc1(x))
            x = F.relu(self.fc2(x))
            x = self.fc3(x)
            return x







The train function
------------------
Now it gets interesting, because we introduce some changes to the example `from the PyTorch
documentation <https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html>`_.

We wrap the training script in a function ``train_cifar(config, checkpoint_dir=None, data_dir=None)``.
As you can guess, the ``config`` parameter will receive the hyperparameters we would like to
train with. The ``checkpoint_dir`` parameter is used to restore checkpoints. The ``data_dir`` specifies
the directory where we load and store the data, so multiple runs can share the same data source.

.. code-block:: python

    net = Net(config["l1"], config["l2"])

    if checkpoint_dir:
        model_state, optimizer_state = torch.load(
            os.path.join(checkpoint_dir, "checkpoint"))
        net.load_state_dict(model_state)
        optimizer.load_state_dict(optimizer_state)

The learning rate of the optimizer is made configurable, too:

.. code-block:: python

    optimizer = optim.SGD(net.parameters(), lr=config["lr"], momentum=0.9)

We also split the training data into a training and validation subset. We thus train on
80% of the data and calculate the validation loss on the remaining 20%. The batch sizes
with which we iterate through the training and test sets are configurable as well.

Adding (multi) GPU support with DataParallel
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Image classification benefits largely from GPUs. Luckily, we can continue to use
PyTorch's abstractions in Ray Tune. Thus, we can wrap our model in ``nn.DataParallel``
to support data parallel training on multiple GPUs:

.. code-block:: python

    device = "cpu"
    if torch.cuda.is_available():
        device = "cuda:0"
        if torch.cuda.device_count() > 1:
            net = nn.DataParallel(net)
    net.to(device)

By using a ``device`` variable we make sure that training also works when we have
no GPUs available. PyTorch requires us to send our data to the GPU memory explicitly,
like this:

.. code-block:: python

    for i, data in enumerate(trainloader, 0):
        inputs, labels = data
        inputs, labels = inputs.to(device), labels.to(device)

The code now supports training on CPUs, on a single GPU, and on multiple GPUs. Notably, Ray
also supports `fractional GPUs <https://docs.ray.io/en/master/using-ray-with-gpus.html#fractional-gpus>`_
so we can share GPUs among trials, as long as the model still fits on the GPU memory. We'll come back
to that later.

Communicating with Ray Tune
~~~~~~~~~~~~~~~~~~~~~~~~~~~

The most interesting part is the communication with Ray Tune:

.. code-block:: python

    with tune.checkpoint_dir(epoch) as checkpoint_dir:
        path = os.path.join(checkpoint_dir, "checkpoint")
        torch.save((net.state_dict(), optimizer.state_dict()), path)

    tune.report(loss=(val_loss / val_steps), accuracy=correct / total)

Here we first save a checkpoint and then report some metrics back to Ray Tune. Specifically,
we send the validation loss and accuracy back to Ray Tune. Ray Tune can then use these metrics
to decide which hyperparameter configuration lead to the best results. These metrics
can also be used to stop bad performing trials early in order to avoid wasting
resources on those trials.

The checkpoint saving is optional, however, it is necessary if we wanted to use advanced
schedulers like
`Population Based Training <https://docs.ray.io/en/master/tune/tutorials/tune-advanced-tutorial.html>`_.
Also, by saving the checkpoint we can later load the trained models and validate them
on a test set.

Full training function
~~~~~~~~~~~~~~~~~~~~~~

The full code example looks like this:


.. code-block:: default



    def train_cifar(config, checkpoint_dir=None, data_dir=None):
        net = Net(config["l1"], config["l2"])

        device = "cpu"
        if torch.cuda.is_available():
            device = "cuda:0"
            if torch.cuda.device_count() > 1:
                net = nn.DataParallel(net)
        net.to(device)

        criterion = nn.CrossEntropyLoss()
        optimizer = optim.SGD(net.parameters(), lr=config["lr"], momentum=0.9)

        if checkpoint_dir:
            model_state, optimizer_state = torch.load(
                os.path.join(checkpoint_dir, "checkpoint"))
            net.load_state_dict(model_state)
            optimizer.load_state_dict(optimizer_state)

        trainset, testset = load_data(data_dir)

        test_abs = int(len(trainset) * 0.8)
        train_subset, val_subset = random_split(
            trainset, [test_abs, len(trainset) - test_abs])

        trainloader = torch.utils.data.DataLoader(
            train_subset,
            batch_size=int(config["batch_size"]),
            shuffle=True,
            num_workers=8)
        valloader = torch.utils.data.DataLoader(
            val_subset,
            batch_size=int(config["batch_size"]),
            shuffle=True,
            num_workers=8)

        for epoch in range(10):  # loop over the dataset multiple times
            running_loss = 0.0
            epoch_steps = 0
            for i, data in enumerate(trainloader, 0):
                # get the inputs; data is a list of [inputs, labels]
                inputs, labels = data
                inputs, labels = inputs.to(device), labels.to(device)

                # zero the parameter gradients
                optimizer.zero_grad()

                # forward + backward + optimize
                outputs = net(inputs)
                loss = criterion(outputs, labels)
                loss.backward()
                optimizer.step()

                # print statistics
                running_loss += loss.item()
                epoch_steps += 1
                if i % 2000 == 1999:  # print every 2000 mini-batches
                    print("[%d, %5d] loss: %.3f" % (epoch + 1, i + 1,
                                                    running_loss / epoch_steps))
                    running_loss = 0.0

            # Validation loss
            val_loss = 0.0
            val_steps = 0
            total = 0
            correct = 0
            for i, data in enumerate(valloader, 0):
                with torch.no_grad():
                    inputs, labels = data
                    inputs, labels = inputs.to(device), labels.to(device)

                    outputs = net(inputs)
                    _, predicted = torch.max(outputs.data, 1)
                    total += labels.size(0)
                    correct += (predicted == labels).sum().item()

                    loss = criterion(outputs, labels)
                    val_loss += loss.cpu().numpy()
                    val_steps += 1

            with tune.checkpoint_dir(epoch) as checkpoint_dir:
                path = os.path.join(checkpoint_dir, "checkpoint")
                torch.save((net.state_dict(), optimizer.state_dict()), path)

            tune.report(loss=(val_loss / val_steps), accuracy=correct / total)
        print("Finished Training")







As you can see, most of the code is adapted directly from the original example.

Test set accuracy
-----------------
Commonly the performance of a machine learning model is tested on a hold-out test
set with data that has not been used for training the model. We also wrap this in a
function:


.. code-block:: default



    def test_accuracy(net, device="cpu"):
        trainset, testset = load_data()

        testloader = torch.utils.data.DataLoader(
            testset, batch_size=4, shuffle=False, num_workers=2)

        correct = 0
        total = 0
        with torch.no_grad():
            for data in testloader:
                images, labels = data
                images, labels = images.to(device), labels.to(device)
                outputs = net(images)
                _, predicted = torch.max(outputs.data, 1)
                total += labels.size(0)
                correct += (predicted == labels).sum().item()

        return correct / total







The function also expects a ``device`` parameter, so we can do the
test set validation on a GPU.

Configuring the search space
----------------------------
Lastly, we need to define Ray Tune's search space. Here is an example:

.. code-block:: python

    config = {
        "l1": tune.sample_from(lambda _: 2**np.random.randint(2, 9)),
        "l2": tune.sample_from(lambda _: 2**np.random.randint(2, 9)),
        "lr": tune.loguniform(1e-4, 1e-1),
        "batch_size": tune.choice([2, 4, 8, 16])
    }

The ``tune.sample_from()`` function makes it possible to define your own sample
methods to obtain hyperparameters. In this example, the ``l1`` and ``l2`` parameters
should be powers of 2 between 4 and 256, so either 4, 8, 16, 32, 64, 128, or 256.
The ``lr`` (learning rate) should be uniformly sampled between 0.0001 and 0.1. Lastly,
the batch size is a choice between 2, 4, 8, and 16.

At each trial, Ray Tune will now randomly sample a combination of parameters from these
search spaces. It will then train a number of models in parallel and find the best
performing one among these. We also use the ``ASHAScheduler`` which will terminate bad
performing trials early.

We wrap the ``train_cifar`` function with ``functools.partial`` to set the constant
``data_dir`` parameter. We can also tell Ray Tune what resources should be
available for each trial:

.. code-block:: python

    gpus_per_trial = 2
    # ...
    result = tune.run(
        partial(train_cifar, data_dir=data_dir),
        resources_per_trial={"cpu": 8, "gpu": gpus_per_trial},
        config=config,
        num_samples=num_samples,
        scheduler=scheduler,
        progress_reporter=reporter,
        checkpoint_at_end=True)

You can specify the number of CPUs, which are then available e.g.
to increase the ``num_workers`` of the PyTorch ``DataLoader`` instances. The selected
number of GPUs are made visible to PyTorch in each trial. Trials do not have access to
GPUs that haven't been requested for them - so you don't have to care about two trials
using the same set of resources.

Here we can also specify fractional GPUs, so something like ``gpus_per_trial=0.5`` is
completely valid. The trials will then share GPUs among each other.
You just have to make sure that the models still fit in the GPU memory.

After training the models, we will find the best performing one and load the trained
network from the checkpoint file. We then obtain the test set accuracy and report
everything by printing.

The full main function looks like this:


.. code-block:: default



    def main(num_samples=10, max_num_epochs=10, gpus_per_trial=2):
        data_dir = os.path.abspath("./data")
        load_data(data_dir)
        config = {
            "l1": tune.sample_from(lambda _: 2 ** np.random.randint(2, 9)),
            "l2": tune.sample_from(lambda _: 2 ** np.random.randint(2, 9)),
            "lr": tune.loguniform(1e-4, 1e-1),
            "batch_size": tune.choice([2, 4, 8, 16])
        }
        scheduler = ASHAScheduler(
            metric="loss",
            mode="min",
            max_t=max_num_epochs,
            grace_period=1,
            reduction_factor=2)
        reporter = CLIReporter(
            # parameter_columns=["l1", "l2", "lr", "batch_size"],
            metric_columns=["loss", "accuracy", "training_iteration"])
        result = tune.run(
            partial(train_cifar, data_dir=data_dir),
            resources_per_trial={"cpu": 2, "gpu": gpus_per_trial},
            config=config,
            num_samples=num_samples,
            scheduler=scheduler,
            progress_reporter=reporter)

        best_trial = result.get_best_trial("loss", "min", "last")
        print("Best trial config: {}".format(best_trial.config))
        print("Best trial final validation loss: {}".format(
            best_trial.last_result["loss"]))
        print("Best trial final validation accuracy: {}".format(
            best_trial.last_result["accuracy"]))

        best_trained_model = Net(best_trial.config["l1"], best_trial.config["l2"])
        device = "cpu"
        if torch.cuda.is_available():
            device = "cuda:0"
            if gpus_per_trial > 1:
                best_trained_model = nn.DataParallel(best_trained_model)
        best_trained_model.to(device)

        best_checkpoint_dir = best_trial.checkpoint.value
        model_state, optimizer_state = torch.load(os.path.join(
            best_checkpoint_dir, "checkpoint"))
        best_trained_model.load_state_dict(model_state)

        test_acc = test_accuracy(best_trained_model, device)
        print("Best trial test set accuracy: {}".format(test_acc))


    if __name__ == "__main__":
        # You can change the number of GPUs per trial here:
        main(num_samples=10, max_num_epochs=10, gpus_per_trial=0)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz
    Extracting /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data
    Files already downloaded and verified
    == Status ==
    Memory usage on this node: 4.0/240.1 GiB
    Using AsyncHyperBand: num_stopped=0
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: None
    Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 1/10 (1 RUNNING)
    +---------------------+----------+-------+--------------+------+------+------------+
    | Trial name          | status   | loc   |   batch_size |   l1 |   l2 |         lr |
    |---------------------+----------+-------+--------------+------+------+------------|
    | DEFAULT_f7c38_00000 | RUNNING  |       |           16 |   32 |   32 | 0.00907818 |
    +---------------------+----------+-------+--------------+------+------+------------+


    [2m[36m(pid=1503)[0m Files already downloaded and verified
    [2m[36m(pid=1493)[0m Files already downloaded and verified
    [2m[36m(pid=1494)[0m Files already downloaded and verified
    [2m[36m(pid=1500)[0m Files already downloaded and verified
    [2m[36m(pid=1575)[0m Files already downloaded and verified
    [2m[36m(pid=1507)[0m Files already downloaded and verified
    [2m[36m(pid=1565)[0m Files already downloaded and verified
    [2m[36m(pid=1510)[0m Files already downloaded and verified
    [2m[36m(pid=1577)[0m Files already downloaded and verified
    [2m[36m(pid=1497)[0m Files already downloaded and verified
    [2m[36m(pid=1503)[0m Files already downloaded and verified
    [2m[36m(pid=1493)[0m Files already downloaded and verified
    [2m[36m(pid=1494)[0m Files already downloaded and verified
    [2m[36m(pid=1500)[0m Files already downloaded and verified
    [2m[36m(pid=1575)[0m Files already downloaded and verified
    [2m[36m(pid=1507)[0m Files already downloaded and verified
    [2m[36m(pid=1565)[0m Files already downloaded and verified
    [2m[36m(pid=1510)[0m Files already downloaded and verified
    [2m[36m(pid=1577)[0m Files already downloaded and verified
    [2m[36m(pid=1497)[0m Files already downloaded and verified
    [2m[36m(pid=1510)[0m [1,  2000] loss: 2.241
    [2m[36m(pid=1507)[0m [1,  2000] loss: 2.317
    [2m[36m(pid=1500)[0m [1,  2000] loss: 2.327
    [2m[36m(pid=1575)[0m [1,  2000] loss: 2.298
    [2m[36m(pid=1493)[0m [1,  2000] loss: 1.974
    [2m[36m(pid=1565)[0m [1,  2000] loss: 2.309
    [2m[36m(pid=1494)[0m [1,  2000] loss: 2.103
    [2m[36m(pid=1503)[0m [1,  2000] loss: 1.775
    [2m[36m(pid=1577)[0m [1,  2000] loss: 2.296
    [2m[36m(pid=1497)[0m [1,  2000] loss: 1.911
    [2m[36m(pid=1510)[0m [1,  4000] loss: 1.005
    [2m[36m(pid=1507)[0m [1,  4000] loss: 1.161
    [2m[36m(pid=1500)[0m [1,  4000] loss: 1.164
    Result for DEFAULT_f7c38_00000:
      accuracy: 0.4688
      date: 2021-02-26_19-30-07
      done: false
      experiment_id: d9f27abb205d4a77acf553a45e087a0f
      experiment_tag: 0_batch_size=16,l1=32,l2=32,lr=0.0090782
      hostname: c7646e93ec41
      iterations_since_restore: 1
      loss: 1.4755892121315002
      node_ip: 172.17.0.2
      pid: 1503
      should_checkpoint: true
      time_since_restore: 27.35321617126465
      time_this_iter_s: 27.35321617126465
      time_total_s: 27.35321617126465
      timestamp: 1614367807
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: f7c38_00000
  
    == Status ==
    Memory usage on this node: 9.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=0
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -1.4755892121315002
    Resources requested: 20/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (10 RUNNING)
    +---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status   | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00000 | RUNNING  | 172.17.0.2:1503 |           16 |   32 |   32 | 0.00907818  | 1.47559 |     0.4688 |                    1 |
    | DEFAULT_f7c38_00001 | RUNNING  |                 |            8 |  128 |   16 | 0.00388351  |         |            |                      |
    | DEFAULT_f7c38_00002 | RUNNING  |                 |            8 |    4 |   32 | 0.000632427 |         |            |                      |
    | DEFAULT_f7c38_00003 | RUNNING  |                 |            2 |   32 |    8 | 0.0219628   |         |            |                      |
    | DEFAULT_f7c38_00004 | RUNNING  |                 |            2 |   16 |   16 | 0.00125119  |         |            |                      |
    | DEFAULT_f7c38_00005 | RUNNING  |                 |            8 |   64 |   32 | 0.046222    |         |            |                      |
    | DEFAULT_f7c38_00006 | RUNNING  |                 |           16 |    8 |    8 | 0.00149417  |         |            |                      |
    | DEFAULT_f7c38_00007 | RUNNING  |                 |            8 |  256 |    8 | 0.00193744  |         |            |                      |
    | DEFAULT_f7c38_00008 | RUNNING  |                 |           16 |  256 |   32 | 0.00285209  |         |            |                      |
    | DEFAULT_f7c38_00009 | RUNNING  |                 |            2 |   16 |    8 | 0.0174651   |         |            |                      |
    +---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_f7c38_00006:
      accuracy: 0.1986
      date: 2021-02-26_19-30-08
      done: true
      experiment_id: da0e87db1f7b4fe88ea270c80689c65d
      experiment_tag: 6_batch_size=16,l1=8,l2=8,lr=0.0014942
      hostname: c7646e93ec41
      iterations_since_restore: 1
      loss: 2.1496753736495973
      node_ip: 172.17.0.2
      pid: 1577
      should_checkpoint: true
      time_since_restore: 27.375630617141724
      time_this_iter_s: 27.375630617141724
      time_total_s: 27.375630617141724
      timestamp: 1614367808
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: f7c38_00006
  
    Result for DEFAULT_f7c38_00008:
      accuracy: 0.4452
      date: 2021-02-26_19-30-10
      done: false
      experiment_id: 718ccef3a34c4b79b9024f35806e7445
      experiment_tag: 8_batch_size=16,l1=256,l2=32,lr=0.0028521
      hostname: c7646e93ec41
      iterations_since_restore: 1
      loss: 1.512575371170044
      node_ip: 172.17.0.2
      pid: 1497
      should_checkpoint: true
      time_since_restore: 29.842683792114258
      time_this_iter_s: 29.842683792114258
      time_total_s: 29.842683792114258
      timestamp: 1614367810
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: f7c38_00008
  
    [2m[36m(pid=1575)[0m [1,  4000] loss: 1.102
    [2m[36m(pid=1493)[0m [1,  4000] loss: 0.814
    [2m[36m(pid=1565)[0m [1,  4000] loss: 1.158
    [2m[36m(pid=1494)[0m [1,  4000] loss: 0.904
    [2m[36m(pid=1510)[0m [1,  6000] loss: 0.624
    [2m[36m(pid=1507)[0m [1,  6000] loss: 0.773
    [2m[36m(pid=1500)[0m [1,  6000] loss: 0.776
    Result for DEFAULT_f7c38_00002:
      accuracy: 0.2287
      date: 2021-02-26_19-30-22
      done: true
      experiment_id: be92eeb1c4254fa4b99d98c8e8ccbd13
      experiment_tag: 2_batch_size=8,l1=4,l2=32,lr=0.00063243
      hostname: c7646e93ec41
      iterations_since_restore: 1
      loss: 1.9711600758552552
      node_ip: 172.17.0.2
      pid: 1575
      should_checkpoint: true
      time_since_restore: 41.80233597755432
      time_this_iter_s: 41.80233597755432
      time_total_s: 41.80233597755432
      timestamp: 1614367822
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: f7c38_00002
  
    == Status ==
    Memory usage on this node: 8.8/240.1 GiB
    Using AsyncHyperBand: num_stopped=2
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -1.7418677235126496
    Resources requested: 18/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (9 RUNNING, 1 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00000 | RUNNING    | 172.17.0.2:1503 |           16 |   32 |   32 | 0.00907818  | 1.47559 |     0.4688 |                    1 |
    | DEFAULT_f7c38_00001 | RUNNING    |                 |            8 |  128 |   16 | 0.00388351  |         |            |                      |
    | DEFAULT_f7c38_00002 | RUNNING    | 172.17.0.2:1575 |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00003 | RUNNING    |                 |            2 |   32 |    8 | 0.0219628   |         |            |                      |
    | DEFAULT_f7c38_00004 | RUNNING    |                 |            2 |   16 |   16 | 0.00125119  |         |            |                      |
    | DEFAULT_f7c38_00005 | RUNNING    |                 |            8 |   64 |   32 | 0.046222    |         |            |                      |
    | DEFAULT_f7c38_00007 | RUNNING    |                 |            8 |  256 |    8 | 0.00193744  |         |            |                      |
    | DEFAULT_f7c38_00008 | RUNNING    | 172.17.0.2:1497 |           16 |  256 |   32 | 0.00285209  | 1.51258 |     0.4452 |                    1 |
    | DEFAULT_f7c38_00009 | RUNNING    |                 |            2 |   16 |    8 | 0.0174651   |         |            |                      |
    | DEFAULT_f7c38_00006 | TERMINATED |                 |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_f7c38_00001:
      accuracy: 0.4611
      date: 2021-02-26_19-30-23
      done: false
      experiment_id: cb88ccedf50c4d419ffdbee9c629db71
      experiment_tag: 1_batch_size=8,l1=128,l2=16,lr=0.0038835
      hostname: c7646e93ec41
      iterations_since_restore: 1
      loss: 1.4841741970062257
      node_ip: 172.17.0.2
      pid: 1493
      should_checkpoint: true
      time_since_restore: 43.255813121795654
      time_this_iter_s: 43.255813121795654
      time_total_s: 43.255813121795654
      timestamp: 1614367823
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: f7c38_00001
  
    [2m[36m(pid=1503)[0m [2,  2000] loss: 1.439
    Result for DEFAULT_f7c38_00005:
      accuracy: 0.1008
      date: 2021-02-26_19-30-24
      done: true
      experiment_id: f08664b3223a421796b8859e693972a1
      experiment_tag: 5_batch_size=8,l1=64,l2=32,lr=0.046222
      hostname: c7646e93ec41
      iterations_since_restore: 1
      loss: 2.313350661468506
      node_ip: 172.17.0.2
      pid: 1565
      should_checkpoint: true
      time_since_restore: 44.24198913574219
      time_this_iter_s: 44.24198913574219
      time_total_s: 44.24198913574219
      timestamp: 1614367824
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: f7c38_00005
  
    Result for DEFAULT_f7c38_00007:
      accuracy: 0.3846
      date: 2021-02-26_19-30-25
      done: false
      experiment_id: 8d69b5ddd87644a183982631ab6669d3
      experiment_tag: 7_batch_size=8,l1=256,l2=8,lr=0.0019374
      hostname: c7646e93ec41
      iterations_since_restore: 1
      loss: 1.6243644812583924
      node_ip: 172.17.0.2
      pid: 1494
      should_checkpoint: true
      time_since_restore: 44.587260723114014
      time_this_iter_s: 44.587260723114014
      time_total_s: 44.587260723114014
      timestamp: 1614367825
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: f7c38_00007
  
    [2m[36m(pid=1497)[0m [2,  2000] loss: 1.437
    [2m[36m(pid=1510)[0m [1,  8000] loss: 0.449
    [2m[36m(pid=1507)[0m [1,  8000] loss: 0.581
    [2m[36m(pid=1500)[0m [1,  8000] loss: 0.581
    Result for DEFAULT_f7c38_00000:
      accuracy: 0.5189
      date: 2021-02-26_19-30-30
      done: false
      experiment_id: d9f27abb205d4a77acf553a45e087a0f
      experiment_tag: 0_batch_size=16,l1=32,l2=32,lr=0.0090782
      hostname: c7646e93ec41
      iterations_since_restore: 2
      loss: 1.351635143470764
      node_ip: 172.17.0.2
      pid: 1503
      should_checkpoint: true
      time_since_restore: 50.15865445137024
      time_this_iter_s: 22.80543828010559
      time_total_s: 50.15865445137024
      timestamp: 1614367830
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: f7c38_00000
  
    == Status ==
    Memory usage on this node: 7.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=3
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.351635143470764 | Iter 1.000: -1.6243644812583924
    Resources requested: 14/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (7 RUNNING, 3 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00000 | RUNNING    | 172.17.0.2:1503 |           16 |   32 |   32 | 0.00907818  | 1.35164 |     0.5189 |                    2 |
    | DEFAULT_f7c38_00001 | RUNNING    | 172.17.0.2:1493 |            8 |  128 |   16 | 0.00388351  | 1.48417 |     0.4611 |                    1 |
    | DEFAULT_f7c38_00003 | RUNNING    |                 |            2 |   32 |    8 | 0.0219628   |         |            |                      |
    | DEFAULT_f7c38_00004 | RUNNING    |                 |            2 |   16 |   16 | 0.00125119  |         |            |                      |
    | DEFAULT_f7c38_00007 | RUNNING    | 172.17.0.2:1494 |            8 |  256 |    8 | 0.00193744  | 1.62436 |     0.3846 |                    1 |
    | DEFAULT_f7c38_00008 | RUNNING    | 172.17.0.2:1497 |           16 |  256 |   32 | 0.00285209  | 1.51258 |     0.4452 |                    1 |
    | DEFAULT_f7c38_00009 | RUNNING    |                 |            2 |   16 |    8 | 0.0174651   |         |            |                      |
    | DEFAULT_f7c38_00002 | TERMINATED |                 |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00005 | TERMINATED |                 |            8 |   64 |   32 | 0.046222    | 2.31335 |     0.1008 |                    1 |
    | DEFAULT_f7c38_00006 | TERMINATED |                 |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_f7c38_00008:
      accuracy: 0.5219
      date: 2021-02-26_19-30-34
      done: false
      experiment_id: 718ccef3a34c4b79b9024f35806e7445
      experiment_tag: 8_batch_size=16,l1=256,l2=32,lr=0.0028521
      hostname: c7646e93ec41
      iterations_since_restore: 2
      loss: 1.3435057857513428
      node_ip: 172.17.0.2
      pid: 1497
      should_checkpoint: true
      time_since_restore: 53.758923053741455
      time_this_iter_s: 23.916239261627197
      time_total_s: 53.758923053741455
      timestamp: 1614367834
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: f7c38_00008
  
    [2m[36m(pid=1493)[0m [2,  2000] loss: 1.457
    [2m[36m(pid=1510)[0m [1, 10000] loss: 0.343
    [2m[36m(pid=1494)[0m [2,  2000] loss: 1.568
    [2m[36m(pid=1507)[0m [1, 10000] loss: 0.465
    [2m[36m(pid=1500)[0m [1, 10000] loss: 0.465
    [2m[36m(pid=1503)[0m [3,  2000] loss: 1.346
    [2m[36m(pid=1510)[0m [1, 12000] loss: 0.275
    [2m[36m(pid=1507)[0m [1, 12000] loss: 0.387
    [2m[36m(pid=1493)[0m [2,  4000] loss: 0.704
    [2m[36m(pid=1500)[0m [1, 12000] loss: 0.388
    [2m[36m(pid=1497)[0m [3,  2000] loss: 1.283
    [2m[36m(pid=1494)[0m [2,  4000] loss: 0.729
    Result for DEFAULT_f7c38_00000:
      accuracy: 0.5243
      date: 2021-02-26_19-30-52
      done: false
      experiment_id: d9f27abb205d4a77acf553a45e087a0f
      experiment_tag: 0_batch_size=16,l1=32,l2=32,lr=0.0090782
      hostname: c7646e93ec41
      iterations_since_restore: 3
      loss: 1.3527173637390137
      node_ip: 172.17.0.2
      pid: 1503
      should_checkpoint: true
      time_since_restore: 71.5914659500122
      time_this_iter_s: 21.432811498641968
      time_total_s: 71.5914659500122
      timestamp: 1614367852
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: f7c38_00000
  
    == Status ==
    Memory usage on this node: 7.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=3
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.3475704646110533 | Iter 1.000: -1.6243644812583924
    Resources requested: 14/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (7 RUNNING, 3 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00000 | RUNNING    | 172.17.0.2:1503 |           16 |   32 |   32 | 0.00907818  | 1.35272 |     0.5243 |                    3 |
    | DEFAULT_f7c38_00001 | RUNNING    | 172.17.0.2:1493 |            8 |  128 |   16 | 0.00388351  | 1.48417 |     0.4611 |                    1 |
    | DEFAULT_f7c38_00003 | RUNNING    |                 |            2 |   32 |    8 | 0.0219628   |         |            |                      |
    | DEFAULT_f7c38_00004 | RUNNING    |                 |            2 |   16 |   16 | 0.00125119  |         |            |                      |
    | DEFAULT_f7c38_00007 | RUNNING    | 172.17.0.2:1494 |            8 |  256 |    8 | 0.00193744  | 1.62436 |     0.3846 |                    1 |
    | DEFAULT_f7c38_00008 | RUNNING    | 172.17.0.2:1497 |           16 |  256 |   32 | 0.00285209  | 1.34351 |     0.5219 |                    2 |
    | DEFAULT_f7c38_00009 | RUNNING    |                 |            2 |   16 |    8 | 0.0174651   |         |            |                      |
    | DEFAULT_f7c38_00002 | TERMINATED |                 |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00005 | TERMINATED |                 |            8 |   64 |   32 | 0.046222    | 2.31335 |     0.1008 |                    1 |
    | DEFAULT_f7c38_00006 | TERMINATED |                 |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1510)[0m [1, 14000] loss: 0.233
    Result for DEFAULT_f7c38_00008:
      accuracy: 0.5583
      date: 2021-02-26_19-30-57
      done: false
      experiment_id: 718ccef3a34c4b79b9024f35806e7445
      experiment_tag: 8_batch_size=16,l1=256,l2=32,lr=0.0028521
      hostname: c7646e93ec41
      iterations_since_restore: 3
      loss: 1.2585407758712768
      node_ip: 172.17.0.2
      pid: 1497
      should_checkpoint: true
      time_since_restore: 76.89561414718628
      time_this_iter_s: 23.136691093444824
      time_total_s: 76.89561414718628
      timestamp: 1614367857
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: f7c38_00008
  
    == Status ==
    Memory usage on this node: 7.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=3
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.3475704646110533 | Iter 1.000: -1.6243644812583924
    Resources requested: 14/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (7 RUNNING, 3 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00000 | RUNNING    | 172.17.0.2:1503 |           16 |   32 |   32 | 0.00907818  | 1.35272 |     0.5243 |                    3 |
    | DEFAULT_f7c38_00001 | RUNNING    | 172.17.0.2:1493 |            8 |  128 |   16 | 0.00388351  | 1.48417 |     0.4611 |                    1 |
    | DEFAULT_f7c38_00003 | RUNNING    |                 |            2 |   32 |    8 | 0.0219628   |         |            |                      |
    | DEFAULT_f7c38_00004 | RUNNING    |                 |            2 |   16 |   16 | 0.00125119  |         |            |                      |
    | DEFAULT_f7c38_00007 | RUNNING    | 172.17.0.2:1494 |            8 |  256 |    8 | 0.00193744  | 1.62436 |     0.3846 |                    1 |
    | DEFAULT_f7c38_00008 | RUNNING    | 172.17.0.2:1497 |           16 |  256 |   32 | 0.00285209  | 1.25854 |     0.5583 |                    3 |
    | DEFAULT_f7c38_00009 | RUNNING    |                 |            2 |   16 |    8 | 0.0174651   |         |            |                      |
    | DEFAULT_f7c38_00002 | TERMINATED |                 |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00005 | TERMINATED |                 |            8 |   64 |   32 | 0.046222    | 2.31335 |     0.1008 |                    1 |
    | DEFAULT_f7c38_00006 | TERMINATED |                 |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1507)[0m [1, 14000] loss: 0.332
    Result for DEFAULT_f7c38_00001:
      accuracy: 0.5205
      date: 2021-02-26_19-30-59
      done: false
      experiment_id: cb88ccedf50c4d419ffdbee9c629db71
      experiment_tag: 1_batch_size=8,l1=128,l2=16,lr=0.0038835
      hostname: c7646e93ec41
      iterations_since_restore: 2
      loss: 1.3460959777116777
      node_ip: 172.17.0.2
      pid: 1493
      should_checkpoint: true
      time_since_restore: 78.93657732009888
      time_this_iter_s: 35.68076419830322
      time_total_s: 78.93657732009888
      timestamp: 1614367859
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: f7c38_00001
  
    [2m[36m(pid=1500)[0m [1, 14000] loss: 0.332
    Result for DEFAULT_f7c38_00007:
      accuracy: 0.496
      date: 2021-02-26_19-31-01
      done: true
      experiment_id: 8d69b5ddd87644a183982631ab6669d3
      experiment_tag: 7_batch_size=8,l1=256,l2=8,lr=0.0019374
      hostname: c7646e93ec41
      iterations_since_restore: 2
      loss: 1.3683236353635788
      node_ip: 172.17.0.2
      pid: 1494
      should_checkpoint: true
      time_since_restore: 81.38576197624207
      time_this_iter_s: 36.79850125312805
      time_total_s: 81.38576197624207
      timestamp: 1614367861
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: f7c38_00007
  
    [2m[36m(pid=1510)[0m [1, 16000] loss: 0.201
    [2m[36m(pid=1503)[0m [4,  2000] loss: 1.296
    [2m[36m(pid=1507)[0m [1, 16000] loss: 0.290
    [2m[36m(pid=1500)[0m [1, 16000] loss: 0.291
    [2m[36m(pid=1493)[0m [3,  2000] loss: 1.295
    [2m[36m(pid=1497)[0m [4,  2000] loss: 1.171
    Result for DEFAULT_f7c38_00000:
      accuracy: 0.525
      date: 2021-02-26_19-31-13
      done: false
      experiment_id: d9f27abb205d4a77acf553a45e087a0f
      experiment_tag: 0_batch_size=16,l1=32,l2=32,lr=0.0090782
      hostname: c7646e93ec41
      iterations_since_restore: 4
      loss: 1.4032314581871033
      node_ip: 172.17.0.2
      pid: 1503
      should_checkpoint: true
      time_since_restore: 93.05310845375061
      time_this_iter_s: 21.461642503738403
      time_total_s: 93.05310845375061
      timestamp: 1614367873
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: f7c38_00000
  
    == Status ==
    Memory usage on this node: 7.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=4
    Bracket: Iter 8.000: None | Iter 4.000: -1.4032314581871033 | Iter 2.000: -1.348865560591221 | Iter 1.000: -1.6243644812583924
    Resources requested: 12/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00000 | RUNNING    | 172.17.0.2:1503 |           16 |   32 |   32 | 0.00907818  | 1.40323 |     0.525  |                    4 |
    | DEFAULT_f7c38_00001 | RUNNING    | 172.17.0.2:1493 |            8 |  128 |   16 | 0.00388351  | 1.3461  |     0.5205 |                    2 |
    | DEFAULT_f7c38_00003 | RUNNING    |                 |            2 |   32 |    8 | 0.0219628   |         |            |                      |
    | DEFAULT_f7c38_00004 | RUNNING    |                 |            2 |   16 |   16 | 0.00125119  |         |            |                      |
    | DEFAULT_f7c38_00008 | RUNNING    | 172.17.0.2:1497 |           16 |  256 |   32 | 0.00285209  | 1.25854 |     0.5583 |                    3 |
    | DEFAULT_f7c38_00009 | RUNNING    |                 |            2 |   16 |    8 | 0.0174651   |         |            |                      |
    | DEFAULT_f7c38_00002 | TERMINATED |                 |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00005 | TERMINATED |                 |            8 |   64 |   32 | 0.046222    | 2.31335 |     0.1008 |                    1 |
    | DEFAULT_f7c38_00006 | TERMINATED |                 |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    | DEFAULT_f7c38_00007 | TERMINATED |                 |            8 |  256 |    8 | 0.00193744  | 1.36832 |     0.496  |                    2 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1510)[0m [1, 18000] loss: 0.179
    [2m[36m(pid=1507)[0m [1, 18000] loss: 0.258
    Result for DEFAULT_f7c38_00008:
      accuracy: 0.5605
      date: 2021-02-26_19-31-19
      done: false
      experiment_id: 718ccef3a34c4b79b9024f35806e7445
      experiment_tag: 8_batch_size=16,l1=256,l2=32,lr=0.0028521
      hostname: c7646e93ec41
      iterations_since_restore: 4
      loss: 1.2706965040683746
      node_ip: 172.17.0.2
      pid: 1497
      should_checkpoint: true
      time_since_restore: 99.38015484809875
      time_this_iter_s: 22.484540700912476
      time_total_s: 99.38015484809875
      timestamp: 1614367879
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: f7c38_00008
  
    == Status ==
    Memory usage on this node: 7.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=4
    Bracket: Iter 8.000: None | Iter 4.000: -1.336963981127739 | Iter 2.000: -1.348865560591221 | Iter 1.000: -1.6243644812583924
    Resources requested: 12/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00000 | RUNNING    | 172.17.0.2:1503 |           16 |   32 |   32 | 0.00907818  | 1.40323 |     0.525  |                    4 |
    | DEFAULT_f7c38_00001 | RUNNING    | 172.17.0.2:1493 |            8 |  128 |   16 | 0.00388351  | 1.3461  |     0.5205 |                    2 |
    | DEFAULT_f7c38_00003 | RUNNING    |                 |            2 |   32 |    8 | 0.0219628   |         |            |                      |
    | DEFAULT_f7c38_00004 | RUNNING    |                 |            2 |   16 |   16 | 0.00125119  |         |            |                      |
    | DEFAULT_f7c38_00008 | RUNNING    | 172.17.0.2:1497 |           16 |  256 |   32 | 0.00285209  | 1.2707  |     0.5605 |                    4 |
    | DEFAULT_f7c38_00009 | RUNNING    |                 |            2 |   16 |    8 | 0.0174651   |         |            |                      |
    | DEFAULT_f7c38_00002 | TERMINATED |                 |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00005 | TERMINATED |                 |            8 |   64 |   32 | 0.046222    | 2.31335 |     0.1008 |                    1 |
    | DEFAULT_f7c38_00006 | TERMINATED |                 |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    | DEFAULT_f7c38_00007 | TERMINATED |                 |            8 |  256 |    8 | 0.00193744  | 1.36832 |     0.496  |                    2 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1500)[0m [1, 18000] loss: 0.259
    [2m[36m(pid=1493)[0m [3,  4000] loss: 0.650
    [2m[36m(pid=1510)[0m [1, 20000] loss: 0.158
    [2m[36m(pid=1507)[0m [1, 20000] loss: 0.232
    [2m[36m(pid=1503)[0m [5,  2000] loss: 1.266
    [2m[36m(pid=1500)[0m [1, 20000] loss: 0.232
    Result for DEFAULT_f7c38_00001:
      accuracy: 0.5403
      date: 2021-02-26_19-31-45
      done: false
      experiment_id: cb88ccedf50c4d419ffdbee9c629db71
      experiment_tag: 1_batch_size=8,l1=128,l2=16,lr=0.0038835
      hostname: c7646e93ec41
      iterations_since_restore: 3
      loss: 1.3079756083846092
      node_ip: 172.17.0.2
      pid: 1493
      should_checkpoint: true
      time_since_restore: 124.93921065330505
      time_this_iter_s: 46.00263333320618
      time_total_s: 124.93921065330505
      timestamp: 1614367905
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: f7c38_00001
  
    == Status ==
    Memory usage on this node: 7.0/240.1 GiB
    Using AsyncHyperBand: num_stopped=4
    Bracket: Iter 8.000: None | Iter 4.000: -1.336963981127739 | Iter 2.000: -1.348865560591221 | Iter 1.000: -1.6243644812583924
    Resources requested: 12/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00000 | RUNNING    | 172.17.0.2:1503 |           16 |   32 |   32 | 0.00907818  | 1.40323 |     0.525  |                    4 |
    | DEFAULT_f7c38_00001 | RUNNING    | 172.17.0.2:1493 |            8 |  128 |   16 | 0.00388351  | 1.30798 |     0.5403 |                    3 |
    | DEFAULT_f7c38_00003 | RUNNING    |                 |            2 |   32 |    8 | 0.0219628   |         |            |                      |
    | DEFAULT_f7c38_00004 | RUNNING    |                 |            2 |   16 |   16 | 0.00125119  |         |            |                      |
    | DEFAULT_f7c38_00008 | RUNNING    | 172.17.0.2:1497 |           16 |  256 |   32 | 0.00285209  | 1.2707  |     0.5605 |                    4 |
    | DEFAULT_f7c38_00009 | RUNNING    |                 |            2 |   16 |    8 | 0.0174651   |         |            |                      |
    | DEFAULT_f7c38_00002 | TERMINATED |                 |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00005 | TERMINATED |                 |            8 |   64 |   32 | 0.046222    | 2.31335 |     0.1008 |                    1 |
    | DEFAULT_f7c38_00006 | TERMINATED |                 |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    | DEFAULT_f7c38_00007 | TERMINATED |                 |            8 |  256 |    8 | 0.00193744  | 1.36832 |     0.496  |                    2 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_f7c38_00000:
      accuracy: 0.5248
      date: 2021-02-26_19-31-45
      done: false
      experiment_id: d9f27abb205d4a77acf553a45e087a0f
      experiment_tag: 0_batch_size=16,l1=32,l2=32,lr=0.0090782
      hostname: c7646e93ec41
      iterations_since_restore: 5
      loss: 1.3441760416030883
      node_ip: 172.17.0.2
      pid: 1503
      should_checkpoint: true
      time_since_restore: 125.33234405517578
      time_this_iter_s: 32.27923560142517
      time_total_s: 125.33234405517578
      timestamp: 1614367905
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: f7c38_00000
  
    [2m[36m(pid=1497)[0m [5,  2000] loss: 1.087
    Result for DEFAULT_f7c38_00004:
      accuracy: 0.365
      date: 2021-02-26_19-31-49
      done: true
      experiment_id: ec1568f16c22486f8cee067731a8bf62
      experiment_tag: 4_batch_size=2,l1=16,l2=16,lr=0.0012512
      hostname: c7646e93ec41
      iterations_since_restore: 1
      loss: 1.721688775152713
      node_ip: 172.17.0.2
      pid: 1510
      should_checkpoint: true
      time_since_restore: 128.50242400169373
      time_this_iter_s: 128.50242400169373
      time_total_s: 128.50242400169373
      timestamp: 1614367909
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: f7c38_00004
  
    Result for DEFAULT_f7c38_00009:
      accuracy: 0.0987
      date: 2021-02-26_19-31-52
      done: true
      experiment_id: 04ce630f93d748e2b3ef256342fae953
      experiment_tag: 9_batch_size=2,l1=16,l2=8,lr=0.017465
      hostname: c7646e93ec41
      iterations_since_restore: 1
      loss: 2.3368918051719665
      node_ip: 172.17.0.2
      pid: 1507
      should_checkpoint: true
      time_since_restore: 131.79548835754395
      time_this_iter_s: 131.79548835754395
      time_total_s: 131.79548835754395
      timestamp: 1614367912
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: f7c38_00009
  
    == Status ==
    Memory usage on this node: 6.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: None | Iter 4.000: -1.336963981127739 | Iter 2.000: -1.348865560591221 | Iter 1.000: -1.721688775152713
    Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00000 | RUNNING    | 172.17.0.2:1503 |           16 |   32 |   32 | 0.00907818  | 1.34418 |     0.5248 |                    5 |
    | DEFAULT_f7c38_00001 | RUNNING    | 172.17.0.2:1493 |            8 |  128 |   16 | 0.00388351  | 1.30798 |     0.5403 |                    3 |
    | DEFAULT_f7c38_00003 | RUNNING    |                 |            2 |   32 |    8 | 0.0219628   |         |            |                      |
    | DEFAULT_f7c38_00008 | RUNNING    | 172.17.0.2:1497 |           16 |  256 |   32 | 0.00285209  | 1.2707  |     0.5605 |                    4 |
    | DEFAULT_f7c38_00009 | RUNNING    | 172.17.0.2:1507 |            2 |   16 |    8 | 0.0174651   | 2.33689 |     0.0987 |                    1 |
    | DEFAULT_f7c38_00002 | TERMINATED |                 |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00004 | TERMINATED |                 |            2 |   16 |   16 | 0.00125119  | 1.72169 |     0.365  |                    1 |
    | DEFAULT_f7c38_00005 | TERMINATED |                 |            8 |   64 |   32 | 0.046222    | 2.31335 |     0.1008 |                    1 |
    | DEFAULT_f7c38_00006 | TERMINATED |                 |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    | DEFAULT_f7c38_00007 | TERMINATED |                 |            8 |  256 |    8 | 0.00193744  | 1.36832 |     0.496  |                    2 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_f7c38_00008:
      accuracy: 0.5989
      date: 2021-02-26_19-31-53
      done: false
      experiment_id: 718ccef3a34c4b79b9024f35806e7445
      experiment_tag: 8_batch_size=16,l1=256,l2=32,lr=0.0028521
      hostname: c7646e93ec41
      iterations_since_restore: 5
      loss: 1.1758384785175324
      node_ip: 172.17.0.2
      pid: 1497
      should_checkpoint: true
      time_since_restore: 133.19252038002014
      time_this_iter_s: 33.81236553192139
      time_total_s: 133.19252038002014
      timestamp: 1614367913
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: f7c38_00008
  
    Result for DEFAULT_f7c38_00003:
      accuracy: 0.0967
      date: 2021-02-26_19-31-54
      done: true
      experiment_id: efcb46ad01a14a4ca310f9c71db5c24f
      experiment_tag: 3_batch_size=2,l1=32,l2=8,lr=0.021963
      hostname: c7646e93ec41
      iterations_since_restore: 1
      loss: 2.3475418260335923
      node_ip: 172.17.0.2
      pid: 1500
      should_checkpoint: true
      time_since_restore: 133.82510375976562
      time_this_iter_s: 133.82510375976562
      time_total_s: 133.82510375976562
      timestamp: 1614367914
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: f7c38_00003
  
    [2m[36m(pid=1493)[0m [4,  2000] loss: 1.216
    [2m[36m(pid=1503)[0m [6,  2000] loss: 1.243
    Result for DEFAULT_f7c38_00000:
      accuracy: 0.5449
      date: 2021-02-26_19-32-06
      done: false
      experiment_id: d9f27abb205d4a77acf553a45e087a0f
      experiment_tag: 0_batch_size=16,l1=32,l2=32,lr=0.0090782
      hostname: c7646e93ec41
      iterations_since_restore: 6
      loss: 1.3448781977653503
      node_ip: 172.17.0.2
      pid: 1503
      should_checkpoint: true
      time_since_restore: 145.60769748687744
      time_this_iter_s: 20.27535343170166
      time_total_s: 145.60769748687744
      timestamp: 1614367926
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: f7c38_00000
  
    == Status ==
    Memory usage on this node: 5.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: None | Iter 4.000: -1.336963981127739 | Iter 2.000: -1.348865560591221 | Iter 1.000: -1.8464244255039841
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00000 | RUNNING    | 172.17.0.2:1503 |           16 |   32 |   32 | 0.00907818  | 1.34488 |     0.5449 |                    6 |
    | DEFAULT_f7c38_00001 | RUNNING    | 172.17.0.2:1493 |            8 |  128 |   16 | 0.00388351  | 1.30798 |     0.5403 |                    3 |
    | DEFAULT_f7c38_00008 | RUNNING    | 172.17.0.2:1497 |           16 |  256 |   32 | 0.00285209  | 1.17584 |     0.5989 |                    5 |
    | DEFAULT_f7c38_00002 | TERMINATED |                 |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00003 | TERMINATED |                 |            2 |   32 |    8 | 0.0219628   | 2.34754 |     0.0967 |                    1 |
    | DEFAULT_f7c38_00004 | TERMINATED |                 |            2 |   16 |   16 | 0.00125119  | 1.72169 |     0.365  |                    1 |
    | DEFAULT_f7c38_00005 | TERMINATED |                 |            8 |   64 |   32 | 0.046222    | 2.31335 |     0.1008 |                    1 |
    | DEFAULT_f7c38_00006 | TERMINATED |                 |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    | DEFAULT_f7c38_00007 | TERMINATED |                 |            8 |  256 |    8 | 0.00193744  | 1.36832 |     0.496  |                    2 |
    | DEFAULT_f7c38_00009 | TERMINATED |                 |            2 |   16 |    8 | 0.0174651   | 2.33689 |     0.0987 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1493)[0m [4,  4000] loss: 0.610
    [2m[36m(pid=1497)[0m [6,  2000] loss: 1.007
    Result for DEFAULT_f7c38_00008:
      accuracy: 0.6068
      date: 2021-02-26_19-32-15
      done: false
      experiment_id: 718ccef3a34c4b79b9024f35806e7445
      experiment_tag: 8_batch_size=16,l1=256,l2=32,lr=0.0028521
      hostname: c7646e93ec41
      iterations_since_restore: 6
      loss: 1.1409603202819825
      node_ip: 172.17.0.2
      pid: 1497
      should_checkpoint: true
      time_since_restore: 154.389639377594
      time_this_iter_s: 21.197118997573853
      time_total_s: 154.389639377594
      timestamp: 1614367935
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: f7c38_00008
  
    == Status ==
    Memory usage on this node: 5.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: None | Iter 4.000: -1.336963981127739 | Iter 2.000: -1.348865560591221 | Iter 1.000: -1.8464244255039841
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00000 | RUNNING    | 172.17.0.2:1503 |           16 |   32 |   32 | 0.00907818  | 1.34488 |     0.5449 |                    6 |
    | DEFAULT_f7c38_00001 | RUNNING    | 172.17.0.2:1493 |            8 |  128 |   16 | 0.00388351  | 1.30798 |     0.5403 |                    3 |
    | DEFAULT_f7c38_00008 | RUNNING    | 172.17.0.2:1497 |           16 |  256 |   32 | 0.00285209  | 1.14096 |     0.6068 |                    6 |
    | DEFAULT_f7c38_00002 | TERMINATED |                 |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00003 | TERMINATED |                 |            2 |   32 |    8 | 0.0219628   | 2.34754 |     0.0967 |                    1 |
    | DEFAULT_f7c38_00004 | TERMINATED |                 |            2 |   16 |   16 | 0.00125119  | 1.72169 |     0.365  |                    1 |
    | DEFAULT_f7c38_00005 | TERMINATED |                 |            8 |   64 |   32 | 0.046222    | 2.31335 |     0.1008 |                    1 |
    | DEFAULT_f7c38_00006 | TERMINATED |                 |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    | DEFAULT_f7c38_00007 | TERMINATED |                 |            8 |  256 |    8 | 0.00193744  | 1.36832 |     0.496  |                    2 |
    | DEFAULT_f7c38_00009 | TERMINATED |                 |            2 |   16 |    8 | 0.0174651   | 2.33689 |     0.0987 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_f7c38_00001:
      accuracy: 0.5546
      date: 2021-02-26_19-32-18
      done: false
      experiment_id: cb88ccedf50c4d419ffdbee9c629db71
      experiment_tag: 1_batch_size=8,l1=128,l2=16,lr=0.0038835
      hostname: c7646e93ec41
      iterations_since_restore: 4
      loss: 1.2923115787744521
      node_ip: 172.17.0.2
      pid: 1493
      should_checkpoint: true
      time_since_restore: 157.71276712417603
      time_this_iter_s: 32.77355647087097
      time_total_s: 157.71276712417603
      timestamp: 1614367938
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: f7c38_00001
  
    [2m[36m(pid=1503)[0m [7,  2000] loss: 1.227
    Result for DEFAULT_f7c38_00000:
      accuracy: 0.5283
      date: 2021-02-26_19-32-26
      done: false
      experiment_id: d9f27abb205d4a77acf553a45e087a0f
      experiment_tag: 0_batch_size=16,l1=32,l2=32,lr=0.0090782
      hostname: c7646e93ec41
      iterations_since_restore: 7
      loss: 1.3853388003349305
      node_ip: 172.17.0.2
      pid: 1503
      should_checkpoint: true
      time_since_restore: 165.55629420280457
      time_this_iter_s: 19.948596715927124
      time_total_s: 165.55629420280457
      timestamp: 1614367946
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: f7c38_00000
  
    == Status ==
    Memory usage on this node: 5.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: None | Iter 4.000: -1.2923115787744521 | Iter 2.000: -1.348865560591221 | Iter 1.000: -1.8464244255039841
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00000 | RUNNING    | 172.17.0.2:1503 |           16 |   32 |   32 | 0.00907818  | 1.38534 |     0.5283 |                    7 |
    | DEFAULT_f7c38_00001 | RUNNING    | 172.17.0.2:1493 |            8 |  128 |   16 | 0.00388351  | 1.29231 |     0.5546 |                    4 |
    | DEFAULT_f7c38_00008 | RUNNING    | 172.17.0.2:1497 |           16 |  256 |   32 | 0.00285209  | 1.14096 |     0.6068 |                    6 |
    | DEFAULT_f7c38_00002 | TERMINATED |                 |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00003 | TERMINATED |                 |            2 |   32 |    8 | 0.0219628   | 2.34754 |     0.0967 |                    1 |
    | DEFAULT_f7c38_00004 | TERMINATED |                 |            2 |   16 |   16 | 0.00125119  | 1.72169 |     0.365  |                    1 |
    | DEFAULT_f7c38_00005 | TERMINATED |                 |            8 |   64 |   32 | 0.046222    | 2.31335 |     0.1008 |                    1 |
    | DEFAULT_f7c38_00006 | TERMINATED |                 |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    | DEFAULT_f7c38_00007 | TERMINATED |                 |            8 |  256 |    8 | 0.00193744  | 1.36832 |     0.496  |                    2 |
    | DEFAULT_f7c38_00009 | TERMINATED |                 |            2 |   16 |    8 | 0.0174651   | 2.33689 |     0.0987 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1493)[0m [5,  2000] loss: 1.128
    [2m[36m(pid=1497)[0m [7,  2000] loss: 0.943
    Result for DEFAULT_f7c38_00008:
      accuracy: 0.6165
      date: 2021-02-26_19-32-36
      done: false
      experiment_id: 718ccef3a34c4b79b9024f35806e7445
      experiment_tag: 8_batch_size=16,l1=256,l2=32,lr=0.0028521
      hostname: c7646e93ec41
      iterations_since_restore: 7
      loss: 1.1333352941513062
      node_ip: 172.17.0.2
      pid: 1497
      should_checkpoint: true
      time_since_restore: 175.4852170944214
      time_this_iter_s: 21.095577716827393
      time_total_s: 175.4852170944214
      timestamp: 1614367956
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: f7c38_00008
  
    == Status ==
    Memory usage on this node: 5.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: None | Iter 4.000: -1.2923115787744521 | Iter 2.000: -1.348865560591221 | Iter 1.000: -1.8464244255039841
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00000 | RUNNING    | 172.17.0.2:1503 |           16 |   32 |   32 | 0.00907818  | 1.38534 |     0.5283 |                    7 |
    | DEFAULT_f7c38_00001 | RUNNING    | 172.17.0.2:1493 |            8 |  128 |   16 | 0.00388351  | 1.29231 |     0.5546 |                    4 |
    | DEFAULT_f7c38_00008 | RUNNING    | 172.17.0.2:1497 |           16 |  256 |   32 | 0.00285209  | 1.13334 |     0.6165 |                    7 |
    | DEFAULT_f7c38_00002 | TERMINATED |                 |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00003 | TERMINATED |                 |            2 |   32 |    8 | 0.0219628   | 2.34754 |     0.0967 |                    1 |
    | DEFAULT_f7c38_00004 | TERMINATED |                 |            2 |   16 |   16 | 0.00125119  | 1.72169 |     0.365  |                    1 |
    | DEFAULT_f7c38_00005 | TERMINATED |                 |            8 |   64 |   32 | 0.046222    | 2.31335 |     0.1008 |                    1 |
    | DEFAULT_f7c38_00006 | TERMINATED |                 |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    | DEFAULT_f7c38_00007 | TERMINATED |                 |            8 |  256 |    8 | 0.00193744  | 1.36832 |     0.496  |                    2 |
    | DEFAULT_f7c38_00009 | TERMINATED |                 |            2 |   16 |    8 | 0.0174651   | 2.33689 |     0.0987 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1503)[0m [8,  2000] loss: 1.221
    [2m[36m(pid=1493)[0m [5,  4000] loss: 0.581
    Result for DEFAULT_f7c38_00000:
      accuracy: 0.5394
      date: 2021-02-26_19-32-45
      done: false
      experiment_id: d9f27abb205d4a77acf553a45e087a0f
      experiment_tag: 0_batch_size=16,l1=32,l2=32,lr=0.0090782
      hostname: c7646e93ec41
      iterations_since_restore: 8
      loss: 1.334604852771759
      node_ip: 172.17.0.2
      pid: 1503
      should_checkpoint: true
      time_since_restore: 185.31374073028564
      time_this_iter_s: 19.75744652748108
      time_total_s: 185.31374073028564
      timestamp: 1614367965
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: f7c38_00000
  
    == Status ==
    Memory usage on this node: 5.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: -1.334604852771759 | Iter 4.000: -1.2923115787744521 | Iter 2.000: -1.348865560591221 | Iter 1.000: -1.8464244255039841
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00000 | RUNNING    | 172.17.0.2:1503 |           16 |   32 |   32 | 0.00907818  | 1.3346  |     0.5394 |                    8 |
    | DEFAULT_f7c38_00001 | RUNNING    | 172.17.0.2:1493 |            8 |  128 |   16 | 0.00388351  | 1.29231 |     0.5546 |                    4 |
    | DEFAULT_f7c38_00008 | RUNNING    | 172.17.0.2:1497 |           16 |  256 |   32 | 0.00285209  | 1.13334 |     0.6165 |                    7 |
    | DEFAULT_f7c38_00002 | TERMINATED |                 |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00003 | TERMINATED |                 |            2 |   32 |    8 | 0.0219628   | 2.34754 |     0.0967 |                    1 |
    | DEFAULT_f7c38_00004 | TERMINATED |                 |            2 |   16 |   16 | 0.00125119  | 1.72169 |     0.365  |                    1 |
    | DEFAULT_f7c38_00005 | TERMINATED |                 |            8 |   64 |   32 | 0.046222    | 2.31335 |     0.1008 |                    1 |
    | DEFAULT_f7c38_00006 | TERMINATED |                 |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    | DEFAULT_f7c38_00007 | TERMINATED |                 |            8 |  256 |    8 | 0.00193744  | 1.36832 |     0.496  |                    2 |
    | DEFAULT_f7c38_00009 | TERMINATED |                 |            2 |   16 |    8 | 0.0174651   | 2.33689 |     0.0987 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_f7c38_00001:
      accuracy: 0.5654
      date: 2021-02-26_19-32-50
      done: false
      experiment_id: cb88ccedf50c4d419ffdbee9c629db71
      experiment_tag: 1_batch_size=8,l1=128,l2=16,lr=0.0038835
      hostname: c7646e93ec41
      iterations_since_restore: 5
      loss: 1.2404598366260529
      node_ip: 172.17.0.2
      pid: 1493
      should_checkpoint: true
      time_since_restore: 190.4368712902069
      time_this_iter_s: 32.724104166030884
      time_total_s: 190.4368712902069
      timestamp: 1614367970
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: f7c38_00001
  
    == Status ==
    Memory usage on this node: 5.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: -1.334604852771759 | Iter 4.000: -1.2923115787744521 | Iter 2.000: -1.348865560591221 | Iter 1.000: -1.8464244255039841
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00000 | RUNNING    | 172.17.0.2:1503 |           16 |   32 |   32 | 0.00907818  | 1.3346  |     0.5394 |                    8 |
    | DEFAULT_f7c38_00001 | RUNNING    | 172.17.0.2:1493 |            8 |  128 |   16 | 0.00388351  | 1.24046 |     0.5654 |                    5 |
    | DEFAULT_f7c38_00008 | RUNNING    | 172.17.0.2:1497 |           16 |  256 |   32 | 0.00285209  | 1.13334 |     0.6165 |                    7 |
    | DEFAULT_f7c38_00002 | TERMINATED |                 |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00003 | TERMINATED |                 |            2 |   32 |    8 | 0.0219628   | 2.34754 |     0.0967 |                    1 |
    | DEFAULT_f7c38_00004 | TERMINATED |                 |            2 |   16 |   16 | 0.00125119  | 1.72169 |     0.365  |                    1 |
    | DEFAULT_f7c38_00005 | TERMINATED |                 |            8 |   64 |   32 | 0.046222    | 2.31335 |     0.1008 |                    1 |
    | DEFAULT_f7c38_00006 | TERMINATED |                 |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    | DEFAULT_f7c38_00007 | TERMINATED |                 |            8 |  256 |    8 | 0.00193744  | 1.36832 |     0.496  |                    2 |
    | DEFAULT_f7c38_00009 | TERMINATED |                 |            2 |   16 |    8 | 0.0174651   | 2.33689 |     0.0987 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1497)[0m [8,  2000] loss: 0.879
    Result for DEFAULT_f7c38_00008:
      accuracy: 0.6251
      date: 2021-02-26_19-32-57
      done: false
      experiment_id: 718ccef3a34c4b79b9024f35806e7445
      experiment_tag: 8_batch_size=16,l1=256,l2=32,lr=0.0028521
      hostname: c7646e93ec41
      iterations_since_restore: 8
      loss: 1.1066461347579957
      node_ip: 172.17.0.2
      pid: 1497
      should_checkpoint: true
      time_since_restore: 196.60511660575867
      time_this_iter_s: 21.11989951133728
      time_total_s: 196.60511660575867
      timestamp: 1614367977
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: f7c38_00008
  
    == Status ==
    Memory usage on this node: 5.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: -1.2206254937648775 | Iter 4.000: -1.2923115787744521 | Iter 2.000: -1.348865560591221 | Iter 1.000: -1.8464244255039841
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00000 | RUNNING    | 172.17.0.2:1503 |           16 |   32 |   32 | 0.00907818  | 1.3346  |     0.5394 |                    8 |
    | DEFAULT_f7c38_00001 | RUNNING    | 172.17.0.2:1493 |            8 |  128 |   16 | 0.00388351  | 1.24046 |     0.5654 |                    5 |
    | DEFAULT_f7c38_00008 | RUNNING    | 172.17.0.2:1497 |           16 |  256 |   32 | 0.00285209  | 1.10665 |     0.6251 |                    8 |
    | DEFAULT_f7c38_00002 | TERMINATED |                 |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00003 | TERMINATED |                 |            2 |   32 |    8 | 0.0219628   | 2.34754 |     0.0967 |                    1 |
    | DEFAULT_f7c38_00004 | TERMINATED |                 |            2 |   16 |   16 | 0.00125119  | 1.72169 |     0.365  |                    1 |
    | DEFAULT_f7c38_00005 | TERMINATED |                 |            8 |   64 |   32 | 0.046222    | 2.31335 |     0.1008 |                    1 |
    | DEFAULT_f7c38_00006 | TERMINATED |                 |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    | DEFAULT_f7c38_00007 | TERMINATED |                 |            8 |  256 |    8 | 0.00193744  | 1.36832 |     0.496  |                    2 |
    | DEFAULT_f7c38_00009 | TERMINATED |                 |            2 |   16 |    8 | 0.0174651   | 2.33689 |     0.0987 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1503)[0m [9,  2000] loss: 1.217
    [2m[36m(pid=1493)[0m [6,  2000] loss: 1.090
    Result for DEFAULT_f7c38_00000:
      accuracy: 0.5318
      date: 2021-02-26_19-33-05
      done: false
      experiment_id: d9f27abb205d4a77acf553a45e087a0f
      experiment_tag: 0_batch_size=16,l1=32,l2=32,lr=0.0090782
      hostname: c7646e93ec41
      iterations_since_restore: 9
      loss: 1.3411521487236022
      node_ip: 172.17.0.2
      pid: 1503
      should_checkpoint: true
      time_since_restore: 205.12128233909607
      time_this_iter_s: 19.807541608810425
      time_total_s: 205.12128233909607
      timestamp: 1614367985
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: f7c38_00000
  
    == Status ==
    Memory usage on this node: 5.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: -1.2206254937648775 | Iter 4.000: -1.2923115787744521 | Iter 2.000: -1.348865560591221 | Iter 1.000: -1.8464244255039841
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00000 | RUNNING    | 172.17.0.2:1503 |           16 |   32 |   32 | 0.00907818  | 1.34115 |     0.5318 |                    9 |
    | DEFAULT_f7c38_00001 | RUNNING    | 172.17.0.2:1493 |            8 |  128 |   16 | 0.00388351  | 1.24046 |     0.5654 |                    5 |
    | DEFAULT_f7c38_00008 | RUNNING    | 172.17.0.2:1497 |           16 |  256 |   32 | 0.00285209  | 1.10665 |     0.6251 |                    8 |
    | DEFAULT_f7c38_00002 | TERMINATED |                 |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00003 | TERMINATED |                 |            2 |   32 |    8 | 0.0219628   | 2.34754 |     0.0967 |                    1 |
    | DEFAULT_f7c38_00004 | TERMINATED |                 |            2 |   16 |   16 | 0.00125119  | 1.72169 |     0.365  |                    1 |
    | DEFAULT_f7c38_00005 | TERMINATED |                 |            8 |   64 |   32 | 0.046222    | 2.31335 |     0.1008 |                    1 |
    | DEFAULT_f7c38_00006 | TERMINATED |                 |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    | DEFAULT_f7c38_00007 | TERMINATED |                 |            8 |  256 |    8 | 0.00193744  | 1.36832 |     0.496  |                    2 |
    | DEFAULT_f7c38_00009 | TERMINATED |                 |            2 |   16 |    8 | 0.0174651   | 2.33689 |     0.0987 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1497)[0m [9,  2000] loss: 0.810
    [2m[36m(pid=1493)[0m [6,  4000] loss: 0.551
    Result for DEFAULT_f7c38_00008:
      accuracy: 0.6032
      date: 2021-02-26_19-33-18
      done: false
      experiment_id: 718ccef3a34c4b79b9024f35806e7445
      experiment_tag: 8_batch_size=16,l1=256,l2=32,lr=0.0028521
      hostname: c7646e93ec41
      iterations_since_restore: 9
      loss: 1.1900930685043336
      node_ip: 172.17.0.2
      pid: 1497
      should_checkpoint: true
      time_since_restore: 217.61572265625
      time_this_iter_s: 21.010606050491333
      time_total_s: 217.61572265625
      timestamp: 1614367998
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: f7c38_00008
  
    == Status ==
    Memory usage on this node: 5.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: -1.2206254937648775 | Iter 4.000: -1.2923115787744521 | Iter 2.000: -1.348865560591221 | Iter 1.000: -1.8464244255039841
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00000 | RUNNING    | 172.17.0.2:1503 |           16 |   32 |   32 | 0.00907818  | 1.34115 |     0.5318 |                    9 |
    | DEFAULT_f7c38_00001 | RUNNING    | 172.17.0.2:1493 |            8 |  128 |   16 | 0.00388351  | 1.24046 |     0.5654 |                    5 |
    | DEFAULT_f7c38_00008 | RUNNING    | 172.17.0.2:1497 |           16 |  256 |   32 | 0.00285209  | 1.19009 |     0.6032 |                    9 |
    | DEFAULT_f7c38_00002 | TERMINATED |                 |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00003 | TERMINATED |                 |            2 |   32 |    8 | 0.0219628   | 2.34754 |     0.0967 |                    1 |
    | DEFAULT_f7c38_00004 | TERMINATED |                 |            2 |   16 |   16 | 0.00125119  | 1.72169 |     0.365  |                    1 |
    | DEFAULT_f7c38_00005 | TERMINATED |                 |            8 |   64 |   32 | 0.046222    | 2.31335 |     0.1008 |                    1 |
    | DEFAULT_f7c38_00006 | TERMINATED |                 |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    | DEFAULT_f7c38_00007 | TERMINATED |                 |            8 |  256 |    8 | 0.00193744  | 1.36832 |     0.496  |                    2 |
    | DEFAULT_f7c38_00009 | TERMINATED |                 |            2 |   16 |    8 | 0.0174651   | 2.33689 |     0.0987 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1503)[0m [10,  2000] loss: 1.217
    Result for DEFAULT_f7c38_00001:
      accuracy: 0.5796
      date: 2021-02-26_19-33-23
      done: false
      experiment_id: cb88ccedf50c4d419ffdbee9c629db71
      experiment_tag: 1_batch_size=8,l1=128,l2=16,lr=0.0038835
      hostname: c7646e93ec41
      iterations_since_restore: 6
      loss: 1.230583655691147
      node_ip: 172.17.0.2
      pid: 1493
      should_checkpoint: true
      time_since_restore: 222.99194979667664
      time_this_iter_s: 32.55507850646973
      time_total_s: 222.99194979667664
      timestamp: 1614368003
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: f7c38_00001
  
    == Status ==
    Memory usage on this node: 5.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: -1.2206254937648775 | Iter 4.000: -1.2923115787744521 | Iter 2.000: -1.348865560591221 | Iter 1.000: -1.8464244255039841
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00000 | RUNNING    | 172.17.0.2:1503 |           16 |   32 |   32 | 0.00907818  | 1.34115 |     0.5318 |                    9 |
    | DEFAULT_f7c38_00001 | RUNNING    | 172.17.0.2:1493 |            8 |  128 |   16 | 0.00388351  | 1.23058 |     0.5796 |                    6 |
    | DEFAULT_f7c38_00008 | RUNNING    | 172.17.0.2:1497 |           16 |  256 |   32 | 0.00285209  | 1.19009 |     0.6032 |                    9 |
    | DEFAULT_f7c38_00002 | TERMINATED |                 |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00003 | TERMINATED |                 |            2 |   32 |    8 | 0.0219628   | 2.34754 |     0.0967 |                    1 |
    | DEFAULT_f7c38_00004 | TERMINATED |                 |            2 |   16 |   16 | 0.00125119  | 1.72169 |     0.365  |                    1 |
    | DEFAULT_f7c38_00005 | TERMINATED |                 |            8 |   64 |   32 | 0.046222    | 2.31335 |     0.1008 |                    1 |
    | DEFAULT_f7c38_00006 | TERMINATED |                 |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    | DEFAULT_f7c38_00007 | TERMINATED |                 |            8 |  256 |    8 | 0.00193744  | 1.36832 |     0.496  |                    2 |
    | DEFAULT_f7c38_00009 | TERMINATED |                 |            2 |   16 |    8 | 0.0174651   | 2.33689 |     0.0987 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_f7c38_00000:
      accuracy: 0.5406
      date: 2021-02-26_19-33-25
      done: true
      experiment_id: d9f27abb205d4a77acf553a45e087a0f
      experiment_tag: 0_batch_size=16,l1=32,l2=32,lr=0.0090782
      hostname: c7646e93ec41
      iterations_since_restore: 10
      loss: 1.369473348903656
      node_ip: 172.17.0.2
      pid: 1503
      should_checkpoint: true
      time_since_restore: 224.8058512210846
      time_this_iter_s: 19.684568881988525
      time_total_s: 224.8058512210846
      timestamp: 1614368005
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: f7c38_00000
  
    [2m[36m(pid=1497)[0m [10,  2000] loss: 0.770
    [2m[36m(pid=1493)[0m [7,  2000] loss: 1.050
    Result for DEFAULT_f7c38_00008:
      accuracy: 0.5932
      date: 2021-02-26_19-33-39
      done: true
      experiment_id: 718ccef3a34c4b79b9024f35806e7445
      experiment_tag: 8_batch_size=16,l1=256,l2=32,lr=0.0028521
      hostname: c7646e93ec41
      iterations_since_restore: 10
      loss: 1.290389664411545
      node_ip: 172.17.0.2
      pid: 1497
      should_checkpoint: true
      time_since_restore: 238.64631938934326
      time_this_iter_s: 21.03059673309326
      time_total_s: 238.64631938934326
      timestamp: 1614368019
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: f7c38_00008
  
    == Status ==
    Memory usage on this node: 4.8/240.1 GiB
    Using AsyncHyperBand: num_stopped=9
    Bracket: Iter 8.000: -1.2206254937648775 | Iter 4.000: -1.2923115787744521 | Iter 2.000: -1.348865560591221 | Iter 1.000: -1.8464244255039841
    Resources requested: 4/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00001 | RUNNING    | 172.17.0.2:1493 |            8 |  128 |   16 | 0.00388351  | 1.23058 |     0.5796 |                    6 |
    | DEFAULT_f7c38_00008 | RUNNING    | 172.17.0.2:1497 |           16 |  256 |   32 | 0.00285209  | 1.29039 |     0.5932 |                   10 |
    | DEFAULT_f7c38_00000 | TERMINATED |                 |           16 |   32 |   32 | 0.00907818  | 1.36947 |     0.5406 |                   10 |
    | DEFAULT_f7c38_00002 | TERMINATED |                 |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00003 | TERMINATED |                 |            2 |   32 |    8 | 0.0219628   | 2.34754 |     0.0967 |                    1 |
    | DEFAULT_f7c38_00004 | TERMINATED |                 |            2 |   16 |   16 | 0.00125119  | 1.72169 |     0.365  |                    1 |
    | DEFAULT_f7c38_00005 | TERMINATED |                 |            8 |   64 |   32 | 0.046222    | 2.31335 |     0.1008 |                    1 |
    | DEFAULT_f7c38_00006 | TERMINATED |                 |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    | DEFAULT_f7c38_00007 | TERMINATED |                 |            8 |  256 |    8 | 0.00193744  | 1.36832 |     0.496  |                    2 |
    | DEFAULT_f7c38_00009 | TERMINATED |                 |            2 |   16 |    8 | 0.0174651   | 2.33689 |     0.0987 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1493)[0m [7,  4000] loss: 0.533
    Result for DEFAULT_f7c38_00001:
      accuracy: 0.5852
      date: 2021-02-26_19-33-54
      done: false
      experiment_id: cb88ccedf50c4d419ffdbee9c629db71
      experiment_tag: 1_batch_size=8,l1=128,l2=16,lr=0.0038835
      hostname: c7646e93ec41
      iterations_since_restore: 7
      loss: 1.2335173476338386
      node_ip: 172.17.0.2
      pid: 1493
      should_checkpoint: true
      time_since_restore: 254.23092079162598
      time_this_iter_s: 31.23897099494934
      time_total_s: 254.23092079162598
      timestamp: 1614368034
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: f7c38_00001
  
    == Status ==
    Memory usage on this node: 4.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=9
    Bracket: Iter 8.000: -1.2206254937648775 | Iter 4.000: -1.2923115787744521 | Iter 2.000: -1.348865560591221 | Iter 1.000: -1.8464244255039841
    Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00001 | RUNNING    | 172.17.0.2:1493 |            8 |  128 |   16 | 0.00388351  | 1.23352 |     0.5852 |                    7 |
    | DEFAULT_f7c38_00000 | TERMINATED |                 |           16 |   32 |   32 | 0.00907818  | 1.36947 |     0.5406 |                   10 |
    | DEFAULT_f7c38_00002 | TERMINATED |                 |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00003 | TERMINATED |                 |            2 |   32 |    8 | 0.0219628   | 2.34754 |     0.0967 |                    1 |
    | DEFAULT_f7c38_00004 | TERMINATED |                 |            2 |   16 |   16 | 0.00125119  | 1.72169 |     0.365  |                    1 |
    | DEFAULT_f7c38_00005 | TERMINATED |                 |            8 |   64 |   32 | 0.046222    | 2.31335 |     0.1008 |                    1 |
    | DEFAULT_f7c38_00006 | TERMINATED |                 |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    | DEFAULT_f7c38_00007 | TERMINATED |                 |            8 |  256 |    8 | 0.00193744  | 1.36832 |     0.496  |                    2 |
    | DEFAULT_f7c38_00008 | TERMINATED |                 |           16 |  256 |   32 | 0.00285209  | 1.29039 |     0.5932 |                   10 |
    | DEFAULT_f7c38_00009 | TERMINATED |                 |            2 |   16 |    8 | 0.0174651   | 2.33689 |     0.0987 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1493)[0m [8,  2000] loss: 1.005
    [2m[36m(pid=1493)[0m [8,  4000] loss: 0.521
    Result for DEFAULT_f7c38_00001:
      accuracy: 0.5706
      date: 2021-02-26_19-34-25
      done: true
      experiment_id: cb88ccedf50c4d419ffdbee9c629db71
      experiment_tag: 1_batch_size=8,l1=128,l2=16,lr=0.0038835
      hostname: c7646e93ec41
      iterations_since_restore: 8
      loss: 1.3023030910253526
      node_ip: 172.17.0.2
      pid: 1493
      should_checkpoint: true
      time_since_restore: 285.0215516090393
      time_this_iter_s: 30.79063081741333
      time_total_s: 285.0215516090393
      timestamp: 1614368065
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: f7c38_00001
  
    == Status ==
    Memory usage on this node: 4.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=10
    Bracket: Iter 8.000: -1.3023030910253526 | Iter 4.000: -1.2923115787744521 | Iter 2.000: -1.348865560591221 | Iter 1.000: -1.8464244255039841
    Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00001 | RUNNING    | 172.17.0.2:1493 |            8 |  128 |   16 | 0.00388351  | 1.3023  |     0.5706 |                    8 |
    | DEFAULT_f7c38_00000 | TERMINATED |                 |           16 |   32 |   32 | 0.00907818  | 1.36947 |     0.5406 |                   10 |
    | DEFAULT_f7c38_00002 | TERMINATED |                 |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00003 | TERMINATED |                 |            2 |   32 |    8 | 0.0219628   | 2.34754 |     0.0967 |                    1 |
    | DEFAULT_f7c38_00004 | TERMINATED |                 |            2 |   16 |   16 | 0.00125119  | 1.72169 |     0.365  |                    1 |
    | DEFAULT_f7c38_00005 | TERMINATED |                 |            8 |   64 |   32 | 0.046222    | 2.31335 |     0.1008 |                    1 |
    | DEFAULT_f7c38_00006 | TERMINATED |                 |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    | DEFAULT_f7c38_00007 | TERMINATED |                 |            8 |  256 |    8 | 0.00193744  | 1.36832 |     0.496  |                    2 |
    | DEFAULT_f7c38_00008 | TERMINATED |                 |           16 |  256 |   32 | 0.00285209  | 1.29039 |     0.5932 |                   10 |
    | DEFAULT_f7c38_00009 | TERMINATED |                 |            2 |   16 |    8 | 0.0174651   | 2.33689 |     0.0987 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    == Status ==
    Memory usage on this node: 4.0/240.1 GiB
    Using AsyncHyperBand: num_stopped=10
    Bracket: Iter 8.000: -1.3023030910253526 | Iter 4.000: -1.2923115787744521 | Iter 2.000: -1.348865560591221 | Iter 1.000: -1.8464244255039841
    Resources requested: 0/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-26_19-29-39
    Number of trials: 10/10 (10 TERMINATED)
    +---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc   |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_f7c38_00000 | TERMINATED |       |           16 |   32 |   32 | 0.00907818  | 1.36947 |     0.5406 |                   10 |
    | DEFAULT_f7c38_00001 | TERMINATED |       |            8 |  128 |   16 | 0.00388351  | 1.3023  |     0.5706 |                    8 |
    | DEFAULT_f7c38_00002 | TERMINATED |       |            8 |    4 |   32 | 0.000632427 | 1.97116 |     0.2287 |                    1 |
    | DEFAULT_f7c38_00003 | TERMINATED |       |            2 |   32 |    8 | 0.0219628   | 2.34754 |     0.0967 |                    1 |
    | DEFAULT_f7c38_00004 | TERMINATED |       |            2 |   16 |   16 | 0.00125119  | 1.72169 |     0.365  |                    1 |
    | DEFAULT_f7c38_00005 | TERMINATED |       |            8 |   64 |   32 | 0.046222    | 2.31335 |     0.1008 |                    1 |
    | DEFAULT_f7c38_00006 | TERMINATED |       |           16 |    8 |    8 | 0.00149417  | 2.14968 |     0.1986 |                    1 |
    | DEFAULT_f7c38_00007 | TERMINATED |       |            8 |  256 |    8 | 0.00193744  | 1.36832 |     0.496  |                    2 |
    | DEFAULT_f7c38_00008 | TERMINATED |       |           16 |  256 |   32 | 0.00285209  | 1.29039 |     0.5932 |                   10 |
    | DEFAULT_f7c38_00009 | TERMINATED |       |            2 |   16 |    8 | 0.0174651   | 2.33689 |     0.0987 |                    1 |
    +---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+


    Best trial config: {'l1': 256, 'l2': 32, 'lr': 0.0028520853781244006, 'batch_size': 16}
    Best trial final validation loss: 1.290389664411545
    Best trial final validation accuracy: 0.5932
    Files already downloaded and verified
    Files already downloaded and verified
    Best trial test set accuracy: 0.5863


If you run the code, an example output could look like this:

.. code-block::

    Number of trials: 10 (10 TERMINATED)
    +-----+------+------+-------------+--------------+---------+------------+--------------------+
    | ... |   l1 |   l2 |          lr |   batch_size |    loss |   accuracy | training_iteration |
    |-----+------+------+-------------+--------------+---------+------------+--------------------|
    | ... |   64 |    4 | 0.00011629  |            2 | 1.87273 |     0.244  |                  2 |
    | ... |   32 |   64 | 0.000339763 |            8 | 1.23603 |     0.567  |                  8 |
    | ... |    8 |   16 | 0.00276249  |           16 | 1.1815  |     0.5836 |                 10 |
    | ... |    4 |   64 | 0.000648721 |            4 | 1.31131 |     0.5224 |                  8 |
    | ... |   32 |   16 | 0.000340753 |            8 | 1.26454 |     0.5444 |                  8 |
    | ... |    8 |    4 | 0.000699775 |            8 | 1.99594 |     0.1983 |                  2 |
    | ... |  256 |    8 | 0.0839654   |           16 | 2.3119  |     0.0993 |                  1 |
    | ... |   16 |  128 | 0.0758154   |           16 | 2.33575 |     0.1327 |                  1 |
    | ... |   16 |    8 | 0.0763312   |           16 | 2.31129 |     0.1042 |                  4 |
    | ... |  128 |   16 | 0.000124903 |            4 | 2.26917 |     0.1945 |                  1 |
    +-----+------+------+-------------+--------------+---------+------------+--------------------+


    Best trial config: {'l1': 8, 'l2': 16, 'lr': 0.00276249, 'batch_size': 16, 'data_dir': '...'}
    Best trial final validation loss: 1.181501
    Best trial final validation accuracy: 0.5836
    Best trial test set accuracy: 0.5806

Most trials have been stopped early in order to avoid wasting resources.
The best performing trial achieved a validation accuracy of about 58%, which could
be confirmed on the test set.

So that's it! You can now tune the parameters of your PyTorch models.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 5 minutes  8.039 seconds)


.. _sphx_glr_download_beginner_hyperparameter_tuning_tutorial.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download

     :download:`Download Python source code: hyperparameter_tuning_tutorial.py <hyperparameter_tuning_tutorial.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: hyperparameter_tuning_tutorial.ipynb <hyperparameter_tuning_tutorial.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.readthedocs.io>`_
