.. note::
    :class: sphx-glr-download-link-note

    Click :ref:`here <sphx_glr_download_beginner_hyperparameter_tuning_tutorial.py>` to download the full example code
.. rst-class:: sphx-glr-example-title

.. _sphx_glr_beginner_hyperparameter_tuning_tutorial.py:


Hyperparameter tuning with Ray Tune
===================================

Hyperparameter tuning can make the difference between an average model and a highly
accurate one. Often simple things like choosing a different learning rate or changing
a network layer size can have a dramatic impact on your model performance.

Fortunately, there are tools that help with finding the best combination of parameters.
`Ray Tune <https://docs.ray.io/en/latest/tune.html>`_ is an industry standard tool for
distributed hyperparameter tuning. Ray Tune includes the latest hyperparameter search
algorithms, integrates with TensorBoard and other analysis libraries, and natively
supports distributed training through `Ray's distributed machine learning engine
<https://ray.io/>`_.

In this tutorial, we will show you how to integrate Ray Tune into your PyTorch
training workflow. We will extend `this tutorial from the PyTorch documentation
<https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html>`_ for training
a CIFAR10 image classifier.

As you will see, we only need to add some slight modifications. In particular, we
need to

1. wrap data loading and training in functions,
2. make some network parameters configurable,
3. add checkpointing (optional),
4. and define the search space for the model tuning

|

To run this tutorial, please make sure the following packages are
installed:

-  ``ray[tune]``: Distributed hyperparameter tuning library
-  ``torchvision``: For the data transformers

Setup / Imports
---------------
Let's start with the imports:


.. code-block:: default

    from functools import partial
    import numpy as np
    import os
    import torch
    import torch.nn as nn
    import torch.nn.functional as F
    import torch.optim as optim
    from torch.utils.data import random_split
    import torchvision
    import torchvision.transforms as transforms
    from ray import tune
    from ray.tune import CLIReporter
    from ray.tune.schedulers import ASHAScheduler







Most of the imports are needed for building the PyTorch model. Only the last three
imports are for Ray Tune.

Data loaders
------------
We wrap the data loaders in their own function and pass a global data directory.
This way we can share a data directory between different trials.


.. code-block:: default



    def load_data(data_dir="./data"):
        transform = transforms.Compose([
            transforms.ToTensor(),
            transforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5))
        ])

        trainset = torchvision.datasets.CIFAR10(
            root=data_dir, train=True, download=True, transform=transform)

        testset = torchvision.datasets.CIFAR10(
            root=data_dir, train=False, download=True, transform=transform)

        return trainset, testset







Configurable neural network
---------------------------
We can only tune those parameters that are configurable. In this example, we can specify
the layer sizes of the fully connected layers:


.. code-block:: default



    class Net(nn.Module):
        def __init__(self, l1=120, l2=84):
            super(Net, self).__init__()
            self.conv1 = nn.Conv2d(3, 6, 5)
            self.pool = nn.MaxPool2d(2, 2)
            self.conv2 = nn.Conv2d(6, 16, 5)
            self.fc1 = nn.Linear(16 * 5 * 5, l1)
            self.fc2 = nn.Linear(l1, l2)
            self.fc3 = nn.Linear(l2, 10)

        def forward(self, x):
            x = self.pool(F.relu(self.conv1(x)))
            x = self.pool(F.relu(self.conv2(x)))
            x = x.view(-1, 16 * 5 * 5)
            x = F.relu(self.fc1(x))
            x = F.relu(self.fc2(x))
            x = self.fc3(x)
            return x







The train function
------------------
Now it gets interesting, because we introduce some changes to the example `from the PyTorch
documentation <https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html>`_.

We wrap the training script in a function ``train_cifar(config, checkpoint_dir=None, data_dir=None)``.
As you can guess, the ``config`` parameter will receive the hyperparameters we would like to
train with. The ``checkpoint_dir`` parameter is used to restore checkpoints. The ``data_dir`` specifies
the directory where we load and store the data, so multiple runs can share the same data source.

.. code-block:: python

    net = Net(config["l1"], config["l2"])

    if checkpoint_dir:
        model_state, optimizer_state = torch.load(
            os.path.join(checkpoint_dir, "checkpoint"))
        net.load_state_dict(model_state)
        optimizer.load_state_dict(optimizer_state)

The learning rate of the optimizer is made configurable, too:

.. code-block:: python

    optimizer = optim.SGD(net.parameters(), lr=config["lr"], momentum=0.9)

We also split the training data into a training and validation subset. We thus train on
80% of the data and calculate the validation loss on the remaining 20%. The batch sizes
with which we iterate through the training and test sets are configurable as well.

Adding (multi) GPU support with DataParallel
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Image classification benefits largely from GPUs. Luckily, we can continue to use
PyTorch's abstractions in Ray Tune. Thus, we can wrap our model in ``nn.DataParallel``
to support data parallel training on multiple GPUs:

.. code-block:: python

    device = "cpu"
    if torch.cuda.is_available():
        device = "cuda:0"
        if torch.cuda.device_count() > 1:
            net = nn.DataParallel(net)
    net.to(device)

By using a ``device`` variable we make sure that training also works when we have
no GPUs available. PyTorch requires us to send our data to the GPU memory explicitly,
like this:

.. code-block:: python

    for i, data in enumerate(trainloader, 0):
        inputs, labels = data
        inputs, labels = inputs.to(device), labels.to(device)

The code now supports training on CPUs, on a single GPU, and on multiple GPUs. Notably, Ray
also supports `fractional GPUs <https://docs.ray.io/en/master/using-ray-with-gpus.html#fractional-gpus>`_
so we can share GPUs among trials, as long as the model still fits on the GPU memory. We'll come back
to that later.

Communicating with Ray Tune
~~~~~~~~~~~~~~~~~~~~~~~~~~~

The most interesting part is the communication with Ray Tune:

.. code-block:: python

    with tune.checkpoint_dir(epoch) as checkpoint_dir:
        path = os.path.join(checkpoint_dir, "checkpoint")
        torch.save((net.state_dict(), optimizer.state_dict()), path)

    tune.report(loss=(val_loss / val_steps), accuracy=correct / total)

Here we first save a checkpoint and then report some metrics back to Ray Tune. Specifically,
we send the validation loss and accuracy back to Ray Tune. Ray Tune can then use these metrics
to decide which hyperparameter configuration lead to the best results. These metrics
can also be used to stop bad performing trials early in order to avoid wasting
resources on those trials.

The checkpoint saving is optional, however, it is necessary if we wanted to use advanced
schedulers like
`Population Based Training <https://docs.ray.io/en/master/tune/tutorials/tune-advanced-tutorial.html>`_.
Also, by saving the checkpoint we can later load the trained models and validate them
on a test set.

Full training function
~~~~~~~~~~~~~~~~~~~~~~

The full code example looks like this:


.. code-block:: default



    def train_cifar(config, checkpoint_dir=None, data_dir=None):
        net = Net(config["l1"], config["l2"])

        device = "cpu"
        if torch.cuda.is_available():
            device = "cuda:0"
            if torch.cuda.device_count() > 1:
                net = nn.DataParallel(net)
        net.to(device)

        criterion = nn.CrossEntropyLoss()
        optimizer = optim.SGD(net.parameters(), lr=config["lr"], momentum=0.9)

        if checkpoint_dir:
            model_state, optimizer_state = torch.load(
                os.path.join(checkpoint_dir, "checkpoint"))
            net.load_state_dict(model_state)
            optimizer.load_state_dict(optimizer_state)

        trainset, testset = load_data(data_dir)

        test_abs = int(len(trainset) * 0.8)
        train_subset, val_subset = random_split(
            trainset, [test_abs, len(trainset) - test_abs])

        trainloader = torch.utils.data.DataLoader(
            train_subset,
            batch_size=int(config["batch_size"]),
            shuffle=True,
            num_workers=8)
        valloader = torch.utils.data.DataLoader(
            val_subset,
            batch_size=int(config["batch_size"]),
            shuffle=True,
            num_workers=8)

        for epoch in range(10):  # loop over the dataset multiple times
            running_loss = 0.0
            epoch_steps = 0
            for i, data in enumerate(trainloader, 0):
                # get the inputs; data is a list of [inputs, labels]
                inputs, labels = data
                inputs, labels = inputs.to(device), labels.to(device)

                # zero the parameter gradients
                optimizer.zero_grad()

                # forward + backward + optimize
                outputs = net(inputs)
                loss = criterion(outputs, labels)
                loss.backward()
                optimizer.step()

                # print statistics
                running_loss += loss.item()
                epoch_steps += 1
                if i % 2000 == 1999:  # print every 2000 mini-batches
                    print("[%d, %5d] loss: %.3f" % (epoch + 1, i + 1,
                                                    running_loss / epoch_steps))
                    running_loss = 0.0

            # Validation loss
            val_loss = 0.0
            val_steps = 0
            total = 0
            correct = 0
            for i, data in enumerate(valloader, 0):
                with torch.no_grad():
                    inputs, labels = data
                    inputs, labels = inputs.to(device), labels.to(device)

                    outputs = net(inputs)
                    _, predicted = torch.max(outputs.data, 1)
                    total += labels.size(0)
                    correct += (predicted == labels).sum().item()

                    loss = criterion(outputs, labels)
                    val_loss += loss.cpu().numpy()
                    val_steps += 1

            with tune.checkpoint_dir(epoch) as checkpoint_dir:
                path = os.path.join(checkpoint_dir, "checkpoint")
                torch.save((net.state_dict(), optimizer.state_dict()), path)

            tune.report(loss=(val_loss / val_steps), accuracy=correct / total)
        print("Finished Training")







As you can see, most of the code is adapted directly from the original example.

Test set accuracy
-----------------
Commonly the performance of a machine learning model is tested on a hold-out test
set with data that has not been used for training the model. We also wrap this in a
function:


.. code-block:: default



    def test_accuracy(net, device="cpu"):
        trainset, testset = load_data()

        testloader = torch.utils.data.DataLoader(
            testset, batch_size=4, shuffle=False, num_workers=2)

        correct = 0
        total = 0
        with torch.no_grad():
            for data in testloader:
                images, labels = data
                images, labels = images.to(device), labels.to(device)
                outputs = net(images)
                _, predicted = torch.max(outputs.data, 1)
                total += labels.size(0)
                correct += (predicted == labels).sum().item()

        return correct / total







The function also expects a ``device`` parameter, so we can do the
test set validation on a GPU.

Configuring the search space
----------------------------
Lastly, we need to define Ray Tune's search space. Here is an example:

.. code-block:: python

    config = {
        "l1": tune.sample_from(lambda _: 2**np.random.randint(2, 9)),
        "l2": tune.sample_from(lambda _: 2**np.random.randint(2, 9)),
        "lr": tune.loguniform(1e-4, 1e-1),
        "batch_size": tune.choice([2, 4, 8, 16])
    }

The ``tune.sample_from()`` function makes it possible to define your own sample
methods to obtain hyperparameters. In this example, the ``l1`` and ``l2`` parameters
should be powers of 2 between 4 and 256, so either 4, 8, 16, 32, 64, 128, or 256.
The ``lr`` (learning rate) should be uniformly sampled between 0.0001 and 0.1. Lastly,
the batch size is a choice between 2, 4, 8, and 16.

At each trial, Ray Tune will now randomly sample a combination of parameters from these
search spaces. It will then train a number of models in parallel and find the best
performing one among these. We also use the ``ASHAScheduler`` which will terminate bad
performing trials early.

We wrap the ``train_cifar`` function with ``functools.partial`` to set the constant
``data_dir`` parameter. We can also tell Ray Tune what resources should be
available for each trial:

.. code-block:: python

    gpus_per_trial = 2
    # ...
    result = tune.run(
        partial(train_cifar, data_dir=data_dir),
        resources_per_trial={"cpu": 8, "gpu": gpus_per_trial},
        config=config,
        num_samples=num_samples,
        scheduler=scheduler,
        progress_reporter=reporter,
        checkpoint_at_end=True)

You can specify the number of CPUs, which are then available e.g.
to increase the ``num_workers`` of the PyTorch ``DataLoader`` instances. The selected
number of GPUs are made visible to PyTorch in each trial. Trials do not have access to
GPUs that haven't been requested for them - so you don't have to care about two trials
using the same set of resources.

Here we can also specify fractional GPUs, so something like ``gpus_per_trial=0.5`` is
completely valid. The trials will then share GPUs among each other.
You just have to make sure that the models still fit in the GPU memory.

After training the models, we will find the best performing one and load the trained
network from the checkpoint file. We then obtain the test set accuracy and report
everything by printing.

The full main function looks like this:


.. code-block:: default



    def main(num_samples=10, max_num_epochs=10, gpus_per_trial=2):
        data_dir = os.path.abspath("./data")
        load_data(data_dir)
        config = {
            "l1": tune.sample_from(lambda _: 2 ** np.random.randint(2, 9)),
            "l2": tune.sample_from(lambda _: 2 ** np.random.randint(2, 9)),
            "lr": tune.loguniform(1e-4, 1e-1),
            "batch_size": tune.choice([2, 4, 8, 16])
        }
        scheduler = ASHAScheduler(
            metric="loss",
            mode="min",
            max_t=max_num_epochs,
            grace_period=1,
            reduction_factor=2)
        reporter = CLIReporter(
            # parameter_columns=["l1", "l2", "lr", "batch_size"],
            metric_columns=["loss", "accuracy", "training_iteration"])
        result = tune.run(
            partial(train_cifar, data_dir=data_dir),
            resources_per_trial={"cpu": 2, "gpu": gpus_per_trial},
            config=config,
            num_samples=num_samples,
            scheduler=scheduler,
            progress_reporter=reporter)

        best_trial = result.get_best_trial("loss", "min", "last")
        print("Best trial config: {}".format(best_trial.config))
        print("Best trial final validation loss: {}".format(
            best_trial.last_result["loss"]))
        print("Best trial final validation accuracy: {}".format(
            best_trial.last_result["accuracy"]))

        best_trained_model = Net(best_trial.config["l1"], best_trial.config["l2"])
        device = "cpu"
        if torch.cuda.is_available():
            device = "cuda:0"
            if gpus_per_trial > 1:
                best_trained_model = nn.DataParallel(best_trained_model)
        best_trained_model.to(device)

        best_checkpoint_dir = best_trial.checkpoint.value
        model_state, optimizer_state = torch.load(os.path.join(
            best_checkpoint_dir, "checkpoint"))
        best_trained_model.load_state_dict(model_state)

        test_acc = test_accuracy(best_trained_model, device)
        print("Best trial test set accuracy: {}".format(test_acc))


    if __name__ == "__main__":
        # You can change the number of GPUs per trial here:
        main(num_samples=10, max_num_epochs=10, gpus_per_trial=0)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz
    Extracting /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data
    Files already downloaded and verified
    == Status ==
    Memory usage on this node: 4.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=0
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: None
    Resources requested: 0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-06-15_16-21-41
    Number of trials: 10/10 (10 PENDING)
    +---------------------+----------+-------+--------------+------+------+-------------+
    | Trial name          | status   | loc   |   batch_size |   l1 |   l2 |          lr |
    |---------------------+----------+-------+--------------+------+------+-------------|
    | DEFAULT_c4a3c_00000 | PENDING  |       |           16 |    8 |   32 | 0.0359233   |
    | DEFAULT_c4a3c_00001 | PENDING  |       |            2 |  256 |  128 | 0.0193597   |
    | DEFAULT_c4a3c_00002 | PENDING  |       |            8 |   16 |   16 | 0.000332111 |
    | DEFAULT_c4a3c_00003 | PENDING  |       |           16 |    8 |   32 | 0.00110393  |
    | DEFAULT_c4a3c_00004 | PENDING  |       |            2 |   16 |   16 | 0.00385544  |
    | DEFAULT_c4a3c_00005 | PENDING  |       |            4 |  256 |   32 | 0.0659351   |
    | DEFAULT_c4a3c_00006 | PENDING  |       |            4 |  256 |   32 | 0.00734397  |
    | DEFAULT_c4a3c_00007 | PENDING  |       |            4 |    8 |   32 | 0.000229293 |
    | DEFAULT_c4a3c_00008 | PENDING  |       |            8 |    4 |   32 | 0.0211247   |
    | DEFAULT_c4a3c_00009 | PENDING  |       |           16 |   16 |  256 | 0.0031862   |
    +---------------------+----------+-------+--------------+------+------+-------------+


    [2m[36m(pid=1447)[0m Files already downloaded and verified
    [2m[36m(pid=1503)[0m Files already downloaded and verified
    [2m[36m(pid=1500)[0m Files already downloaded and verified
    [2m[36m(pid=1487)[0m Files already downloaded and verified
    [2m[36m(pid=1492)[0m Files already downloaded and verified
    [2m[36m(pid=1479)[0m Files already downloaded and verified
    [2m[36m(pid=1497)[0m Files already downloaded and verified
    [2m[36m(pid=1452)[0m Files already downloaded and verified
    [2m[36m(pid=1483)[0m Files already downloaded and verified
    [2m[36m(pid=1488)[0m Files already downloaded and verified
    [2m[36m(pid=1447)[0m Files already downloaded and verified
    [2m[36m(pid=1503)[0m Files already downloaded and verified
    [2m[36m(pid=1500)[0m Files already downloaded and verified
    [2m[36m(pid=1487)[0m Files already downloaded and verified
    [2m[36m(pid=1479)[0m Files already downloaded and verified
    [2m[36m(pid=1497)[0m Files already downloaded and verified
    [2m[36m(pid=1452)[0m Files already downloaded and verified
    [2m[36m(pid=1483)[0m Files already downloaded and verified
    [2m[36m(pid=1492)[0m Files already downloaded and verified
    [2m[36m(pid=1488)[0m Files already downloaded and verified
    [2m[36m(pid=1483)[0m [1,  2000] loss: 2.150
    [2m[36m(pid=1497)[0m [1,  2000] loss: 2.307
    [2m[36m(pid=1492)[0m [1,  2000] loss: 2.025
    [2m[36m(pid=1500)[0m [1,  2000] loss: 2.320
    [2m[36m(pid=1487)[0m [1,  2000] loss: 2.304
    [2m[36m(pid=1488)[0m [1,  2000] loss: 2.311
    [2m[36m(pid=1503)[0m [1,  2000] loss: 2.344
    [2m[36m(pid=1447)[0m [1,  2000] loss: 2.104
    [2m[36m(pid=1452)[0m [1,  2000] loss: 1.825
    [2m[36m(pid=1479)[0m [1,  2000] loss: 2.098
    [2m[36m(pid=1483)[0m [1,  4000] loss: 1.003
    [2m[36m(pid=1497)[0m [1,  4000] loss: 1.151
    Result for DEFAULT_c4a3c_00000:
      accuracy: 0.1002
      date: 2021-06-15_16-22-08
      done: false
      experiment_id: 758444e5757c4f019d610998b9eb272d
      hostname: 615a1934159b
      iterations_since_restore: 1
      loss: 2.3174027568817137
      node_ip: 172.17.0.2
      pid: 1447
      should_checkpoint: true
      time_since_restore: 25.176374435424805
      time_this_iter_s: 25.176374435424805
      time_total_s: 25.176374435424805
      timestamp: 1623774128
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: c4a3c_00000
  
    == Status ==
    Memory usage on this node: 9.6/240.1 GiB
    Using AsyncHyperBand: num_stopped=0
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -2.3174027568817137
    Resources requested: 20.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-06-15_16-21-41
    Number of trials: 10/10 (10 RUNNING)
    +---------------------+----------+-----------------+--------------+------+------+-------------+--------+------------+----------------------+
    | Trial name          | status   | loc             |   batch_size |   l1 |   l2 |          lr |   loss |   accuracy |   training_iteration |
    |---------------------+----------+-----------------+--------------+------+------+-------------+--------+------------+----------------------|
    | DEFAULT_c4a3c_00000 | RUNNING  | 172.17.0.2:1447 |           16 |    8 |   32 | 0.0359233   | 2.3174 |     0.1002 |                    1 |
    | DEFAULT_c4a3c_00001 | RUNNING  |                 |            2 |  256 |  128 | 0.0193597   |        |            |                      |
    | DEFAULT_c4a3c_00002 | RUNNING  |                 |            8 |   16 |   16 | 0.000332111 |        |            |                      |
    | DEFAULT_c4a3c_00003 | RUNNING  |                 |           16 |    8 |   32 | 0.00110393  |        |            |                      |
    | DEFAULT_c4a3c_00004 | RUNNING  |                 |            2 |   16 |   16 | 0.00385544  |        |            |                      |
    | DEFAULT_c4a3c_00005 | RUNNING  |                 |            4 |  256 |   32 | 0.0659351   |        |            |                      |
    | DEFAULT_c4a3c_00006 | RUNNING  |                 |            4 |  256 |   32 | 0.00734397  |        |            |                      |
    | DEFAULT_c4a3c_00007 | RUNNING  |                 |            4 |    8 |   32 | 0.000229293 |        |            |                      |
    | DEFAULT_c4a3c_00008 | RUNNING  |                 |            8 |    4 |   32 | 0.0211247   |        |            |                      |
    | DEFAULT_c4a3c_00009 | RUNNING  |                 |           16 |   16 |  256 | 0.0031862   |        |            |                      |
    +---------------------+----------+-----------------+--------------+------+------+-------------+--------+------------+----------------------+


    Result for DEFAULT_c4a3c_00009:
      accuracy: 0.4651
      date: 2021-06-15_16-22-09
      done: false
      experiment_id: de8a7e8cf0d045fcb9697edc75341916
      hostname: 615a1934159b
      iterations_since_restore: 1
      loss: 1.456335988998413
      node_ip: 172.17.0.2
      pid: 1452
      should_checkpoint: true
      time_since_restore: 26.144399881362915
      time_this_iter_s: 26.144399881362915
      time_total_s: 26.144399881362915
      timestamp: 1623774129
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: c4a3c_00009
  
    Result for DEFAULT_c4a3c_00003:
      accuracy: 0.3387
      date: 2021-06-15_16-22-09
      done: false
      experiment_id: b8c52fc7e76a47f2abe348f26f0a9bbd
      hostname: 615a1934159b
      iterations_since_restore: 1
      loss: 1.7437347366333007
      node_ip: 172.17.0.2
      pid: 1479
      should_checkpoint: true
      time_since_restore: 26.27993679046631
      time_this_iter_s: 26.27993679046631
      time_total_s: 26.27993679046631
      timestamp: 1623774129
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: c4a3c_00003
  
    [2m[36m(pid=1492)[0m [1,  4000] loss: 0.927
    [2m[36m(pid=1487)[0m [1,  4000] loss: 1.138
    [2m[36m(pid=1488)[0m [1,  4000] loss: 1.155
    [2m[36m(pid=1500)[0m [1,  4000] loss: 1.163
    [2m[36m(pid=1503)[0m [1,  4000] loss: 1.170
    [2m[36m(pid=1483)[0m [1,  6000] loss: 0.654
    [2m[36m(pid=1497)[0m [1,  6000] loss: 0.767
    [2m[36m(pid=1492)[0m [1,  6000] loss: 0.599
    Result for DEFAULT_c4a3c_00002:
      accuracy: 0.2096
      date: 2021-06-15_16-22-21
      done: true
      experiment_id: a2acef30623c43dc89b6b09b60106cb5
      hostname: 615a1934159b
      iterations_since_restore: 1
      loss: 2.151623181724548
      node_ip: 172.17.0.2
      pid: 1487
      should_checkpoint: true
      time_since_restore: 38.97651267051697
      time_this_iter_s: 38.97651267051697
      time_total_s: 38.97651267051697
      timestamp: 1623774141
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: c4a3c_00002
  
    == Status ==
    Memory usage on this node: 9.6/240.1 GiB
    Using AsyncHyperBand: num_stopped=1
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -1.9476789591789245
    Resources requested: 20.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-06-15_16-21-41
    Number of trials: 10/10 (10 RUNNING)
    +---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status   | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_c4a3c_00000 | RUNNING  | 172.17.0.2:1447 |           16 |    8 |   32 | 0.0359233   | 2.3174  |     0.1002 |                    1 |
    | DEFAULT_c4a3c_00001 | RUNNING  |                 |            2 |  256 |  128 | 0.0193597   |         |            |                      |
    | DEFAULT_c4a3c_00002 | RUNNING  | 172.17.0.2:1487 |            8 |   16 |   16 | 0.000332111 | 2.15162 |     0.2096 |                    1 |
    | DEFAULT_c4a3c_00003 | RUNNING  | 172.17.0.2:1479 |           16 |    8 |   32 | 0.00110393  | 1.74373 |     0.3387 |                    1 |
    | DEFAULT_c4a3c_00004 | RUNNING  |                 |            2 |   16 |   16 | 0.00385544  |         |            |                      |
    | DEFAULT_c4a3c_00005 | RUNNING  |                 |            4 |  256 |   32 | 0.0659351   |         |            |                      |
    | DEFAULT_c4a3c_00006 | RUNNING  |                 |            4 |  256 |   32 | 0.00734397  |         |            |                      |
    | DEFAULT_c4a3c_00007 | RUNNING  |                 |            4 |    8 |   32 | 0.000229293 |         |            |                      |
    | DEFAULT_c4a3c_00008 | RUNNING  |                 |            8 |    4 |   32 | 0.0211247   |         |            |                      |
    | DEFAULT_c4a3c_00009 | RUNNING  | 172.17.0.2:1452 |           16 |   16 |  256 | 0.0031862   | 1.45634 |     0.4651 |                    1 |
    +---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_c4a3c_00008:
      accuracy: 0.1022
      date: 2021-06-15_16-22-22
      done: true
      experiment_id: aa8c65aac7a246c8a6eb8b87e75d822b
      hostname: 615a1934159b
      iterations_since_restore: 1
      loss: 2.3058040367126464
      node_ip: 172.17.0.2
      pid: 1488
      should_checkpoint: true
      time_since_restore: 39.26124858856201
      time_this_iter_s: 39.26124858856201
      time_total_s: 39.26124858856201
      timestamp: 1623774142
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: c4a3c_00008
  
    [2m[36m(pid=1447)[0m [2,  2000] loss: 2.310
    [2m[36m(pid=1452)[0m [2,  2000] loss: 1.429
    [2m[36m(pid=1479)[0m [2,  2000] loss: 1.663
    [2m[36m(pid=1483)[0m [1,  8000] loss: 0.495
    [2m[36m(pid=1500)[0m [1,  6000] loss: 0.774
    [2m[36m(pid=1503)[0m [1,  6000] loss: 0.780
    [2m[36m(pid=1497)[0m [1,  8000] loss: 0.574
    Result for DEFAULT_c4a3c_00000:
      accuracy: 0.1001
      date: 2021-06-15_16-22-29
      done: false
      experiment_id: 758444e5757c4f019d610998b9eb272d
      hostname: 615a1934159b
      iterations_since_restore: 2
      loss: 2.308913571548462
      node_ip: 172.17.0.2
      pid: 1447
      should_checkpoint: true
      time_since_restore: 46.6418240070343
      time_this_iter_s: 21.465449571609497
      time_total_s: 46.6418240070343
      timestamp: 1623774149
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: c4a3c_00000
  
    == Status ==
    Memory usage on this node: 8.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=2
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -2.308913571548462 | Iter 1.000: -2.151623181724548
    Resources requested: 16.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-06-15_16-21-41
    Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_c4a3c_00000 | RUNNING    | 172.17.0.2:1447 |           16 |    8 |   32 | 0.0359233   | 2.30891 |     0.1001 |                    2 |
    | DEFAULT_c4a3c_00001 | RUNNING    |                 |            2 |  256 |  128 | 0.0193597   |         |            |                      |
    | DEFAULT_c4a3c_00003 | RUNNING    | 172.17.0.2:1479 |           16 |    8 |   32 | 0.00110393  | 1.74373 |     0.3387 |                    1 |
    | DEFAULT_c4a3c_00004 | RUNNING    |                 |            2 |   16 |   16 | 0.00385544  |         |            |                      |
    | DEFAULT_c4a3c_00005 | RUNNING    |                 |            4 |  256 |   32 | 0.0659351   |         |            |                      |
    | DEFAULT_c4a3c_00006 | RUNNING    |                 |            4 |  256 |   32 | 0.00734397  |         |            |                      |
    | DEFAULT_c4a3c_00007 | RUNNING    |                 |            4 |    8 |   32 | 0.000229293 |         |            |                      |
    | DEFAULT_c4a3c_00009 | RUNNING    | 172.17.0.2:1452 |           16 |   16 |  256 | 0.0031862   | 1.45634 |     0.4651 |                    1 |
    | DEFAULT_c4a3c_00002 | TERMINATED |                 |            8 |   16 |   16 | 0.000332111 | 2.15162 |     0.2096 |                    1 |
    | DEFAULT_c4a3c_00008 | TERMINATED |                 |            8 |    4 |   32 | 0.0211247   | 2.3058  |     0.1022 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_c4a3c_00009:
      accuracy: 0.5172
      date: 2021-06-15_16-22-30
      done: false
      experiment_id: de8a7e8cf0d045fcb9697edc75341916
      hostname: 615a1934159b
      iterations_since_restore: 2
      loss: 1.376230835533142
      node_ip: 172.17.0.2
      pid: 1452
      should_checkpoint: true
      time_since_restore: 47.59300398826599
      time_this_iter_s: 21.448604106903076
      time_total_s: 47.59300398826599
      timestamp: 1623774150
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: c4a3c_00009
  
    [2m[36m(pid=1492)[0m [1,  8000] loss: 0.446
    Result for DEFAULT_c4a3c_00003:
      accuracy: 0.4408
      date: 2021-06-15_16-22-31
      done: false
      experiment_id: b8c52fc7e76a47f2abe348f26f0a9bbd
      hostname: 615a1934159b
      iterations_since_restore: 2
      loss: 1.5206001603126527
      node_ip: 172.17.0.2
      pid: 1479
      should_checkpoint: true
      time_since_restore: 48.25265884399414
      time_this_iter_s: 21.972722053527832
      time_total_s: 48.25265884399414
      timestamp: 1623774151
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: c4a3c_00003
  
    [2m[36m(pid=1483)[0m [1, 10000] loss: 0.386
    [2m[36m(pid=1497)[0m [1, 10000] loss: 0.455
    [2m[36m(pid=1500)[0m [1,  8000] loss: 0.581
    [2m[36m(pid=1503)[0m [1,  8000] loss: 0.586
    [2m[36m(pid=1492)[0m [1, 10000] loss: 0.357
    [2m[36m(pid=1483)[0m [1, 12000] loss: 0.317
    [2m[36m(pid=1447)[0m [3,  2000] loss: 2.308
    [2m[36m(pid=1452)[0m [3,  2000] loss: 1.303
    Result for DEFAULT_c4a3c_00007:
      accuracy: 0.1606
      date: 2021-06-15_16-22-45
      done: true
      experiment_id: 3137312e5641491c9a94a9e2e82cbc6b
      hostname: 615a1934159b
      iterations_since_restore: 1
      loss: 2.2544857504844664
      node_ip: 172.17.0.2
      pid: 1497
      should_checkpoint: true
      time_since_restore: 62.549649715423584
      time_this_iter_s: 62.549649715423584
      time_total_s: 62.549649715423584
      timestamp: 1623774165
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: c4a3c_00007
  
    == Status ==
    Memory usage on this node: 8.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=3
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.5206001603126527 | Iter 1.000: -2.2030544661045073
    Resources requested: 16.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-06-15_16-21-41
    Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_c4a3c_00000 | RUNNING    | 172.17.0.2:1447 |           16 |    8 |   32 | 0.0359233   | 2.30891 |     0.1001 |                    2 |
    | DEFAULT_c4a3c_00001 | RUNNING    |                 |            2 |  256 |  128 | 0.0193597   |         |            |                      |
    | DEFAULT_c4a3c_00003 | RUNNING    | 172.17.0.2:1479 |           16 |    8 |   32 | 0.00110393  | 1.5206  |     0.4408 |                    2 |
    | DEFAULT_c4a3c_00004 | RUNNING    |                 |            2 |   16 |   16 | 0.00385544  |         |            |                      |
    | DEFAULT_c4a3c_00005 | RUNNING    |                 |            4 |  256 |   32 | 0.0659351   |         |            |                      |
    | DEFAULT_c4a3c_00006 | RUNNING    |                 |            4 |  256 |   32 | 0.00734397  |         |            |                      |
    | DEFAULT_c4a3c_00007 | RUNNING    | 172.17.0.2:1497 |            4 |    8 |   32 | 0.000229293 | 2.25449 |     0.1606 |                    1 |
    | DEFAULT_c4a3c_00009 | RUNNING    | 172.17.0.2:1452 |           16 |   16 |  256 | 0.0031862   | 1.37623 |     0.5172 |                    2 |
    | DEFAULT_c4a3c_00002 | TERMINATED |                 |            8 |   16 |   16 | 0.000332111 | 2.15162 |     0.2096 |                    1 |
    | DEFAULT_c4a3c_00008 | TERMINATED |                 |            8 |    4 |   32 | 0.0211247   | 2.3058  |     0.1022 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1479)[0m [3,  2000] loss: 1.493
    Result for DEFAULT_c4a3c_00006:
      accuracy: 0.3427
      date: 2021-06-15_16-22-48
      done: false
      experiment_id: 5bff4abdc59241ce835f55a3dcce451f
      hostname: 615a1934159b
      iterations_since_restore: 1
      loss: 1.7997061514377595
      node_ip: 172.17.0.2
      pid: 1492
      should_checkpoint: true
      time_since_restore: 65.91021060943604
      time_this_iter_s: 65.91021060943604
      time_total_s: 65.91021060943604
      timestamp: 1623774168
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: c4a3c_00006
  
    Result for DEFAULT_c4a3c_00000:
      accuracy: 0.096
      date: 2021-06-15_16-22-49
      done: false
      experiment_id: 758444e5757c4f019d610998b9eb272d
      hostname: 615a1934159b
      iterations_since_restore: 3
      loss: 2.3126079734802247
      node_ip: 172.17.0.2
      pid: 1447
      should_checkpoint: true
      time_since_restore: 66.93190455436707
      time_this_iter_s: 20.290080547332764
      time_total_s: 66.93190455436707
      timestamp: 1623774169
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: c4a3c_00000
  
    Result for DEFAULT_c4a3c_00009:
      accuracy: 0.5573
      date: 2021-06-15_16-22-50
      done: false
      experiment_id: de8a7e8cf0d045fcb9697edc75341916
      hostname: 615a1934159b
      iterations_since_restore: 3
      loss: 1.2415180274009705
      node_ip: 172.17.0.2
      pid: 1452
      should_checkpoint: true
      time_since_restore: 67.74820828437805
      time_this_iter_s: 20.15520429611206
      time_total_s: 67.74820828437805
      timestamp: 1623774170
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: c4a3c_00009
  
    == Status ==
    Memory usage on this node: 7.9/240.1 GiB
    Using AsyncHyperBand: num_stopped=3
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.5206001603126527 | Iter 1.000: -2.151623181724548
    Resources requested: 14.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-06-15_16-21-41
    Number of trials: 10/10 (7 RUNNING, 3 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_c4a3c_00000 | RUNNING    | 172.17.0.2:1447 |           16 |    8 |   32 | 0.0359233   | 2.31261 |     0.096  |                    3 |
    | DEFAULT_c4a3c_00001 | RUNNING    |                 |            2 |  256 |  128 | 0.0193597   |         |            |                      |
    | DEFAULT_c4a3c_00003 | RUNNING    | 172.17.0.2:1479 |           16 |    8 |   32 | 0.00110393  | 1.5206  |     0.4408 |                    2 |
    | DEFAULT_c4a3c_00004 | RUNNING    |                 |            2 |   16 |   16 | 0.00385544  |         |            |                      |
    | DEFAULT_c4a3c_00005 | RUNNING    |                 |            4 |  256 |   32 | 0.0659351   |         |            |                      |
    | DEFAULT_c4a3c_00006 | RUNNING    | 172.17.0.2:1492 |            4 |  256 |   32 | 0.00734397  | 1.79971 |     0.3427 |                    1 |
    | DEFAULT_c4a3c_00009 | RUNNING    | 172.17.0.2:1452 |           16 |   16 |  256 | 0.0031862   | 1.24152 |     0.5573 |                    3 |
    | DEFAULT_c4a3c_00002 | TERMINATED |                 |            8 |   16 |   16 | 0.000332111 | 2.15162 |     0.2096 |                    1 |
    | DEFAULT_c4a3c_00007 | TERMINATED |                 |            4 |    8 |   32 | 0.000229293 | 2.25449 |     0.1606 |                    1 |
    | DEFAULT_c4a3c_00008 | TERMINATED |                 |            8 |    4 |   32 | 0.0211247   | 2.3058  |     0.1022 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1483)[0m [1, 14000] loss: 0.279
    Result for DEFAULT_c4a3c_00003:
      accuracy: 0.4803
      date: 2021-06-15_16-22-52
      done: false
      experiment_id: b8c52fc7e76a47f2abe348f26f0a9bbd
      hostname: 615a1934159b
      iterations_since_restore: 3
      loss: 1.427922790813446
      node_ip: 172.17.0.2
      pid: 1479
      should_checkpoint: true
      time_since_restore: 68.87466669082642
      time_this_iter_s: 20.622007846832275
      time_total_s: 68.87466669082642
      timestamp: 1623774172
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: c4a3c_00003
  
    [2m[36m(pid=1500)[0m [1, 10000] loss: 0.462
    [2m[36m(pid=1503)[0m [1, 10000] loss: 0.469
    [2m[36m(pid=1492)[0m [2,  2000] loss: 1.752
    [2m[36m(pid=1483)[0m [1, 16000] loss: 0.234
    Result for DEFAULT_c4a3c_00005:
      accuracy: 0.1001
      date: 2021-06-15_16-23-02
      done: true
      experiment_id: 0f3758c20a114387a9daa3aba26a4ab8
      hostname: 615a1934159b
      iterations_since_restore: 1
      loss: 2.385577262735367
      node_ip: 172.17.0.2
      pid: 1503
      should_checkpoint: true
      time_since_restore: 79.09078407287598
      time_this_iter_s: 79.09078407287598
      time_total_s: 79.09078407287598
      timestamp: 1623774182
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: c4a3c_00005
  
    == Status ==
    Memory usage on this node: 7.9/240.1 GiB
    Using AsyncHyperBand: num_stopped=4
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.5206001603126527 | Iter 1.000: -2.2030544661045073
    Resources requested: 14.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-06-15_16-21-41
    Number of trials: 10/10 (7 RUNNING, 3 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_c4a3c_00000 | RUNNING    | 172.17.0.2:1447 |           16 |    8 |   32 | 0.0359233   | 2.31261 |     0.096  |                    3 |
    | DEFAULT_c4a3c_00001 | RUNNING    |                 |            2 |  256 |  128 | 0.0193597   |         |            |                      |
    | DEFAULT_c4a3c_00003 | RUNNING    | 172.17.0.2:1479 |           16 |    8 |   32 | 0.00110393  | 1.42792 |     0.4803 |                    3 |
    | DEFAULT_c4a3c_00004 | RUNNING    |                 |            2 |   16 |   16 | 0.00385544  |         |            |                      |
    | DEFAULT_c4a3c_00005 | RUNNING    | 172.17.0.2:1503 |            4 |  256 |   32 | 0.0659351   | 2.38558 |     0.1001 |                    1 |
    | DEFAULT_c4a3c_00006 | RUNNING    | 172.17.0.2:1492 |            4 |  256 |   32 | 0.00734397  | 1.79971 |     0.3427 |                    1 |
    | DEFAULT_c4a3c_00009 | RUNNING    | 172.17.0.2:1452 |           16 |   16 |  256 | 0.0031862   | 1.24152 |     0.5573 |                    3 |
    | DEFAULT_c4a3c_00002 | TERMINATED |                 |            8 |   16 |   16 | 0.000332111 | 2.15162 |     0.2096 |                    1 |
    | DEFAULT_c4a3c_00007 | TERMINATED |                 |            4 |    8 |   32 | 0.000229293 | 2.25449 |     0.1606 |                    1 |
    | DEFAULT_c4a3c_00008 | TERMINATED |                 |            8 |    4 |   32 | 0.0211247   | 2.3058  |     0.1022 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1447)[0m [4,  2000] loss: 2.308
    [2m[36m(pid=1452)[0m [4,  2000] loss: 1.219
    [2m[36m(pid=1500)[0m [1, 12000] loss: 0.373
    [2m[36m(pid=1479)[0m [4,  2000] loss: 1.393
    [2m[36m(pid=1483)[0m [1, 18000] loss: 0.214
    [2m[36m(pid=1492)[0m [2,  4000] loss: 0.889
    Result for DEFAULT_c4a3c_00000:
      accuracy: 0.1044
      date: 2021-06-15_16-23-09
      done: false
      experiment_id: 758444e5757c4f019d610998b9eb272d
      hostname: 615a1934159b
      iterations_since_restore: 4
      loss: 2.3107225387573243
      node_ip: 172.17.0.2
      pid: 1447
      should_checkpoint: true
      time_since_restore: 86.74744963645935
      time_this_iter_s: 19.815545082092285
      time_total_s: 86.74744963645935
      timestamp: 1623774189
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: c4a3c_00000
  
    == Status ==
    Memory usage on this node: 7.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=4
    Bracket: Iter 8.000: None | Iter 4.000: -2.3107225387573243 | Iter 2.000: -1.5206001603126527 | Iter 1.000: -2.2030544661045073
    Resources requested: 12.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-06-15_16-21-41
    Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_c4a3c_00000 | RUNNING    | 172.17.0.2:1447 |           16 |    8 |   32 | 0.0359233   | 2.31072 |     0.1044 |                    4 |
    | DEFAULT_c4a3c_00001 | RUNNING    |                 |            2 |  256 |  128 | 0.0193597   |         |            |                      |
    | DEFAULT_c4a3c_00003 | RUNNING    | 172.17.0.2:1479 |           16 |    8 |   32 | 0.00110393  | 1.42792 |     0.4803 |                    3 |
    | DEFAULT_c4a3c_00004 | RUNNING    |                 |            2 |   16 |   16 | 0.00385544  |         |            |                      |
    | DEFAULT_c4a3c_00006 | RUNNING    | 172.17.0.2:1492 |            4 |  256 |   32 | 0.00734397  | 1.79971 |     0.3427 |                    1 |
    | DEFAULT_c4a3c_00009 | RUNNING    | 172.17.0.2:1452 |           16 |   16 |  256 | 0.0031862   | 1.24152 |     0.5573 |                    3 |
    | DEFAULT_c4a3c_00002 | TERMINATED |                 |            8 |   16 |   16 | 0.000332111 | 2.15162 |     0.2096 |                    1 |
    | DEFAULT_c4a3c_00005 | TERMINATED |                 |            4 |  256 |   32 | 0.0659351   | 2.38558 |     0.1001 |                    1 |
    | DEFAULT_c4a3c_00007 | TERMINATED |                 |            4 |    8 |   32 | 0.000229293 | 2.25449 |     0.1606 |                    1 |
    | DEFAULT_c4a3c_00008 | TERMINATED |                 |            8 |    4 |   32 | 0.0211247   | 2.3058  |     0.1022 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_c4a3c_00009:
      accuracy: 0.5564
      date: 2021-06-15_16-23-10
      done: false
      experiment_id: de8a7e8cf0d045fcb9697edc75341916
      hostname: 615a1934159b
      iterations_since_restore: 4
      loss: 1.2472866856575011
      node_ip: 172.17.0.2
      pid: 1452
      should_checkpoint: true
      time_since_restore: 87.6689863204956
      time_this_iter_s: 19.920778036117554
      time_total_s: 87.6689863204956
      timestamp: 1623774190
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: c4a3c_00009
  
    Result for DEFAULT_c4a3c_00003:
      accuracy: 0.5105
      date: 2021-06-15_16-23-11
      done: false
      experiment_id: b8c52fc7e76a47f2abe348f26f0a9bbd
      hostname: 615a1934159b
      iterations_since_restore: 4
      loss: 1.3437757709503173
      node_ip: 172.17.0.2
      pid: 1479
      should_checkpoint: true
      time_since_restore: 88.63772416114807
      time_this_iter_s: 19.763057470321655
      time_total_s: 88.63772416114807
      timestamp: 1623774191
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: c4a3c_00003
  
    [2m[36m(pid=1483)[0m [1, 20000] loss: 0.192
    [2m[36m(pid=1500)[0m [1, 14000] loss: 0.328
    [2m[36m(pid=1492)[0m [2,  6000] loss: 0.593
    [2m[36m(pid=1447)[0m [5,  2000] loss: 2.308
    [2m[36m(pid=1452)[0m [5,  2000] loss: 1.168
    [2m[36m(pid=1479)[0m [5,  2000] loss: 1.318
    Result for DEFAULT_c4a3c_00004:
      accuracy: 0.2808
      date: 2021-06-15_16-23-28
      done: false
      experiment_id: df2ed2a57fba4f8b92cdd31bd590c32d
      hostname: 615a1934159b
      iterations_since_restore: 1
      loss: 1.916797140532732
      node_ip: 172.17.0.2
      pid: 1483
      should_checkpoint: true
      time_since_restore: 105.07106590270996
      time_this_iter_s: 105.07106590270996
      time_total_s: 105.07106590270996
      timestamp: 1623774208
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: c4a3c_00004
  
    == Status ==
    Memory usage on this node: 7.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=4
    Bracket: Iter 8.000: None | Iter 4.000: -1.3437757709503173 | Iter 2.000: -1.5206001603126527 | Iter 1.000: -2.151623181724548
    Resources requested: 12.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-06-15_16-21-41
    Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_c4a3c_00000 | RUNNING    | 172.17.0.2:1447 |           16 |    8 |   32 | 0.0359233   | 2.31072 |     0.1044 |                    4 |
    | DEFAULT_c4a3c_00001 | RUNNING    |                 |            2 |  256 |  128 | 0.0193597   |         |            |                      |
    | DEFAULT_c4a3c_00003 | RUNNING    | 172.17.0.2:1479 |           16 |    8 |   32 | 0.00110393  | 1.34378 |     0.5105 |                    4 |
    | DEFAULT_c4a3c_00004 | RUNNING    | 172.17.0.2:1483 |            2 |   16 |   16 | 0.00385544  | 1.9168  |     0.2808 |                    1 |
    | DEFAULT_c4a3c_00006 | RUNNING    | 172.17.0.2:1492 |            4 |  256 |   32 | 0.00734397  | 1.79971 |     0.3427 |                    1 |
    | DEFAULT_c4a3c_00009 | RUNNING    | 172.17.0.2:1452 |           16 |   16 |  256 | 0.0031862   | 1.24729 |     0.5564 |                    4 |
    | DEFAULT_c4a3c_00002 | TERMINATED |                 |            8 |   16 |   16 | 0.000332111 | 2.15162 |     0.2096 |                    1 |
    | DEFAULT_c4a3c_00005 | TERMINATED |                 |            4 |  256 |   32 | 0.0659351   | 2.38558 |     0.1001 |                    1 |
    | DEFAULT_c4a3c_00007 | TERMINATED |                 |            4 |    8 |   32 | 0.000229293 | 2.25449 |     0.1606 |                    1 |
    | DEFAULT_c4a3c_00008 | TERMINATED |                 |            8 |    4 |   32 | 0.0211247   | 2.3058  |     0.1022 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1492)[0m [2,  8000] loss: 0.443
    Result for DEFAULT_c4a3c_00000:
      accuracy: 0.1003
      date: 2021-06-15_16-23-28
      done: false
      experiment_id: 758444e5757c4f019d610998b9eb272d
      hostname: 615a1934159b
      iterations_since_restore: 5
      loss: 2.3054019733428954
      node_ip: 172.17.0.2
      pid: 1447
      should_checkpoint: true
      time_since_restore: 105.99117946624756
      time_this_iter_s: 19.243729829788208
      time_total_s: 105.99117946624756
      timestamp: 1623774208
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: c4a3c_00000
  
    Result for DEFAULT_c4a3c_00009:
      accuracy: 0.5794
      date: 2021-06-15_16-23-29
      done: false
      experiment_id: de8a7e8cf0d045fcb9697edc75341916
      hostname: 615a1934159b
      iterations_since_restore: 5
      loss: 1.2036607970237732
      node_ip: 172.17.0.2
      pid: 1452
      should_checkpoint: true
      time_since_restore: 106.94673681259155
      time_this_iter_s: 19.277750492095947
      time_total_s: 106.94673681259155
      timestamp: 1623774209
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: c4a3c_00009
  
    [2m[36m(pid=1500)[0m [1, 16000] loss: 0.283
    Result for DEFAULT_c4a3c_00003:
      accuracy: 0.5184
      date: 2021-06-15_16-23-31
      done: false
      experiment_id: b8c52fc7e76a47f2abe348f26f0a9bbd
      hostname: 615a1934159b
      iterations_since_restore: 5
      loss: 1.3201262585639955
      node_ip: 172.17.0.2
      pid: 1479
      should_checkpoint: true
      time_since_restore: 108.01372051239014
      time_this_iter_s: 19.375996351242065
      time_total_s: 108.01372051239014
      timestamp: 1623774211
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: c4a3c_00003
  
    [2m[36m(pid=1483)[0m [2,  2000] loss: 1.924
    [2m[36m(pid=1492)[0m [2, 10000] loss: 0.356
    [2m[36m(pid=1447)[0m [6,  2000] loss: 2.308
    [2m[36m(pid=1500)[0m [1, 18000] loss: 0.260
    [2m[36m(pid=1452)[0m [6,  2000] loss: 1.123
    [2m[36m(pid=1483)[0m [2,  4000] loss: 0.969
    [2m[36m(pid=1479)[0m [6,  2000] loss: 1.266
    Result for DEFAULT_c4a3c_00006:
      accuracy: 0.3234
      date: 2021-06-15_16-23-44
      done: true
      experiment_id: 5bff4abdc59241ce835f55a3dcce451f
      hostname: 615a1934159b
      iterations_since_restore: 2
      loss: 1.8271690237522125
      node_ip: 172.17.0.2
      pid: 1492
      should_checkpoint: true
      time_since_restore: 121.5739541053772
      time_this_iter_s: 55.66374349594116
      time_total_s: 121.5739541053772
      timestamp: 1623774224
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: c4a3c_00006
  
    == Status ==
    Memory usage on this node: 7.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: None | Iter 4.000: -1.3437757709503173 | Iter 2.000: -1.6738845920324326 | Iter 1.000: -2.151623181724548
    Resources requested: 12.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-06-15_16-21-41
    Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_c4a3c_00000 | RUNNING    | 172.17.0.2:1447 |           16 |    8 |   32 | 0.0359233   | 2.3054  |     0.1003 |                    5 |
    | DEFAULT_c4a3c_00001 | RUNNING    |                 |            2 |  256 |  128 | 0.0193597   |         |            |                      |
    | DEFAULT_c4a3c_00003 | RUNNING    | 172.17.0.2:1479 |           16 |    8 |   32 | 0.00110393  | 1.32013 |     0.5184 |                    5 |
    | DEFAULT_c4a3c_00004 | RUNNING    | 172.17.0.2:1483 |            2 |   16 |   16 | 0.00385544  | 1.9168  |     0.2808 |                    1 |
    | DEFAULT_c4a3c_00006 | RUNNING    | 172.17.0.2:1492 |            4 |  256 |   32 | 0.00734397  | 1.82717 |     0.3234 |                    2 |
    | DEFAULT_c4a3c_00009 | RUNNING    | 172.17.0.2:1452 |           16 |   16 |  256 | 0.0031862   | 1.20366 |     0.5794 |                    5 |
    | DEFAULT_c4a3c_00002 | TERMINATED |                 |            8 |   16 |   16 | 0.000332111 | 2.15162 |     0.2096 |                    1 |
    | DEFAULT_c4a3c_00005 | TERMINATED |                 |            4 |  256 |   32 | 0.0659351   | 2.38558 |     0.1001 |                    1 |
    | DEFAULT_c4a3c_00007 | TERMINATED |                 |            4 |    8 |   32 | 0.000229293 | 2.25449 |     0.1606 |                    1 |
    | DEFAULT_c4a3c_00008 | TERMINATED |                 |            8 |    4 |   32 | 0.0211247   | 2.3058  |     0.1022 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_c4a3c_00000:
      accuracy: 0.1019
      date: 2021-06-15_16-23-48
      done: false
      experiment_id: 758444e5757c4f019d610998b9eb272d
      hostname: 615a1934159b
      iterations_since_restore: 6
      loss: 2.3049231948852538
      node_ip: 172.17.0.2
      pid: 1447
      should_checkpoint: true
      time_since_restore: 125.0694522857666
      time_this_iter_s: 19.078272819519043
      time_total_s: 125.0694522857666
      timestamp: 1623774228
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: c4a3c_00000
  
    Result for DEFAULT_c4a3c_00009:
      accuracy: 0.5986
      date: 2021-06-15_16-23-49
      done: false
      experiment_id: de8a7e8cf0d045fcb9697edc75341916
      hostname: 615a1934159b
      iterations_since_restore: 6
      loss: 1.13774745593071
      node_ip: 172.17.0.2
      pid: 1452
      should_checkpoint: true
      time_since_restore: 126.22222781181335
      time_this_iter_s: 19.2754909992218
      time_total_s: 126.22222781181335
      timestamp: 1623774229
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: c4a3c_00009
  
    Result for DEFAULT_c4a3c_00003:
      accuracy: 0.5546
      date: 2021-06-15_16-23-50
      done: false
      experiment_id: b8c52fc7e76a47f2abe348f26f0a9bbd
      hostname: 615a1934159b
      iterations_since_restore: 6
      loss: 1.2343854907989502
      node_ip: 172.17.0.2
      pid: 1479
      should_checkpoint: true
      time_since_restore: 127.29196786880493
      time_this_iter_s: 19.278247356414795
      time_total_s: 127.29196786880493
      timestamp: 1623774230
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: c4a3c_00003
  
    == Status ==
    Memory usage on this node: 6.8/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: None | Iter 4.000: -1.3437757709503173 | Iter 2.000: -1.6738845920324326 | Iter 1.000: -2.151623181724548
    Resources requested: 10.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-06-15_16-21-41
    Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_c4a3c_00000 | RUNNING    | 172.17.0.2:1447 |           16 |    8 |   32 | 0.0359233   | 2.30492 |     0.1019 |                    6 |
    | DEFAULT_c4a3c_00001 | RUNNING    |                 |            2 |  256 |  128 | 0.0193597   |         |            |                      |
    | DEFAULT_c4a3c_00003 | RUNNING    | 172.17.0.2:1479 |           16 |    8 |   32 | 0.00110393  | 1.23439 |     0.5546 |                    6 |
    | DEFAULT_c4a3c_00004 | RUNNING    | 172.17.0.2:1483 |            2 |   16 |   16 | 0.00385544  | 1.9168  |     0.2808 |                    1 |
    | DEFAULT_c4a3c_00009 | RUNNING    | 172.17.0.2:1452 |           16 |   16 |  256 | 0.0031862   | 1.13775 |     0.5986 |                    6 |
    | DEFAULT_c4a3c_00002 | TERMINATED |                 |            8 |   16 |   16 | 0.000332111 | 2.15162 |     0.2096 |                    1 |
    | DEFAULT_c4a3c_00005 | TERMINATED |                 |            4 |  256 |   32 | 0.0659351   | 2.38558 |     0.1001 |                    1 |
    | DEFAULT_c4a3c_00006 | TERMINATED |                 |            4 |  256 |   32 | 0.00734397  | 1.82717 |     0.3234 |                    2 |
    | DEFAULT_c4a3c_00007 | TERMINATED |                 |            4 |    8 |   32 | 0.000229293 | 2.25449 |     0.1606 |                    1 |
    | DEFAULT_c4a3c_00008 | TERMINATED |                 |            8 |    4 |   32 | 0.0211247   | 2.3058  |     0.1022 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1483)[0m [2,  6000] loss: 0.637
    [2m[36m(pid=1500)[0m [1, 20000] loss: 0.232
    [2m[36m(pid=1483)[0m [2,  8000] loss: 0.489
    [2m[36m(pid=1447)[0m [7,  2000] loss: 2.308
    [2m[36m(pid=1452)[0m [7,  2000] loss: 1.100
    [2m[36m(pid=1479)[0m [7,  2000] loss: 1.226
    Result for DEFAULT_c4a3c_00000:
      accuracy: 0.0997
      date: 2021-06-15_16-24-06
      done: false
      experiment_id: 758444e5757c4f019d610998b9eb272d
      hostname: 615a1934159b
      iterations_since_restore: 7
      loss: 2.309821306228638
      node_ip: 172.17.0.2
      pid: 1447
      should_checkpoint: true
      time_since_restore: 143.83607840538025
      time_this_iter_s: 18.766626119613647
      time_total_s: 143.83607840538025
      timestamp: 1623774246
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: c4a3c_00000
  
    == Status ==
    Memory usage on this node: 6.8/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: None | Iter 4.000: -1.3437757709503173 | Iter 2.000: -1.6738845920324326 | Iter 1.000: -2.151623181724548
    Resources requested: 10.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-06-15_16-21-41
    Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_c4a3c_00000 | RUNNING    | 172.17.0.2:1447 |           16 |    8 |   32 | 0.0359233   | 2.30982 |     0.0997 |                    7 |
    | DEFAULT_c4a3c_00001 | RUNNING    |                 |            2 |  256 |  128 | 0.0193597   |         |            |                      |
    | DEFAULT_c4a3c_00003 | RUNNING    | 172.17.0.2:1479 |           16 |    8 |   32 | 0.00110393  | 1.23439 |     0.5546 |                    6 |
    | DEFAULT_c4a3c_00004 | RUNNING    | 172.17.0.2:1483 |            2 |   16 |   16 | 0.00385544  | 1.9168  |     0.2808 |                    1 |
    | DEFAULT_c4a3c_00009 | RUNNING    | 172.17.0.2:1452 |           16 |   16 |  256 | 0.0031862   | 1.13775 |     0.5986 |                    6 |
    | DEFAULT_c4a3c_00002 | TERMINATED |                 |            8 |   16 |   16 | 0.000332111 | 2.15162 |     0.2096 |                    1 |
    | DEFAULT_c4a3c_00005 | TERMINATED |                 |            4 |  256 |   32 | 0.0659351   | 2.38558 |     0.1001 |                    1 |
    | DEFAULT_c4a3c_00006 | TERMINATED |                 |            4 |  256 |   32 | 0.00734397  | 1.82717 |     0.3234 |                    2 |
    | DEFAULT_c4a3c_00007 | TERMINATED |                 |            4 |    8 |   32 | 0.000229293 | 2.25449 |     0.1606 |                    1 |
    | DEFAULT_c4a3c_00008 | TERMINATED |                 |            8 |    4 |   32 | 0.0211247   | 2.3058  |     0.1022 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1483)[0m [2, 10000] loss: 0.390
    Result for DEFAULT_c4a3c_00001:
      accuracy: 0.0993
      date: 2021-06-15_16-24-07
      done: true
      experiment_id: af936f7188224edf9e92ac9920ddbfee
      hostname: 615a1934159b
      iterations_since_restore: 1
      loss: 2.321391214323044
      node_ip: 172.17.0.2
      pid: 1500
      should_checkpoint: true
      time_since_restore: 144.77335381507874
      time_this_iter_s: 144.77335381507874
      time_total_s: 144.77335381507874
      timestamp: 1623774247
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: c4a3c_00001
  
    Result for DEFAULT_c4a3c_00009:
      accuracy: 0.6166
      date: 2021-06-15_16-24-08
      done: false
      experiment_id: de8a7e8cf0d045fcb9697edc75341916
      hostname: 615a1934159b
      iterations_since_restore: 7
      loss: 1.1032763731002808
      node_ip: 172.17.0.2
      pid: 1452
      should_checkpoint: true
      time_since_restore: 145.21147179603577
      time_this_iter_s: 18.989243984222412
      time_total_s: 145.21147179603577
      timestamp: 1623774248
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: c4a3c_00009
  
    Result for DEFAULT_c4a3c_00003:
      accuracy: 0.548
      date: 2021-06-15_16-24-09
      done: false
      experiment_id: b8c52fc7e76a47f2abe348f26f0a9bbd
      hostname: 615a1934159b
      iterations_since_restore: 7
      loss: 1.2435762419700622
      node_ip: 172.17.0.2
      pid: 1479
      should_checkpoint: true
      time_since_restore: 146.29103064537048
      time_this_iter_s: 18.99906277656555
      time_total_s: 146.29103064537048
      timestamp: 1623774249
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: c4a3c_00003
  
    [2m[36m(pid=1483)[0m [2, 12000] loss: 0.323
    [2m[36m(pid=1447)[0m [8,  2000] loss: 2.308
    [2m[36m(pid=1452)[0m [8,  2000] loss: 1.071
    [2m[36m(pid=1479)[0m [8,  2000] loss: 1.189
    [2m[36m(pid=1483)[0m [2, 14000] loss: 0.280
    Result for DEFAULT_c4a3c_00000:
      accuracy: 0.1003
      date: 2021-06-15_16-24-25
      done: false
      experiment_id: 758444e5757c4f019d610998b9eb272d
      hostname: 615a1934159b
      iterations_since_restore: 8
      loss: 2.3060981269836427
      node_ip: 172.17.0.2
      pid: 1447
      should_checkpoint: true
      time_since_restore: 162.18670773506165
      time_this_iter_s: 18.350629329681396
      time_total_s: 162.18670773506165
      timestamp: 1623774265
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: c4a3c_00000
  
    == Status ==
    Memory usage on this node: 6.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: -2.3060981269836427 | Iter 4.000: -1.3437757709503173 | Iter 2.000: -1.6738845920324326 | Iter 1.000: -2.2030544661045073
    Resources requested: 8.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-06-15_16-21-41
    Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_c4a3c_00000 | RUNNING    | 172.17.0.2:1447 |           16 |    8 |   32 | 0.0359233   | 2.3061  |     0.1003 |                    8 |
    | DEFAULT_c4a3c_00003 | RUNNING    | 172.17.0.2:1479 |           16 |    8 |   32 | 0.00110393  | 1.24358 |     0.548  |                    7 |
    | DEFAULT_c4a3c_00004 | RUNNING    | 172.17.0.2:1483 |            2 |   16 |   16 | 0.00385544  | 1.9168  |     0.2808 |                    1 |
    | DEFAULT_c4a3c_00009 | RUNNING    | 172.17.0.2:1452 |           16 |   16 |  256 | 0.0031862   | 1.10328 |     0.6166 |                    7 |
    | DEFAULT_c4a3c_00001 | TERMINATED |                 |            2 |  256 |  128 | 0.0193597   | 2.32139 |     0.0993 |                    1 |
    | DEFAULT_c4a3c_00002 | TERMINATED |                 |            8 |   16 |   16 | 0.000332111 | 2.15162 |     0.2096 |                    1 |
    | DEFAULT_c4a3c_00005 | TERMINATED |                 |            4 |  256 |   32 | 0.0659351   | 2.38558 |     0.1001 |                    1 |
    | DEFAULT_c4a3c_00006 | TERMINATED |                 |            4 |  256 |   32 | 0.00734397  | 1.82717 |     0.3234 |                    2 |
    | DEFAULT_c4a3c_00007 | TERMINATED |                 |            4 |    8 |   32 | 0.000229293 | 2.25449 |     0.1606 |                    1 |
    | DEFAULT_c4a3c_00008 | TERMINATED |                 |            8 |    4 |   32 | 0.0211247   | 2.3058  |     0.1022 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_c4a3c_00009:
      accuracy: 0.6065
      date: 2021-06-15_16-24-26
      done: false
      experiment_id: de8a7e8cf0d045fcb9697edc75341916
      hostname: 615a1934159b
      iterations_since_restore: 8
      loss: 1.120782018184662
      node_ip: 172.17.0.2
      pid: 1452
      should_checkpoint: true
      time_since_restore: 163.6553657054901
      time_this_iter_s: 18.443893909454346
      time_total_s: 163.6553657054901
      timestamp: 1623774266
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: c4a3c_00009
  
    Result for DEFAULT_c4a3c_00003:
      accuracy: 0.5522
      date: 2021-06-15_16-24-28
      done: false
      experiment_id: b8c52fc7e76a47f2abe348f26f0a9bbd
      hostname: 615a1934159b
      iterations_since_restore: 8
      loss: 1.2390765377998352
      node_ip: 172.17.0.2
      pid: 1479
      should_checkpoint: true
      time_since_restore: 165.26633167266846
      time_this_iter_s: 18.975301027297974
      time_total_s: 165.26633167266846
      timestamp: 1623774268
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: c4a3c_00003
  
    [2m[36m(pid=1483)[0m [2, 16000] loss: 0.245
    [2m[36m(pid=1483)[0m [2, 18000] loss: 0.219
    [2m[36m(pid=1447)[0m [9,  2000] loss: 2.308
    [2m[36m(pid=1452)[0m [9,  2000] loss: 1.053
    [2m[36m(pid=1479)[0m [9,  2000] loss: 1.172
    Result for DEFAULT_c4a3c_00000:
      accuracy: 0.1003
      date: 2021-06-15_16-24-44
      done: false
      experiment_id: 758444e5757c4f019d610998b9eb272d
      hostname: 615a1934159b
      iterations_since_restore: 9
      loss: 2.3062274433135985
      node_ip: 172.17.0.2
      pid: 1447
      should_checkpoint: true
      time_since_restore: 181.2393856048584
      time_this_iter_s: 19.052677869796753
      time_total_s: 181.2393856048584
      timestamp: 1623774284
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: c4a3c_00000
  
    == Status ==
    Memory usage on this node: 6.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: -1.2390765377998352 | Iter 4.000: -1.3437757709503173 | Iter 2.000: -1.6738845920324326 | Iter 1.000: -2.2030544661045073
    Resources requested: 8.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-06-15_16-21-41
    Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_c4a3c_00000 | RUNNING    | 172.17.0.2:1447 |           16 |    8 |   32 | 0.0359233   | 2.30623 |     0.1003 |                    9 |
    | DEFAULT_c4a3c_00003 | RUNNING    | 172.17.0.2:1479 |           16 |    8 |   32 | 0.00110393  | 1.23908 |     0.5522 |                    8 |
    | DEFAULT_c4a3c_00004 | RUNNING    | 172.17.0.2:1483 |            2 |   16 |   16 | 0.00385544  | 1.9168  |     0.2808 |                    1 |
    | DEFAULT_c4a3c_00009 | RUNNING    | 172.17.0.2:1452 |           16 |   16 |  256 | 0.0031862   | 1.12078 |     0.6065 |                    8 |
    | DEFAULT_c4a3c_00001 | TERMINATED |                 |            2 |  256 |  128 | 0.0193597   | 2.32139 |     0.0993 |                    1 |
    | DEFAULT_c4a3c_00002 | TERMINATED |                 |            8 |   16 |   16 | 0.000332111 | 2.15162 |     0.2096 |                    1 |
    | DEFAULT_c4a3c_00005 | TERMINATED |                 |            4 |  256 |   32 | 0.0659351   | 2.38558 |     0.1001 |                    1 |
    | DEFAULT_c4a3c_00006 | TERMINATED |                 |            4 |  256 |   32 | 0.00734397  | 1.82717 |     0.3234 |                    2 |
    | DEFAULT_c4a3c_00007 | TERMINATED |                 |            4 |    8 |   32 | 0.000229293 | 2.25449 |     0.1606 |                    1 |
    | DEFAULT_c4a3c_00008 | TERMINATED |                 |            8 |    4 |   32 | 0.0211247   | 2.3058  |     0.1022 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1483)[0m [2, 20000] loss: 0.201
    Result for DEFAULT_c4a3c_00009:
      accuracy: 0.5896
      date: 2021-06-15_16-24-44
      done: false
      experiment_id: de8a7e8cf0d045fcb9697edc75341916
      hostname: 615a1934159b
      iterations_since_restore: 9
      loss: 1.1562930879116058
      node_ip: 172.17.0.2
      pid: 1452
      should_checkpoint: true
      time_since_restore: 181.96829795837402
      time_this_iter_s: 18.31293225288391
      time_total_s: 181.96829795837402
      timestamp: 1623774284
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: c4a3c_00009
  
    Result for DEFAULT_c4a3c_00003:
      accuracy: 0.5452
      date: 2021-06-15_16-24-46
      done: false
      experiment_id: b8c52fc7e76a47f2abe348f26f0a9bbd
      hostname: 615a1934159b
      iterations_since_restore: 9
      loss: 1.2674719321250916
      node_ip: 172.17.0.2
      pid: 1479
      should_checkpoint: true
      time_since_restore: 183.80494213104248
      time_this_iter_s: 18.538610458374023
      time_total_s: 183.80494213104248
      timestamp: 1623774286
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: c4a3c_00003
  
    Result for DEFAULT_c4a3c_00004:
      accuracy: 0.2488
      date: 2021-06-15_16-24-56
      done: true
      experiment_id: df2ed2a57fba4f8b92cdd31bd590c32d
      hostname: 615a1934159b
      iterations_since_restore: 2
      loss: 2.0477545131549237
      node_ip: 172.17.0.2
      pid: 1483
      should_checkpoint: true
      time_since_restore: 193.2767961025238
      time_this_iter_s: 88.20573019981384
      time_total_s: 193.2767961025238
      timestamp: 1623774296
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: c4a3c_00004
  
    == Status ==
    Memory usage on this node: 6.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: -1.2390765377998352 | Iter 4.000: -1.3437757709503173 | Iter 2.000: -1.8271690237522125 | Iter 1.000: -2.2030544661045073
    Resources requested: 8.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-06-15_16-21-41
    Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_c4a3c_00000 | RUNNING    | 172.17.0.2:1447 |           16 |    8 |   32 | 0.0359233   | 2.30623 |     0.1003 |                    9 |
    | DEFAULT_c4a3c_00003 | RUNNING    | 172.17.0.2:1479 |           16 |    8 |   32 | 0.00110393  | 1.26747 |     0.5452 |                    9 |
    | DEFAULT_c4a3c_00004 | RUNNING    | 172.17.0.2:1483 |            2 |   16 |   16 | 0.00385544  | 2.04775 |     0.2488 |                    2 |
    | DEFAULT_c4a3c_00009 | RUNNING    | 172.17.0.2:1452 |           16 |   16 |  256 | 0.0031862   | 1.15629 |     0.5896 |                    9 |
    | DEFAULT_c4a3c_00001 | TERMINATED |                 |            2 |  256 |  128 | 0.0193597   | 2.32139 |     0.0993 |                    1 |
    | DEFAULT_c4a3c_00002 | TERMINATED |                 |            8 |   16 |   16 | 0.000332111 | 2.15162 |     0.2096 |                    1 |
    | DEFAULT_c4a3c_00005 | TERMINATED |                 |            4 |  256 |   32 | 0.0659351   | 2.38558 |     0.1001 |                    1 |
    | DEFAULT_c4a3c_00006 | TERMINATED |                 |            4 |  256 |   32 | 0.00734397  | 1.82717 |     0.3234 |                    2 |
    | DEFAULT_c4a3c_00007 | TERMINATED |                 |            4 |    8 |   32 | 0.000229293 | 2.25449 |     0.1606 |                    1 |
    | DEFAULT_c4a3c_00008 | TERMINATED |                 |            8 |    4 |   32 | 0.0211247   | 2.3058  |     0.1022 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1447)[0m [10,  2000] loss: 2.308
    [2m[36m(pid=1452)[0m [10,  2000] loss: 1.043
    [2m[36m(pid=1479)[0m [10,  2000] loss: 1.148
    Result for DEFAULT_c4a3c_00000:
      accuracy: 0.0978
      date: 2021-06-15_16-25-02
      done: true
      experiment_id: 758444e5757c4f019d610998b9eb272d
      hostname: 615a1934159b
      iterations_since_restore: 10
      loss: 2.3057401542663576
      node_ip: 172.17.0.2
      pid: 1447
      should_checkpoint: true
      time_since_restore: 199.58976674079895
      time_this_iter_s: 18.35038113594055
      time_total_s: 199.58976674079895
      timestamp: 1623774302
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: c4a3c_00000
  
    == Status ==
    Memory usage on this node: 5.6/240.1 GiB
    Using AsyncHyperBand: num_stopped=8
    Bracket: Iter 8.000: -1.2390765377998352 | Iter 4.000: -1.3437757709503173 | Iter 2.000: -1.8271690237522125 | Iter 1.000: -2.2030544661045073
    Resources requested: 6.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-06-15_16-21-41
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_c4a3c_00000 | RUNNING    | 172.17.0.2:1447 |           16 |    8 |   32 | 0.0359233   | 2.30574 |     0.0978 |                   10 |
    | DEFAULT_c4a3c_00003 | RUNNING    | 172.17.0.2:1479 |           16 |    8 |   32 | 0.00110393  | 1.26747 |     0.5452 |                    9 |
    | DEFAULT_c4a3c_00009 | RUNNING    | 172.17.0.2:1452 |           16 |   16 |  256 | 0.0031862   | 1.15629 |     0.5896 |                    9 |
    | DEFAULT_c4a3c_00001 | TERMINATED |                 |            2 |  256 |  128 | 0.0193597   | 2.32139 |     0.0993 |                    1 |
    | DEFAULT_c4a3c_00002 | TERMINATED |                 |            8 |   16 |   16 | 0.000332111 | 2.15162 |     0.2096 |                    1 |
    | DEFAULT_c4a3c_00004 | TERMINATED |                 |            2 |   16 |   16 | 0.00385544  | 2.04775 |     0.2488 |                    2 |
    | DEFAULT_c4a3c_00005 | TERMINATED |                 |            4 |  256 |   32 | 0.0659351   | 2.38558 |     0.1001 |                    1 |
    | DEFAULT_c4a3c_00006 | TERMINATED |                 |            4 |  256 |   32 | 0.00734397  | 1.82717 |     0.3234 |                    2 |
    | DEFAULT_c4a3c_00007 | TERMINATED |                 |            4 |    8 |   32 | 0.000229293 | 2.25449 |     0.1606 |                    1 |
    | DEFAULT_c4a3c_00008 | TERMINATED |                 |            8 |    4 |   32 | 0.0211247   | 2.3058  |     0.1022 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_c4a3c_00009:
      accuracy: 0.607
      date: 2021-06-15_16-25-03
      done: true
      experiment_id: de8a7e8cf0d045fcb9697edc75341916
      hostname: 615a1934159b
      iterations_since_restore: 10
      loss: 1.1222736031055451
      node_ip: 172.17.0.2
      pid: 1452
      should_checkpoint: true
      time_since_restore: 200.44778561592102
      time_this_iter_s: 18.479487657546997
      time_total_s: 200.44778561592102
      timestamp: 1623774303
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: c4a3c_00009
  
    Result for DEFAULT_c4a3c_00003:
      accuracy: 0.5712
      date: 2021-06-15_16-25-05
      done: true
      experiment_id: b8c52fc7e76a47f2abe348f26f0a9bbd
      hostname: 615a1934159b
      iterations_since_restore: 10
      loss: 1.1875498938560485
      node_ip: 172.17.0.2
      pid: 1479
      should_checkpoint: true
      time_since_restore: 202.14835453033447
      time_this_iter_s: 18.343412399291992
      time_total_s: 202.14835453033447
      timestamp: 1623774305
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: c4a3c_00003
  
    == Status ==
    Memory usage on this node: 4.0/240.1 GiB
    Using AsyncHyperBand: num_stopped=10
    Bracket: Iter 8.000: -1.2390765377998352 | Iter 4.000: -1.3437757709503173 | Iter 2.000: -1.8271690237522125 | Iter 1.000: -2.2030544661045073
    Resources requested: 0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-06-15_16-21-41
    Number of trials: 10/10 (10 TERMINATED)
    +---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc   |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_c4a3c_00000 | TERMINATED |       |           16 |    8 |   32 | 0.0359233   | 2.30574 |     0.0978 |                   10 |
    | DEFAULT_c4a3c_00001 | TERMINATED |       |            2 |  256 |  128 | 0.0193597   | 2.32139 |     0.0993 |                    1 |
    | DEFAULT_c4a3c_00002 | TERMINATED |       |            8 |   16 |   16 | 0.000332111 | 2.15162 |     0.2096 |                    1 |
    | DEFAULT_c4a3c_00003 | TERMINATED |       |           16 |    8 |   32 | 0.00110393  | 1.18755 |     0.5712 |                   10 |
    | DEFAULT_c4a3c_00004 | TERMINATED |       |            2 |   16 |   16 | 0.00385544  | 2.04775 |     0.2488 |                    2 |
    | DEFAULT_c4a3c_00005 | TERMINATED |       |            4 |  256 |   32 | 0.0659351   | 2.38558 |     0.1001 |                    1 |
    | DEFAULT_c4a3c_00006 | TERMINATED |       |            4 |  256 |   32 | 0.00734397  | 1.82717 |     0.3234 |                    2 |
    | DEFAULT_c4a3c_00007 | TERMINATED |       |            4 |    8 |   32 | 0.000229293 | 2.25449 |     0.1606 |                    1 |
    | DEFAULT_c4a3c_00008 | TERMINATED |       |            8 |    4 |   32 | 0.0211247   | 2.3058  |     0.1022 |                    1 |
    | DEFAULT_c4a3c_00009 | TERMINATED |       |           16 |   16 |  256 | 0.0031862   | 1.12227 |     0.607  |                   10 |
    +---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+


    Best trial config: {'l1': 16, 'l2': 256, 'lr': 0.003186196483950659, 'batch_size': 16}
    Best trial final validation loss: 1.1222736031055451
    Best trial final validation accuracy: 0.607
    Files already downloaded and verified
    Files already downloaded and verified
    Best trial test set accuracy: 0.6012


If you run the code, an example output could look like this:

::

    Number of trials: 10 (10 TERMINATED)
    +-----+------+------+-------------+--------------+---------+------------+--------------------+
    | ... |   l1 |   l2 |          lr |   batch_size |    loss |   accuracy | training_iteration |
    |-----+------+------+-------------+--------------+---------+------------+--------------------|
    | ... |   64 |    4 | 0.00011629  |            2 | 1.87273 |     0.244  |                  2 |
    | ... |   32 |   64 | 0.000339763 |            8 | 1.23603 |     0.567  |                  8 |
    | ... |    8 |   16 | 0.00276249  |           16 | 1.1815  |     0.5836 |                 10 |
    | ... |    4 |   64 | 0.000648721 |            4 | 1.31131 |     0.5224 |                  8 |
    | ... |   32 |   16 | 0.000340753 |            8 | 1.26454 |     0.5444 |                  8 |
    | ... |    8 |    4 | 0.000699775 |            8 | 1.99594 |     0.1983 |                  2 |
    | ... |  256 |    8 | 0.0839654   |           16 | 2.3119  |     0.0993 |                  1 |
    | ... |   16 |  128 | 0.0758154   |           16 | 2.33575 |     0.1327 |                  1 |
    | ... |   16 |    8 | 0.0763312   |           16 | 2.31129 |     0.1042 |                  4 |
    | ... |  128 |   16 | 0.000124903 |            4 | 2.26917 |     0.1945 |                  1 |
    +-----+------+------+-------------+--------------+---------+------------+--------------------+


    Best trial config: {'l1': 8, 'l2': 16, 'lr': 0.00276249, 'batch_size': 16, 'data_dir': '...'}
    Best trial final validation loss: 1.181501
    Best trial final validation accuracy: 0.5836
    Best trial test set accuracy: 0.5806

Most trials have been stopped early in order to avoid wasting resources.
The best performing trial achieved a validation accuracy of about 58%, which could
be confirmed on the test set.

So that's it! You can now tune the parameters of your PyTorch models.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 3 minutes  43.832 seconds)


.. _sphx_glr_download_beginner_hyperparameter_tuning_tutorial.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download

     :download:`Download Python source code: hyperparameter_tuning_tutorial.py <hyperparameter_tuning_tutorial.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: hyperparameter_tuning_tutorial.ipynb <hyperparameter_tuning_tutorial.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.readthedocs.io>`_
