.. note::
    :class: sphx-glr-download-link-note

    Click :ref:`here <sphx_glr_download_beginner_hyperparameter_tuning_tutorial.py>` to download the full example code
.. rst-class:: sphx-glr-example-title

.. _sphx_glr_beginner_hyperparameter_tuning_tutorial.py:


Hyperparameter tuning with Ray Tune
===================================

Hyperparameter tuning can make the difference between an average model and a highly
accurate one. Often simple things like choosing a different learning rate or changing
a network layer size can have a dramatic impact on your model performance.

Fortunately, there are tools that help with finding the best combination of parameters.
`Ray Tune <https://docs.ray.io/en/latest/tune.html>`_ is an industry standard tool for
distributed hyperparameter tuning. Ray Tune includes the latest hyperparameter search
algorithms, integrates with TensorBoard and other analysis libraries, and natively
supports distributed training through `Ray's distributed machine learning engine
<https://ray.io/>`_.

In this tutorial, we will show you how to integrate Ray Tune into your PyTorch
training workflow. We will extend `this tutorial from the PyTorch documentation
<https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html>`_ for training
a CIFAR10 image classifier.

As you will see, we only need to add some slight modifications. In particular, we
need to

1. wrap data loading and training in functions,
2. make some network parameters configurable,
3. add checkpointing (optional),
4. and define the search space for the model tuning

|

To run this tutorial, please make sure the following packages are
installed:

-  ``ray[tune]``: Distributed hyperparameter tuning library
-  ``torchvision``: For the data transformers

Setup / Imports
---------------
Let's start with the imports:


.. code-block:: default

    from functools import partial
    import numpy as np
    import os
    import torch
    import torch.nn as nn
    import torch.nn.functional as F
    import torch.optim as optim
    from torch.utils.data import random_split
    import torchvision
    import torchvision.transforms as transforms
    from ray import tune
    from ray.tune import CLIReporter
    from ray.tune.schedulers import ASHAScheduler







Most of the imports are needed for building the PyTorch model. Only the last three
imports are for Ray Tune.

Data loaders
------------
We wrap the data loaders in their own function and pass a global data directory.
This way we can share a data directory between different trials.


.. code-block:: default



    def load_data(data_dir="./data"):
        transform = transforms.Compose([
            transforms.ToTensor(),
            transforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5))
        ])

        trainset = torchvision.datasets.CIFAR10(
            root=data_dir, train=True, download=True, transform=transform)

        testset = torchvision.datasets.CIFAR10(
            root=data_dir, train=False, download=True, transform=transform)

        return trainset, testset







Configurable neural network
---------------------------
We can only tune those parameters that are configurable. In this example, we can specify
the layer sizes of the fully connected layers:


.. code-block:: default



    class Net(nn.Module):
        def __init__(self, l1=120, l2=84):
            super(Net, self).__init__()
            self.conv1 = nn.Conv2d(3, 6, 5)
            self.pool = nn.MaxPool2d(2, 2)
            self.conv2 = nn.Conv2d(6, 16, 5)
            self.fc1 = nn.Linear(16 * 5 * 5, l1)
            self.fc2 = nn.Linear(l1, l2)
            self.fc3 = nn.Linear(l2, 10)

        def forward(self, x):
            x = self.pool(F.relu(self.conv1(x)))
            x = self.pool(F.relu(self.conv2(x)))
            x = x.view(-1, 16 * 5 * 5)
            x = F.relu(self.fc1(x))
            x = F.relu(self.fc2(x))
            x = self.fc3(x)
            return x







The train function
------------------
Now it gets interesting, because we introduce some changes to the example `from the PyTorch
documentation <https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html>`_.

We wrap the training script in a function ``train_cifar(config, checkpoint_dir=None, data_dir=None)``.
As you can guess, the ``config`` parameter will receive the hyperparameters we would like to
train with. The ``checkpoint_dir`` parameter is used to restore checkpoints. The ``data_dir`` specifies
the directory where we load and store the data, so multiple runs can share the same data source.

.. code-block:: python

    net = Net(config["l1"], config["l2"])

    if checkpoint_dir:
        model_state, optimizer_state = torch.load(
            os.path.join(checkpoint_dir, "checkpoint"))
        net.load_state_dict(model_state)
        optimizer.load_state_dict(optimizer_state)

The learning rate of the optimizer is made configurable, too:

.. code-block:: python

    optimizer = optim.SGD(net.parameters(), lr=config["lr"], momentum=0.9)

We also split the training data into a training and validation subset. We thus train on
80% of the data and calculate the validation loss on the remaining 20%. The batch sizes
with which we iterate through the training and test sets are configurable as well.

Adding (multi) GPU support with DataParallel
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Image classification benefits largely from GPUs. Luckily, we can continue to use
PyTorch's abstractions in Ray Tune. Thus, we can wrap our model in ``nn.DataParallel``
to support data parallel training on multiple GPUs:

.. code-block:: python

    device = "cpu"
    if torch.cuda.is_available():
        device = "cuda:0"
        if torch.cuda.device_count() > 1:
            net = nn.DataParallel(net)
    net.to(device)

By using a ``device`` variable we make sure that training also works when we have
no GPUs available. PyTorch requires us to send our data to the GPU memory explicitly,
like this:

.. code-block:: python

    for i, data in enumerate(trainloader, 0):
        inputs, labels = data
        inputs, labels = inputs.to(device), labels.to(device)

The code now supports training on CPUs, on a single GPU, and on multiple GPUs. Notably, Ray
also supports `fractional GPUs <https://docs.ray.io/en/master/using-ray-with-gpus.html#fractional-gpus>`_
so we can share GPUs among trials, as long as the model still fits on the GPU memory. We'll come back
to that later.

Communicating with Ray Tune
~~~~~~~~~~~~~~~~~~~~~~~~~~~

The most interesting part is the communication with Ray Tune:

.. code-block:: python

    with tune.checkpoint_dir(epoch) as checkpoint_dir:
        path = os.path.join(checkpoint_dir, "checkpoint")
        torch.save((net.state_dict(), optimizer.state_dict()), path)

    tune.report(loss=(val_loss / val_steps), accuracy=correct / total)

Here we first save a checkpoint and then report some metrics back to Ray Tune. Specifically,
we send the validation loss and accuracy back to Ray Tune. Ray Tune can then use these metrics
to decide which hyperparameter configuration lead to the best results. These metrics
can also be used to stop bad performing trials early in order to avoid wasting
resources on those trials.

The checkpoint saving is optional, however, it is necessary if we wanted to use advanced
schedulers like
`Population Based Training <https://docs.ray.io/en/master/tune/tutorials/tune-advanced-tutorial.html>`_.
Also, by saving the checkpoint we can later load the trained models and validate them
on a test set.

Full training function
~~~~~~~~~~~~~~~~~~~~~~

The full code example looks like this:


.. code-block:: default



    def train_cifar(config, checkpoint_dir=None, data_dir=None):
        net = Net(config["l1"], config["l2"])

        device = "cpu"
        if torch.cuda.is_available():
            device = "cuda:0"
            if torch.cuda.device_count() > 1:
                net = nn.DataParallel(net)
        net.to(device)

        criterion = nn.CrossEntropyLoss()
        optimizer = optim.SGD(net.parameters(), lr=config["lr"], momentum=0.9)

        if checkpoint_dir:
            model_state, optimizer_state = torch.load(
                os.path.join(checkpoint_dir, "checkpoint"))
            net.load_state_dict(model_state)
            optimizer.load_state_dict(optimizer_state)

        trainset, testset = load_data(data_dir)

        test_abs = int(len(trainset) * 0.8)
        train_subset, val_subset = random_split(
            trainset, [test_abs, len(trainset) - test_abs])

        trainloader = torch.utils.data.DataLoader(
            train_subset,
            batch_size=int(config["batch_size"]),
            shuffle=True,
            num_workers=8)
        valloader = torch.utils.data.DataLoader(
            val_subset,
            batch_size=int(config["batch_size"]),
            shuffle=True,
            num_workers=8)

        for epoch in range(10):  # loop over the dataset multiple times
            running_loss = 0.0
            epoch_steps = 0
            for i, data in enumerate(trainloader, 0):
                # get the inputs; data is a list of [inputs, labels]
                inputs, labels = data
                inputs, labels = inputs.to(device), labels.to(device)

                # zero the parameter gradients
                optimizer.zero_grad()

                # forward + backward + optimize
                outputs = net(inputs)
                loss = criterion(outputs, labels)
                loss.backward()
                optimizer.step()

                # print statistics
                running_loss += loss.item()
                epoch_steps += 1
                if i % 2000 == 1999:  # print every 2000 mini-batches
                    print("[%d, %5d] loss: %.3f" % (epoch + 1, i + 1,
                                                    running_loss / epoch_steps))
                    running_loss = 0.0

            # Validation loss
            val_loss = 0.0
            val_steps = 0
            total = 0
            correct = 0
            for i, data in enumerate(valloader, 0):
                with torch.no_grad():
                    inputs, labels = data
                    inputs, labels = inputs.to(device), labels.to(device)

                    outputs = net(inputs)
                    _, predicted = torch.max(outputs.data, 1)
                    total += labels.size(0)
                    correct += (predicted == labels).sum().item()

                    loss = criterion(outputs, labels)
                    val_loss += loss.cpu().numpy()
                    val_steps += 1

            with tune.checkpoint_dir(epoch) as checkpoint_dir:
                path = os.path.join(checkpoint_dir, "checkpoint")
                torch.save((net.state_dict(), optimizer.state_dict()), path)

            tune.report(loss=(val_loss / val_steps), accuracy=correct / total)
        print("Finished Training")







As you can see, most of the code is adapted directly from the original example.

Test set accuracy
-----------------
Commonly the performance of a machine learning model is tested on a hold-out test
set with data that has not been used for training the model. We also wrap this in a
function:


.. code-block:: default



    def test_accuracy(net, device="cpu"):
        trainset, testset = load_data()

        testloader = torch.utils.data.DataLoader(
            testset, batch_size=4, shuffle=False, num_workers=2)

        correct = 0
        total = 0
        with torch.no_grad():
            for data in testloader:
                images, labels = data
                images, labels = images.to(device), labels.to(device)
                outputs = net(images)
                _, predicted = torch.max(outputs.data, 1)
                total += labels.size(0)
                correct += (predicted == labels).sum().item()

        return correct / total







The function also expects a ``device`` parameter, so we can do the
test set validation on a GPU.

Configuring the search space
----------------------------
Lastly, we need to define Ray Tune's search space. Here is an example:

.. code-block:: python

    config = {
        "l1": tune.sample_from(lambda _: 2**np.random.randint(2, 9)),
        "l2": tune.sample_from(lambda _: 2**np.random.randint(2, 9)),
        "lr": tune.loguniform(1e-4, 1e-1),
        "batch_size": tune.choice([2, 4, 8, 16])
    }

The ``tune.sample_from()`` function makes it possible to define your own sample
methods to obtain hyperparameters. In this example, the ``l1`` and ``l2`` parameters
should be powers of 2 between 4 and 256, so either 4, 8, 16, 32, 64, 128, or 256.
The ``lr`` (learning rate) should be uniformly sampled between 0.0001 and 0.1. Lastly,
the batch size is a choice between 2, 4, 8, and 16.

At each trial, Ray Tune will now randomly sample a combination of parameters from these
search spaces. It will then train a number of models in parallel and find the best
performing one among these. We also use the ``ASHAScheduler`` which will terminate bad
performing trials early.

We wrap the ``train_cifar`` function with ``functools.partial`` to set the constant
``data_dir`` parameter. We can also tell Ray Tune what resources should be
available for each trial:

.. code-block:: python

    gpus_per_trial = 2
    # ...
    result = tune.run(
        partial(train_cifar, data_dir=data_dir),
        resources_per_trial={"cpu": 8, "gpu": gpus_per_trial},
        config=config,
        num_samples=num_samples,
        scheduler=scheduler,
        progress_reporter=reporter,
        checkpoint_at_end=True)

You can specify the number of CPUs, which are then available e.g.
to increase the ``num_workers`` of the PyTorch ``DataLoader`` instances. The selected
number of GPUs are made visible to PyTorch in each trial. Trials do not have access to
GPUs that haven't been requested for them - so you don't have to care about two trials
using the same set of resources.

Here we can also specify fractional GPUs, so something like ``gpus_per_trial=0.5`` is
completely valid. The trials will then share GPUs among each other.
You just have to make sure that the models still fit in the GPU memory.

After training the models, we will find the best performing one and load the trained
network from the checkpoint file. We then obtain the test set accuracy and report
everything by printing.

The full main function looks like this:


.. code-block:: default



    def main(num_samples=10, max_num_epochs=10, gpus_per_trial=2):
        data_dir = os.path.abspath("./data")
        load_data(data_dir)
        config = {
            "l1": tune.sample_from(lambda _: 2 ** np.random.randint(2, 9)),
            "l2": tune.sample_from(lambda _: 2 ** np.random.randint(2, 9)),
            "lr": tune.loguniform(1e-4, 1e-1),
            "batch_size": tune.choice([2, 4, 8, 16])
        }
        scheduler = ASHAScheduler(
            metric="loss",
            mode="min",
            max_t=max_num_epochs,
            grace_period=1,
            reduction_factor=2)
        reporter = CLIReporter(
            # parameter_columns=["l1", "l2", "lr", "batch_size"],
            metric_columns=["loss", "accuracy", "training_iteration"])
        result = tune.run(
            partial(train_cifar, data_dir=data_dir),
            resources_per_trial={"cpu": 2, "gpu": gpus_per_trial},
            config=config,
            num_samples=num_samples,
            scheduler=scheduler,
            progress_reporter=reporter)

        best_trial = result.get_best_trial("loss", "min", "last")
        print("Best trial config: {}".format(best_trial.config))
        print("Best trial final validation loss: {}".format(
            best_trial.last_result["loss"]))
        print("Best trial final validation accuracy: {}".format(
            best_trial.last_result["accuracy"]))

        best_trained_model = Net(best_trial.config["l1"], best_trial.config["l2"])
        device = "cpu"
        if torch.cuda.is_available():
            device = "cuda:0"
            if gpus_per_trial > 1:
                best_trained_model = nn.DataParallel(best_trained_model)
        best_trained_model.to(device)

        best_checkpoint_dir = best_trial.checkpoint.value
        model_state, optimizer_state = torch.load(os.path.join(
            best_checkpoint_dir, "checkpoint"))
        best_trained_model.load_state_dict(model_state)

        test_acc = test_accuracy(best_trained_model, device)
        print("Best trial test set accuracy: {}".format(test_acc))


    if __name__ == "__main__":
        # You can change the number of GPUs per trial here:
        main(num_samples=10, max_num_epochs=10, gpus_per_trial=0)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz
    Extracting /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data
    Files already downloaded and verified
    == Status ==
    Memory usage on this node: 4.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=0
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: None
    Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-13_00-10-29
    Number of trials: 1/10 (1 RUNNING)
    +---------------------+----------+-------+--------------+------+------+------------+
    | Trial name          | status   | loc   |   batch_size |   l1 |   l2 |         lr |
    |---------------------+----------+-------+--------------+------+------+------------|
    | DEFAULT_a7dc9_00000 | RUNNING  |       |            4 |   64 |  128 | 0.00460012 |
    +---------------------+----------+-------+--------------+------+------+------------+


    [2m[36m(pid=1467)[0m Files already downloaded and verified
    [2m[36m(pid=1432)[0m Files already downloaded and verified
    [2m[36m(pid=1427)[0m Files already downloaded and verified
    [2m[36m(pid=1430)[0m Files already downloaded and verified
    [2m[36m(pid=1434)[0m Files already downloaded and verified
    [2m[36m(pid=1429)[0m Files already downloaded and verified
    [2m[36m(pid=1428)[0m Files already downloaded and verified
    [2m[36m(pid=1485)[0m Files already downloaded and verified
    [2m[36m(pid=1433)[0m Files already downloaded and verified
    [2m[36m(pid=1431)[0m Files already downloaded and verified
    [2m[36m(pid=1467)[0m Files already downloaded and verified
    [2m[36m(pid=1432)[0m Files already downloaded and verified
    [2m[36m(pid=1427)[0m Files already downloaded and verified
    [2m[36m(pid=1430)[0m Files already downloaded and verified
    [2m[36m(pid=1434)[0m Files already downloaded and verified
    [2m[36m(pid=1429)[0m Files already downloaded and verified
    [2m[36m(pid=1428)[0m Files already downloaded and verified
    [2m[36m(pid=1485)[0m Files already downloaded and verified
    [2m[36m(pid=1431)[0m Files already downloaded and verified
    [2m[36m(pid=1433)[0m Files already downloaded and verified
    [2m[36m(pid=1432)[0m [1,  2000] loss: 2.210
    [2m[36m(pid=1429)[0m [1,  2000] loss: 2.383
    [2m[36m(pid=1434)[0m [1,  2000] loss: 2.308
    [2m[36m(pid=1427)[0m [1,  2000] loss: 2.004
    [2m[36m(pid=1430)[0m [1,  2000] loss: 2.317
    [2m[36m(pid=1431)[0m [1,  2000] loss: 2.322
    [2m[36m(pid=1485)[0m [1,  2000] loss: 2.323
    [2m[36m(pid=1467)[0m [1,  2000] loss: 2.266
    [2m[36m(pid=1428)[0m [1,  2000] loss: 1.898
    [2m[36m(pid=1433)[0m [1,  2000] loss: 2.287
    [2m[36m(pid=1432)[0m [1,  4000] loss: 1.012
    [2m[36m(pid=1429)[0m [1,  4000] loss: 1.192
    [2m[36m(pid=1434)[0m [1,  4000] loss: 1.157
    [2m[36m(pid=1427)[0m [1,  4000] loss: 0.881
    [2m[36m(pid=1431)[0m [1,  4000] loss: 1.161
    [2m[36m(pid=1430)[0m [1,  4000] loss: 1.158
    [2m[36m(pid=1485)[0m [1,  4000] loss: 1.161
    [2m[36m(pid=1428)[0m [1,  4000] loss: 0.794
    [2m[36m(pid=1467)[0m [1,  4000] loss: 0.962
    [2m[36m(pid=1433)[0m [1,  4000] loss: 1.140
    [2m[36m(pid=1432)[0m [1,  6000] loss: 0.642
    [2m[36m(pid=1429)[0m [1,  6000] loss: 0.795
    [2m[36m(pid=1434)[0m [1,  6000] loss: 0.771
    [2m[36m(pid=1427)[0m [1,  6000] loss: 0.555
    Result for DEFAULT_a7dc9_00004:
      accuracy: 0.0978
      date: 2021-04-13_00-11-10
      done: false
      experiment_id: c4b98eaea4f14af49ea81f4c0c450916
      hostname: f64b9a093aea
      iterations_since_restore: 1
      loss: 2.3155379371643066
      node_ip: 172.17.0.2
      pid: 1431
      should_checkpoint: true
      time_since_restore: 39.384122133255005
      time_this_iter_s: 39.384122133255005
      time_total_s: 39.384122133255005
      timestamp: 1618272670
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: a7dc9_00004
  
    == Status ==
    Memory usage on this node: 9.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=0
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -2.3155379371643066
    Resources requested: 20/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-13_00-10-29
    Number of trials: 10/10 (10 RUNNING)
    +---------------------+----------+-----------------+--------------+------+------+------------+---------+------------+----------------------+
    | Trial name          | status   | loc             |   batch_size |   l1 |   l2 |         lr |    loss |   accuracy |   training_iteration |
    |---------------------+----------+-----------------+--------------+------+------+------------+---------+------------+----------------------|
    | DEFAULT_a7dc9_00000 | RUNNING  |                 |            4 |   64 |  128 | 0.00460012 |         |            |                      |
    | DEFAULT_a7dc9_00001 | RUNNING  |                 |            2 |  256 |    8 | 0.0120715  |         |            |                      |
    | DEFAULT_a7dc9_00002 | RUNNING  |                 |            4 |   16 |    8 | 0.0213926  |         |            |                      |
    | DEFAULT_a7dc9_00003 | RUNNING  |                 |            2 |    4 |  256 | 0.00165723 |         |            |                      |
    | DEFAULT_a7dc9_00004 | RUNNING  | 172.17.0.2:1431 |            8 |    4 |    4 | 0.0644851  | 2.31554 |     0.0978 |                    1 |
    | DEFAULT_a7dc9_00005 | RUNNING  |                 |            8 |   16 |   32 | 0.0771842  |         |            |                      |
    | DEFAULT_a7dc9_00006 | RUNNING  |                 |            8 |   64 |  128 | 0.00519527 |         |            |                      |
    | DEFAULT_a7dc9_00007 | RUNNING  |                 |            8 |  128 |  128 | 0.0690339  |         |            |                      |
    | DEFAULT_a7dc9_00008 | RUNNING  |                 |            2 |   16 |    4 | 0.0733233  |         |            |                      |
    | DEFAULT_a7dc9_00009 | RUNNING  |                 |            8 |  128 |    8 | 0.00133252 |         |            |                      |
    +---------------------+----------+-----------------+--------------+------+------+------------+---------+------------+----------------------+


    Result for DEFAULT_a7dc9_00005:
      accuracy: 0.0982
      date: 2021-04-13_00-11-10
      done: true
      experiment_id: df4ae0c622c24a68857080188bbb1bc2
      hostname: f64b9a093aea
      iterations_since_restore: 1
      loss: 2.3172050054550173
      node_ip: 172.17.0.2
      pid: 1485
      should_checkpoint: true
      time_since_restore: 40.10026025772095
      time_this_iter_s: 40.10026025772095
      time_total_s: 40.10026025772095
      timestamp: 1618272670
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: a7dc9_00005
  
    Result for DEFAULT_a7dc9_00006:
      accuracy: 0.4597
      date: 2021-04-13_00-11-11
      done: false
      experiment_id: 5edaafa398314adfadca90fab59849ca
      hostname: f64b9a093aea
      iterations_since_restore: 1
      loss: 1.4927994678020478
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 40.24941635131836
      time_this_iter_s: 40.24941635131836
      time_total_s: 40.24941635131836
      timestamp: 1618272671
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: a7dc9_00006
  
    Result for DEFAULT_a7dc9_00009:
      accuracy: 0.3844
      date: 2021-04-13_00-11-11
      done: false
      experiment_id: d905d623c4a140d2b6f1346993d9bd3d
      hostname: f64b9a093aea
      iterations_since_restore: 1
      loss: 1.6510787745952606
      node_ip: 172.17.0.2
      pid: 1467
      should_checkpoint: true
      time_since_restore: 40.696608543395996
      time_this_iter_s: 40.696608543395996
      time_total_s: 40.696608543395996
      timestamp: 1618272671
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: a7dc9_00009
  
    [2m[36m(pid=1430)[0m [1,  6000] loss: 0.773
    [2m[36m(pid=1432)[0m [1,  8000] loss: 0.461
    [2m[36m(pid=1429)[0m [1,  8000] loss: 0.596
    Result for DEFAULT_a7dc9_00007:
      accuracy: 0.1613
      date: 2021-04-13_00-11-15
      done: true
      experiment_id: 04c9e43879ca44cc94d0217e879bd5b6
      hostname: f64b9a093aea
      iterations_since_restore: 1
      loss: 2.2255352974891665
      node_ip: 172.17.0.2
      pid: 1433
      should_checkpoint: true
      time_since_restore: 44.211162090301514
      time_this_iter_s: 44.211162090301514
      time_total_s: 44.211162090301514
      timestamp: 1618272675
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: a7dc9_00007
  
    [2m[36m(pid=1434)[0m [1,  8000] loss: 0.579
    [2m[36m(pid=1427)[0m [1,  8000] loss: 0.406
    [2m[36m(pid=1431)[0m [2,  2000] loss: 2.322
    [2m[36m(pid=1428)[0m [2,  2000] loss: 1.447
    [2m[36m(pid=1432)[0m [1, 10000] loss: 0.364
    [2m[36m(pid=1467)[0m [2,  2000] loss: 1.614
    [2m[36m(pid=1429)[0m [1, 10000] loss: 0.477
    [2m[36m(pid=1430)[0m [1,  8000] loss: 0.580
    [2m[36m(pid=1434)[0m [1, 10000] loss: 0.463
    [2m[36m(pid=1427)[0m [1, 10000] loss: 0.322
    [2m[36m(pid=1432)[0m [1, 12000] loss: 0.298
    [2m[36m(pid=1431)[0m [2,  4000] loss: 1.160
    [2m[36m(pid=1429)[0m [1, 12000] loss: 0.398
    [2m[36m(pid=1428)[0m [2,  4000] loss: 0.704
    Result for DEFAULT_a7dc9_00002:
      accuracy: 0.1031
      date: 2021-04-13_00-11-34
      done: true
      experiment_id: 62ee5af6b52948df8ff074417869e3b2
      hostname: f64b9a093aea
      iterations_since_restore: 1
      loss: 2.3139703393936157
      node_ip: 172.17.0.2
      pid: 1434
      should_checkpoint: true
      time_since_restore: 63.909939765930176
      time_this_iter_s: 63.909939765930176
      time_total_s: 63.909939765930176
      timestamp: 1618272694
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: a7dc9_00002
      [2m[36m(pid=1467)[0m [2,  4000] loss: 0.751

    == Status ==
    Memory usage on this node: 8.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=3
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -2.269752818441391
    Resources requested: 16/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-13_00-10-29
    Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |         lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------|
    | DEFAULT_a7dc9_00000 | RUNNING    |                 |            4 |   64 |  128 | 0.00460012 |         |            |                      |
    | DEFAULT_a7dc9_00001 | RUNNING    |                 |            2 |  256 |    8 | 0.0120715  |         |            |                      |
    | DEFAULT_a7dc9_00002 | RUNNING    | 172.17.0.2:1434 |            4 |   16 |    8 | 0.0213926  | 2.31397 |     0.1031 |                    1 |
    | DEFAULT_a7dc9_00003 | RUNNING    |                 |            2 |    4 |  256 | 0.00165723 |         |            |                      |
    | DEFAULT_a7dc9_00004 | RUNNING    | 172.17.0.2:1431 |            8 |    4 |    4 | 0.0644851  | 2.31554 |     0.0978 |                    1 |
    | DEFAULT_a7dc9_00006 | RUNNING    | 172.17.0.2:1428 |            8 |   64 |  128 | 0.00519527 | 1.4928  |     0.4597 |                    1 |
    | DEFAULT_a7dc9_00008 | RUNNING    |                 |            2 |   16 |    4 | 0.0733233  |         |            |                      |
    | DEFAULT_a7dc9_00009 | RUNNING    | 172.17.0.2:1467 |            8 |  128 |    8 | 0.00133252 | 1.65108 |     0.3844 |                    1 |
    | DEFAULT_a7dc9_00005 | TERMINATED |                 |            8 |   16 |   32 | 0.0771842  | 2.31721 |     0.0982 |                    1 |
    | DEFAULT_a7dc9_00007 | TERMINATED |                 |            8 |  128 |  128 | 0.0690339  | 2.22554 |     0.1613 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+


    Result for DEFAULT_a7dc9_00000:
      accuracy: 0.4013
      date: 2021-04-13_00-11-35
      done: false
      experiment_id: 36aba866b6a74bf8a45b30924e2cfe0d
      hostname: f64b9a093aea
      iterations_since_restore: 1
      loss: 1.6217208881616592
      node_ip: 172.17.0.2
      pid: 1427
      should_checkpoint: true
      time_since_restore: 64.37019085884094
      time_this_iter_s: 64.37019085884094
      time_total_s: 64.37019085884094
      timestamp: 1618272695
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: a7dc9_00000
  
    [2m[36m(pid=1430)[0m [1, 10000] loss: 0.463
    [2m[36m(pid=1432)[0m [1, 14000] loss: 0.252
    [2m[36m(pid=1429)[0m [1, 14000] loss: 0.341
    Result for DEFAULT_a7dc9_00004:
      accuracy: 0.1003
      date: 2021-04-13_00-11-42
      done: false
      experiment_id: c4b98eaea4f14af49ea81f4c0c450916
      hostname: f64b9a093aea
      iterations_since_restore: 2
      loss: 2.3171956439971924
      node_ip: 172.17.0.2
      pid: 1431
      should_checkpoint: true
      time_since_restore: 71.36697697639465
      time_this_iter_s: 31.98285484313965
      time_total_s: 71.36697697639465
      timestamp: 1618272702
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: a7dc9_00004
  
    == Status ==
    Memory usage on this node: 7.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=3
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -2.3171956439971924 | Iter 1.000: -2.2255352974891665
    Resources requested: 14/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-13_00-10-29
    Number of trials: 10/10 (7 RUNNING, 3 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |         lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------|
    | DEFAULT_a7dc9_00000 | RUNNING    | 172.17.0.2:1427 |            4 |   64 |  128 | 0.00460012 | 1.62172 |     0.4013 |                    1 |
    | DEFAULT_a7dc9_00001 | RUNNING    |                 |            2 |  256 |    8 | 0.0120715  |         |            |                      |
    | DEFAULT_a7dc9_00003 | RUNNING    |                 |            2 |    4 |  256 | 0.00165723 |         |            |                      |
    | DEFAULT_a7dc9_00004 | RUNNING    | 172.17.0.2:1431 |            8 |    4 |    4 | 0.0644851  | 2.3172  |     0.1003 |                    2 |
    | DEFAULT_a7dc9_00006 | RUNNING    | 172.17.0.2:1428 |            8 |   64 |  128 | 0.00519527 | 1.4928  |     0.4597 |                    1 |
    | DEFAULT_a7dc9_00008 | RUNNING    |                 |            2 |   16 |    4 | 0.0733233  |         |            |                      |
    | DEFAULT_a7dc9_00009 | RUNNING    | 172.17.0.2:1467 |            8 |  128 |    8 | 0.00133252 | 1.65108 |     0.3844 |                    1 |
    | DEFAULT_a7dc9_00002 | TERMINATED |                 |            4 |   16 |    8 | 0.0213926  | 2.31397 |     0.1031 |                    1 |
    | DEFAULT_a7dc9_00005 | TERMINATED |                 |            8 |   16 |   32 | 0.0771842  | 2.31721 |     0.0982 |                    1 |
    | DEFAULT_a7dc9_00007 | TERMINATED |                 |            8 |  128 |  128 | 0.0690339  | 2.22554 |     0.1613 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+


    Result for DEFAULT_a7dc9_00006:
      accuracy: 0.5005
      date: 2021-04-13_00-11-43
      done: false
      experiment_id: 5edaafa398314adfadca90fab59849ca
      hostname: f64b9a093aea
      iterations_since_restore: 2
      loss: 1.4236699146270753
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 72.6453025341034
      time_this_iter_s: 32.395886182785034
      time_total_s: 72.6453025341034
      timestamp: 1618272703
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: a7dc9_00006
  
    Result for DEFAULT_a7dc9_00009:
      accuracy: 0.4658
      date: 2021-04-13_00-11-44
      done: false
      experiment_id: d905d623c4a140d2b6f1346993d9bd3d
      hostname: f64b9a093aea
      iterations_since_restore: 2
      loss: 1.4711346462249757
      node_ip: 172.17.0.2
      pid: 1467
      should_checkpoint: true
      time_since_restore: 73.69337606430054
      time_this_iter_s: 32.99676752090454
      time_total_s: 73.69337606430054
      timestamp: 1618272704
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: a7dc9_00009
  
    [2m[36m(pid=1427)[0m [2,  2000] loss: 1.565
    [2m[36m(pid=1432)[0m [1, 16000] loss: 0.216
    [2m[36m(pid=1430)[0m [1, 12000] loss: 0.386
    [2m[36m(pid=1429)[0m [1, 16000] loss: 0.298
    [2m[36m(pid=1431)[0m [3,  2000] loss: 2.321
    [2m[36m(pid=1427)[0m [2,  4000] loss: 0.784
    [2m[36m(pid=1428)[0m [3,  2000] loss: 1.342
    [2m[36m(pid=1467)[0m [3,  2000] loss: 1.391
    [2m[36m(pid=1432)[0m [1, 18000] loss: 0.191
    [2m[36m(pid=1429)[0m [1, 18000] loss: 0.266
    [2m[36m(pid=1430)[0m [1, 14000] loss: 0.331
    [2m[36m(pid=1431)[0m [3,  4000] loss: 1.160
    [2m[36m(pid=1427)[0m [2,  6000] loss: 0.523
    [2m[36m(pid=1432)[0m [1, 20000] loss: 0.171
    [2m[36m(pid=1428)[0m [3,  4000] loss: 0.667
    [2m[36m(pid=1467)[0m [3,  4000] loss: 0.674
    [2m[36m(pid=1429)[0m [1, 20000] loss: 0.238
    Result for DEFAULT_a7dc9_00004:
      accuracy: 0.0955
      date: 2021-04-13_00-12-13
      done: false
      experiment_id: c4b98eaea4f14af49ea81f4c0c450916
      hostname: f64b9a093aea
      iterations_since_restore: 3
      loss: 2.3234064916610717
      node_ip: 172.17.0.2
      pid: 1431
      should_checkpoint: true
      time_since_restore: 102.29998874664307
      time_this_iter_s: 30.933011770248413
      time_total_s: 102.29998874664307
      timestamp: 1618272733
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: a7dc9_00004
  
    == Status ==
    Memory usage on this node: 7.8/240.1 GiB
    Using AsyncHyperBand: num_stopped=3
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.4711346462249757 | Iter 1.000: -2.2255352974891665
    Resources requested: 14/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-13_00-10-29
    Number of trials: 10/10 (7 RUNNING, 3 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |         lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------|
    | DEFAULT_a7dc9_00000 | RUNNING    | 172.17.0.2:1427 |            4 |   64 |  128 | 0.00460012 | 1.62172 |     0.4013 |                    1 |
    | DEFAULT_a7dc9_00001 | RUNNING    |                 |            2 |  256 |    8 | 0.0120715  |         |            |                      |
    | DEFAULT_a7dc9_00003 | RUNNING    |                 |            2 |    4 |  256 | 0.00165723 |         |            |                      |
    | DEFAULT_a7dc9_00004 | RUNNING    | 172.17.0.2:1431 |            8 |    4 |    4 | 0.0644851  | 2.32341 |     0.0955 |                    3 |
    | DEFAULT_a7dc9_00006 | RUNNING    | 172.17.0.2:1428 |            8 |   64 |  128 | 0.00519527 | 1.42367 |     0.5005 |                    2 |
    | DEFAULT_a7dc9_00008 | RUNNING    |                 |            2 |   16 |    4 | 0.0733233  |         |            |                      |
    | DEFAULT_a7dc9_00009 | RUNNING    | 172.17.0.2:1467 |            8 |  128 |    8 | 0.00133252 | 1.47113 |     0.4658 |                    2 |
    | DEFAULT_a7dc9_00002 | TERMINATED |                 |            4 |   16 |    8 | 0.0213926  | 2.31397 |     0.1031 |                    1 |
    | DEFAULT_a7dc9_00005 | TERMINATED |                 |            8 |   16 |   32 | 0.0771842  | 2.31721 |     0.0982 |                    1 |
    | DEFAULT_a7dc9_00007 | TERMINATED |                 |            8 |  128 |  128 | 0.0690339  | 2.22554 |     0.1613 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+


    [2m[36m(pid=1427)[0m [2,  8000] loss: 0.390
    [2m[36m(pid=1430)[0m [1, 16000] loss: 0.290
    Result for DEFAULT_a7dc9_00006:
      accuracy: 0.5364
      date: 2021-04-13_00-12-15
      done: false
      experiment_id: 5edaafa398314adfadca90fab59849ca
      hostname: f64b9a093aea
      iterations_since_restore: 3
      loss: 1.326456891465187
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 104.274733543396
      time_this_iter_s: 31.629431009292603
      time_total_s: 104.274733543396
      timestamp: 1618272735
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: a7dc9_00006
  
    Result for DEFAULT_a7dc9_00009:
      accuracy: 0.5281
      date: 2021-04-13_00-12-16
      done: false
      experiment_id: d905d623c4a140d2b6f1346993d9bd3d
      hostname: f64b9a093aea
      iterations_since_restore: 3
      loss: 1.307702940738201
      node_ip: 172.17.0.2
      pid: 1467
      should_checkpoint: true
      time_since_restore: 105.72349572181702
      time_this_iter_s: 32.03011965751648
      time_total_s: 105.72349572181702
      timestamp: 1618272736
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: a7dc9_00009
  
    Result for DEFAULT_a7dc9_00003:
      accuracy: 0.3878
      date: 2021-04-13_00-12-18
      done: false
      experiment_id: 8001d7a8ee694440a78633f68eba7889
      hostname: f64b9a093aea
      iterations_since_restore: 1
      loss: 1.6306191297978163
      node_ip: 172.17.0.2
      pid: 1432
      should_checkpoint: true
      time_since_restore: 107.53885674476624
      time_this_iter_s: 107.53885674476624
      time_total_s: 107.53885674476624
      timestamp: 1618272738
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: a7dc9_00003
  
    == Status ==
    Memory usage on this node: 7.9/240.1 GiB
    Using AsyncHyperBand: num_stopped=3
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.4711346462249757 | Iter 1.000: -1.9383070360422137
    Resources requested: 14/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-13_00-10-29
    Number of trials: 10/10 (7 RUNNING, 3 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |         lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------|
    | DEFAULT_a7dc9_00000 | RUNNING    | 172.17.0.2:1427 |            4 |   64 |  128 | 0.00460012 | 1.62172 |     0.4013 |                    1 |
    | DEFAULT_a7dc9_00001 | RUNNING    |                 |            2 |  256 |    8 | 0.0120715  |         |            |                      |
    | DEFAULT_a7dc9_00003 | RUNNING    | 172.17.0.2:1432 |            2 |    4 |  256 | 0.00165723 | 1.63062 |     0.3878 |                    1 |
    | DEFAULT_a7dc9_00004 | RUNNING    | 172.17.0.2:1431 |            8 |    4 |    4 | 0.0644851  | 2.32341 |     0.0955 |                    3 |
    | DEFAULT_a7dc9_00006 | RUNNING    | 172.17.0.2:1428 |            8 |   64 |  128 | 0.00519527 | 1.32646 |     0.5364 |                    3 |
    | DEFAULT_a7dc9_00008 | RUNNING    |                 |            2 |   16 |    4 | 0.0733233  |         |            |                      |
    | DEFAULT_a7dc9_00009 | RUNNING    | 172.17.0.2:1467 |            8 |  128 |    8 | 0.00133252 | 1.3077  |     0.5281 |                    3 |
    | DEFAULT_a7dc9_00002 | TERMINATED |                 |            4 |   16 |    8 | 0.0213926  | 2.31397 |     0.1031 |                    1 |
    | DEFAULT_a7dc9_00005 | TERMINATED |                 |            8 |   16 |   32 | 0.0771842  | 2.31721 |     0.0982 |                    1 |
    | DEFAULT_a7dc9_00007 | TERMINATED |                 |            8 |  128 |  128 | 0.0690339  | 2.22554 |     0.1613 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+


    Result for DEFAULT_a7dc9_00008:
      accuracy: 0.1
      date: 2021-04-13_00-12-20
      done: true
      experiment_id: 7c71ac84ed744990aec5bc931f414f86
      hostname: f64b9a093aea
      iterations_since_restore: 1
      loss: 2.3645520659685135
      node_ip: 172.17.0.2
      pid: 1429
      should_checkpoint: true
      time_since_restore: 109.56482434272766
      time_this_iter_s: 109.56482434272766
      time_total_s: 109.56482434272766
      timestamp: 1618272740
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: a7dc9_00008
  
    [2m[36m(pid=1427)[0m [2, 10000] loss: 0.309
    [2m[36m(pid=1431)[0m [4,  2000] loss: 2.320
    [2m[36m(pid=1430)[0m [1, 18000] loss: 0.257
    [2m[36m(pid=1428)[0m [4,  2000] loss: 1.271
    [2m[36m(pid=1432)[0m [2,  2000] loss: 1.693
    [2m[36m(pid=1467)[0m [4,  2000] loss: 1.272
    Result for DEFAULT_a7dc9_00000:
      accuracy: 0.4628
      date: 2021-04-13_00-12-29
      done: true
      experiment_id: 36aba866b6a74bf8a45b30924e2cfe0d
      hostname: f64b9a093aea
      iterations_since_restore: 2
      loss: 1.584251736485958
      node_ip: 172.17.0.2
      pid: 1427
      should_checkpoint: true
      time_since_restore: 118.74218797683716
      time_this_iter_s: 54.371997117996216
      time_total_s: 118.74218797683716
      timestamp: 1618272749
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: a7dc9_00000
  
    == Status ==
    Memory usage on this node: 7.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.5276931913554668 | Iter 1.000: -2.2255352974891665
    Resources requested: 12/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-13_00-10-29
    Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |         lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------|
    | DEFAULT_a7dc9_00000 | RUNNING    | 172.17.0.2:1427 |            4 |   64 |  128 | 0.00460012 | 1.58425 |     0.4628 |                    2 |
    | DEFAULT_a7dc9_00001 | RUNNING    |                 |            2 |  256 |    8 | 0.0120715  |         |            |                      |
    | DEFAULT_a7dc9_00003 | RUNNING    | 172.17.0.2:1432 |            2 |    4 |  256 | 0.00165723 | 1.63062 |     0.3878 |                    1 |
    | DEFAULT_a7dc9_00004 | RUNNING    | 172.17.0.2:1431 |            8 |    4 |    4 | 0.0644851  | 2.32341 |     0.0955 |                    3 |
    | DEFAULT_a7dc9_00006 | RUNNING    | 172.17.0.2:1428 |            8 |   64 |  128 | 0.00519527 | 1.32646 |     0.5364 |                    3 |
    | DEFAULT_a7dc9_00009 | RUNNING    | 172.17.0.2:1467 |            8 |  128 |    8 | 0.00133252 | 1.3077  |     0.5281 |                    3 |
    | DEFAULT_a7dc9_00002 | TERMINATED |                 |            4 |   16 |    8 | 0.0213926  | 2.31397 |     0.1031 |                    1 |
    | DEFAULT_a7dc9_00005 | TERMINATED |                 |            8 |   16 |   32 | 0.0771842  | 2.31721 |     0.0982 |                    1 |
    | DEFAULT_a7dc9_00007 | TERMINATED |                 |            8 |  128 |  128 | 0.0690339  | 2.22554 |     0.1613 |                    1 |
    | DEFAULT_a7dc9_00008 | TERMINATED |                 |            2 |   16 |    4 | 0.0733233  | 2.36455 |     0.1    |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+


    [2m[36m(pid=1432)[0m [2,  4000] loss: 0.842
    [2m[36m(pid=1431)[0m [4,  4000] loss: 1.162
    [2m[36m(pid=1428)[0m [4,  4000] loss: 0.656
    [2m[36m(pid=1430)[0m [1, 20000] loss: 0.232
    [2m[36m(pid=1467)[0m [4,  4000] loss: 0.628
    [2m[36m(pid=1432)[0m [2,  6000] loss: 0.556
    Result for DEFAULT_a7dc9_00004:
      accuracy: 0.0955
      date: 2021-04-13_00-12-43
      done: false
      experiment_id: c4b98eaea4f14af49ea81f4c0c450916
      hostname: f64b9a093aea
      iterations_since_restore: 4
      loss: 2.3185101697921753
      node_ip: 172.17.0.2
      pid: 1431
      should_checkpoint: true
      time_since_restore: 132.80372071266174
      time_this_iter_s: 30.503731966018677
      time_total_s: 132.80372071266174
      timestamp: 1618272763
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: a7dc9_00004
  
    == Status ==
    Memory usage on this node: 6.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: None | Iter 4.000: -2.3185101697921753 | Iter 2.000: -1.5276931913554668 | Iter 1.000: -2.2255352974891665
    Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-13_00-10-29
    Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |         lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------|
    | DEFAULT_a7dc9_00001 | RUNNING    |                 |            2 |  256 |    8 | 0.0120715  |         |            |                      |
    | DEFAULT_a7dc9_00003 | RUNNING    | 172.17.0.2:1432 |            2 |    4 |  256 | 0.00165723 | 1.63062 |     0.3878 |                    1 |
    | DEFAULT_a7dc9_00004 | RUNNING    | 172.17.0.2:1431 |            8 |    4 |    4 | 0.0644851  | 2.31851 |     0.0955 |                    4 |
    | DEFAULT_a7dc9_00006 | RUNNING    | 172.17.0.2:1428 |            8 |   64 |  128 | 0.00519527 | 1.32646 |     0.5364 |                    3 |
    | DEFAULT_a7dc9_00009 | RUNNING    | 172.17.0.2:1467 |            8 |  128 |    8 | 0.00133252 | 1.3077  |     0.5281 |                    3 |
    | DEFAULT_a7dc9_00000 | TERMINATED |                 |            4 |   64 |  128 | 0.00460012 | 1.58425 |     0.4628 |                    2 |
    | DEFAULT_a7dc9_00002 | TERMINATED |                 |            4 |   16 |    8 | 0.0213926  | 2.31397 |     0.1031 |                    1 |
    | DEFAULT_a7dc9_00005 | TERMINATED |                 |            8 |   16 |   32 | 0.0771842  | 2.31721 |     0.0982 |                    1 |
    | DEFAULT_a7dc9_00007 | TERMINATED |                 |            8 |  128 |  128 | 0.0690339  | 2.22554 |     0.1613 |                    1 |
    | DEFAULT_a7dc9_00008 | TERMINATED |                 |            2 |   16 |    4 | 0.0733233  | 2.36455 |     0.1    |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+


    Result for DEFAULT_a7dc9_00006:
      accuracy: 0.5359
      date: 2021-04-13_00-12-45
      done: false
      experiment_id: 5edaafa398314adfadca90fab59849ca
      hostname: f64b9a093aea
      iterations_since_restore: 4
      loss: 1.34401549243927
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 135.00437378883362
      time_this_iter_s: 30.729640245437622
      time_total_s: 135.00437378883362
      timestamp: 1618272765
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: a7dc9_00006
  
    Result for DEFAULT_a7dc9_00009:
      accuracy: 0.5569
      date: 2021-04-13_00-12-47
      done: false
      experiment_id: d905d623c4a140d2b6f1346993d9bd3d
      hostname: f64b9a093aea
      iterations_since_restore: 4
      loss: 1.2553004919767379
      node_ip: 172.17.0.2
      pid: 1467
      should_checkpoint: true
      time_since_restore: 136.62927412986755
      time_this_iter_s: 30.905778408050537
      time_total_s: 136.62927412986755
      timestamp: 1618272767
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: a7dc9_00009
  
    Result for DEFAULT_a7dc9_00001:
      accuracy: 0.0964
      date: 2021-04-13_00-12-49
      done: true
      experiment_id: 482ae6b802664143bc4450357fa24c67
      hostname: f64b9a093aea
      iterations_since_restore: 1
      loss: 2.313242027616501
      node_ip: 172.17.0.2
      pid: 1430
      should_checkpoint: true
      time_since_restore: 138.48275876045227
      time_this_iter_s: 138.48275876045227
      time_total_s: 138.48275876045227
      timestamp: 1618272769
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: a7dc9_00001
  
    == Status ==
    Memory usage on this node: 6.8/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: None | Iter 4.000: -1.34401549243927 | Iter 2.000: -1.5276931913554668 | Iter 1.000: -2.2693886625528337
    Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-13_00-10-29
    Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |         lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------|
    | DEFAULT_a7dc9_00001 | RUNNING    | 172.17.0.2:1430 |            2 |  256 |    8 | 0.0120715  | 2.31324 |     0.0964 |                    1 |
    | DEFAULT_a7dc9_00003 | RUNNING    | 172.17.0.2:1432 |            2 |    4 |  256 | 0.00165723 | 1.63062 |     0.3878 |                    1 |
    | DEFAULT_a7dc9_00004 | RUNNING    | 172.17.0.2:1431 |            8 |    4 |    4 | 0.0644851  | 2.31851 |     0.0955 |                    4 |
    | DEFAULT_a7dc9_00006 | RUNNING    | 172.17.0.2:1428 |            8 |   64 |  128 | 0.00519527 | 1.34402 |     0.5359 |                    4 |
    | DEFAULT_a7dc9_00009 | RUNNING    | 172.17.0.2:1467 |            8 |  128 |    8 | 0.00133252 | 1.2553  |     0.5569 |                    4 |
    | DEFAULT_a7dc9_00000 | TERMINATED |                 |            4 |   64 |  128 | 0.00460012 | 1.58425 |     0.4628 |                    2 |
    | DEFAULT_a7dc9_00002 | TERMINATED |                 |            4 |   16 |    8 | 0.0213926  | 2.31397 |     0.1031 |                    1 |
    | DEFAULT_a7dc9_00005 | TERMINATED |                 |            8 |   16 |   32 | 0.0771842  | 2.31721 |     0.0982 |                    1 |
    | DEFAULT_a7dc9_00007 | TERMINATED |                 |            8 |  128 |  128 | 0.0690339  | 2.22554 |     0.1613 |                    1 |
    | DEFAULT_a7dc9_00008 | TERMINATED |                 |            2 |   16 |    4 | 0.0733233  | 2.36455 |     0.1    |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+


    [2m[36m(pid=1432)[0m [2,  8000] loss: 0.421
    [2m[36m(pid=1431)[0m [5,  2000] loss: 2.322
    [2m[36m(pid=1428)[0m [5,  2000] loss: 1.244
    [2m[36m(pid=1467)[0m [5,  2000] loss: 1.184
    [2m[36m(pid=1432)[0m [2, 10000] loss: 0.333
    [2m[36m(pid=1431)[0m [5,  4000] loss: 1.161
    [2m[36m(pid=1432)[0m [2, 12000] loss: 0.277
    [2m[36m(pid=1428)[0m [5,  4000] loss: 0.632
    [2m[36m(pid=1467)[0m [5,  4000] loss: 0.589
    Result for DEFAULT_a7dc9_00004:
      accuracy: 0.0955
      date: 2021-04-13_00-13-12
      done: false
      experiment_id: c4b98eaea4f14af49ea81f4c0c450916
      hostname: f64b9a093aea
      iterations_since_restore: 5
      loss: 2.333412847518921
      node_ip: 172.17.0.2
      pid: 1431
      should_checkpoint: true
      time_since_restore: 161.6880521774292
      time_this_iter_s: 28.884331464767456
      time_total_s: 161.6880521774292
      timestamp: 1618272792
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: a7dc9_00004
  
    == Status ==
    Memory usage on this node: 6.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: None | Iter 4.000: -1.34401549243927 | Iter 2.000: -1.5276931913554668 | Iter 1.000: -2.2693886625528337
    Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-13_00-10-29
    Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |         lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------|
    | DEFAULT_a7dc9_00003 | RUNNING    | 172.17.0.2:1432 |            2 |    4 |  256 | 0.00165723 | 1.63062 |     0.3878 |                    1 |
    | DEFAULT_a7dc9_00004 | RUNNING    | 172.17.0.2:1431 |            8 |    4 |    4 | 0.0644851  | 2.33341 |     0.0955 |                    5 |
    | DEFAULT_a7dc9_00006 | RUNNING    | 172.17.0.2:1428 |            8 |   64 |  128 | 0.00519527 | 1.34402 |     0.5359 |                    4 |
    | DEFAULT_a7dc9_00009 | RUNNING    | 172.17.0.2:1467 |            8 |  128 |    8 | 0.00133252 | 1.2553  |     0.5569 |                    4 |
    | DEFAULT_a7dc9_00000 | TERMINATED |                 |            4 |   64 |  128 | 0.00460012 | 1.58425 |     0.4628 |                    2 |
    | DEFAULT_a7dc9_00001 | TERMINATED |                 |            2 |  256 |    8 | 0.0120715  | 2.31324 |     0.0964 |                    1 |
    | DEFAULT_a7dc9_00002 | TERMINATED |                 |            4 |   16 |    8 | 0.0213926  | 2.31397 |     0.1031 |                    1 |
    | DEFAULT_a7dc9_00005 | TERMINATED |                 |            8 |   16 |   32 | 0.0771842  | 2.31721 |     0.0982 |                    1 |
    | DEFAULT_a7dc9_00007 | TERMINATED |                 |            8 |  128 |  128 | 0.0690339  | 2.22554 |     0.1613 |                    1 |
    | DEFAULT_a7dc9_00008 | TERMINATED |                 |            2 |   16 |    4 | 0.0733233  | 2.36455 |     0.1    |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+


    [2m[36m(pid=1432)[0m [2, 14000] loss: 0.238
    Result for DEFAULT_a7dc9_00006:
      accuracy: 0.5138
      date: 2021-04-13_00-13-15
      done: false
      experiment_id: 5edaafa398314adfadca90fab59849ca
      hostname: f64b9a093aea
      iterations_since_restore: 5
      loss: 1.4178876069307327
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 164.2995204925537
      time_this_iter_s: 29.295146703720093
      time_total_s: 164.2995204925537
      timestamp: 1618272795
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: a7dc9_00006
  
    Result for DEFAULT_a7dc9_00009:
      accuracy: 0.5792
      date: 2021-04-13_00-13-17
      done: false
      experiment_id: d905d623c4a140d2b6f1346993d9bd3d
      hostname: f64b9a093aea
      iterations_since_restore: 5
      loss: 1.195793594610691
      node_ip: 172.17.0.2
      pid: 1467
      should_checkpoint: true
      time_since_restore: 166.6521511077881
      time_this_iter_s: 30.022876977920532
      time_total_s: 166.6521511077881
      timestamp: 1618272797
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: a7dc9_00009
  
    [2m[36m(pid=1432)[0m [2, 16000] loss: 0.204
    [2m[36m(pid=1431)[0m [6,  2000] loss: 2.321
    [2m[36m(pid=1428)[0m [6,  2000] loss: 1.206
    [2m[36m(pid=1467)[0m [6,  2000] loss: 1.105
    [2m[36m(pid=1432)[0m [2, 18000] loss: 0.182
    [2m[36m(pid=1431)[0m [6,  4000] loss: 1.161
    [2m[36m(pid=1428)[0m [6,  4000] loss: 0.626
    [2m[36m(pid=1432)[0m [2, 20000] loss: 0.166
    [2m[36m(pid=1467)[0m [6,  4000] loss: 0.551
    Result for DEFAULT_a7dc9_00004:
      accuracy: 0.0985
      date: 2021-04-13_00-13-41
      done: false
      experiment_id: c4b98eaea4f14af49ea81f4c0c450916
      hostname: f64b9a093aea
      iterations_since_restore: 6
      loss: 2.312900128173828
      node_ip: 172.17.0.2
      pid: 1431
      should_checkpoint: true
      time_since_restore: 190.52484107017517
      time_this_iter_s: 28.83678889274597
      time_total_s: 190.52484107017517
      timestamp: 1618272821
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: a7dc9_00004
  
    == Status ==
    Memory usage on this node: 6.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: None | Iter 4.000: -1.34401549243927 | Iter 2.000: -1.5276931913554668 | Iter 1.000: -2.2693886625528337
    Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-13_00-10-29
    Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |         lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------|
    | DEFAULT_a7dc9_00003 | RUNNING    | 172.17.0.2:1432 |            2 |    4 |  256 | 0.00165723 | 1.63062 |     0.3878 |                    1 |
    | DEFAULT_a7dc9_00004 | RUNNING    | 172.17.0.2:1431 |            8 |    4 |    4 | 0.0644851  | 2.3129  |     0.0985 |                    6 |
    | DEFAULT_a7dc9_00006 | RUNNING    | 172.17.0.2:1428 |            8 |   64 |  128 | 0.00519527 | 1.41789 |     0.5138 |                    5 |
    | DEFAULT_a7dc9_00009 | RUNNING    | 172.17.0.2:1467 |            8 |  128 |    8 | 0.00133252 | 1.19579 |     0.5792 |                    5 |
    | DEFAULT_a7dc9_00000 | TERMINATED |                 |            4 |   64 |  128 | 0.00460012 | 1.58425 |     0.4628 |                    2 |
    | DEFAULT_a7dc9_00001 | TERMINATED |                 |            2 |  256 |    8 | 0.0120715  | 2.31324 |     0.0964 |                    1 |
    | DEFAULT_a7dc9_00002 | TERMINATED |                 |            4 |   16 |    8 | 0.0213926  | 2.31397 |     0.1031 |                    1 |
    | DEFAULT_a7dc9_00005 | TERMINATED |                 |            8 |   16 |   32 | 0.0771842  | 2.31721 |     0.0982 |                    1 |
    | DEFAULT_a7dc9_00007 | TERMINATED |                 |            8 |  128 |  128 | 0.0690339  | 2.22554 |     0.1613 |                    1 |
    | DEFAULT_a7dc9_00008 | TERMINATED |                 |            2 |   16 |    4 | 0.0733233  | 2.36455 |     0.1    |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+


    Result for DEFAULT_a7dc9_00006:
      accuracy: 0.5437
      date: 2021-04-13_00-13-44
      done: false
      experiment_id: 5edaafa398314adfadca90fab59849ca
      hostname: f64b9a093aea
      iterations_since_restore: 6
      loss: 1.3379271590709687
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 193.49521398544312
      time_this_iter_s: 29.195693492889404
      time_total_s: 193.49521398544312
      timestamp: 1618272824
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: a7dc9_00006
  
    Result for DEFAULT_a7dc9_00009:
      accuracy: 0.6034
      date: 2021-04-13_00-13-46
      done: false
      experiment_id: d905d623c4a140d2b6f1346993d9bd3d
      hostname: f64b9a093aea
      iterations_since_restore: 6
      loss: 1.1562668138504029
      node_ip: 172.17.0.2
      pid: 1467
      should_checkpoint: true
      time_since_restore: 196.0986614227295
      time_this_iter_s: 29.446510314941406
      time_total_s: 196.0986614227295
      timestamp: 1618272826
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: a7dc9_00009
  
    == Status ==
    Memory usage on this node: 6.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: None | Iter 4.000: -1.34401549243927 | Iter 2.000: -1.5276931913554668 | Iter 1.000: -2.2693886625528337
    Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-13_00-10-29
    Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |         lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------|
    | DEFAULT_a7dc9_00003 | RUNNING    | 172.17.0.2:1432 |            2 |    4 |  256 | 0.00165723 | 1.63062 |     0.3878 |                    1 |
    | DEFAULT_a7dc9_00004 | RUNNING    | 172.17.0.2:1431 |            8 |    4 |    4 | 0.0644851  | 2.3129  |     0.0985 |                    6 |
    | DEFAULT_a7dc9_00006 | RUNNING    | 172.17.0.2:1428 |            8 |   64 |  128 | 0.00519527 | 1.33793 |     0.5437 |                    6 |
    | DEFAULT_a7dc9_00009 | RUNNING    | 172.17.0.2:1467 |            8 |  128 |    8 | 0.00133252 | 1.15627 |     0.6034 |                    6 |
    | DEFAULT_a7dc9_00000 | TERMINATED |                 |            4 |   64 |  128 | 0.00460012 | 1.58425 |     0.4628 |                    2 |
    | DEFAULT_a7dc9_00001 | TERMINATED |                 |            2 |  256 |    8 | 0.0120715  | 2.31324 |     0.0964 |                    1 |
    | DEFAULT_a7dc9_00002 | TERMINATED |                 |            4 |   16 |    8 | 0.0213926  | 2.31397 |     0.1031 |                    1 |
    | DEFAULT_a7dc9_00005 | TERMINATED |                 |            8 |   16 |   32 | 0.0771842  | 2.31721 |     0.0982 |                    1 |
    | DEFAULT_a7dc9_00007 | TERMINATED |                 |            8 |  128 |  128 | 0.0690339  | 2.22554 |     0.1613 |                    1 |
    | DEFAULT_a7dc9_00008 | TERMINATED |                 |            2 |   16 |    4 | 0.0733233  | 2.36455 |     0.1    |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+


    Result for DEFAULT_a7dc9_00003:
      accuracy: 0.3854
      date: 2021-04-13_00-13-48
      done: true
      experiment_id: 8001d7a8ee694440a78633f68eba7889
      hostname: f64b9a093aea
      iterations_since_restore: 2
      loss: 1.6468786836147309
      node_ip: 172.17.0.2
      pid: 1432
      should_checkpoint: true
      time_since_restore: 197.453941822052
      time_this_iter_s: 89.91508507728577
      time_total_s: 197.453941822052
      timestamp: 1618272828
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: a7dc9_00003
  
    [2m[36m(pid=1431)[0m [7,  2000] loss: 2.321
    [2m[36m(pid=1428)[0m [7,  2000] loss: 1.197
    [2m[36m(pid=1467)[0m [7,  2000] loss: 1.027
    [2m[36m(pid=1431)[0m [7,  4000] loss: 1.161
    [2m[36m(pid=1428)[0m [7,  4000] loss: 0.619
    [2m[36m(pid=1467)[0m [7,  4000] loss: 0.529
    Result for DEFAULT_a7dc9_00004:
      accuracy: 0.1011
      date: 2021-04-13_00-14-09
      done: false
      experiment_id: c4b98eaea4f14af49ea81f4c0c450916
      hostname: f64b9a093aea
      iterations_since_restore: 7
      loss: 2.311463496208191
      node_ip: 172.17.0.2
      pid: 1431
      should_checkpoint: true
      time_since_restore: 218.7524447441101
      time_this_iter_s: 28.227603673934937
      time_total_s: 218.7524447441101
      timestamp: 1618272849
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: a7dc9_00004
  
    == Status ==
    Memory usage on this node: 5.8/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: None | Iter 4.000: -1.34401549243927 | Iter 2.000: -1.584251736485958 | Iter 1.000: -2.2693886625528337
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-13_00-10-29
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |         lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------|
    | DEFAULT_a7dc9_00004 | RUNNING    | 172.17.0.2:1431 |            8 |    4 |    4 | 0.0644851  | 2.31146 |     0.1011 |                    7 |
    | DEFAULT_a7dc9_00006 | RUNNING    | 172.17.0.2:1428 |            8 |   64 |  128 | 0.00519527 | 1.33793 |     0.5437 |                    6 |
    | DEFAULT_a7dc9_00009 | RUNNING    | 172.17.0.2:1467 |            8 |  128 |    8 | 0.00133252 | 1.15627 |     0.6034 |                    6 |
    | DEFAULT_a7dc9_00000 | TERMINATED |                 |            4 |   64 |  128 | 0.00460012 | 1.58425 |     0.4628 |                    2 |
    | DEFAULT_a7dc9_00001 | TERMINATED |                 |            2 |  256 |    8 | 0.0120715  | 2.31324 |     0.0964 |                    1 |
    | DEFAULT_a7dc9_00002 | TERMINATED |                 |            4 |   16 |    8 | 0.0213926  | 2.31397 |     0.1031 |                    1 |
    | DEFAULT_a7dc9_00003 | TERMINATED |                 |            2 |    4 |  256 | 0.00165723 | 1.64688 |     0.3854 |                    2 |
    | DEFAULT_a7dc9_00005 | TERMINATED |                 |            8 |   16 |   32 | 0.0771842  | 2.31721 |     0.0982 |                    1 |
    | DEFAULT_a7dc9_00007 | TERMINATED |                 |            8 |  128 |  128 | 0.0690339  | 2.22554 |     0.1613 |                    1 |
    | DEFAULT_a7dc9_00008 | TERMINATED |                 |            2 |   16 |    4 | 0.0733233  | 2.36455 |     0.1    |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+


    Result for DEFAULT_a7dc9_00006:
      accuracy: 0.5492
      date: 2021-04-13_00-14-13
      done: false
      experiment_id: 5edaafa398314adfadca90fab59849ca
      hostname: f64b9a093aea
      iterations_since_restore: 7
      loss: 1.3275982178211212
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 222.21580529212952
      time_this_iter_s: 28.7205913066864
      time_total_s: 222.21580529212952
      timestamp: 1618272853
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: a7dc9_00006
  
    Result for DEFAULT_a7dc9_00009:
      accuracy: 0.5991
      date: 2021-04-13_00-14-15
      done: false
      experiment_id: d905d623c4a140d2b6f1346993d9bd3d
      hostname: f64b9a093aea
      iterations_since_restore: 7
      loss: 1.1530771402597428
      node_ip: 172.17.0.2
      pid: 1467
      should_checkpoint: true
      time_since_restore: 225.09997153282166
      time_this_iter_s: 29.001310110092163
      time_total_s: 225.09997153282166
      timestamp: 1618272855
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: a7dc9_00009
  
    == Status ==
    Memory usage on this node: 5.8/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: None | Iter 4.000: -1.34401549243927 | Iter 2.000: -1.584251736485958 | Iter 1.000: -2.2693886625528337
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-13_00-10-29
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |         lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------|
    | DEFAULT_a7dc9_00004 | RUNNING    | 172.17.0.2:1431 |            8 |    4 |    4 | 0.0644851  | 2.31146 |     0.1011 |                    7 |
    | DEFAULT_a7dc9_00006 | RUNNING    | 172.17.0.2:1428 |            8 |   64 |  128 | 0.00519527 | 1.3276  |     0.5492 |                    7 |
    | DEFAULT_a7dc9_00009 | RUNNING    | 172.17.0.2:1467 |            8 |  128 |    8 | 0.00133252 | 1.15308 |     0.5991 |                    7 |
    | DEFAULT_a7dc9_00000 | TERMINATED |                 |            4 |   64 |  128 | 0.00460012 | 1.58425 |     0.4628 |                    2 |
    | DEFAULT_a7dc9_00001 | TERMINATED |                 |            2 |  256 |    8 | 0.0120715  | 2.31324 |     0.0964 |                    1 |
    | DEFAULT_a7dc9_00002 | TERMINATED |                 |            4 |   16 |    8 | 0.0213926  | 2.31397 |     0.1031 |                    1 |
    | DEFAULT_a7dc9_00003 | TERMINATED |                 |            2 |    4 |  256 | 0.00165723 | 1.64688 |     0.3854 |                    2 |
    | DEFAULT_a7dc9_00005 | TERMINATED |                 |            8 |   16 |   32 | 0.0771842  | 2.31721 |     0.0982 |                    1 |
    | DEFAULT_a7dc9_00007 | TERMINATED |                 |            8 |  128 |  128 | 0.0690339  | 2.22554 |     0.1613 |                    1 |
    | DEFAULT_a7dc9_00008 | TERMINATED |                 |            2 |   16 |    4 | 0.0733233  | 2.36455 |     0.1    |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+


    [2m[36m(pid=1431)[0m [8,  2000] loss: 2.321
    [2m[36m(pid=1428)[0m [8,  2000] loss: 1.182
    [2m[36m(pid=1467)[0m [8,  2000] loss: 0.971
    [2m[36m(pid=1431)[0m [8,  4000] loss: 1.161
    [2m[36m(pid=1428)[0m [8,  4000] loss: 0.607
    [2m[36m(pid=1467)[0m [8,  4000] loss: 0.500
    Result for DEFAULT_a7dc9_00004:
      accuracy: 0.0978
      date: 2021-04-13_00-14-37
      done: false
      experiment_id: c4b98eaea4f14af49ea81f4c0c450916
      hostname: f64b9a093aea
      iterations_since_restore: 8
      loss: 2.324570158004761
      node_ip: 172.17.0.2
      pid: 1431
      should_checkpoint: true
      time_since_restore: 247.12085890769958
      time_this_iter_s: 28.368414163589478
      time_total_s: 247.12085890769958
      timestamp: 1618272877
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: a7dc9_00004
  
    == Status ==
    Memory usage on this node: 5.9/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: -2.324570158004761 | Iter 4.000: -1.34401549243927 | Iter 2.000: -1.584251736485958 | Iter 1.000: -2.2693886625528337
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-13_00-10-29
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |         lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------|
    | DEFAULT_a7dc9_00004 | RUNNING    | 172.17.0.2:1431 |            8 |    4 |    4 | 0.0644851  | 2.32457 |     0.0978 |                    8 |
    | DEFAULT_a7dc9_00006 | RUNNING    | 172.17.0.2:1428 |            8 |   64 |  128 | 0.00519527 | 1.3276  |     0.5492 |                    7 |
    | DEFAULT_a7dc9_00009 | RUNNING    | 172.17.0.2:1467 |            8 |  128 |    8 | 0.00133252 | 1.15308 |     0.5991 |                    7 |
    | DEFAULT_a7dc9_00000 | TERMINATED |                 |            4 |   64 |  128 | 0.00460012 | 1.58425 |     0.4628 |                    2 |
    | DEFAULT_a7dc9_00001 | TERMINATED |                 |            2 |  256 |    8 | 0.0120715  | 2.31324 |     0.0964 |                    1 |
    | DEFAULT_a7dc9_00002 | TERMINATED |                 |            4 |   16 |    8 | 0.0213926  | 2.31397 |     0.1031 |                    1 |
    | DEFAULT_a7dc9_00003 | TERMINATED |                 |            2 |    4 |  256 | 0.00165723 | 1.64688 |     0.3854 |                    2 |
    | DEFAULT_a7dc9_00005 | TERMINATED |                 |            8 |   16 |   32 | 0.0771842  | 2.31721 |     0.0982 |                    1 |
    | DEFAULT_a7dc9_00007 | TERMINATED |                 |            8 |  128 |  128 | 0.0690339  | 2.22554 |     0.1613 |                    1 |
    | DEFAULT_a7dc9_00008 | TERMINATED |                 |            2 |   16 |    4 | 0.0733233  | 2.36455 |     0.1    |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+


    Result for DEFAULT_a7dc9_00006:
      accuracy: 0.526
      date: 2021-04-13_00-14-41
      done: false
      experiment_id: 5edaafa398314adfadca90fab59849ca
      hostname: f64b9a093aea
      iterations_since_restore: 8
      loss: 1.4301013449668885
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 250.60576558113098
      time_this_iter_s: 28.389960289001465
      time_total_s: 250.60576558113098
      timestamp: 1618272881
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: a7dc9_00006
  
    Result for DEFAULT_a7dc9_00009:
      accuracy: 0.5863
      date: 2021-04-13_00-14-44
      done: false
      experiment_id: d905d623c4a140d2b6f1346993d9bd3d
      hostname: f64b9a093aea
      iterations_since_restore: 8
      loss: 1.1954072054862976
      node_ip: 172.17.0.2
      pid: 1467
      should_checkpoint: true
      time_since_restore: 253.95626378059387
      time_this_iter_s: 28.856292247772217
      time_total_s: 253.95626378059387
      timestamp: 1618272884
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: a7dc9_00009
  
    == Status ==
    Memory usage on this node: 5.9/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: -1.4301013449668885 | Iter 4.000: -1.34401549243927 | Iter 2.000: -1.584251736485958 | Iter 1.000: -2.2693886625528337
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-13_00-10-29
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |         lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------|
    | DEFAULT_a7dc9_00004 | RUNNING    | 172.17.0.2:1431 |            8 |    4 |    4 | 0.0644851  | 2.32457 |     0.0978 |                    8 |
    | DEFAULT_a7dc9_00006 | RUNNING    | 172.17.0.2:1428 |            8 |   64 |  128 | 0.00519527 | 1.4301  |     0.526  |                    8 |
    | DEFAULT_a7dc9_00009 | RUNNING    | 172.17.0.2:1467 |            8 |  128 |    8 | 0.00133252 | 1.19541 |     0.5863 |                    8 |
    | DEFAULT_a7dc9_00000 | TERMINATED |                 |            4 |   64 |  128 | 0.00460012 | 1.58425 |     0.4628 |                    2 |
    | DEFAULT_a7dc9_00001 | TERMINATED |                 |            2 |  256 |    8 | 0.0120715  | 2.31324 |     0.0964 |                    1 |
    | DEFAULT_a7dc9_00002 | TERMINATED |                 |            4 |   16 |    8 | 0.0213926  | 2.31397 |     0.1031 |                    1 |
    | DEFAULT_a7dc9_00003 | TERMINATED |                 |            2 |    4 |  256 | 0.00165723 | 1.64688 |     0.3854 |                    2 |
    | DEFAULT_a7dc9_00005 | TERMINATED |                 |            8 |   16 |   32 | 0.0771842  | 2.31721 |     0.0982 |                    1 |
    | DEFAULT_a7dc9_00007 | TERMINATED |                 |            8 |  128 |  128 | 0.0690339  | 2.22554 |     0.1613 |                    1 |
    | DEFAULT_a7dc9_00008 | TERMINATED |                 |            2 |   16 |    4 | 0.0733233  | 2.36455 |     0.1    |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+


    [2m[36m(pid=1431)[0m [9,  2000] loss: 2.321
    [2m[36m(pid=1428)[0m [9,  2000] loss: 1.179
    [2m[36m(pid=1467)[0m [9,  2000] loss: 0.940
    [2m[36m(pid=1431)[0m [9,  4000] loss: 1.161
    [2m[36m(pid=1428)[0m [9,  4000] loss: 0.607
    [2m[36m(pid=1467)[0m [9,  4000] loss: 0.471
    Result for DEFAULT_a7dc9_00004:
      accuracy: 0.0978
      date: 2021-04-13_00-15-06
      done: false
      experiment_id: c4b98eaea4f14af49ea81f4c0c450916
      hostname: f64b9a093aea
      iterations_since_restore: 9
      loss: 2.326448431015015
      node_ip: 172.17.0.2
      pid: 1431
      should_checkpoint: true
      time_since_restore: 275.45418405532837
      time_this_iter_s: 28.333325147628784
      time_total_s: 275.45418405532837
      timestamp: 1618272906
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: a7dc9_00004
  
    == Status ==
    Memory usage on this node: 5.9/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: -1.4301013449668885 | Iter 4.000: -1.34401549243927 | Iter 2.000: -1.584251736485958 | Iter 1.000: -2.2693886625528337
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-13_00-10-29
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |         lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------|
    | DEFAULT_a7dc9_00004 | RUNNING    | 172.17.0.2:1431 |            8 |    4 |    4 | 0.0644851  | 2.32645 |     0.0978 |                    9 |
    | DEFAULT_a7dc9_00006 | RUNNING    | 172.17.0.2:1428 |            8 |   64 |  128 | 0.00519527 | 1.4301  |     0.526  |                    8 |
    | DEFAULT_a7dc9_00009 | RUNNING    | 172.17.0.2:1467 |            8 |  128 |    8 | 0.00133252 | 1.19541 |     0.5863 |                    8 |
    | DEFAULT_a7dc9_00000 | TERMINATED |                 |            4 |   64 |  128 | 0.00460012 | 1.58425 |     0.4628 |                    2 |
    | DEFAULT_a7dc9_00001 | TERMINATED |                 |            2 |  256 |    8 | 0.0120715  | 2.31324 |     0.0964 |                    1 |
    | DEFAULT_a7dc9_00002 | TERMINATED |                 |            4 |   16 |    8 | 0.0213926  | 2.31397 |     0.1031 |                    1 |
    | DEFAULT_a7dc9_00003 | TERMINATED |                 |            2 |    4 |  256 | 0.00165723 | 1.64688 |     0.3854 |                    2 |
    | DEFAULT_a7dc9_00005 | TERMINATED |                 |            8 |   16 |   32 | 0.0771842  | 2.31721 |     0.0982 |                    1 |
    | DEFAULT_a7dc9_00007 | TERMINATED |                 |            8 |  128 |  128 | 0.0690339  | 2.22554 |     0.1613 |                    1 |
    | DEFAULT_a7dc9_00008 | TERMINATED |                 |            2 |   16 |    4 | 0.0733233  | 2.36455 |     0.1    |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+


    Result for DEFAULT_a7dc9_00006:
      accuracy: 0.5411
      date: 2021-04-13_00-15-09
      done: false
      experiment_id: 5edaafa398314adfadca90fab59849ca
      hostname: f64b9a093aea
      iterations_since_restore: 9
      loss: 1.3387500878810883
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 279.17460465431213
      time_this_iter_s: 28.568839073181152
      time_total_s: 279.17460465431213
      timestamp: 1618272909
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: a7dc9_00006
  
    Result for DEFAULT_a7dc9_00009:
      accuracy: 0.59
      date: 2021-04-13_00-15-14
      done: false
      experiment_id: d905d623c4a140d2b6f1346993d9bd3d
      hostname: f64b9a093aea
      iterations_since_restore: 9
      loss: 1.2303548949956893
      node_ip: 172.17.0.2
      pid: 1467
      should_checkpoint: true
      time_since_restore: 283.2528738975525
      time_this_iter_s: 29.296610116958618
      time_total_s: 283.2528738975525
      timestamp: 1618272914
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: a7dc9_00009
  
    == Status ==
    Memory usage on this node: 6.0/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: -1.4301013449668885 | Iter 4.000: -1.34401549243927 | Iter 2.000: -1.584251736485958 | Iter 1.000: -2.2693886625528337
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-13_00-10-29
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |         lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------|
    | DEFAULT_a7dc9_00004 | RUNNING    | 172.17.0.2:1431 |            8 |    4 |    4 | 0.0644851  | 2.32645 |     0.0978 |                    9 |
    | DEFAULT_a7dc9_00006 | RUNNING    | 172.17.0.2:1428 |            8 |   64 |  128 | 0.00519527 | 1.33875 |     0.5411 |                    9 |
    | DEFAULT_a7dc9_00009 | RUNNING    | 172.17.0.2:1467 |            8 |  128 |    8 | 0.00133252 | 1.23035 |     0.59   |                    9 |
    | DEFAULT_a7dc9_00000 | TERMINATED |                 |            4 |   64 |  128 | 0.00460012 | 1.58425 |     0.4628 |                    2 |
    | DEFAULT_a7dc9_00001 | TERMINATED |                 |            2 |  256 |    8 | 0.0120715  | 2.31324 |     0.0964 |                    1 |
    | DEFAULT_a7dc9_00002 | TERMINATED |                 |            4 |   16 |    8 | 0.0213926  | 2.31397 |     0.1031 |                    1 |
    | DEFAULT_a7dc9_00003 | TERMINATED |                 |            2 |    4 |  256 | 0.00165723 | 1.64688 |     0.3854 |                    2 |
    | DEFAULT_a7dc9_00005 | TERMINATED |                 |            8 |   16 |   32 | 0.0771842  | 2.31721 |     0.0982 |                    1 |
    | DEFAULT_a7dc9_00007 | TERMINATED |                 |            8 |  128 |  128 | 0.0690339  | 2.22554 |     0.1613 |                    1 |
    | DEFAULT_a7dc9_00008 | TERMINATED |                 |            2 |   16 |    4 | 0.0733233  | 2.36455 |     0.1    |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+


    [2m[36m(pid=1431)[0m [10,  2000] loss: 2.319
    [2m[36m(pid=1428)[0m [10,  2000] loss: 1.161
    [2m[36m(pid=1467)[0m [10,  2000] loss: 0.878
    [2m[36m(pid=1431)[0m [10,  4000] loss: 1.161
    [2m[36m(pid=1428)[0m [10,  4000] loss: 0.618
    [2m[36m(pid=1467)[0m [10,  4000] loss: 0.453
    Result for DEFAULT_a7dc9_00004:
      accuracy: 0.1011
      date: 2021-04-13_00-15-34
      done: true
      experiment_id: c4b98eaea4f14af49ea81f4c0c450916
      hostname: f64b9a093aea
      iterations_since_restore: 10
      loss: 2.316990189933777
      node_ip: 172.17.0.2
      pid: 1431
      should_checkpoint: true
      time_since_restore: 303.626371383667
      time_this_iter_s: 28.172187328338623
      time_total_s: 303.626371383667
      timestamp: 1618272934
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: a7dc9_00004
  
    == Status ==
    Memory usage on this node: 6.0/240.1 GiB
    Using AsyncHyperBand: num_stopped=8
    Bracket: Iter 8.000: -1.4301013449668885 | Iter 4.000: -1.34401549243927 | Iter 2.000: -1.584251736485958 | Iter 1.000: -2.2693886625528337
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-13_00-10-29
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |         lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------|
    | DEFAULT_a7dc9_00004 | RUNNING    | 172.17.0.2:1431 |            8 |    4 |    4 | 0.0644851  | 2.31699 |     0.1011 |                   10 |
    | DEFAULT_a7dc9_00006 | RUNNING    | 172.17.0.2:1428 |            8 |   64 |  128 | 0.00519527 | 1.33875 |     0.5411 |                    9 |
    | DEFAULT_a7dc9_00009 | RUNNING    | 172.17.0.2:1467 |            8 |  128 |    8 | 0.00133252 | 1.23035 |     0.59   |                    9 |
    | DEFAULT_a7dc9_00000 | TERMINATED |                 |            4 |   64 |  128 | 0.00460012 | 1.58425 |     0.4628 |                    2 |
    | DEFAULT_a7dc9_00001 | TERMINATED |                 |            2 |  256 |    8 | 0.0120715  | 2.31324 |     0.0964 |                    1 |
    | DEFAULT_a7dc9_00002 | TERMINATED |                 |            4 |   16 |    8 | 0.0213926  | 2.31397 |     0.1031 |                    1 |
    | DEFAULT_a7dc9_00003 | TERMINATED |                 |            2 |    4 |  256 | 0.00165723 | 1.64688 |     0.3854 |                    2 |
    | DEFAULT_a7dc9_00005 | TERMINATED |                 |            8 |   16 |   32 | 0.0771842  | 2.31721 |     0.0982 |                    1 |
    | DEFAULT_a7dc9_00007 | TERMINATED |                 |            8 |  128 |  128 | 0.0690339  | 2.22554 |     0.1613 |                    1 |
    | DEFAULT_a7dc9_00008 | TERMINATED |                 |            2 |   16 |    4 | 0.0733233  | 2.36455 |     0.1    |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+


    Result for DEFAULT_a7dc9_00006:
      accuracy: 0.5248
      date: 2021-04-13_00-15-38
      done: true
      experiment_id: 5edaafa398314adfadca90fab59849ca
      hostname: f64b9a093aea
      iterations_since_restore: 10
      loss: 1.4430944140553474
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 307.4208199977875
      time_this_iter_s: 28.246215343475342
      time_total_s: 307.4208199977875
      timestamp: 1618272938
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: a7dc9_00006
  
    Result for DEFAULT_a7dc9_00009:
      accuracy: 0.6197
      date: 2021-04-13_00-15-42
      done: true
      experiment_id: d905d623c4a140d2b6f1346993d9bd3d
      hostname: f64b9a093aea
      iterations_since_restore: 10
      loss: 1.1348403178572655
      node_ip: 172.17.0.2
      pid: 1467
      should_checkpoint: true
      time_since_restore: 311.9205641746521
      time_this_iter_s: 28.66769027709961
      time_total_s: 311.9205641746521
      timestamp: 1618272942
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: a7dc9_00009
  
    == Status ==
    Memory usage on this node: 4.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=10
    Bracket: Iter 8.000: -1.4301013449668885 | Iter 4.000: -1.34401549243927 | Iter 2.000: -1.584251736485958 | Iter 1.000: -2.2693886625528337
    Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-13_00-10-29
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |         lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------|
    | DEFAULT_a7dc9_00009 | RUNNING    | 172.17.0.2:1467 |            8 |  128 |    8 | 0.00133252 | 1.13484 |     0.6197 |                   10 |
    | DEFAULT_a7dc9_00000 | TERMINATED |                 |            4 |   64 |  128 | 0.00460012 | 1.58425 |     0.4628 |                    2 |
    | DEFAULT_a7dc9_00001 | TERMINATED |                 |            2 |  256 |    8 | 0.0120715  | 2.31324 |     0.0964 |                    1 |
    | DEFAULT_a7dc9_00002 | TERMINATED |                 |            4 |   16 |    8 | 0.0213926  | 2.31397 |     0.1031 |                    1 |
    | DEFAULT_a7dc9_00003 | TERMINATED |                 |            2 |    4 |  256 | 0.00165723 | 1.64688 |     0.3854 |                    2 |
    | DEFAULT_a7dc9_00004 | TERMINATED |                 |            8 |    4 |    4 | 0.0644851  | 2.31699 |     0.1011 |                   10 |
    | DEFAULT_a7dc9_00005 | TERMINATED |                 |            8 |   16 |   32 | 0.0771842  | 2.31721 |     0.0982 |                    1 |
    | DEFAULT_a7dc9_00006 | TERMINATED |                 |            8 |   64 |  128 | 0.00519527 | 1.44309 |     0.5248 |                   10 |
    | DEFAULT_a7dc9_00007 | TERMINATED |                 |            8 |  128 |  128 | 0.0690339  | 2.22554 |     0.1613 |                    1 |
    | DEFAULT_a7dc9_00008 | TERMINATED |                 |            2 |   16 |    4 | 0.0733233  | 2.36455 |     0.1    |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+------------+---------+------------+----------------------+


    == Status ==
    Memory usage on this node: 4.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=10
    Bracket: Iter 8.000: -1.4301013449668885 | Iter 4.000: -1.34401549243927 | Iter 2.000: -1.584251736485958 | Iter 1.000: -2.2693886625528337
    Resources requested: 0/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-13_00-10-29
    Number of trials: 10/10 (10 TERMINATED)
    +---------------------+------------+-------+--------------+------+------+------------+---------+------------+----------------------+
    | Trial name          | status     | loc   |   batch_size |   l1 |   l2 |         lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-------+--------------+------+------+------------+---------+------------+----------------------|
    | DEFAULT_a7dc9_00000 | TERMINATED |       |            4 |   64 |  128 | 0.00460012 | 1.58425 |     0.4628 |                    2 |
    | DEFAULT_a7dc9_00001 | TERMINATED |       |            2 |  256 |    8 | 0.0120715  | 2.31324 |     0.0964 |                    1 |
    | DEFAULT_a7dc9_00002 | TERMINATED |       |            4 |   16 |    8 | 0.0213926  | 2.31397 |     0.1031 |                    1 |
    | DEFAULT_a7dc9_00003 | TERMINATED |       |            2 |    4 |  256 | 0.00165723 | 1.64688 |     0.3854 |                    2 |
    | DEFAULT_a7dc9_00004 | TERMINATED |       |            8 |    4 |    4 | 0.0644851  | 2.31699 |     0.1011 |                   10 |
    | DEFAULT_a7dc9_00005 | TERMINATED |       |            8 |   16 |   32 | 0.0771842  | 2.31721 |     0.0982 |                    1 |
    | DEFAULT_a7dc9_00006 | TERMINATED |       |            8 |   64 |  128 | 0.00519527 | 1.44309 |     0.5248 |                   10 |
    | DEFAULT_a7dc9_00007 | TERMINATED |       |            8 |  128 |  128 | 0.0690339  | 2.22554 |     0.1613 |                    1 |
    | DEFAULT_a7dc9_00008 | TERMINATED |       |            2 |   16 |    4 | 0.0733233  | 2.36455 |     0.1    |                    1 |
    | DEFAULT_a7dc9_00009 | TERMINATED |       |            8 |  128 |    8 | 0.00133252 | 1.13484 |     0.6197 |                   10 |
    +---------------------+------------+-------+--------------+------+------+------------+---------+------------+----------------------+


    Best trial config: {'l1': 128, 'l2': 8, 'lr': 0.0013325212099700428, 'batch_size': 8}
    Best trial final validation loss: 1.1348403178572655
    Best trial final validation accuracy: 0.6197
    Files already downloaded and verified
    Files already downloaded and verified
    Best trial test set accuracy: 0.6047


If you run the code, an example output could look like this:

.. code-block::

    Number of trials: 10 (10 TERMINATED)
    +-----+------+------+-------------+--------------+---------+------------+--------------------+
    | ... |   l1 |   l2 |          lr |   batch_size |    loss |   accuracy | training_iteration |
    |-----+------+------+-------------+--------------+---------+------------+--------------------|
    | ... |   64 |    4 | 0.00011629  |            2 | 1.87273 |     0.244  |                  2 |
    | ... |   32 |   64 | 0.000339763 |            8 | 1.23603 |     0.567  |                  8 |
    | ... |    8 |   16 | 0.00276249  |           16 | 1.1815  |     0.5836 |                 10 |
    | ... |    4 |   64 | 0.000648721 |            4 | 1.31131 |     0.5224 |                  8 |
    | ... |   32 |   16 | 0.000340753 |            8 | 1.26454 |     0.5444 |                  8 |
    | ... |    8 |    4 | 0.000699775 |            8 | 1.99594 |     0.1983 |                  2 |
    | ... |  256 |    8 | 0.0839654   |           16 | 2.3119  |     0.0993 |                  1 |
    | ... |   16 |  128 | 0.0758154   |           16 | 2.33575 |     0.1327 |                  1 |
    | ... |   16 |    8 | 0.0763312   |           16 | 2.31129 |     0.1042 |                  4 |
    | ... |  128 |   16 | 0.000124903 |            4 | 2.26917 |     0.1945 |                  1 |
    +-----+------+------+-------------+--------------+---------+------------+--------------------+


    Best trial config: {'l1': 8, 'l2': 16, 'lr': 0.00276249, 'batch_size': 16, 'data_dir': '...'}
    Best trial final validation loss: 1.181501
    Best trial final validation accuracy: 0.5836
    Best trial test set accuracy: 0.5806

Most trials have been stopped early in order to avoid wasting resources.
The best performing trial achieved a validation accuracy of about 58%, which could
be confirmed on the test set.

So that's it! You can now tune the parameters of your PyTorch models.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 5 minutes  36.186 seconds)


.. _sphx_glr_download_beginner_hyperparameter_tuning_tutorial.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download

     :download:`Download Python source code: hyperparameter_tuning_tutorial.py <hyperparameter_tuning_tutorial.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: hyperparameter_tuning_tutorial.ipynb <hyperparameter_tuning_tutorial.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.readthedocs.io>`_
