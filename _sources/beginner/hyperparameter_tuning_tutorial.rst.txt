.. note::
    :class: sphx-glr-download-link-note

    Click :ref:`here <sphx_glr_download_beginner_hyperparameter_tuning_tutorial.py>` to download the full example code
.. rst-class:: sphx-glr-example-title

.. _sphx_glr_beginner_hyperparameter_tuning_tutorial.py:


Hyperparameter tuning with Ray Tune
===================================

Hyperparameter tuning can make the difference between an average model and a highly
accurate one. Often simple things like choosing a different learning rate or changing
a network layer size can have a dramatic impact on your model performance.

Fortunately, there are tools that help with finding the best combination of parameters.
`Ray Tune <https://docs.ray.io/en/latest/tune.html>`_ is an industry standard tool for
distributed hyperparameter tuning. Ray Tune includes the latest hyperparameter search
algorithms, integrates with TensorBoard and other analysis libraries, and natively
supports distributed training through `Ray's distributed machine learning engine
<https://ray.io/>`_.

In this tutorial, we will show you how to integrate Ray Tune into your PyTorch
training workflow. We will extend `this tutorial from the PyTorch documentation
<https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html>`_ for training
a CIFAR10 image classifier.

As you will see, we only need to add some slight modifications. In particular, we
need to

1. wrap data loading and training in functions,
2. make some network parameters configurable,
3. add checkpointing (optional),
4. and define the search space for the model tuning

|

To run this tutorial, please make sure the following packages are
installed:

-  ``ray[tune]``: Distributed hyperparameter tuning library
-  ``torchvision``: For the data transformers

Setup / Imports
---------------
Let's start with the imports:


.. code-block:: default

    from functools import partial
    import numpy as np
    import os
    import torch
    import torch.nn as nn
    import torch.nn.functional as F
    import torch.optim as optim
    from torch.utils.data import random_split
    import torchvision
    import torchvision.transforms as transforms
    from ray import tune
    from ray.tune import CLIReporter
    from ray.tune.schedulers import ASHAScheduler







Most of the imports are needed for building the PyTorch model. Only the last three
imports are for Ray Tune.

Data loaders
------------
We wrap the data loaders in their own function and pass a global data directory.
This way we can share a data directory between different trials.


.. code-block:: default



    def load_data(data_dir="./data"):
        transform = transforms.Compose([
            transforms.ToTensor(),
            transforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5))
        ])

        trainset = torchvision.datasets.CIFAR10(
            root=data_dir, train=True, download=True, transform=transform)

        testset = torchvision.datasets.CIFAR10(
            root=data_dir, train=False, download=True, transform=transform)

        return trainset, testset







Configurable neural network
---------------------------
We can only tune those parameters that are configurable. In this example, we can specify
the layer sizes of the fully connected layers:


.. code-block:: default



    class Net(nn.Module):
        def __init__(self, l1=120, l2=84):
            super(Net, self).__init__()
            self.conv1 = nn.Conv2d(3, 6, 5)
            self.pool = nn.MaxPool2d(2, 2)
            self.conv2 = nn.Conv2d(6, 16, 5)
            self.fc1 = nn.Linear(16 * 5 * 5, l1)
            self.fc2 = nn.Linear(l1, l2)
            self.fc3 = nn.Linear(l2, 10)

        def forward(self, x):
            x = self.pool(F.relu(self.conv1(x)))
            x = self.pool(F.relu(self.conv2(x)))
            x = x.view(-1, 16 * 5 * 5)
            x = F.relu(self.fc1(x))
            x = F.relu(self.fc2(x))
            x = self.fc3(x)
            return x







The train function
------------------
Now it gets interesting, because we introduce some changes to the example `from the PyTorch
documentation <https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html>`_.

We wrap the training script in a function ``train_cifar(config, checkpoint_dir=None, data_dir=None)``.
As you can guess, the ``config`` parameter will receive the hyperparameters we would like to
train with. The ``checkpoint_dir`` parameter is used to restore checkpoints. The ``data_dir`` specifies
the directory where we load and store the data, so multiple runs can share the same data source.

.. code-block:: python

    net = Net(config["l1"], config["l2"])

    if checkpoint_dir:
        model_state, optimizer_state = torch.load(
            os.path.join(checkpoint_dir, "checkpoint"))
        net.load_state_dict(model_state)
        optimizer.load_state_dict(optimizer_state)

The learning rate of the optimizer is made configurable, too:

.. code-block:: python

    optimizer = optim.SGD(net.parameters(), lr=config["lr"], momentum=0.9)

We also split the training data into a training and validation subset. We thus train on
80% of the data and calculate the validation loss on the remaining 20%. The batch sizes
with which we iterate through the training and test sets are configurable as well.

Adding (multi) GPU support with DataParallel
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Image classification benefits largely from GPUs. Luckily, we can continue to use
PyTorch's abstractions in Ray Tune. Thus, we can wrap our model in ``nn.DataParallel``
to support data parallel training on multiple GPUs:

.. code-block:: python

    device = "cpu"
    if torch.cuda.is_available():
        device = "cuda:0"
        if torch.cuda.device_count() > 1:
            net = nn.DataParallel(net)
    net.to(device)

By using a ``device`` variable we make sure that training also works when we have
no GPUs available. PyTorch requires us to send our data to the GPU memory explicitly,
like this:

.. code-block:: python

    for i, data in enumerate(trainloader, 0):
        inputs, labels = data
        inputs, labels = inputs.to(device), labels.to(device)

The code now supports training on CPUs, on a single GPU, and on multiple GPUs. Notably, Ray
also supports `fractional GPUs <https://docs.ray.io/en/master/using-ray-with-gpus.html#fractional-gpus>`_
so we can share GPUs among trials, as long as the model still fits on the GPU memory. We'll come back
to that later.

Communicating with Ray Tune
~~~~~~~~~~~~~~~~~~~~~~~~~~~

The most interesting part is the communication with Ray Tune:

.. code-block:: python

    with tune.checkpoint_dir(epoch) as checkpoint_dir:
        path = os.path.join(checkpoint_dir, "checkpoint")
        torch.save((net.state_dict(), optimizer.state_dict()), path)

    tune.report(loss=(val_loss / val_steps), accuracy=correct / total)

Here we first save a checkpoint and then report some metrics back to Ray Tune. Specifically,
we send the validation loss and accuracy back to Ray Tune. Ray Tune can then use these metrics
to decide which hyperparameter configuration lead to the best results. These metrics
can also be used to stop bad performing trials early in order to avoid wasting
resources on those trials.

The checkpoint saving is optional, however, it is necessary if we wanted to use advanced
schedulers like
`Population Based Training <https://docs.ray.io/en/master/tune/tutorials/tune-advanced-tutorial.html>`_.
Also, by saving the checkpoint we can later load the trained models and validate them
on a test set.

Full training function
~~~~~~~~~~~~~~~~~~~~~~

The full code example looks like this:


.. code-block:: default



    def train_cifar(config, checkpoint_dir=None, data_dir=None):
        net = Net(config["l1"], config["l2"])

        device = "cpu"
        if torch.cuda.is_available():
            device = "cuda:0"
            if torch.cuda.device_count() > 1:
                net = nn.DataParallel(net)
        net.to(device)

        criterion = nn.CrossEntropyLoss()
        optimizer = optim.SGD(net.parameters(), lr=config["lr"], momentum=0.9)

        if checkpoint_dir:
            model_state, optimizer_state = torch.load(
                os.path.join(checkpoint_dir, "checkpoint"))
            net.load_state_dict(model_state)
            optimizer.load_state_dict(optimizer_state)

        trainset, testset = load_data(data_dir)

        test_abs = int(len(trainset) * 0.8)
        train_subset, val_subset = random_split(
            trainset, [test_abs, len(trainset) - test_abs])

        trainloader = torch.utils.data.DataLoader(
            train_subset,
            batch_size=int(config["batch_size"]),
            shuffle=True,
            num_workers=8)
        valloader = torch.utils.data.DataLoader(
            val_subset,
            batch_size=int(config["batch_size"]),
            shuffle=True,
            num_workers=8)

        for epoch in range(10):  # loop over the dataset multiple times
            running_loss = 0.0
            epoch_steps = 0
            for i, data in enumerate(trainloader, 0):
                # get the inputs; data is a list of [inputs, labels]
                inputs, labels = data
                inputs, labels = inputs.to(device), labels.to(device)

                # zero the parameter gradients
                optimizer.zero_grad()

                # forward + backward + optimize
                outputs = net(inputs)
                loss = criterion(outputs, labels)
                loss.backward()
                optimizer.step()

                # print statistics
                running_loss += loss.item()
                epoch_steps += 1
                if i % 2000 == 1999:  # print every 2000 mini-batches
                    print("[%d, %5d] loss: %.3f" % (epoch + 1, i + 1,
                                                    running_loss / epoch_steps))
                    running_loss = 0.0

            # Validation loss
            val_loss = 0.0
            val_steps = 0
            total = 0
            correct = 0
            for i, data in enumerate(valloader, 0):
                with torch.no_grad():
                    inputs, labels = data
                    inputs, labels = inputs.to(device), labels.to(device)

                    outputs = net(inputs)
                    _, predicted = torch.max(outputs.data, 1)
                    total += labels.size(0)
                    correct += (predicted == labels).sum().item()

                    loss = criterion(outputs, labels)
                    val_loss += loss.cpu().numpy()
                    val_steps += 1

            with tune.checkpoint_dir(epoch) as checkpoint_dir:
                path = os.path.join(checkpoint_dir, "checkpoint")
                torch.save((net.state_dict(), optimizer.state_dict()), path)

            tune.report(loss=(val_loss / val_steps), accuracy=correct / total)
        print("Finished Training")







As you can see, most of the code is adapted directly from the original example.

Test set accuracy
-----------------
Commonly the performance of a machine learning model is tested on a hold-out test
set with data that has not been used for training the model. We also wrap this in a
function:


.. code-block:: default



    def test_accuracy(net, device="cpu"):
        trainset, testset = load_data()

        testloader = torch.utils.data.DataLoader(
            testset, batch_size=4, shuffle=False, num_workers=2)

        correct = 0
        total = 0
        with torch.no_grad():
            for data in testloader:
                images, labels = data
                images, labels = images.to(device), labels.to(device)
                outputs = net(images)
                _, predicted = torch.max(outputs.data, 1)
                total += labels.size(0)
                correct += (predicted == labels).sum().item()

        return correct / total







The function also expects a ``device`` parameter, so we can do the
test set validation on a GPU.

Configuring the search space
----------------------------
Lastly, we need to define Ray Tune's search space. Here is an example:

.. code-block:: python

    config = {
        "l1": tune.sample_from(lambda _: 2**np.random.randint(2, 9)),
        "l2": tune.sample_from(lambda _: 2**np.random.randint(2, 9)),
        "lr": tune.loguniform(1e-4, 1e-1),
        "batch_size": tune.choice([2, 4, 8, 16])
    }

The ``tune.sample_from()`` function makes it possible to define your own sample
methods to obtain hyperparameters. In this example, the ``l1`` and ``l2`` parameters
should be powers of 2 between 4 and 256, so either 4, 8, 16, 32, 64, 128, or 256.
The ``lr`` (learning rate) should be uniformly sampled between 0.0001 and 0.1. Lastly,
the batch size is a choice between 2, 4, 8, and 16.

At each trial, Ray Tune will now randomly sample a combination of parameters from these
search spaces. It will then train a number of models in parallel and find the best
performing one among these. We also use the ``ASHAScheduler`` which will terminate bad
performing trials early.

We wrap the ``train_cifar`` function with ``functools.partial`` to set the constant
``data_dir`` parameter. We can also tell Ray Tune what resources should be
available for each trial:

.. code-block:: python

    gpus_per_trial = 2
    # ...
    result = tune.run(
        partial(train_cifar, data_dir=data_dir),
        resources_per_trial={"cpu": 8, "gpu": gpus_per_trial},
        config=config,
        num_samples=num_samples,
        scheduler=scheduler,
        progress_reporter=reporter,
        checkpoint_at_end=True)

You can specify the number of CPUs, which are then available e.g.
to increase the ``num_workers`` of the PyTorch ``DataLoader`` instances. The selected
number of GPUs are made visible to PyTorch in each trial. Trials do not have access to
GPUs that haven't been requested for them - so you don't have to care about two trials
using the same set of resources.

Here we can also specify fractional GPUs, so something like ``gpus_per_trial=0.5`` is
completely valid. The trials will then share GPUs among each other.
You just have to make sure that the models still fit in the GPU memory.

After training the models, we will find the best performing one and load the trained
network from the checkpoint file. We then obtain the test set accuracy and report
everything by printing.

The full main function looks like this:


.. code-block:: default



    def main(num_samples=10, max_num_epochs=10, gpus_per_trial=2):
        data_dir = os.path.abspath("./data")
        load_data(data_dir)
        config = {
            "l1": tune.sample_from(lambda _: 2 ** np.random.randint(2, 9)),
            "l2": tune.sample_from(lambda _: 2 ** np.random.randint(2, 9)),
            "lr": tune.loguniform(1e-4, 1e-1),
            "batch_size": tune.choice([2, 4, 8, 16])
        }
        scheduler = ASHAScheduler(
            metric="loss",
            mode="min",
            max_t=max_num_epochs,
            grace_period=1,
            reduction_factor=2)
        reporter = CLIReporter(
            # parameter_columns=["l1", "l2", "lr", "batch_size"],
            metric_columns=["loss", "accuracy", "training_iteration"])
        result = tune.run(
            partial(train_cifar, data_dir=data_dir),
            resources_per_trial={"cpu": 2, "gpu": gpus_per_trial},
            config=config,
            num_samples=num_samples,
            scheduler=scheduler,
            progress_reporter=reporter)

        best_trial = result.get_best_trial("loss", "min", "last")
        print("Best trial config: {}".format(best_trial.config))
        print("Best trial final validation loss: {}".format(
            best_trial.last_result["loss"]))
        print("Best trial final validation accuracy: {}".format(
            best_trial.last_result["accuracy"]))

        best_trained_model = Net(best_trial.config["l1"], best_trial.config["l2"])
        device = "cpu"
        if torch.cuda.is_available():
            device = "cuda:0"
            if gpus_per_trial > 1:
                best_trained_model = nn.DataParallel(best_trained_model)
        best_trained_model.to(device)

        best_checkpoint_dir = best_trial.checkpoint.value
        model_state, optimizer_state = torch.load(os.path.join(
            best_checkpoint_dir, "checkpoint"))
        best_trained_model.load_state_dict(model_state)

        test_acc = test_accuracy(best_trained_model, device)
        print("Best trial test set accuracy: {}".format(test_acc))


    if __name__ == "__main__":
        # You can change the number of GPUs per trial here:
        main(num_samples=10, max_num_epochs=10, gpus_per_trial=0)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz
    Extracting /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data
    Files already downloaded and verified
    == Status ==
    Memory usage on this node: 4.0/240.1 GiB
    Using AsyncHyperBand: num_stopped=0
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: None
    Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 1/10 (1 RUNNING)
    +---------------------+----------+-------+--------------+------+------+------------+
    | Trial name          | status   | loc   |   batch_size |   l1 |   l2 |         lr |
    |---------------------+----------+-------+--------------+------+------+------------|
    | DEFAULT_83e35_00000 | RUNNING  |       |            2 |    4 |    4 | 0.00667388 |
    +---------------------+----------+-------+--------------+------+------+------------+


    [2m[36m(pid=1513)[0m Files already downloaded and verified
    [2m[36m(pid=1505)[0m Files already downloaded and verified
    [2m[36m(pid=1555)[0m Files already downloaded and verified
    [2m[36m(pid=1557)[0m Files already downloaded and verified
    [2m[36m(pid=1573)[0m Files already downloaded and verified
    [2m[36m(pid=1571)[0m Files already downloaded and verified
    [2m[36m(pid=1567)[0m Files already downloaded and verified
    [2m[36m(pid=1556)[0m Files already downloaded and verified
    [2m[36m(pid=1562)[0m Files already downloaded and verified
    [2m[36m(pid=1554)[0m Files already downloaded and verified
    [2m[36m(pid=1513)[0m Files already downloaded and verified
    [2m[36m(pid=1505)[0m Files already downloaded and verified
    [2m[36m(pid=1555)[0m Files already downloaded and verified
    [2m[36m(pid=1557)[0m Files already downloaded and verified
    [2m[36m(pid=1573)[0m Files already downloaded and verified
    [2m[36m(pid=1571)[0m Files already downloaded and verified
    [2m[36m(pid=1567)[0m Files already downloaded and verified
    [2m[36m(pid=1556)[0m Files already downloaded and verified
    [2m[36m(pid=1562)[0m Files already downloaded and verified
    [2m[36m(pid=1554)[0m Files already downloaded and verified
    [2m[36m(pid=1513)[0m [1,  2000] loss: 2.308
    [2m[36m(pid=1505)[0m [1,  2000] loss: 2.250
    [2m[36m(pid=1555)[0m [1,  2000] loss: 2.305
    [2m[36m(pid=1567)[0m [1,  2000] loss: 2.218
    [2m[36m(pid=1556)[0m [1,  2000] loss: 2.369
    [2m[36m(pid=1573)[0m [1,  2000] loss: 2.307
    [2m[36m(pid=1554)[0m [1,  2000] loss: 2.013
    [2m[36m(pid=1562)[0m [1,  2000] loss: 2.342
    [2m[36m(pid=1557)[0m [1,  2000] loss: 2.307
    [2m[36m(pid=1571)[0m [1,  2000] loss: 2.280
    [2m[36m(pid=1513)[0m [1,  4000] loss: 1.155
    [2m[36m(pid=1505)[0m [1,  4000] loss: 1.038
    [2m[36m(pid=1555)[0m [1,  4000] loss: 1.150
    [2m[36m(pid=1567)[0m [1,  4000] loss: 0.997
    [2m[36m(pid=1556)[0m [1,  4000] loss: 1.185
    [2m[36m(pid=1573)[0m [1,  4000] loss: 1.152
    Result for DEFAULT_83e35_00001:
      accuracy: 0.2253
      date: 2021-02-16_17-51-22
      done: false
      experiment_id: 8540657ed4e64ba084eb5bc2de6591f8
      experiment_tag: 1_batch_size=16,l1=128,l2=8,lr=0.0011107
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 1
      loss: 2.0636304904937743
      node_ip: 172.17.0.2
      pid: 1571
      should_checkpoint: true
      time_since_restore: 27.147892713546753
      time_this_iter_s: 27.147892713546753
      time_total_s: 27.147892713546753
      timestamp: 1613497882
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 83e35_00001
  
    == Status ==
    Memory usage on this node: 9.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=0
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -2.0636304904937743
    Resources requested: 20/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (10 RUNNING)
    +---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status   | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00000 | RUNNING  |                 |            2 |    4 |    4 | 0.00667388  |         |            |                      |
    | DEFAULT_83e35_00001 | RUNNING  | 172.17.0.2:1571 |           16 |  128 |    8 | 0.00111068  | 2.06363 |     0.2253 |                    1 |
    | DEFAULT_83e35_00002 | RUNNING  |                 |            2 |   32 |    4 | 0.000934657 |         |            |                      |
    | DEFAULT_83e35_00003 | RUNNING  |                 |            8 |  128 |   16 | 0.000391851 |         |            |                      |
    | DEFAULT_83e35_00004 | RUNNING  |                 |            4 |    4 |   16 | 0.00015716  |         |            |                      |
    | DEFAULT_83e35_00005 | RUNNING  |                 |            2 |   16 |   32 | 0.000132492 |         |            |                      |
    | DEFAULT_83e35_00006 | RUNNING  |                 |            2 |   64 |    4 | 0.0573297   |         |            |                      |
    | DEFAULT_83e35_00007 | RUNNING  |                 |            8 |    8 |   64 | 0.00203608  |         |            |                      |
    | DEFAULT_83e35_00008 | RUNNING  |                 |            2 |    4 |   16 | 0.0013424   |         |            |                      |
    | DEFAULT_83e35_00009 | RUNNING  |                 |            2 |  256 |   32 | 0.0362223   |         |            |                      |
    +---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1554)[0m [1,  4000] loss: 0.814
    [2m[36m(pid=1557)[0m [1,  4000] loss: 1.146
    [2m[36m(pid=1562)[0m [1,  4000] loss: 1.173
    [2m[36m(pid=1505)[0m [1,  6000] loss: 0.649
    [2m[36m(pid=1513)[0m [1,  6000] loss: 0.770
    [2m[36m(pid=1567)[0m [1,  6000] loss: 0.621
    [2m[36m(pid=1555)[0m [1,  6000] loss: 0.762
    [2m[36m(pid=1573)[0m [1,  6000] loss: 0.767
    [2m[36m(pid=1556)[0m [1,  6000] loss: 0.787
    Result for DEFAULT_83e35_00007:
      accuracy: 0.4427
      date: 2021-02-16_17-51-36
      done: false
      experiment_id: 8692d31293c64eacb4624252a4a44731
      experiment_tag: 7_batch_size=8,l1=8,l2=64,lr=0.0020361
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 1
      loss: 1.4797377706050874
      node_ip: 172.17.0.2
      pid: 1554
      should_checkpoint: true
      time_since_restore: 40.676658391952515
      time_this_iter_s: 40.676658391952515
      time_total_s: 40.676658391952515
      timestamp: 1613497896
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 83e35_00007
  
    == Status ==
    Memory usage on this node: 9.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=0
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -1.7716841305494309
    Resources requested: 20/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (10 RUNNING)
    +---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status   | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00000 | RUNNING  |                 |            2 |    4 |    4 | 0.00667388  |         |            |                      |
    | DEFAULT_83e35_00001 | RUNNING  | 172.17.0.2:1571 |           16 |  128 |    8 | 0.00111068  | 2.06363 |     0.2253 |                    1 |
    | DEFAULT_83e35_00002 | RUNNING  |                 |            2 |   32 |    4 | 0.000934657 |         |            |                      |
    | DEFAULT_83e35_00003 | RUNNING  |                 |            8 |  128 |   16 | 0.000391851 |         |            |                      |
    | DEFAULT_83e35_00004 | RUNNING  |                 |            4 |    4 |   16 | 0.00015716  |         |            |                      |
    | DEFAULT_83e35_00005 | RUNNING  |                 |            2 |   16 |   32 | 0.000132492 |         |            |                      |
    | DEFAULT_83e35_00006 | RUNNING  |                 |            2 |   64 |    4 | 0.0573297   |         |            |                      |
    | DEFAULT_83e35_00007 | RUNNING  | 172.17.0.2:1554 |            8 |    8 |   64 | 0.00203608  | 1.47974 |     0.4427 |                    1 |
    | DEFAULT_83e35_00008 | RUNNING  |                 |            2 |    4 |   16 | 0.0013424   |         |            |                      |
    | DEFAULT_83e35_00009 | RUNNING  |                 |            2 |  256 |   32 | 0.0362223   |         |            |                      |
    +---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_83e35_00003:
      accuracy: 0.2344
      date: 2021-02-16_17-51-38
      done: true
      experiment_id: 7c0157e8b1cb4311959e0d8ba8685f35
      experiment_tag: 3_batch_size=8,l1=128,l2=16,lr=0.00039185
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 1
      loss: 2.089074881839752
      node_ip: 172.17.0.2
      pid: 1557
      should_checkpoint: true
      time_since_restore: 42.89669489860535
      time_this_iter_s: 42.89669489860535
      time_total_s: 42.89669489860535
      timestamp: 1613497898
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 83e35_00003
  
    [2m[36m(pid=1571)[0m [2,  2000] loss: 1.922
    [2m[36m(pid=1562)[0m [1,  6000] loss: 0.781
    [2m[36m(pid=1567)[0m [1,  8000] loss: 0.450
    [2m[36m(pid=1505)[0m [1,  8000] loss: 0.461
    [2m[36m(pid=1513)[0m [1,  8000] loss: 0.578
    [2m[36m(pid=1555)[0m [1,  8000] loss: 0.563
    [2m[36m(pid=1573)[0m [1,  8000] loss: 0.571
    [2m[36m(pid=1556)[0m [1,  8000] loss: 0.593
    Result for DEFAULT_83e35_00001:
      accuracy: 0.3714
      date: 2021-02-16_17-51-46
      done: false
      experiment_id: 8540657ed4e64ba084eb5bc2de6591f8
      experiment_tag: 1_batch_size=16,l1=128,l2=8,lr=0.0011107
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 2
      loss: 1.698451767539978
      node_ip: 172.17.0.2
      pid: 1571
      should_checkpoint: true
      time_since_restore: 51.04782271385193
      time_this_iter_s: 23.899930000305176
      time_total_s: 51.04782271385193
      timestamp: 1613497906
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 83e35_00001
  
    == Status ==
    Memory usage on this node: 8.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=1
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.698451767539978 | Iter 1.000: -2.0636304904937743
    Resources requested: 18/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (9 RUNNING, 1 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00000 | RUNNING    |                 |            2 |    4 |    4 | 0.00667388  |         |            |                      |
    | DEFAULT_83e35_00001 | RUNNING    | 172.17.0.2:1571 |           16 |  128 |    8 | 0.00111068  | 1.69845 |     0.3714 |                    2 |
    | DEFAULT_83e35_00002 | RUNNING    |                 |            2 |   32 |    4 | 0.000934657 |         |            |                      |
    | DEFAULT_83e35_00004 | RUNNING    |                 |            4 |    4 |   16 | 0.00015716  |         |            |                      |
    | DEFAULT_83e35_00005 | RUNNING    |                 |            2 |   16 |   32 | 0.000132492 |         |            |                      |
    | DEFAULT_83e35_00006 | RUNNING    |                 |            2 |   64 |    4 | 0.0573297   |         |            |                      |
    | DEFAULT_83e35_00007 | RUNNING    | 172.17.0.2:1554 |            8 |    8 |   64 | 0.00203608  | 1.47974 |     0.4427 |                    1 |
    | DEFAULT_83e35_00008 | RUNNING    |                 |            2 |    4 |   16 | 0.0013424   |         |            |                      |
    | DEFAULT_83e35_00009 | RUNNING    |                 |            2 |  256 |   32 | 0.0362223   |         |            |                      |
    | DEFAULT_83e35_00003 | TERMINATED |                 |            8 |  128 |   16 | 0.000391851 | 2.08907 |     0.2344 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1554)[0m [2,  2000] loss: 1.449
    [2m[36m(pid=1567)[0m [1, 10000] loss: 0.343
    [2m[36m(pid=1505)[0m [1, 10000] loss: 0.362
    [2m[36m(pid=1513)[0m [1, 10000] loss: 0.462
    [2m[36m(pid=1555)[0m [1, 10000] loss: 0.433
    [2m[36m(pid=1562)[0m [1,  8000] loss: 0.586
    [2m[36m(pid=1573)[0m [1, 10000] loss: 0.444
    [2m[36m(pid=1556)[0m [1, 10000] loss: 0.472
    [2m[36m(pid=1554)[0m [2,  4000] loss: 0.695
    [2m[36m(pid=1567)[0m [1, 12000] loss: 0.283
    [2m[36m(pid=1505)[0m [1, 12000] loss: 0.288
    [2m[36m(pid=1555)[0m [1, 12000] loss: 0.347
    [2m[36m(pid=1513)[0m [1, 12000] loss: 0.385
    [2m[36m(pid=1571)[0m [3,  2000] loss: 1.629
    Result for DEFAULT_83e35_00004:
      accuracy: 0.1507
      date: 2021-02-16_17-52-02
      done: true
      experiment_id: 8b56a6c6dac648069ab5fc9b7c79cfcc
      experiment_tag: 4_batch_size=4,l1=4,l2=16,lr=0.00015716
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 1
      loss: 2.1913687014102936
      node_ip: 172.17.0.2
      pid: 1573
      should_checkpoint: true
      time_since_restore: 67.70356225967407
      time_this_iter_s: 67.70356225967407
      time_total_s: 67.70356225967407
      timestamp: 1613497922
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 83e35_00004
  
    == Status ==
    Memory usage on this node: 8.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=2
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.698451767539978 | Iter 1.000: -2.0763526861667634
    Resources requested: 18/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (9 RUNNING, 1 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00000 | RUNNING    |                 |            2 |    4 |    4 | 0.00667388  |         |            |                      |
    | DEFAULT_83e35_00001 | RUNNING    | 172.17.0.2:1571 |           16 |  128 |    8 | 0.00111068  | 1.69845 |     0.3714 |                    2 |
    | DEFAULT_83e35_00002 | RUNNING    |                 |            2 |   32 |    4 | 0.000934657 |         |            |                      |
    | DEFAULT_83e35_00004 | RUNNING    | 172.17.0.2:1573 |            4 |    4 |   16 | 0.00015716  | 2.19137 |     0.1507 |                    1 |
    | DEFAULT_83e35_00005 | RUNNING    |                 |            2 |   16 |   32 | 0.000132492 |         |            |                      |
    | DEFAULT_83e35_00006 | RUNNING    |                 |            2 |   64 |    4 | 0.0573297   |         |            |                      |
    | DEFAULT_83e35_00007 | RUNNING    | 172.17.0.2:1554 |            8 |    8 |   64 | 0.00203608  | 1.47974 |     0.4427 |                    1 |
    | DEFAULT_83e35_00008 | RUNNING    |                 |            2 |    4 |   16 | 0.0013424   |         |            |                      |
    | DEFAULT_83e35_00009 | RUNNING    |                 |            2 |  256 |   32 | 0.0362223   |         |            |                      |
    | DEFAULT_83e35_00003 | TERMINATED |                 |            8 |  128 |   16 | 0.000391851 | 2.08907 |     0.2344 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1556)[0m [1, 12000] loss: 0.395
    [2m[36m(pid=1562)[0m [1, 10000] loss: 0.468
    Result for DEFAULT_83e35_00001:
      accuracy: 0.4385
      date: 2021-02-16_17-52-09
      done: false
      experiment_id: 8540657ed4e64ba084eb5bc2de6591f8
      experiment_tag: 1_batch_size=16,l1=128,l2=8,lr=0.0011107
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 3
      loss: 1.5303633577346802
      node_ip: 172.17.0.2
      pid: 1571
      should_checkpoint: true
      time_since_restore: 74.25771832466125
      time_this_iter_s: 23.209895610809326
      time_total_s: 74.25771832466125
      timestamp: 1613497929
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: 83e35_00001
  
    == Status ==
    Memory usage on this node: 8.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=2
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.698451767539978 | Iter 1.000: -2.0763526861667634
    Resources requested: 16/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00000 | RUNNING    |                 |            2 |    4 |    4 | 0.00667388  |         |            |                      |
    | DEFAULT_83e35_00001 | RUNNING    | 172.17.0.2:1571 |           16 |  128 |    8 | 0.00111068  | 1.53036 |     0.4385 |                    3 |
    | DEFAULT_83e35_00002 | RUNNING    |                 |            2 |   32 |    4 | 0.000934657 |         |            |                      |
    | DEFAULT_83e35_00005 | RUNNING    |                 |            2 |   16 |   32 | 0.000132492 |         |            |                      |
    | DEFAULT_83e35_00006 | RUNNING    |                 |            2 |   64 |    4 | 0.0573297   |         |            |                      |
    | DEFAULT_83e35_00007 | RUNNING    | 172.17.0.2:1554 |            8 |    8 |   64 | 0.00203608  | 1.47974 |     0.4427 |                    1 |
    | DEFAULT_83e35_00008 | RUNNING    |                 |            2 |    4 |   16 | 0.0013424   |         |            |                      |
    | DEFAULT_83e35_00009 | RUNNING    |                 |            2 |  256 |   32 | 0.0362223   |         |            |                      |
    | DEFAULT_83e35_00003 | TERMINATED |                 |            8 |  128 |   16 | 0.000391851 | 2.08907 |     0.2344 |                    1 |
    | DEFAULT_83e35_00004 | TERMINATED |                 |            4 |    4 |   16 | 0.00015716  | 2.19137 |     0.1507 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1567)[0m [1, 14000] loss: 0.242
    Result for DEFAULT_83e35_00007:
      accuracy: 0.497
      date: 2021-02-16_17-52-11
      done: false
      experiment_id: 8692d31293c64eacb4624252a4a44731
      experiment_tag: 7_batch_size=8,l1=8,l2=64,lr=0.0020361
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 2
      loss: 1.3973678741455078
      node_ip: 172.17.0.2
      pid: 1554
      should_checkpoint: true
      time_since_restore: 76.38240456581116
      time_this_iter_s: 35.70574617385864
      time_total_s: 76.38240456581116
      timestamp: 1613497931
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 83e35_00007
  
    [2m[36m(pid=1505)[0m [1, 14000] loss: 0.240
    [2m[36m(pid=1555)[0m [1, 14000] loss: 0.290
    [2m[36m(pid=1513)[0m [1, 14000] loss: 0.330
    [2m[36m(pid=1556)[0m [1, 14000] loss: 0.338
    [2m[36m(pid=1567)[0m [1, 16000] loss: 0.208
    [2m[36m(pid=1505)[0m [1, 16000] loss: 0.209
    [2m[36m(pid=1513)[0m [1, 16000] loss: 0.289
    [2m[36m(pid=1562)[0m [1, 12000] loss: 0.391
    [2m[36m(pid=1555)[0m [1, 16000] loss: 0.245
    [2m[36m(pid=1554)[0m [3,  2000] loss: 1.316
    [2m[36m(pid=1571)[0m [4,  2000] loss: 1.489
    [2m[36m(pid=1556)[0m [1, 16000] loss: 0.296
    [2m[36m(pid=1567)[0m [1, 18000] loss: 0.185
    [2m[36m(pid=1505)[0m [1, 18000] loss: 0.185
    Result for DEFAULT_83e35_00001:
      accuracy: 0.4715
      date: 2021-02-16_17-52-32
      done: false
      experiment_id: 8540657ed4e64ba084eb5bc2de6591f8
      experiment_tag: 1_batch_size=16,l1=128,l2=8,lr=0.0011107
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 4
      loss: 1.4416932137489318
      node_ip: 172.17.0.2
      pid: 1571
      should_checkpoint: true
      time_since_restore: 96.71312928199768
      time_this_iter_s: 22.455410957336426
      time_total_s: 96.71312928199768
      timestamp: 1613497952
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: 83e35_00001
  
    == Status ==
    Memory usage on this node: 8.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=2
    Bracket: Iter 8.000: None | Iter 4.000: -1.4416932137489318 | Iter 2.000: -1.5479098208427429 | Iter 1.000: -2.0763526861667634
    Resources requested: 16/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00000 | RUNNING    |                 |            2 |    4 |    4 | 0.00667388  |         |            |                      |
    | DEFAULT_83e35_00001 | RUNNING    | 172.17.0.2:1571 |           16 |  128 |    8 | 0.00111068  | 1.44169 |     0.4715 |                    4 |
    | DEFAULT_83e35_00002 | RUNNING    |                 |            2 |   32 |    4 | 0.000934657 |         |            |                      |
    | DEFAULT_83e35_00005 | RUNNING    |                 |            2 |   16 |   32 | 0.000132492 |         |            |                      |
    | DEFAULT_83e35_00006 | RUNNING    |                 |            2 |   64 |    4 | 0.0573297   |         |            |                      |
    | DEFAULT_83e35_00007 | RUNNING    | 172.17.0.2:1554 |            8 |    8 |   64 | 0.00203608  | 1.39737 |     0.497  |                    2 |
    | DEFAULT_83e35_00008 | RUNNING    |                 |            2 |    4 |   16 | 0.0013424   |         |            |                      |
    | DEFAULT_83e35_00009 | RUNNING    |                 |            2 |  256 |   32 | 0.0362223   |         |            |                      |
    | DEFAULT_83e35_00003 | TERMINATED |                 |            8 |  128 |   16 | 0.000391851 | 2.08907 |     0.2344 |                    1 |
    | DEFAULT_83e35_00004 | TERMINATED |                 |            4 |    4 |   16 | 0.00015716  | 2.19137 |     0.1507 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1513)[0m [1, 18000] loss: 0.256
    [2m[36m(pid=1555)[0m [1, 18000] loss: 0.216
    [2m[36m(pid=1554)[0m [3,  4000] loss: 0.651
    [2m[36m(pid=1562)[0m [1, 14000] loss: 0.335
    [2m[36m(pid=1556)[0m [1, 18000] loss: 0.263
    [2m[36m(pid=1567)[0m [1, 20000] loss: 0.162
    [2m[36m(pid=1505)[0m [1, 20000] loss: 0.164
    [2m[36m(pid=1513)[0m [1, 20000] loss: 0.231
    [2m[36m(pid=1555)[0m [1, 20000] loss: 0.188
    Result for DEFAULT_83e35_00007:
      accuracy: 0.5375
      date: 2021-02-16_17-52-46
      done: false
      experiment_id: 8692d31293c64eacb4624252a4a44731
      experiment_tag: 7_batch_size=8,l1=8,l2=64,lr=0.0020361
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 3
      loss: 1.2754677406430244
      node_ip: 172.17.0.2
      pid: 1554
      should_checkpoint: true
      time_since_restore: 110.97371697425842
      time_this_iter_s: 34.591312408447266
      time_total_s: 110.97371697425842
      timestamp: 1613497966
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: 83e35_00007
  
    == Status ==
    Memory usage on this node: 8.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=2
    Bracket: Iter 8.000: None | Iter 4.000: -1.4416932137489318 | Iter 2.000: -1.5479098208427429 | Iter 1.000: -2.0763526861667634
    Resources requested: 16/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00000 | RUNNING    |                 |            2 |    4 |    4 | 0.00667388  |         |            |                      |
    | DEFAULT_83e35_00001 | RUNNING    | 172.17.0.2:1571 |           16 |  128 |    8 | 0.00111068  | 1.44169 |     0.4715 |                    4 |
    | DEFAULT_83e35_00002 | RUNNING    |                 |            2 |   32 |    4 | 0.000934657 |         |            |                      |
    | DEFAULT_83e35_00005 | RUNNING    |                 |            2 |   16 |   32 | 0.000132492 |         |            |                      |
    | DEFAULT_83e35_00006 | RUNNING    |                 |            2 |   64 |    4 | 0.0573297   |         |            |                      |
    | DEFAULT_83e35_00007 | RUNNING    | 172.17.0.2:1554 |            8 |    8 |   64 | 0.00203608  | 1.27547 |     0.5375 |                    3 |
    | DEFAULT_83e35_00008 | RUNNING    |                 |            2 |    4 |   16 | 0.0013424   |         |            |                      |
    | DEFAULT_83e35_00009 | RUNNING    |                 |            2 |  256 |   32 | 0.0362223   |         |            |                      |
    | DEFAULT_83e35_00003 | TERMINATED |                 |            8 |  128 |   16 | 0.000391851 | 2.08907 |     0.2344 |                    1 |
    | DEFAULT_83e35_00004 | TERMINATED |                 |            4 |    4 |   16 | 0.00015716  | 2.19137 |     0.1507 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1571)[0m [5,  2000] loss: 1.392
    [2m[36m(pid=1556)[0m [1, 20000] loss: 0.237
    [2m[36m(pid=1562)[0m [1, 16000] loss: 0.293
    Result for DEFAULT_83e35_00001:
      accuracy: 0.5065
      date: 2021-02-16_17-52-55
      done: false
      experiment_id: 8540657ed4e64ba084eb5bc2de6591f8
      experiment_tag: 1_batch_size=16,l1=128,l2=8,lr=0.0011107
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 5
      loss: 1.3502450144767761
      node_ip: 172.17.0.2
      pid: 1571
      should_checkpoint: true
      time_since_restore: 120.05749368667603
      time_this_iter_s: 23.344364404678345
      time_total_s: 120.05749368667603
      timestamp: 1613497975
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: 83e35_00001
  
    == Status ==
    Memory usage on this node: 8.0/240.1 GiB
    Using AsyncHyperBand: num_stopped=2
    Bracket: Iter 8.000: None | Iter 4.000: -1.4416932137489318 | Iter 2.000: -1.5479098208427429 | Iter 1.000: -2.0763526861667634
    Resources requested: 16/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00000 | RUNNING    |                 |            2 |    4 |    4 | 0.00667388  |         |            |                      |
    | DEFAULT_83e35_00001 | RUNNING    | 172.17.0.2:1571 |           16 |  128 |    8 | 0.00111068  | 1.35025 |     0.5065 |                    5 |
    | DEFAULT_83e35_00002 | RUNNING    |                 |            2 |   32 |    4 | 0.000934657 |         |            |                      |
    | DEFAULT_83e35_00005 | RUNNING    |                 |            2 |   16 |   32 | 0.000132492 |         |            |                      |
    | DEFAULT_83e35_00006 | RUNNING    |                 |            2 |   64 |    4 | 0.0573297   |         |            |                      |
    | DEFAULT_83e35_00007 | RUNNING    | 172.17.0.2:1554 |            8 |    8 |   64 | 0.00203608  | 1.27547 |     0.5375 |                    3 |
    | DEFAULT_83e35_00008 | RUNNING    |                 |            2 |    4 |   16 | 0.0013424   |         |            |                      |
    | DEFAULT_83e35_00009 | RUNNING    |                 |            2 |  256 |   32 | 0.0362223   |         |            |                      |
    | DEFAULT_83e35_00003 | TERMINATED |                 |            8 |  128 |   16 | 0.000391851 | 2.08907 |     0.2344 |                    1 |
    | DEFAULT_83e35_00004 | TERMINATED |                 |            4 |    4 |   16 | 0.00015716  | 2.19137 |     0.1507 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_83e35_00008:
      accuracy: 0.3451
      date: 2021-02-16_17-52-55
      done: false
      experiment_id: 4d35184cb7194f77bbdaa1a1b7093d10
      experiment_tag: 8_batch_size=2,l1=4,l2=16,lr=0.0013424
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 1
      loss: 1.7003938579455018
      node_ip: 172.17.0.2
      pid: 1567
      should_checkpoint: true
      time_since_restore: 120.16915822029114
      time_this_iter_s: 120.16915822029114
      time_total_s: 120.16915822029114
      timestamp: 1613497975
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 83e35_00008
  
    Result for DEFAULT_83e35_00002:
      accuracy: 0.389
      date: 2021-02-16_17-52-55
      done: false
      experiment_id: f2fb4ebbf0f34fbdb8261caddd35f69a
      experiment_tag: 2_batch_size=2,l1=32,l2=4,lr=0.00093466
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 1
      loss: 1.7182215837866068
      node_ip: 172.17.0.2
      pid: 1505
      should_checkpoint: true
      time_since_restore: 120.74709916114807
      time_this_iter_s: 120.74709916114807
      time_total_s: 120.74709916114807
      timestamp: 1613497975
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 83e35_00002
  
    Result for DEFAULT_83e35_00000:
      accuracy: 0.1029
      date: 2021-02-16_17-52-56
      done: true
      experiment_id: 672cbfabd8d441d58e7d6533b794e4f8
      experiment_tag: 0_batch_size=2,l1=4,l2=4,lr=0.0066739
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 1
      loss: 2.307041269445419
      node_ip: 172.17.0.2
      pid: 1513
      should_checkpoint: true
      time_since_restore: 121.32882738113403
      time_this_iter_s: 121.32882738113403
      time_total_s: 121.32882738113403
      timestamp: 1613497976
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 83e35_00000
  
    Result for DEFAULT_83e35_00005:
      accuracy: 0.308
      date: 2021-02-16_17-52-57
      done: false
      experiment_id: 34ae1f83c0934ff5acf2c042d32bf1b3
      experiment_tag: 5_batch_size=2,l1=16,l2=32,lr=0.00013249
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 1
      loss: 1.8615904504537581
      node_ip: 172.17.0.2
      pid: 1555
      should_checkpoint: true
      time_since_restore: 121.73010754585266
      time_this_iter_s: 121.73010754585266
      time_total_s: 121.73010754585266
      timestamp: 1613497977
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 83e35_00005
  
    [2m[36m(pid=1554)[0m [4,  2000] loss: 1.246
    Result for DEFAULT_83e35_00006:
      accuracy: 0.0997
      date: 2021-02-16_17-53-03
      done: true
      experiment_id: 4227304240944c209fe53a49d7717e36
      experiment_tag: 6_batch_size=2,l1=64,l2=4,lr=0.05733
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 1
      loss: 2.3402358543872834
      node_ip: 172.17.0.2
      pid: 1556
      should_checkpoint: true
      time_since_restore: 128.21892309188843
      time_this_iter_s: 128.21892309188843
      time_total_s: 128.21892309188843
      timestamp: 1613497983
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 83e35_00006
  
    == Status ==
    Memory usage on this node: 7.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=4
    Bracket: Iter 8.000: None | Iter 4.000: -1.4416932137489318 | Iter 2.000: -1.5479098208427429 | Iter 1.000: -2.0636304904937743
    Resources requested: 14/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (7 RUNNING, 3 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00001 | RUNNING    | 172.17.0.2:1571 |           16 |  128 |    8 | 0.00111068  | 1.35025 |     0.5065 |                    5 |
    | DEFAULT_83e35_00002 | RUNNING    | 172.17.0.2:1505 |            2 |   32 |    4 | 0.000934657 | 1.71822 |     0.389  |                    1 |
    | DEFAULT_83e35_00005 | RUNNING    | 172.17.0.2:1555 |            2 |   16 |   32 | 0.000132492 | 1.86159 |     0.308  |                    1 |
    | DEFAULT_83e35_00006 | RUNNING    | 172.17.0.2:1556 |            2 |   64 |    4 | 0.0573297   | 2.34024 |     0.0997 |                    1 |
    | DEFAULT_83e35_00007 | RUNNING    | 172.17.0.2:1554 |            8 |    8 |   64 | 0.00203608  | 1.27547 |     0.5375 |                    3 |
    | DEFAULT_83e35_00008 | RUNNING    | 172.17.0.2:1567 |            2 |    4 |   16 | 0.0013424   | 1.70039 |     0.3451 |                    1 |
    | DEFAULT_83e35_00009 | RUNNING    |                 |            2 |  256 |   32 | 0.0362223   |         |            |                      |
    | DEFAULT_83e35_00000 | TERMINATED |                 |            2 |    4 |    4 | 0.00667388  | 2.30704 |     0.1029 |                    1 |
    | DEFAULT_83e35_00003 | TERMINATED |                 |            8 |  128 |   16 | 0.000391851 | 2.08907 |     0.2344 |                    1 |
    | DEFAULT_83e35_00004 | TERMINATED |                 |            4 |    4 |   16 | 0.00015716  | 2.19137 |     0.1507 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1562)[0m [1, 18000] loss: 0.260
    [2m[36m(pid=1567)[0m [2,  2000] loss: 1.619
    [2m[36m(pid=1505)[0m [2,  2000] loss: 1.563
    [2m[36m(pid=1555)[0m [2,  2000] loss: 1.838
    [2m[36m(pid=1554)[0m [4,  4000] loss: 0.629
    [2m[36m(pid=1571)[0m [6,  2000] loss: 1.305
    [2m[36m(pid=1567)[0m [2,  4000] loss: 0.812
    [2m[36m(pid=1505)[0m [2,  4000] loss: 0.793
    [2m[36m(pid=1555)[0m [2,  4000] loss: 0.876
    [2m[36m(pid=1562)[0m [1, 20000] loss: 0.235
    Result for DEFAULT_83e35_00001:
      accuracy: 0.5203
      date: 2021-02-16_17-53-17
      done: false
      experiment_id: 8540657ed4e64ba084eb5bc2de6591f8
      experiment_tag: 1_batch_size=16,l1=128,l2=8,lr=0.0011107
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 6
      loss: 1.3181174211502076
      node_ip: 172.17.0.2
      pid: 1571
      should_checkpoint: true
      time_since_restore: 142.15866923332214
      time_this_iter_s: 22.101175546646118
      time_total_s: 142.15866923332214
      timestamp: 1613497997
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: 83e35_00001
  
    == Status ==
    Memory usage on this node: 6.9/240.1 GiB
    Using AsyncHyperBand: num_stopped=4
    Bracket: Iter 8.000: None | Iter 4.000: -1.4416932137489318 | Iter 2.000: -1.5479098208427429 | Iter 1.000: -2.0636304904937743
    Resources requested: 12/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00001 | RUNNING    | 172.17.0.2:1571 |           16 |  128 |    8 | 0.00111068  | 1.31812 |     0.5203 |                    6 |
    | DEFAULT_83e35_00002 | RUNNING    | 172.17.0.2:1505 |            2 |   32 |    4 | 0.000934657 | 1.71822 |     0.389  |                    1 |
    | DEFAULT_83e35_00005 | RUNNING    | 172.17.0.2:1555 |            2 |   16 |   32 | 0.000132492 | 1.86159 |     0.308  |                    1 |
    | DEFAULT_83e35_00007 | RUNNING    | 172.17.0.2:1554 |            8 |    8 |   64 | 0.00203608  | 1.27547 |     0.5375 |                    3 |
    | DEFAULT_83e35_00008 | RUNNING    | 172.17.0.2:1567 |            2 |    4 |   16 | 0.0013424   | 1.70039 |     0.3451 |                    1 |
    | DEFAULT_83e35_00009 | RUNNING    |                 |            2 |  256 |   32 | 0.0362223   |         |            |                      |
    | DEFAULT_83e35_00000 | TERMINATED |                 |            2 |    4 |    4 | 0.00667388  | 2.30704 |     0.1029 |                    1 |
    | DEFAULT_83e35_00003 | TERMINATED |                 |            8 |  128 |   16 | 0.000391851 | 2.08907 |     0.2344 |                    1 |
    | DEFAULT_83e35_00004 | TERMINATED |                 |            4 |    4 |   16 | 0.00015716  | 2.19137 |     0.1507 |                    1 |
    | DEFAULT_83e35_00006 | TERMINATED |                 |            2 |   64 |    4 | 0.0573297   | 2.34024 |     0.0997 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_83e35_00007:
      accuracy: 0.5457
      date: 2021-02-16_17-53-20
      done: false
      experiment_id: 8692d31293c64eacb4624252a4a44731
      experiment_tag: 7_batch_size=8,l1=8,l2=64,lr=0.0020361
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 4
      loss: 1.2856233632564544
      node_ip: 172.17.0.2
      pid: 1554
      should_checkpoint: true
      time_since_restore: 145.06045722961426
      time_this_iter_s: 34.086740255355835
      time_total_s: 145.06045722961426
      timestamp: 1613498000
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: 83e35_00007
  
    [2m[36m(pid=1567)[0m [2,  6000] loss: 0.534
    [2m[36m(pid=1505)[0m [2,  6000] loss: 0.529
    [2m[36m(pid=1555)[0m [2,  6000] loss: 0.581
    Result for DEFAULT_83e35_00009:
      accuracy: 0.0939
      date: 2021-02-16_17-53-30
      done: true
      experiment_id: 1664e9deacf34ad4a02ababd556b488f
      experiment_tag: 9_batch_size=2,l1=256,l2=32,lr=0.036222
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 1
      loss: 2.354856359362602
      node_ip: 172.17.0.2
      pid: 1562
      should_checkpoint: true
      time_since_restore: 154.88713550567627
      time_this_iter_s: 154.88713550567627
      time_total_s: 154.88713550567627
      timestamp: 1613498010
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 83e35_00009
  
    == Status ==
    Memory usage on this node: 6.9/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: None | Iter 4.000: -1.363658288502693 | Iter 2.000: -1.5479098208427429 | Iter 1.000: -2.0763526861667634
    Resources requested: 12/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00001 | RUNNING    | 172.17.0.2:1571 |           16 |  128 |    8 | 0.00111068  | 1.31812 |     0.5203 |                    6 |
    | DEFAULT_83e35_00002 | RUNNING    | 172.17.0.2:1505 |            2 |   32 |    4 | 0.000934657 | 1.71822 |     0.389  |                    1 |
    | DEFAULT_83e35_00005 | RUNNING    | 172.17.0.2:1555 |            2 |   16 |   32 | 0.000132492 | 1.86159 |     0.308  |                    1 |
    | DEFAULT_83e35_00007 | RUNNING    | 172.17.0.2:1554 |            8 |    8 |   64 | 0.00203608  | 1.28562 |     0.5457 |                    4 |
    | DEFAULT_83e35_00008 | RUNNING    | 172.17.0.2:1567 |            2 |    4 |   16 | 0.0013424   | 1.70039 |     0.3451 |                    1 |
    | DEFAULT_83e35_00009 | RUNNING    | 172.17.0.2:1562 |            2 |  256 |   32 | 0.0362223   | 2.35486 |     0.0939 |                    1 |
    | DEFAULT_83e35_00000 | TERMINATED |                 |            2 |    4 |    4 | 0.00667388  | 2.30704 |     0.1029 |                    1 |
    | DEFAULT_83e35_00003 | TERMINATED |                 |            8 |  128 |   16 | 0.000391851 | 2.08907 |     0.2344 |                    1 |
    | DEFAULT_83e35_00004 | TERMINATED |                 |            4 |    4 |   16 | 0.00015716  | 2.19137 |     0.1507 |                    1 |
    | DEFAULT_83e35_00006 | TERMINATED |                 |            2 |   64 |    4 | 0.0573297   | 2.34024 |     0.0997 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1554)[0m [5,  2000] loss: 1.204
    [2m[36m(pid=1571)[0m [7,  2000] loss: 1.240
    [2m[36m(pid=1567)[0m [2,  8000] loss: 0.403
    [2m[36m(pid=1505)[0m [2,  8000] loss: 0.381
    [2m[36m(pid=1555)[0m [2,  8000] loss: 0.429
    Result for DEFAULT_83e35_00001:
      accuracy: 0.5452
      date: 2021-02-16_17-53-39
      done: false
      experiment_id: 8540657ed4e64ba084eb5bc2de6591f8
      experiment_tag: 1_batch_size=16,l1=128,l2=8,lr=0.0011107
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 7
      loss: 1.263401969242096
      node_ip: 172.17.0.2
      pid: 1571
      should_checkpoint: true
      time_since_restore: 163.9312572479248
      time_this_iter_s: 21.77258801460266
      time_total_s: 163.9312572479248
      timestamp: 1613498019
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: 83e35_00001
  
    == Status ==
    Memory usage on this node: 6.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: None | Iter 4.000: -1.363658288502693 | Iter 2.000: -1.5479098208427429 | Iter 1.000: -2.0763526861667634
    Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00001 | RUNNING    | 172.17.0.2:1571 |           16 |  128 |    8 | 0.00111068  | 1.2634  |     0.5452 |                    7 |
    | DEFAULT_83e35_00002 | RUNNING    | 172.17.0.2:1505 |            2 |   32 |    4 | 0.000934657 | 1.71822 |     0.389  |                    1 |
    | DEFAULT_83e35_00005 | RUNNING    | 172.17.0.2:1555 |            2 |   16 |   32 | 0.000132492 | 1.86159 |     0.308  |                    1 |
    | DEFAULT_83e35_00007 | RUNNING    | 172.17.0.2:1554 |            8 |    8 |   64 | 0.00203608  | 1.28562 |     0.5457 |                    4 |
    | DEFAULT_83e35_00008 | RUNNING    | 172.17.0.2:1567 |            2 |    4 |   16 | 0.0013424   | 1.70039 |     0.3451 |                    1 |
    | DEFAULT_83e35_00000 | TERMINATED |                 |            2 |    4 |    4 | 0.00667388  | 2.30704 |     0.1029 |                    1 |
    | DEFAULT_83e35_00003 | TERMINATED |                 |            8 |  128 |   16 | 0.000391851 | 2.08907 |     0.2344 |                    1 |
    | DEFAULT_83e35_00004 | TERMINATED |                 |            4 |    4 |   16 | 0.00015716  | 2.19137 |     0.1507 |                    1 |
    | DEFAULT_83e35_00006 | TERMINATED |                 |            2 |   64 |    4 | 0.0573297   | 2.34024 |     0.0997 |                    1 |
    | DEFAULT_83e35_00009 | TERMINATED |                 |            2 |  256 |   32 | 0.0362223   | 2.35486 |     0.0939 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1567)[0m [2, 10000] loss: 0.323
    [2m[36m(pid=1505)[0m [2, 10000] loss: 0.307
    [2m[36m(pid=1554)[0m [5,  4000] loss: 0.606
    [2m[36m(pid=1555)[0m [2, 10000] loss: 0.335
    [2m[36m(pid=1567)[0m [2, 12000] loss: 0.268
    [2m[36m(pid=1505)[0m [2, 12000] loss: 0.257
    Result for DEFAULT_83e35_00007:
      accuracy: 0.5742
      date: 2021-02-16_17-53-52
      done: false
      experiment_id: 8692d31293c64eacb4624252a4a44731
      experiment_tag: 7_batch_size=8,l1=8,l2=64,lr=0.0020361
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 5
      loss: 1.2010663457632065
      node_ip: 172.17.0.2
      pid: 1554
      should_checkpoint: true
      time_since_restore: 177.58458042144775
      time_this_iter_s: 32.524123191833496
      time_total_s: 177.58458042144775
      timestamp: 1613498032
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: 83e35_00007
  
    == Status ==
    Memory usage on this node: 6.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: None | Iter 4.000: -1.363658288502693 | Iter 2.000: -1.5479098208427429 | Iter 1.000: -2.0763526861667634
    Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00001 | RUNNING    | 172.17.0.2:1571 |           16 |  128 |    8 | 0.00111068  | 1.2634  |     0.5452 |                    7 |
    | DEFAULT_83e35_00002 | RUNNING    | 172.17.0.2:1505 |            2 |   32 |    4 | 0.000934657 | 1.71822 |     0.389  |                    1 |
    | DEFAULT_83e35_00005 | RUNNING    | 172.17.0.2:1555 |            2 |   16 |   32 | 0.000132492 | 1.86159 |     0.308  |                    1 |
    | DEFAULT_83e35_00007 | RUNNING    | 172.17.0.2:1554 |            8 |    8 |   64 | 0.00203608  | 1.20107 |     0.5742 |                    5 |
    | DEFAULT_83e35_00008 | RUNNING    | 172.17.0.2:1567 |            2 |    4 |   16 | 0.0013424   | 1.70039 |     0.3451 |                    1 |
    | DEFAULT_83e35_00000 | TERMINATED |                 |            2 |    4 |    4 | 0.00667388  | 2.30704 |     0.1029 |                    1 |
    | DEFAULT_83e35_00003 | TERMINATED |                 |            8 |  128 |   16 | 0.000391851 | 2.08907 |     0.2344 |                    1 |
    | DEFAULT_83e35_00004 | TERMINATED |                 |            4 |    4 |   16 | 0.00015716  | 2.19137 |     0.1507 |                    1 |
    | DEFAULT_83e35_00006 | TERMINATED |                 |            2 |   64 |    4 | 0.0573297   | 2.34024 |     0.0997 |                    1 |
    | DEFAULT_83e35_00009 | TERMINATED |                 |            2 |  256 |   32 | 0.0362223   | 2.35486 |     0.0939 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1555)[0m [2, 12000] loss: 0.274
    [2m[36m(pid=1571)[0m [8,  2000] loss: 1.177
    [2m[36m(pid=1567)[0m [2, 14000] loss: 0.226
    Result for DEFAULT_83e35_00001:
      accuracy: 0.5573
      date: 2021-02-16_17-54-00
      done: false
      experiment_id: 8540657ed4e64ba084eb5bc2de6591f8
      experiment_tag: 1_batch_size=16,l1=128,l2=8,lr=0.0011107
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 8
      loss: 1.2271941506385804
      node_ip: 172.17.0.2
      pid: 1571
      should_checkpoint: true
      time_since_restore: 185.34152054786682
      time_this_iter_s: 21.410263299942017
      time_total_s: 185.34152054786682
      timestamp: 1613498040
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: 83e35_00001
  
    == Status ==
    Memory usage on this node: 6.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: -1.2271941506385804 | Iter 4.000: -1.363658288502693 | Iter 2.000: -1.5479098208427429 | Iter 1.000: -2.0763526861667634
    Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00001 | RUNNING    | 172.17.0.2:1571 |           16 |  128 |    8 | 0.00111068  | 1.22719 |     0.5573 |                    8 |
    | DEFAULT_83e35_00002 | RUNNING    | 172.17.0.2:1505 |            2 |   32 |    4 | 0.000934657 | 1.71822 |     0.389  |                    1 |
    | DEFAULT_83e35_00005 | RUNNING    | 172.17.0.2:1555 |            2 |   16 |   32 | 0.000132492 | 1.86159 |     0.308  |                    1 |
    | DEFAULT_83e35_00007 | RUNNING    | 172.17.0.2:1554 |            8 |    8 |   64 | 0.00203608  | 1.20107 |     0.5742 |                    5 |
    | DEFAULT_83e35_00008 | RUNNING    | 172.17.0.2:1567 |            2 |    4 |   16 | 0.0013424   | 1.70039 |     0.3451 |                    1 |
    | DEFAULT_83e35_00000 | TERMINATED |                 |            2 |    4 |    4 | 0.00667388  | 2.30704 |     0.1029 |                    1 |
    | DEFAULT_83e35_00003 | TERMINATED |                 |            8 |  128 |   16 | 0.000391851 | 2.08907 |     0.2344 |                    1 |
    | DEFAULT_83e35_00004 | TERMINATED |                 |            4 |    4 |   16 | 0.00015716  | 2.19137 |     0.1507 |                    1 |
    | DEFAULT_83e35_00006 | TERMINATED |                 |            2 |   64 |    4 | 0.0573297   | 2.34024 |     0.0997 |                    1 |
    | DEFAULT_83e35_00009 | TERMINATED |                 |            2 |  256 |   32 | 0.0362223   | 2.35486 |     0.0939 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1505)[0m [2, 14000] loss: 0.217
    [2m[36m(pid=1555)[0m [2, 14000] loss: 0.233
    [2m[36m(pid=1554)[0m [6,  2000] loss: 1.171
    [2m[36m(pid=1567)[0m [2, 16000] loss: 0.197
    [2m[36m(pid=1505)[0m [2, 16000] loss: 0.189
    [2m[36m(pid=1555)[0m [2, 16000] loss: 0.203
    [2m[36m(pid=1571)[0m [9,  2000] loss: 1.121
    [2m[36m(pid=1554)[0m [6,  4000] loss: 0.592
    [2m[36m(pid=1567)[0m [2, 18000] loss: 0.180
    [2m[36m(pid=1505)[0m [2, 18000] loss: 0.168
    [2m[36m(pid=1555)[0m [2, 18000] loss: 0.179
    Result for DEFAULT_83e35_00001:
      accuracy: 0.5932
      date: 2021-02-16_17-54-22
      done: false
      experiment_id: 8540657ed4e64ba084eb5bc2de6591f8
      experiment_tag: 1_batch_size=16,l1=128,l2=8,lr=0.0011107
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 9
      loss: 1.175420930957794
      node_ip: 172.17.0.2
      pid: 1571
      should_checkpoint: true
      time_since_restore: 206.69339036941528
      time_this_iter_s: 21.351869821548462
      time_total_s: 206.69339036941528
      timestamp: 1613498062
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: 83e35_00001
  
    == Status ==
    Memory usage on this node: 6.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: -1.2271941506385804 | Iter 4.000: -1.363658288502693 | Iter 2.000: -1.5479098208427429 | Iter 1.000: -2.0763526861667634
    Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00001 | RUNNING    | 172.17.0.2:1571 |           16 |  128 |    8 | 0.00111068  | 1.17542 |     0.5932 |                    9 |
    | DEFAULT_83e35_00002 | RUNNING    | 172.17.0.2:1505 |            2 |   32 |    4 | 0.000934657 | 1.71822 |     0.389  |                    1 |
    | DEFAULT_83e35_00005 | RUNNING    | 172.17.0.2:1555 |            2 |   16 |   32 | 0.000132492 | 1.86159 |     0.308  |                    1 |
    | DEFAULT_83e35_00007 | RUNNING    | 172.17.0.2:1554 |            8 |    8 |   64 | 0.00203608  | 1.20107 |     0.5742 |                    5 |
    | DEFAULT_83e35_00008 | RUNNING    | 172.17.0.2:1567 |            2 |    4 |   16 | 0.0013424   | 1.70039 |     0.3451 |                    1 |
    | DEFAULT_83e35_00000 | TERMINATED |                 |            2 |    4 |    4 | 0.00667388  | 2.30704 |     0.1029 |                    1 |
    | DEFAULT_83e35_00003 | TERMINATED |                 |            8 |  128 |   16 | 0.000391851 | 2.08907 |     0.2344 |                    1 |
    | DEFAULT_83e35_00004 | TERMINATED |                 |            4 |    4 |   16 | 0.00015716  | 2.19137 |     0.1507 |                    1 |
    | DEFAULT_83e35_00006 | TERMINATED |                 |            2 |   64 |    4 | 0.0573297   | 2.34024 |     0.0997 |                    1 |
    | DEFAULT_83e35_00009 | TERMINATED |                 |            2 |  256 |   32 | 0.0362223   | 2.35486 |     0.0939 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_83e35_00007:
      accuracy: 0.5756
      date: 2021-02-16_17-54-25
      done: false
      experiment_id: 8692d31293c64eacb4624252a4a44731
      experiment_tag: 7_batch_size=8,l1=8,l2=64,lr=0.0020361
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 6
      loss: 1.1831926294445991
      node_ip: 172.17.0.2
      pid: 1554
      should_checkpoint: true
      time_since_restore: 210.00341367721558
      time_this_iter_s: 32.41883325576782
      time_total_s: 210.00341367721558
      timestamp: 1613498065
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: 83e35_00007
  
    [2m[36m(pid=1567)[0m [2, 20000] loss: 0.159
    [2m[36m(pid=1505)[0m [2, 20000] loss: 0.148
    [2m[36m(pid=1555)[0m [2, 20000] loss: 0.157
    [2m[36m(pid=1554)[0m [7,  2000] loss: 1.163
    [2m[36m(pid=1571)[0m [10,  2000] loss: 1.075
    Result for DEFAULT_83e35_00008:
      accuracy: 0.3892
      date: 2021-02-16_17-54-39
      done: true
      experiment_id: 4d35184cb7194f77bbdaa1a1b7093d10
      experiment_tag: 8_batch_size=2,l1=4,l2=16,lr=0.0013424
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 2
      loss: 1.663983844331652
      node_ip: 172.17.0.2
      pid: 1567
      should_checkpoint: true
      time_since_restore: 224.4331545829773
      time_this_iter_s: 104.26399636268616
      time_total_s: 224.4331545829773
      timestamp: 1613498079
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 83e35_00008
  
    == Status ==
    Memory usage on this node: 6.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: -1.2271941506385804 | Iter 4.000: -1.363658288502693 | Iter 2.000: -1.663983844331652 | Iter 1.000: -2.0763526861667634
    Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00001 | RUNNING    | 172.17.0.2:1571 |           16 |  128 |    8 | 0.00111068  | 1.17542 |     0.5932 |                    9 |
    | DEFAULT_83e35_00002 | RUNNING    | 172.17.0.2:1505 |            2 |   32 |    4 | 0.000934657 | 1.71822 |     0.389  |                    1 |
    | DEFAULT_83e35_00005 | RUNNING    | 172.17.0.2:1555 |            2 |   16 |   32 | 0.000132492 | 1.86159 |     0.308  |                    1 |
    | DEFAULT_83e35_00007 | RUNNING    | 172.17.0.2:1554 |            8 |    8 |   64 | 0.00203608  | 1.18319 |     0.5756 |                    6 |
    | DEFAULT_83e35_00008 | RUNNING    | 172.17.0.2:1567 |            2 |    4 |   16 | 0.0013424   | 1.66398 |     0.3892 |                    2 |
    | DEFAULT_83e35_00000 | TERMINATED |                 |            2 |    4 |    4 | 0.00667388  | 2.30704 |     0.1029 |                    1 |
    | DEFAULT_83e35_00003 | TERMINATED |                 |            8 |  128 |   16 | 0.000391851 | 2.08907 |     0.2344 |                    1 |
    | DEFAULT_83e35_00004 | TERMINATED |                 |            4 |    4 |   16 | 0.00015716  | 2.19137 |     0.1507 |                    1 |
    | DEFAULT_83e35_00006 | TERMINATED |                 |            2 |   64 |    4 | 0.0573297   | 2.34024 |     0.0997 |                    1 |
    | DEFAULT_83e35_00009 | TERMINATED |                 |            2 |  256 |   32 | 0.0362223   | 2.35486 |     0.0939 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_83e35_00002:
      accuracy: 0.4519
      date: 2021-02-16_17-54-40
      done: false
      experiment_id: f2fb4ebbf0f34fbdb8261caddd35f69a
      experiment_tag: 2_batch_size=2,l1=32,l2=4,lr=0.00093466
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 2
      loss: 1.506743792191893
      node_ip: 172.17.0.2
      pid: 1505
      should_checkpoint: true
      time_since_restore: 225.64905214309692
      time_this_iter_s: 104.90195298194885
      time_total_s: 225.64905214309692
      timestamp: 1613498080
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 83e35_00002
  
    Result for DEFAULT_83e35_00005:
      accuracy: 0.4112
      date: 2021-02-16_17-54-42
      done: true
      experiment_id: 34ae1f83c0934ff5acf2c042d32bf1b3
      experiment_tag: 5_batch_size=2,l1=16,l2=32,lr=0.00013249
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 2
      loss: 1.5943017072498797
      node_ip: 172.17.0.2
      pid: 1555
      should_checkpoint: true
      time_since_restore: 227.61658263206482
      time_this_iter_s: 105.88647508621216
      time_total_s: 227.61658263206482
      timestamp: 1613498082
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 83e35_00005
  
    Result for DEFAULT_83e35_00001:
      accuracy: 0.5824
      date: 2021-02-16_17-54-43
      done: true
      experiment_id: 8540657ed4e64ba084eb5bc2de6591f8
      experiment_tag: 1_batch_size=16,l1=128,l2=8,lr=0.0011107
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 10
      loss: 1.2012829295158387
      node_ip: 172.17.0.2
      pid: 1571
      should_checkpoint: true
      time_since_restore: 228.22248148918152
      time_this_iter_s: 21.529091119766235
      time_total_s: 228.22248148918152
      timestamp: 1613498083
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: 83e35_00001
  
    [2m[36m(pid=1554)[0m [7,  4000] loss: 0.578
    [2m[36m(pid=1505)[0m [3,  2000] loss: 1.448
    Result for DEFAULT_83e35_00007:
      accuracy: 0.5846
      date: 2021-02-16_17-54-56
      done: false
      experiment_id: 8692d31293c64eacb4624252a4a44731
      experiment_tag: 7_batch_size=8,l1=8,l2=64,lr=0.0020361
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 7
      loss: 1.192366264462471
      node_ip: 172.17.0.2
      pid: 1554
      should_checkpoint: true
      time_since_restore: 241.56780433654785
      time_this_iter_s: 31.564390659332275
      time_total_s: 241.56780433654785
      timestamp: 1613498096
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: 83e35_00007
  
    == Status ==
    Memory usage on this node: 4.6/240.1 GiB
    Using AsyncHyperBand: num_stopped=8
    Bracket: Iter 8.000: -1.2271941506385804 | Iter 4.000: -1.363658288502693 | Iter 2.000: -1.5943017072498797 | Iter 1.000: -2.0763526861667634
    Resources requested: 4/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00002 | RUNNING    | 172.17.0.2:1505 |            2 |   32 |    4 | 0.000934657 | 1.50674 |     0.4519 |                    2 |
    | DEFAULT_83e35_00007 | RUNNING    | 172.17.0.2:1554 |            8 |    8 |   64 | 0.00203608  | 1.19237 |     0.5846 |                    7 |
    | DEFAULT_83e35_00000 | TERMINATED |                 |            2 |    4 |    4 | 0.00667388  | 2.30704 |     0.1029 |                    1 |
    | DEFAULT_83e35_00001 | TERMINATED |                 |           16 |  128 |    8 | 0.00111068  | 1.20128 |     0.5824 |                   10 |
    | DEFAULT_83e35_00003 | TERMINATED |                 |            8 |  128 |   16 | 0.000391851 | 2.08907 |     0.2344 |                    1 |
    | DEFAULT_83e35_00004 | TERMINATED |                 |            4 |    4 |   16 | 0.00015716  | 2.19137 |     0.1507 |                    1 |
    | DEFAULT_83e35_00005 | TERMINATED |                 |            2 |   16 |   32 | 0.000132492 | 1.5943  |     0.4112 |                    2 |
    | DEFAULT_83e35_00006 | TERMINATED |                 |            2 |   64 |    4 | 0.0573297   | 2.34024 |     0.0997 |                    1 |
    | DEFAULT_83e35_00008 | TERMINATED |                 |            2 |    4 |   16 | 0.0013424   | 1.66398 |     0.3892 |                    2 |
    | DEFAULT_83e35_00009 | TERMINATED |                 |            2 |  256 |   32 | 0.0362223   | 2.35486 |     0.0939 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1505)[0m [3,  4000] loss: 0.722
    [2m[36m(pid=1505)[0m [3,  6000] loss: 0.486
    [2m[36m(pid=1554)[0m [8,  2000] loss: 1.132
    [2m[36m(pid=1505)[0m [3,  8000] loss: 0.359
    [2m[36m(pid=1554)[0m [8,  4000] loss: 0.564
    [2m[36m(pid=1505)[0m [3, 10000] loss: 0.288
    Result for DEFAULT_83e35_00007:
      accuracy: 0.5849
      date: 2021-02-16_17-55-27
      done: false
      experiment_id: 8692d31293c64eacb4624252a4a44731
      experiment_tag: 7_batch_size=8,l1=8,l2=64,lr=0.0020361
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 8
      loss: 1.1830960616111756
      node_ip: 172.17.0.2
      pid: 1554
      should_checkpoint: true
      time_since_restore: 272.27706718444824
      time_this_iter_s: 30.70926284790039
      time_total_s: 272.27706718444824
      timestamp: 1613498127
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: 83e35_00007
  
    == Status ==
    Memory usage on this node: 4.6/240.1 GiB
    Using AsyncHyperBand: num_stopped=8
    Bracket: Iter 8.000: -1.2051451061248781 | Iter 4.000: -1.363658288502693 | Iter 2.000: -1.5943017072498797 | Iter 1.000: -2.0763526861667634
    Resources requested: 4/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00002 | RUNNING    | 172.17.0.2:1505 |            2 |   32 |    4 | 0.000934657 | 1.50674 |     0.4519 |                    2 |
    | DEFAULT_83e35_00007 | RUNNING    | 172.17.0.2:1554 |            8 |    8 |   64 | 0.00203608  | 1.1831  |     0.5849 |                    8 |
    | DEFAULT_83e35_00000 | TERMINATED |                 |            2 |    4 |    4 | 0.00667388  | 2.30704 |     0.1029 |                    1 |
    | DEFAULT_83e35_00001 | TERMINATED |                 |           16 |  128 |    8 | 0.00111068  | 1.20128 |     0.5824 |                   10 |
    | DEFAULT_83e35_00003 | TERMINATED |                 |            8 |  128 |   16 | 0.000391851 | 2.08907 |     0.2344 |                    1 |
    | DEFAULT_83e35_00004 | TERMINATED |                 |            4 |    4 |   16 | 0.00015716  | 2.19137 |     0.1507 |                    1 |
    | DEFAULT_83e35_00005 | TERMINATED |                 |            2 |   16 |   32 | 0.000132492 | 1.5943  |     0.4112 |                    2 |
    | DEFAULT_83e35_00006 | TERMINATED |                 |            2 |   64 |    4 | 0.0573297   | 2.34024 |     0.0997 |                    1 |
    | DEFAULT_83e35_00008 | TERMINATED |                 |            2 |    4 |   16 | 0.0013424   | 1.66398 |     0.3892 |                    2 |
    | DEFAULT_83e35_00009 | TERMINATED |                 |            2 |  256 |   32 | 0.0362223   | 2.35486 |     0.0939 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1505)[0m [3, 12000] loss: 0.236
    [2m[36m(pid=1554)[0m [9,  2000] loss: 1.121
    [2m[36m(pid=1505)[0m [3, 14000] loss: 0.209
    [2m[36m(pid=1505)[0m [3, 16000] loss: 0.180
    [2m[36m(pid=1554)[0m [9,  4000] loss: 0.559
    [2m[36m(pid=1505)[0m [3, 18000] loss: 0.162
    Result for DEFAULT_83e35_00007:
      accuracy: 0.5873
      date: 2021-02-16_17-55-58
      done: false
      experiment_id: 8692d31293c64eacb4624252a4a44731
      experiment_tag: 7_batch_size=8,l1=8,l2=64,lr=0.0020361
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 9
      loss: 1.1797034819245338
      node_ip: 172.17.0.2
      pid: 1554
      should_checkpoint: true
      time_since_restore: 302.92164850234985
      time_this_iter_s: 30.64458131790161
      time_total_s: 302.92164850234985
      timestamp: 1613498158
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: 83e35_00007
  
    == Status ==
    Memory usage on this node: 4.6/240.1 GiB
    Using AsyncHyperBand: num_stopped=8
    Bracket: Iter 8.000: -1.2051451061248781 | Iter 4.000: -1.363658288502693 | Iter 2.000: -1.5943017072498797 | Iter 1.000: -2.0763526861667634
    Resources requested: 4/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00002 | RUNNING    | 172.17.0.2:1505 |            2 |   32 |    4 | 0.000934657 | 1.50674 |     0.4519 |                    2 |
    | DEFAULT_83e35_00007 | RUNNING    | 172.17.0.2:1554 |            8 |    8 |   64 | 0.00203608  | 1.1797  |     0.5873 |                    9 |
    | DEFAULT_83e35_00000 | TERMINATED |                 |            2 |    4 |    4 | 0.00667388  | 2.30704 |     0.1029 |                    1 |
    | DEFAULT_83e35_00001 | TERMINATED |                 |           16 |  128 |    8 | 0.00111068  | 1.20128 |     0.5824 |                   10 |
    | DEFAULT_83e35_00003 | TERMINATED |                 |            8 |  128 |   16 | 0.000391851 | 2.08907 |     0.2344 |                    1 |
    | DEFAULT_83e35_00004 | TERMINATED |                 |            4 |    4 |   16 | 0.00015716  | 2.19137 |     0.1507 |                    1 |
    | DEFAULT_83e35_00005 | TERMINATED |                 |            2 |   16 |   32 | 0.000132492 | 1.5943  |     0.4112 |                    2 |
    | DEFAULT_83e35_00006 | TERMINATED |                 |            2 |   64 |    4 | 0.0573297   | 2.34024 |     0.0997 |                    1 |
    | DEFAULT_83e35_00008 | TERMINATED |                 |            2 |    4 |   16 | 0.0013424   | 1.66398 |     0.3892 |                    2 |
    | DEFAULT_83e35_00009 | TERMINATED |                 |            2 |  256 |   32 | 0.0362223   | 2.35486 |     0.0939 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1505)[0m [3, 20000] loss: 0.143
    [2m[36m(pid=1554)[0m [10,  2000] loss: 1.098
    Result for DEFAULT_83e35_00002:
      accuracy: 0.4913
      date: 2021-02-16_17-56-17
      done: false
      experiment_id: f2fb4ebbf0f34fbdb8261caddd35f69a
      experiment_tag: 2_batch_size=2,l1=32,l2=4,lr=0.00093466
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 3
      loss: 1.4630282184049488
      node_ip: 172.17.0.2
      pid: 1505
      should_checkpoint: true
      time_since_restore: 322.6043004989624
      time_this_iter_s: 96.95524835586548
      time_total_s: 322.6043004989624
      timestamp: 1613498177
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: 83e35_00002
  
    == Status ==
    Memory usage on this node: 4.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=8
    Bracket: Iter 8.000: -1.2051451061248781 | Iter 4.000: -1.363658288502693 | Iter 2.000: -1.5943017072498797 | Iter 1.000: -2.0763526861667634
    Resources requested: 4/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00002 | RUNNING    | 172.17.0.2:1505 |            2 |   32 |    4 | 0.000934657 | 1.46303 |     0.4913 |                    3 |
    | DEFAULT_83e35_00007 | RUNNING    | 172.17.0.2:1554 |            8 |    8 |   64 | 0.00203608  | 1.1797  |     0.5873 |                    9 |
    | DEFAULT_83e35_00000 | TERMINATED |                 |            2 |    4 |    4 | 0.00667388  | 2.30704 |     0.1029 |                    1 |
    | DEFAULT_83e35_00001 | TERMINATED |                 |           16 |  128 |    8 | 0.00111068  | 1.20128 |     0.5824 |                   10 |
    | DEFAULT_83e35_00003 | TERMINATED |                 |            8 |  128 |   16 | 0.000391851 | 2.08907 |     0.2344 |                    1 |
    | DEFAULT_83e35_00004 | TERMINATED |                 |            4 |    4 |   16 | 0.00015716  | 2.19137 |     0.1507 |                    1 |
    | DEFAULT_83e35_00005 | TERMINATED |                 |            2 |   16 |   32 | 0.000132492 | 1.5943  |     0.4112 |                    2 |
    | DEFAULT_83e35_00006 | TERMINATED |                 |            2 |   64 |    4 | 0.0573297   | 2.34024 |     0.0997 |                    1 |
    | DEFAULT_83e35_00008 | TERMINATED |                 |            2 |    4 |   16 | 0.0013424   | 1.66398 |     0.3892 |                    2 |
    | DEFAULT_83e35_00009 | TERMINATED |                 |            2 |  256 |   32 | 0.0362223   | 2.35486 |     0.0939 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1554)[0m [10,  4000] loss: 0.555
    [2m[36m(pid=1505)[0m [4,  2000] loss: 1.377
    Result for DEFAULT_83e35_00007:
      accuracy: 0.5893
      date: 2021-02-16_17-56-28
      done: true
      experiment_id: 8692d31293c64eacb4624252a4a44731
      experiment_tag: 7_batch_size=8,l1=8,l2=64,lr=0.0020361
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 10
      loss: 1.1710100273132324
      node_ip: 172.17.0.2
      pid: 1554
      should_checkpoint: true
      time_since_restore: 333.433687210083
      time_this_iter_s: 30.512038707733154
      time_total_s: 333.433687210083
      timestamp: 1613498188
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: 83e35_00007
  
    == Status ==
    Memory usage on this node: 4.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=9
    Bracket: Iter 8.000: -1.2051451061248781 | Iter 4.000: -1.363658288502693 | Iter 2.000: -1.5943017072498797 | Iter 1.000: -2.0763526861667634
    Resources requested: 4/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00002 | RUNNING    | 172.17.0.2:1505 |            2 |   32 |    4 | 0.000934657 | 1.46303 |     0.4913 |                    3 |
    | DEFAULT_83e35_00007 | RUNNING    | 172.17.0.2:1554 |            8 |    8 |   64 | 0.00203608  | 1.17101 |     0.5893 |                   10 |
    | DEFAULT_83e35_00000 | TERMINATED |                 |            2 |    4 |    4 | 0.00667388  | 2.30704 |     0.1029 |                    1 |
    | DEFAULT_83e35_00001 | TERMINATED |                 |           16 |  128 |    8 | 0.00111068  | 1.20128 |     0.5824 |                   10 |
    | DEFAULT_83e35_00003 | TERMINATED |                 |            8 |  128 |   16 | 0.000391851 | 2.08907 |     0.2344 |                    1 |
    | DEFAULT_83e35_00004 | TERMINATED |                 |            4 |    4 |   16 | 0.00015716  | 2.19137 |     0.1507 |                    1 |
    | DEFAULT_83e35_00005 | TERMINATED |                 |            2 |   16 |   32 | 0.000132492 | 1.5943  |     0.4112 |                    2 |
    | DEFAULT_83e35_00006 | TERMINATED |                 |            2 |   64 |    4 | 0.0573297   | 2.34024 |     0.0997 |                    1 |
    | DEFAULT_83e35_00008 | TERMINATED |                 |            2 |    4 |   16 | 0.0013424   | 1.66398 |     0.3892 |                    2 |
    | DEFAULT_83e35_00009 | TERMINATED |                 |            2 |  256 |   32 | 0.0362223   | 2.35486 |     0.0939 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1505)[0m [4,  4000] loss: 0.697
    [2m[36m(pid=1505)[0m [4,  6000] loss: 0.461
    [2m[36m(pid=1505)[0m [4,  8000] loss: 0.341
    [2m[36m(pid=1505)[0m [4, 10000] loss: 0.280
    [2m[36m(pid=1505)[0m [4, 12000] loss: 0.223
    [2m[36m(pid=1505)[0m [4, 14000] loss: 0.196
    [2m[36m(pid=1505)[0m [4, 16000] loss: 0.175
    [2m[36m(pid=1505)[0m [4, 18000] loss: 0.157
    [2m[36m(pid=1505)[0m [4, 20000] loss: 0.135
    Result for DEFAULT_83e35_00002:
      accuracy: 0.4904
      date: 2021-02-16_17-57-52
      done: true
      experiment_id: f2fb4ebbf0f34fbdb8261caddd35f69a
      experiment_tag: 2_batch_size=2,l1=32,l2=4,lr=0.00093466
      hostname: 5ff73ad4dbcf
      iterations_since_restore: 4
      loss: 1.4234068893831224
      node_ip: 172.17.0.2
      pid: 1505
      should_checkpoint: true
      time_since_restore: 417.50780153274536
      time_this_iter_s: 94.90350103378296
      time_total_s: 417.50780153274536
      timestamp: 1613498272
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: 83e35_00002
  
    == Status ==
    Memory usage on this node: 4.0/240.1 GiB
    Using AsyncHyperBand: num_stopped=10
    Bracket: Iter 8.000: -1.2051451061248781 | Iter 4.000: -1.4234068893831224 | Iter 2.000: -1.5943017072498797 | Iter 1.000: -2.0763526861667634
    Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00002 | RUNNING    | 172.17.0.2:1505 |            2 |   32 |    4 | 0.000934657 | 1.42341 |     0.4904 |                    4 |
    | DEFAULT_83e35_00000 | TERMINATED |                 |            2 |    4 |    4 | 0.00667388  | 2.30704 |     0.1029 |                    1 |
    | DEFAULT_83e35_00001 | TERMINATED |                 |           16 |  128 |    8 | 0.00111068  | 1.20128 |     0.5824 |                   10 |
    | DEFAULT_83e35_00003 | TERMINATED |                 |            8 |  128 |   16 | 0.000391851 | 2.08907 |     0.2344 |                    1 |
    | DEFAULT_83e35_00004 | TERMINATED |                 |            4 |    4 |   16 | 0.00015716  | 2.19137 |     0.1507 |                    1 |
    | DEFAULT_83e35_00005 | TERMINATED |                 |            2 |   16 |   32 | 0.000132492 | 1.5943  |     0.4112 |                    2 |
    | DEFAULT_83e35_00006 | TERMINATED |                 |            2 |   64 |    4 | 0.0573297   | 2.34024 |     0.0997 |                    1 |
    | DEFAULT_83e35_00007 | TERMINATED |                 |            8 |    8 |   64 | 0.00203608  | 1.17101 |     0.5893 |                   10 |
    | DEFAULT_83e35_00008 | TERMINATED |                 |            2 |    4 |   16 | 0.0013424   | 1.66398 |     0.3892 |                    2 |
    | DEFAULT_83e35_00009 | TERMINATED |                 |            2 |  256 |   32 | 0.0362223   | 2.35486 |     0.0939 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    == Status ==
    Memory usage on this node: 3.8/240.1 GiB
    Using AsyncHyperBand: num_stopped=10
    Bracket: Iter 8.000: -1.2051451061248781 | Iter 4.000: -1.4234068893831224 | Iter 2.000: -1.5943017072498797 | Iter 1.000: -2.0763526861667634
    Resources requested: 0/32 CPUs, 0/2 GPUs, 0.0/157.71 GiB heap, 0.0/49.37 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-02-16_17-50-54
    Number of trials: 10/10 (10 TERMINATED)
    +---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc   |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83e35_00000 | TERMINATED |       |            2 |    4 |    4 | 0.00667388  | 2.30704 |     0.1029 |                    1 |
    | DEFAULT_83e35_00001 | TERMINATED |       |           16 |  128 |    8 | 0.00111068  | 1.20128 |     0.5824 |                   10 |
    | DEFAULT_83e35_00002 | TERMINATED |       |            2 |   32 |    4 | 0.000934657 | 1.42341 |     0.4904 |                    4 |
    | DEFAULT_83e35_00003 | TERMINATED |       |            8 |  128 |   16 | 0.000391851 | 2.08907 |     0.2344 |                    1 |
    | DEFAULT_83e35_00004 | TERMINATED |       |            4 |    4 |   16 | 0.00015716  | 2.19137 |     0.1507 |                    1 |
    | DEFAULT_83e35_00005 | TERMINATED |       |            2 |   16 |   32 | 0.000132492 | 1.5943  |     0.4112 |                    2 |
    | DEFAULT_83e35_00006 | TERMINATED |       |            2 |   64 |    4 | 0.0573297   | 2.34024 |     0.0997 |                    1 |
    | DEFAULT_83e35_00007 | TERMINATED |       |            8 |    8 |   64 | 0.00203608  | 1.17101 |     0.5893 |                   10 |
    | DEFAULT_83e35_00008 | TERMINATED |       |            2 |    4 |   16 | 0.0013424   | 1.66398 |     0.3892 |                    2 |
    | DEFAULT_83e35_00009 | TERMINATED |       |            2 |  256 |   32 | 0.0362223   | 2.35486 |     0.0939 |                    1 |
    +---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+


    Best trial config: {'l1': 8, 'l2': 64, 'lr': 0.002036075661660623, 'batch_size': 8}
    Best trial final validation loss: 1.1710100273132324
    Best trial final validation accuracy: 0.5893
    Files already downloaded and verified
    Files already downloaded and verified
    Best trial test set accuracy: 0.5895


If you run the code, an example output could look like this:

.. code-block::

    Number of trials: 10 (10 TERMINATED)
    +-----+------+------+-------------+--------------+---------+------------+--------------------+
    | ... |   l1 |   l2 |          lr |   batch_size |    loss |   accuracy | training_iteration |
    |-----+------+------+-------------+--------------+---------+------------+--------------------|
    | ... |   64 |    4 | 0.00011629  |            2 | 1.87273 |     0.244  |                  2 |
    | ... |   32 |   64 | 0.000339763 |            8 | 1.23603 |     0.567  |                  8 |
    | ... |    8 |   16 | 0.00276249  |           16 | 1.1815  |     0.5836 |                 10 |
    | ... |    4 |   64 | 0.000648721 |            4 | 1.31131 |     0.5224 |                  8 |
    | ... |   32 |   16 | 0.000340753 |            8 | 1.26454 |     0.5444 |                  8 |
    | ... |    8 |    4 | 0.000699775 |            8 | 1.99594 |     0.1983 |                  2 |
    | ... |  256 |    8 | 0.0839654   |           16 | 2.3119  |     0.0993 |                  1 |
    | ... |   16 |  128 | 0.0758154   |           16 | 2.33575 |     0.1327 |                  1 |
    | ... |   16 |    8 | 0.0763312   |           16 | 2.31129 |     0.1042 |                  4 |
    | ... |  128 |   16 | 0.000124903 |            4 | 2.26917 |     0.1945 |                  1 |
    +-----+------+------+-------------+--------------+---------+------------+--------------------+


    Best trial config: {'l1': 8, 'l2': 16, 'lr': 0.00276249, 'batch_size': 16, 'data_dir': '...'}
    Best trial final validation loss: 1.181501
    Best trial final validation accuracy: 0.5836
    Best trial test set accuracy: 0.5806

Most trials have been stopped early in order to avoid wasting resources.
The best performing trial achieved a validation accuracy of about 58%, which could
be confirmed on the test set.

So that's it! You can now tune the parameters of your PyTorch models.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 7 minutes  20.678 seconds)


.. _sphx_glr_download_beginner_hyperparameter_tuning_tutorial.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download

     :download:`Download Python source code: hyperparameter_tuning_tutorial.py <hyperparameter_tuning_tutorial.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: hyperparameter_tuning_tutorial.ipynb <hyperparameter_tuning_tutorial.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.readthedocs.io>`_
