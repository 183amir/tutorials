.. note::
    :class: sphx-glr-download-link-note

    Click :ref:`here <sphx_glr_download_beginner_hyperparameter_tuning_tutorial.py>` to download the full example code
.. rst-class:: sphx-glr-example-title

.. _sphx_glr_beginner_hyperparameter_tuning_tutorial.py:


Hyperparameter tuning with Ray Tune
===================================

Hyperparameter tuning can make the difference between an average model and a highly
accurate one. Often simple things like choosing a different learning rate or changing
a network layer size can have a dramatic impact on your model performance.

Fortunately, there are tools that help with finding the best combination of parameters.
`Ray Tune <https://docs.ray.io/en/latest/tune.html>`_ is an industry standard tool for
distributed hyperparameter tuning. Ray Tune includes the latest hyperparameter search
algorithms, integrates with TensorBoard and other analysis libraries, and natively
supports distributed training through `Ray's distributed machine learning engine
<https://ray.io/>`_.

In this tutorial, we will show you how to integrate Ray Tune into your PyTorch
training workflow. We will extend `this tutorial from the PyTorch documentation
<https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html>`_ for training
a CIFAR10 image classifier.

As you will see, we only need to add some slight modifications. In particular, we
need to

1. wrap data loading and training in functions,
2. make some network parameters configurable,
3. add checkpointing (optional),
4. and define the search space for the model tuning

|

To run this tutorial, please make sure the following packages are
installed:

-  ``ray[tune]``: Distributed hyperparameter tuning library
-  ``torchvision``: For the data transformers

Setup / Imports
---------------
Let's start with the imports:


.. code-block:: default

    from functools import partial
    import numpy as np
    import os
    import torch
    import torch.nn as nn
    import torch.nn.functional as F
    import torch.optim as optim
    from torch.utils.data import random_split
    import torchvision
    import torchvision.transforms as transforms
    from ray import tune
    from ray.tune import CLIReporter
    from ray.tune.schedulers import ASHAScheduler







Most of the imports are needed for building the PyTorch model. Only the last three
imports are for Ray Tune.

Data loaders
------------
We wrap the data loaders in their own function and pass a global data directory.
This way we can share a data directory between different trials.


.. code-block:: default



    def load_data(data_dir="./data"):
        transform = transforms.Compose([
            transforms.ToTensor(),
            transforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5))
        ])

        trainset = torchvision.datasets.CIFAR10(
            root=data_dir, train=True, download=True, transform=transform)

        testset = torchvision.datasets.CIFAR10(
            root=data_dir, train=False, download=True, transform=transform)

        return trainset, testset







Configurable neural network
---------------------------
We can only tune those parameters that are configurable. In this example, we can specify
the layer sizes of the fully connected layers:


.. code-block:: default



    class Net(nn.Module):
        def __init__(self, l1=120, l2=84):
            super(Net, self).__init__()
            self.conv1 = nn.Conv2d(3, 6, 5)
            self.pool = nn.MaxPool2d(2, 2)
            self.conv2 = nn.Conv2d(6, 16, 5)
            self.fc1 = nn.Linear(16 * 5 * 5, l1)
            self.fc2 = nn.Linear(l1, l2)
            self.fc3 = nn.Linear(l2, 10)

        def forward(self, x):
            x = self.pool(F.relu(self.conv1(x)))
            x = self.pool(F.relu(self.conv2(x)))
            x = x.view(-1, 16 * 5 * 5)
            x = F.relu(self.fc1(x))
            x = F.relu(self.fc2(x))
            x = self.fc3(x)
            return x







The train function
------------------
Now it gets interesting, because we introduce some changes to the example `from the PyTorch
documentation <https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html>`_.

We wrap the training script in a function ``train_cifar(config, checkpoint_dir=None, data_dir=None)``.
As you can guess, the ``config`` parameter will receive the hyperparameters we would like to
train with. The ``checkpoint_dir`` parameter is used to restore checkpoints. The ``data_dir`` specifies
the directory where we load and store the data, so multiple runs can share the same data source.

.. code-block:: python

    net = Net(config["l1"], config["l2"])

    if checkpoint_dir:
        model_state, optimizer_state = torch.load(
            os.path.join(checkpoint_dir, "checkpoint"))
        net.load_state_dict(model_state)
        optimizer.load_state_dict(optimizer_state)

The learning rate of the optimizer is made configurable, too:

.. code-block:: python

    optimizer = optim.SGD(net.parameters(), lr=config["lr"], momentum=0.9)

We also split the training data into a training and validation subset. We thus train on
80% of the data and calculate the validation loss on the remaining 20%. The batch sizes
with which we iterate through the training and test sets are configurable as well.

Adding (multi) GPU support with DataParallel
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Image classification benefits largely from GPUs. Luckily, we can continue to use
PyTorch's abstractions in Ray Tune. Thus, we can wrap our model in ``nn.DataParallel``
to support data parallel training on multiple GPUs:

.. code-block:: python

    device = "cpu"
    if torch.cuda.is_available():
        device = "cuda:0"
        if torch.cuda.device_count() > 1:
            net = nn.DataParallel(net)
    net.to(device)

By using a ``device`` variable we make sure that training also works when we have
no GPUs available. PyTorch requires us to send our data to the GPU memory explicitly,
like this:

.. code-block:: python

    for i, data in enumerate(trainloader, 0):
        inputs, labels = data
        inputs, labels = inputs.to(device), labels.to(device)

The code now supports training on CPUs, on a single GPU, and on multiple GPUs. Notably, Ray
also supports `fractional GPUs <https://docs.ray.io/en/master/using-ray-with-gpus.html#fractional-gpus>`_
so we can share GPUs among trials, as long as the model still fits on the GPU memory. We'll come back
to that later.

Communicating with Ray Tune
~~~~~~~~~~~~~~~~~~~~~~~~~~~

The most interesting part is the communication with Ray Tune:

.. code-block:: python

    with tune.checkpoint_dir(epoch) as checkpoint_dir:
        path = os.path.join(checkpoint_dir, "checkpoint")
        torch.save((net.state_dict(), optimizer.state_dict()), path)

    tune.report(loss=(val_loss / val_steps), accuracy=correct / total)

Here we first save a checkpoint and then report some metrics back to Ray Tune. Specifically,
we send the validation loss and accuracy back to Ray Tune. Ray Tune can then use these metrics
to decide which hyperparameter configuration lead to the best results. These metrics
can also be used to stop bad performing trials early in order to avoid wasting
resources on those trials.

The checkpoint saving is optional, however, it is necessary if we wanted to use advanced
schedulers like
`Population Based Training <https://docs.ray.io/en/master/tune/tutorials/tune-advanced-tutorial.html>`_.
Also, by saving the checkpoint we can later load the trained models and validate them
on a test set.

Full training function
~~~~~~~~~~~~~~~~~~~~~~

The full code example looks like this:


.. code-block:: default



    def train_cifar(config, checkpoint_dir=None, data_dir=None):
        net = Net(config["l1"], config["l2"])

        device = "cpu"
        if torch.cuda.is_available():
            device = "cuda:0"
            if torch.cuda.device_count() > 1:
                net = nn.DataParallel(net)
        net.to(device)

        criterion = nn.CrossEntropyLoss()
        optimizer = optim.SGD(net.parameters(), lr=config["lr"], momentum=0.9)

        if checkpoint_dir:
            model_state, optimizer_state = torch.load(
                os.path.join(checkpoint_dir, "checkpoint"))
            net.load_state_dict(model_state)
            optimizer.load_state_dict(optimizer_state)

        trainset, testset = load_data(data_dir)

        test_abs = int(len(trainset) * 0.8)
        train_subset, val_subset = random_split(
            trainset, [test_abs, len(trainset) - test_abs])

        trainloader = torch.utils.data.DataLoader(
            train_subset,
            batch_size=int(config["batch_size"]),
            shuffle=True,
            num_workers=8)
        valloader = torch.utils.data.DataLoader(
            val_subset,
            batch_size=int(config["batch_size"]),
            shuffle=True,
            num_workers=8)

        for epoch in range(10):  # loop over the dataset multiple times
            running_loss = 0.0
            epoch_steps = 0
            for i, data in enumerate(trainloader, 0):
                # get the inputs; data is a list of [inputs, labels]
                inputs, labels = data
                inputs, labels = inputs.to(device), labels.to(device)

                # zero the parameter gradients
                optimizer.zero_grad()

                # forward + backward + optimize
                outputs = net(inputs)
                loss = criterion(outputs, labels)
                loss.backward()
                optimizer.step()

                # print statistics
                running_loss += loss.item()
                epoch_steps += 1
                if i % 2000 == 1999:  # print every 2000 mini-batches
                    print("[%d, %5d] loss: %.3f" % (epoch + 1, i + 1,
                                                    running_loss / epoch_steps))
                    running_loss = 0.0

            # Validation loss
            val_loss = 0.0
            val_steps = 0
            total = 0
            correct = 0
            for i, data in enumerate(valloader, 0):
                with torch.no_grad():
                    inputs, labels = data
                    inputs, labels = inputs.to(device), labels.to(device)

                    outputs = net(inputs)
                    _, predicted = torch.max(outputs.data, 1)
                    total += labels.size(0)
                    correct += (predicted == labels).sum().item()

                    loss = criterion(outputs, labels)
                    val_loss += loss.cpu().numpy()
                    val_steps += 1

            with tune.checkpoint_dir(epoch) as checkpoint_dir:
                path = os.path.join(checkpoint_dir, "checkpoint")
                torch.save((net.state_dict(), optimizer.state_dict()), path)

            tune.report(loss=(val_loss / val_steps), accuracy=correct / total)
        print("Finished Training")







As you can see, most of the code is adapted directly from the original example.

Test set accuracy
-----------------
Commonly the performance of a machine learning model is tested on a hold-out test
set with data that has not been used for training the model. We also wrap this in a
function:


.. code-block:: default



    def test_accuracy(net, device="cpu"):
        trainset, testset = load_data()

        testloader = torch.utils.data.DataLoader(
            testset, batch_size=4, shuffle=False, num_workers=2)

        correct = 0
        total = 0
        with torch.no_grad():
            for data in testloader:
                images, labels = data
                images, labels = images.to(device), labels.to(device)
                outputs = net(images)
                _, predicted = torch.max(outputs.data, 1)
                total += labels.size(0)
                correct += (predicted == labels).sum().item()

        return correct / total







The function also expects a ``device`` parameter, so we can do the
test set validation on a GPU.

Configuring the search space
----------------------------
Lastly, we need to define Ray Tune's search space. Here is an example:

.. code-block:: python

    config = {
        "l1": tune.sample_from(lambda _: 2**np.random.randint(2, 9)),
        "l2": tune.sample_from(lambda _: 2**np.random.randint(2, 9)),
        "lr": tune.loguniform(1e-4, 1e-1),
        "batch_size": tune.choice([2, 4, 8, 16])
    }

The ``tune.sample_from()`` function makes it possible to define your own sample
methods to obtain hyperparameters. In this example, the ``l1`` and ``l2`` parameters
should be powers of 2 between 4 and 256, so either 4, 8, 16, 32, 64, 128, or 256.
The ``lr`` (learning rate) should be uniformly sampled between 0.0001 and 0.1. Lastly,
the batch size is a choice between 2, 4, 8, and 16.

At each trial, Ray Tune will now randomly sample a combination of parameters from these
search spaces. It will then train a number of models in parallel and find the best
performing one among these. We also use the ``ASHAScheduler`` which will terminate bad
performing trials early.

We wrap the ``train_cifar`` function with ``functools.partial`` to set the constant
``data_dir`` parameter. We can also tell Ray Tune what resources should be
available for each trial:

.. code-block:: python

    gpus_per_trial = 2
    # ...
    result = tune.run(
        partial(train_cifar, data_dir=data_dir),
        resources_per_trial={"cpu": 8, "gpu": gpus_per_trial},
        config=config,
        num_samples=num_samples,
        scheduler=scheduler,
        progress_reporter=reporter,
        checkpoint_at_end=True)

You can specify the number of CPUs, which are then available e.g.
to increase the ``num_workers`` of the PyTorch ``DataLoader`` instances. The selected
number of GPUs are made visible to PyTorch in each trial. Trials do not have access to
GPUs that haven't been requested for them - so you don't have to care about two trials
using the same set of resources.

Here we can also specify fractional GPUs, so something like ``gpus_per_trial=0.5`` is
completely valid. The trials will then share GPUs among each other.
You just have to make sure that the models still fit in the GPU memory.

After training the models, we will find the best performing one and load the trained
network from the checkpoint file. We then obtain the test set accuracy and report
everything by printing.

The full main function looks like this:


.. code-block:: default



    def main(num_samples=10, max_num_epochs=10, gpus_per_trial=2):
        data_dir = os.path.abspath("./data")
        load_data(data_dir)
        config = {
            "l1": tune.sample_from(lambda _: 2 ** np.random.randint(2, 9)),
            "l2": tune.sample_from(lambda _: 2 ** np.random.randint(2, 9)),
            "lr": tune.loguniform(1e-4, 1e-1),
            "batch_size": tune.choice([2, 4, 8, 16])
        }
        scheduler = ASHAScheduler(
            metric="loss",
            mode="min",
            max_t=max_num_epochs,
            grace_period=1,
            reduction_factor=2)
        reporter = CLIReporter(
            # parameter_columns=["l1", "l2", "lr", "batch_size"],
            metric_columns=["loss", "accuracy", "training_iteration"])
        result = tune.run(
            partial(train_cifar, data_dir=data_dir),
            resources_per_trial={"cpu": 2, "gpu": gpus_per_trial},
            config=config,
            num_samples=num_samples,
            scheduler=scheduler,
            progress_reporter=reporter)

        best_trial = result.get_best_trial("loss", "min", "last")
        print("Best trial config: {}".format(best_trial.config))
        print("Best trial final validation loss: {}".format(
            best_trial.last_result["loss"]))
        print("Best trial final validation accuracy: {}".format(
            best_trial.last_result["accuracy"]))

        best_trained_model = Net(best_trial.config["l1"], best_trial.config["l2"])
        device = "cpu"
        if torch.cuda.is_available():
            device = "cuda:0"
            if gpus_per_trial > 1:
                best_trained_model = nn.DataParallel(best_trained_model)
        best_trained_model.to(device)

        best_checkpoint_dir = best_trial.checkpoint.value
        model_state, optimizer_state = torch.load(os.path.join(
            best_checkpoint_dir, "checkpoint"))
        best_trained_model.load_state_dict(model_state)

        test_acc = test_accuracy(best_trained_model, device)
        print("Best trial test set accuracy: {}".format(test_acc))


    if __name__ == "__main__":
        # You can change the number of GPUs per trial here:
        main(num_samples=10, max_num_epochs=10, gpus_per_trial=0)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz
    Extracting /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data
    Files already downloaded and verified
    == Status ==
    Memory usage on this node: 4.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=0
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: None
    Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 1/10 (1 RUNNING)
    +---------------------+----------+-------+--------------+------+------+------------+
    | Trial name          | status   | loc   |   batch_size |   l1 |   l2 |         lr |
    |---------------------+----------+-------+--------------+------+------+------------|
    | DEFAULT_581b3_00000 | RUNNING  |       |            8 |  256 |    8 | 0.00075324 |
    +---------------------+----------+-------+--------------+------+------+------------+


    [2m[36m(pid=1443)[0m Files already downloaded and verified
    [2m[36m(pid=1430)[0m Files already downloaded and verified
    [2m[36m(pid=1429)[0m Files already downloaded and verified
    [2m[36m(pid=1435)[0m Files already downloaded and verified
    [2m[36m(pid=1423)[0m Files already downloaded and verified
    [2m[36m(pid=1475)[0m Files already downloaded and verified
    [2m[36m(pid=1426)[0m Files already downloaded and verified
    [2m[36m(pid=1428)[0m Files already downloaded and verified
    [2m[36m(pid=1420)[0m Files already downloaded and verified
    [2m[36m(pid=1427)[0m Files already downloaded and verified
    [2m[36m(pid=1443)[0m Files already downloaded and verified
    [2m[36m(pid=1430)[0m Files already downloaded and verified
    [2m[36m(pid=1429)[0m Files already downloaded and verified
    [2m[36m(pid=1435)[0m Files already downloaded and verified
    [2m[36m(pid=1423)[0m Files already downloaded and verified
    [2m[36m(pid=1475)[0m Files already downloaded and verified
    [2m[36m(pid=1426)[0m Files already downloaded and verified
    [2m[36m(pid=1428)[0m Files already downloaded and verified
    [2m[36m(pid=1420)[0m Files already downloaded and verified
    [2m[36m(pid=1427)[0m Files already downloaded and verified
    [2m[36m(pid=1420)[0m [1,  2000] loss: 2.321
    [2m[36m(pid=1426)[0m [1,  2000] loss: 2.348
    [2m[36m(pid=1423)[0m [1,  2000] loss: 2.089
    [2m[36m(pid=1443)[0m [1,  2000] loss: 2.307
    [2m[36m(pid=1430)[0m [1,  2000] loss: 2.273
    [2m[36m(pid=1429)[0m [1,  2000] loss: 2.294
    [2m[36m(pid=1428)[0m [1,  2000] loss: 1.910
    [2m[36m(pid=1475)[0m [1,  2000] loss: 1.845
    [2m[36m(pid=1427)[0m [1,  2000] loss: 1.933
    [2m[36m(pid=1435)[0m [1,  2000] loss: 1.748
    [2m[36m(pid=1420)[0m [1,  4000] loss: 1.154
    [2m[36m(pid=1426)[0m [1,  4000] loss: 1.172
    [2m[36m(pid=1423)[0m [1,  4000] loss: 0.993
    Result for DEFAULT_581b3_00003:
      accuracy: 0.3718
      date: 2021-03-25_17-34-53
      done: false
      experiment_id: 9d522cd5382541beb77448849654b6a3
      hostname: 6a871f235667
      iterations_since_restore: 1
      loss: 1.6386612415313722
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 26.714688539505005
      time_this_iter_s: 26.714688539505005
      time_total_s: 26.714688539505005
      timestamp: 1616693693
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 581b3_00003
  
    == Status ==
    Memory usage on this node: 9.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=0
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -1.6386612415313722
    Resources requested: 20/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 10/10 (10 RUNNING)
    +---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status   | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_581b3_00000 | RUNNING  |                 |            8 |  256 |    8 | 0.00075324  |         |            |                      |
    | DEFAULT_581b3_00001 | RUNNING  |                 |            2 |   16 |    4 | 0.0367963   |         |            |                      |
    | DEFAULT_581b3_00002 | RUNNING  |                 |            4 |  256 |   16 | 0.000163494 |         |            |                      |
    | DEFAULT_581b3_00003 | RUNNING  | 172.17.0.2:1428 |           16 |    4 |   32 | 0.00958168  | 1.63866 |     0.3718 |                    1 |
    | DEFAULT_581b3_00004 | RUNNING  |                 |           16 |   16 |    8 | 0.00999627  |         |            |                      |
    | DEFAULT_581b3_00005 | RUNNING  |                 |            4 |  128 |   16 | 0.00965146  |         |            |                      |
    | DEFAULT_581b3_00006 | RUNNING  |                 |           16 |  128 |   16 | 0.0101957   |         |            |                      |
    | DEFAULT_581b3_00007 | RUNNING  |                 |           16 |  256 |  256 | 0.00980314  |         |            |                      |
    | DEFAULT_581b3_00008 | RUNNING  |                 |            8 |   64 |   16 | 0.0396223   |         |            |                      |
    | DEFAULT_581b3_00009 | RUNNING  |                 |            2 |   16 |    4 | 0.000280285 |         |            |                      |
    +---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_581b3_00004:
      accuracy: 0.3853
      date: 2021-03-25_17-34-54
      done: false
      experiment_id: 385573d6552542689c001db95b0bb0e7
      hostname: 6a871f235667
      iterations_since_restore: 1
      loss: 1.6369597690582276
      node_ip: 172.17.0.2
      pid: 1427
      should_checkpoint: true
      time_since_restore: 27.305033445358276
      time_this_iter_s: 27.305033445358276
      time_total_s: 27.305033445358276
      timestamp: 1616693694
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 581b3_00004
  
    [2m[36m(pid=1443)[0m [1,  4000] loss: 1.149
    Result for DEFAULT_581b3_00006:
      accuracy: 0.4403
      date: 2021-03-25_17-34-54
      done: false
      experiment_id: dfa2a83437cf4b3d862a0edadd4dfc37
      hostname: 6a871f235667
      iterations_since_restore: 1
      loss: 1.53124642868042
      node_ip: 172.17.0.2
      pid: 1475
      should_checkpoint: true
      time_since_restore: 27.49654507637024
      time_this_iter_s: 27.49654507637024
      time_total_s: 27.49654507637024
      timestamp: 1616693694
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 581b3_00006
  
    Result for DEFAULT_581b3_00007:
      accuracy: 0.4751
      date: 2021-03-25_17-34-56
      done: false
      experiment_id: 2a8b5c759e61410bb9c1dd4dea517782
      hostname: 6a871f235667
      iterations_since_restore: 1
      loss: 1.4554332139968873
      node_ip: 172.17.0.2
      pid: 1435
      should_checkpoint: true
      time_since_restore: 29.30300545692444
      time_this_iter_s: 29.30300545692444
      time_total_s: 29.30300545692444
      timestamp: 1616693696
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 581b3_00007
  
    [2m[36m(pid=1430)[0m [1,  4000] loss: 1.007
    [2m[36m(pid=1429)[0m [1,  4000] loss: 1.157
    [2m[36m(pid=1420)[0m [1,  6000] loss: 0.764
    [2m[36m(pid=1426)[0m [1,  6000] loss: 0.781
    [2m[36m(pid=1423)[0m [1,  6000] loss: 0.647
    [2m[36m(pid=1443)[0m [1,  6000] loss: 0.759
    Result for DEFAULT_581b3_00000:
      accuracy: 0.3316
      date: 2021-03-25_17-35-09
      done: true
      experiment_id: 9ab95d117637434c8f6131d5bd062f63
      hostname: 6a871f235667
      iterations_since_restore: 1
      loss: 1.8020302513599395
      node_ip: 172.17.0.2
      pid: 1430
      should_checkpoint: true
      time_since_restore: 42.35145163536072
      time_this_iter_s: 42.35145163536072
      time_total_s: 42.35145163536072
      timestamp: 1616693709
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 581b3_00000
  
    == Status ==
    Memory usage on this node: 9.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=1
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -1.6369597690582276
    Resources requested: 20/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 10/10 (10 RUNNING)
    +---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status   | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_581b3_00000 | RUNNING  | 172.17.0.2:1430 |            8 |  256 |    8 | 0.00075324  | 1.80203 |     0.3316 |                    1 |
    | DEFAULT_581b3_00001 | RUNNING  |                 |            2 |   16 |    4 | 0.0367963   |         |            |                      |
    | DEFAULT_581b3_00002 | RUNNING  |                 |            4 |  256 |   16 | 0.000163494 |         |            |                      |
    | DEFAULT_581b3_00003 | RUNNING  | 172.17.0.2:1428 |           16 |    4 |   32 | 0.00958168  | 1.63866 |     0.3718 |                    1 |
    | DEFAULT_581b3_00004 | RUNNING  | 172.17.0.2:1427 |           16 |   16 |    8 | 0.00999627  | 1.63696 |     0.3853 |                    1 |
    | DEFAULT_581b3_00005 | RUNNING  |                 |            4 |  128 |   16 | 0.00965146  |         |            |                      |
    | DEFAULT_581b3_00006 | RUNNING  | 172.17.0.2:1475 |           16 |  128 |   16 | 0.0101957   | 1.53125 |     0.4403 |                    1 |
    | DEFAULT_581b3_00007 | RUNNING  | 172.17.0.2:1435 |           16 |  256 |  256 | 0.00980314  | 1.45543 |     0.4751 |                    1 |
    | DEFAULT_581b3_00008 | RUNNING  |                 |            8 |   64 |   16 | 0.0396223   |         |            |                      |
    | DEFAULT_581b3_00009 | RUNNING  |                 |            2 |   16 |    4 | 0.000280285 |         |            |                      |
    +---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_581b3_00008:
      accuracy: 0.0983
      date: 2021-03-25_17-35-09
      done: true
      experiment_id: 402c579e86dd457da56c6b0653c3bc06
      hostname: 6a871f235667
      iterations_since_restore: 1
      loss: 2.3109463054656985
      node_ip: 172.17.0.2
      pid: 1429
      should_checkpoint: true
      time_since_restore: 42.39901518821716
      time_this_iter_s: 42.39901518821716
      time_total_s: 42.39901518821716
      timestamp: 1616693709
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 581b3_00008
  
    [2m[36m(pid=1428)[0m [2,  2000] loss: 1.632
    [2m[36m(pid=1427)[0m [2,  2000] loss: 1.539
    [2m[36m(pid=1420)[0m [1,  8000] loss: 0.564
    [2m[36m(pid=1475)[0m [2,  2000] loss: 1.482
    [2m[36m(pid=1426)[0m [1,  8000] loss: 0.587
    [2m[36m(pid=1435)[0m [2,  2000] loss: 1.408
    [2m[36m(pid=1423)[0m [1,  8000] loss: 0.484
    Result for DEFAULT_581b3_00003:
      accuracy: 0.4049
      date: 2021-03-25_17-35-16
      done: false
      experiment_id: 9d522cd5382541beb77448849654b6a3
      hostname: 6a871f235667
      iterations_since_restore: 2
      loss: 1.6242812056541442
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 49.13286209106445
      time_this_iter_s: 22.41817355155945
      time_total_s: 49.13286209106445
      timestamp: 1616693716
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 581b3_00003
  
    == Status ==
    Memory usage on this node: 8.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=2
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.6242812056541442 | Iter 1.000: -1.6378105052947998
    Resources requested: 16/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_581b3_00001 | RUNNING    |                 |            2 |   16 |    4 | 0.0367963   |         |            |                      |
    | DEFAULT_581b3_00002 | RUNNING    |                 |            4 |  256 |   16 | 0.000163494 |         |            |                      |
    | DEFAULT_581b3_00003 | RUNNING    | 172.17.0.2:1428 |           16 |    4 |   32 | 0.00958168  | 1.62428 |     0.4049 |                    2 |
    | DEFAULT_581b3_00004 | RUNNING    | 172.17.0.2:1427 |           16 |   16 |    8 | 0.00999627  | 1.63696 |     0.3853 |                    1 |
    | DEFAULT_581b3_00005 | RUNNING    |                 |            4 |  128 |   16 | 0.00965146  |         |            |                      |
    | DEFAULT_581b3_00006 | RUNNING    | 172.17.0.2:1475 |           16 |  128 |   16 | 0.0101957   | 1.53125 |     0.4403 |                    1 |
    | DEFAULT_581b3_00007 | RUNNING    | 172.17.0.2:1435 |           16 |  256 |  256 | 0.00980314  | 1.45543 |     0.4751 |                    1 |
    | DEFAULT_581b3_00009 | RUNNING    |                 |            2 |   16 |    4 | 0.000280285 |         |            |                      |
    | DEFAULT_581b3_00000 | TERMINATED |                 |            8 |  256 |    8 | 0.00075324  | 1.80203 |     0.3316 |                    1 |
    | DEFAULT_581b3_00008 | TERMINATED |                 |            8 |   64 |   16 | 0.0396223   | 2.31095 |     0.0983 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_581b3_00004:
      accuracy: 0.4506
      date: 2021-03-25_17-35-16
      done: false
      experiment_id: 385573d6552542689c001db95b0bb0e7
      hostname: 6a871f235667
      iterations_since_restore: 2
      loss: 1.5038340132713317
      node_ip: 172.17.0.2
      pid: 1427
      should_checkpoint: true
      time_since_restore: 49.72245812416077
      time_this_iter_s: 22.41742467880249
      time_total_s: 49.72245812416077
      timestamp: 1616693716
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 581b3_00004
  
    [2m[36m(pid=1443)[0m [1,  8000] loss: 0.547
    Result for DEFAULT_581b3_00006:
      accuracy: 0.4746
      date: 2021-03-25_17-35-17
      done: false
      experiment_id: dfa2a83437cf4b3d862a0edadd4dfc37
      hostname: 6a871f235667
      iterations_since_restore: 2
      loss: 1.4380357805252075
      node_ip: 172.17.0.2
      pid: 1475
      should_checkpoint: true
      time_since_restore: 50.350749015808105
      time_this_iter_s: 22.854203939437866
      time_total_s: 50.350749015808105
      timestamp: 1616693717
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 581b3_00006
  
    [2m[36m(pid=1420)[0m [1, 10000] loss: 0.438
    Result for DEFAULT_581b3_00007:
      accuracy: 0.5164
      date: 2021-03-25_17-35-20
      done: false
      experiment_id: 2a8b5c759e61410bb9c1dd4dea517782
      hostname: 6a871f235667
      iterations_since_restore: 2
      loss: 1.3734621253967285
      node_ip: 172.17.0.2
      pid: 1435
      should_checkpoint: true
      time_since_restore: 53.432644844055176
      time_this_iter_s: 24.129639387130737
      time_total_s: 53.432644844055176
      timestamp: 1616693720
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 581b3_00007
  
    [2m[36m(pid=1426)[0m [1, 10000] loss: 0.469
    [2m[36m(pid=1423)[0m [1, 10000] loss: 0.385
    [2m[36m(pid=1443)[0m [1, 10000] loss: 0.401
    [2m[36m(pid=1420)[0m [1, 12000] loss: 0.354
    [2m[36m(pid=1426)[0m [1, 12000] loss: 0.391
    [2m[36m(pid=1428)[0m [3,  2000] loss: 1.573
    [2m[36m(pid=1427)[0m [3,  2000] loss: 1.459
    [2m[36m(pid=1475)[0m [3,  2000] loss: 1.373
    Result for DEFAULT_581b3_00005:
      accuracy: 0.2907
      date: 2021-03-25_17-35-33
      done: true
      experiment_id: ee905dc5e0bc4fe7906bcf02ca1507ee
      hostname: 6a871f235667
      iterations_since_restore: 1
      loss: 1.8864224099874496
      node_ip: 172.17.0.2
      pid: 1423
      should_checkpoint: true
      time_since_restore: 66.53933310508728
      time_this_iter_s: 66.53933310508728
      time_total_s: 66.53933310508728
      timestamp: 1616693733
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 581b3_00005
  
    == Status ==
    Memory usage on this node: 8.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=3
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.4709348968982696 | Iter 1.000: -1.6386612415313722
    Resources requested: 16/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_581b3_00001 | RUNNING    |                 |            2 |   16 |    4 | 0.0367963   |         |            |                      |
    | DEFAULT_581b3_00002 | RUNNING    |                 |            4 |  256 |   16 | 0.000163494 |         |            |                      |
    | DEFAULT_581b3_00003 | RUNNING    | 172.17.0.2:1428 |           16 |    4 |   32 | 0.00958168  | 1.62428 |     0.4049 |                    2 |
    | DEFAULT_581b3_00004 | RUNNING    | 172.17.0.2:1427 |           16 |   16 |    8 | 0.00999627  | 1.50383 |     0.4506 |                    2 |
    | DEFAULT_581b3_00005 | RUNNING    | 172.17.0.2:1423 |            4 |  128 |   16 | 0.00965146  | 1.88642 |     0.2907 |                    1 |
    | DEFAULT_581b3_00006 | RUNNING    | 172.17.0.2:1475 |           16 |  128 |   16 | 0.0101957   | 1.43804 |     0.4746 |                    2 |
    | DEFAULT_581b3_00007 | RUNNING    | 172.17.0.2:1435 |           16 |  256 |  256 | 0.00980314  | 1.37346 |     0.5164 |                    2 |
    | DEFAULT_581b3_00009 | RUNNING    |                 |            2 |   16 |    4 | 0.000280285 |         |            |                      |
    | DEFAULT_581b3_00000 | TERMINATED |                 |            8 |  256 |    8 | 0.00075324  | 1.80203 |     0.3316 |                    1 |
    | DEFAULT_581b3_00008 | TERMINATED |                 |            8 |   64 |   16 | 0.0396223   | 2.31095 |     0.0983 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_581b3_00002:
      accuracy: 0.3037
      date: 2021-03-25_17-35-35
      done: true
      experiment_id: 0640118d1e42405fbcc0deddc7286347
      hostname: 6a871f235667
      iterations_since_restore: 1
      loss: 1.9082282887458801
      node_ip: 172.17.0.2
      pid: 1443
      should_checkpoint: true
      time_since_restore: 68.62842011451721
      time_this_iter_s: 68.62842011451721
      time_total_s: 68.62842011451721
      timestamp: 1616693735
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 581b3_00002
  
    [2m[36m(pid=1435)[0m [3,  2000] loss: 1.277
    Result for DEFAULT_581b3_00003:
      accuracy: 0.4088
      date: 2021-03-25_17-35-36
      done: false
      experiment_id: 9d522cd5382541beb77448849654b6a3
      hostname: 6a871f235667
      iterations_since_restore: 3
      loss: 1.6073387943267823
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 69.83785343170166
      time_this_iter_s: 20.704991340637207
      time_total_s: 69.83785343170166
      timestamp: 1616693736
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: 581b3_00003
  
    Result for DEFAULT_581b3_00004:
      accuracy: 0.4447
      date: 2021-03-25_17-35-37
      done: false
      experiment_id: 385573d6552542689c001db95b0bb0e7
      hostname: 6a871f235667
      iterations_since_restore: 3
      loss: 1.5676976749420166
      node_ip: 172.17.0.2
      pid: 1427
      should_checkpoint: true
      time_since_restore: 70.69616031646729
      time_this_iter_s: 20.97370219230652
      time_total_s: 70.69616031646729
      timestamp: 1616693737
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: 581b3_00004
  
    [2m[36m(pid=1420)[0m [1, 14000] loss: 0.296
    Result for DEFAULT_581b3_00006:
      accuracy: 0.4915
      date: 2021-03-25_17-35-38
      done: false
      experiment_id: dfa2a83437cf4b3d862a0edadd4dfc37
      hostname: 6a871f235667
      iterations_since_restore: 3
      loss: 1.4652526065826417
      node_ip: 172.17.0.2
      pid: 1475
      should_checkpoint: true
      time_since_restore: 71.8657500743866
      time_this_iter_s: 21.51500105857849
      time_total_s: 71.8657500743866
      timestamp: 1616693738
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: 581b3_00006
  
    == Status ==
    Memory usage on this node: 7.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=4
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.4709348968982696 | Iter 1.000: -1.720345746445656
    Resources requested: 12/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_581b3_00001 | RUNNING    |                 |            2 |   16 |    4 | 0.0367963   |         |            |                      |
    | DEFAULT_581b3_00003 | RUNNING    | 172.17.0.2:1428 |           16 |    4 |   32 | 0.00958168  | 1.60734 |     0.4088 |                    3 |
    | DEFAULT_581b3_00004 | RUNNING    | 172.17.0.2:1427 |           16 |   16 |    8 | 0.00999627  | 1.5677  |     0.4447 |                    3 |
    | DEFAULT_581b3_00006 | RUNNING    | 172.17.0.2:1475 |           16 |  128 |   16 | 0.0101957   | 1.46525 |     0.4915 |                    3 |
    | DEFAULT_581b3_00007 | RUNNING    | 172.17.0.2:1435 |           16 |  256 |  256 | 0.00980314  | 1.37346 |     0.5164 |                    2 |
    | DEFAULT_581b3_00009 | RUNNING    |                 |            2 |   16 |    4 | 0.000280285 |         |            |                      |
    | DEFAULT_581b3_00000 | TERMINATED |                 |            8 |  256 |    8 | 0.00075324  | 1.80203 |     0.3316 |                    1 |
    | DEFAULT_581b3_00002 | TERMINATED |                 |            4 |  256 |   16 | 0.000163494 | 1.90823 |     0.3037 |                    1 |
    | DEFAULT_581b3_00005 | TERMINATED |                 |            4 |  128 |   16 | 0.00965146  | 1.88642 |     0.2907 |                    1 |
    | DEFAULT_581b3_00008 | TERMINATED |                 |            8 |   64 |   16 | 0.0396223   | 2.31095 |     0.0983 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1426)[0m [1, 14000] loss: 0.335
    Result for DEFAULT_581b3_00007:
      accuracy: 0.5599
      date: 2021-03-25_17-35-43
      done: false
      experiment_id: 2a8b5c759e61410bb9c1dd4dea517782
      hostname: 6a871f235667
      iterations_since_restore: 3
      loss: 1.253779689025879
      node_ip: 172.17.0.2
      pid: 1435
      should_checkpoint: true
      time_since_restore: 76.21417832374573
      time_this_iter_s: 22.78153347969055
      time_total_s: 76.21417832374573
      timestamp: 1616693743
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: 581b3_00007
  
    [2m[36m(pid=1420)[0m [1, 16000] loss: 0.256
    [2m[36m(pid=1426)[0m [1, 16000] loss: 0.294
    [2m[36m(pid=1428)[0m [4,  2000] loss: 1.552
    [2m[36m(pid=1427)[0m [4,  2000] loss: 1.417
    [2m[36m(pid=1475)[0m [4,  2000] loss: 1.305
    [2m[36m(pid=1420)[0m [1, 18000] loss: 0.223
    [2m[36m(pid=1426)[0m [1, 18000] loss: 0.260
    Result for DEFAULT_581b3_00003:
      accuracy: 0.4215
      date: 2021-03-25_17-35-56
      done: false
      experiment_id: 9d522cd5382541beb77448849654b6a3
      hostname: 6a871f235667
      iterations_since_restore: 4
      loss: 1.557613602733612
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 89.65937900543213
      time_this_iter_s: 19.82152557373047
      time_total_s: 89.65937900543213
      timestamp: 1616693756
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: 581b3_00003
  
    == Status ==
    Memory usage on this node: 7.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=4
    Bracket: Iter 8.000: None | Iter 4.000: -1.557613602733612 | Iter 2.000: -1.4709348968982696 | Iter 1.000: -1.720345746445656
    Resources requested: 12/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_581b3_00001 | RUNNING    |                 |            2 |   16 |    4 | 0.0367963   |         |            |                      |
    | DEFAULT_581b3_00003 | RUNNING    | 172.17.0.2:1428 |           16 |    4 |   32 | 0.00958168  | 1.55761 |     0.4215 |                    4 |
    | DEFAULT_581b3_00004 | RUNNING    | 172.17.0.2:1427 |           16 |   16 |    8 | 0.00999627  | 1.5677  |     0.4447 |                    3 |
    | DEFAULT_581b3_00006 | RUNNING    | 172.17.0.2:1475 |           16 |  128 |   16 | 0.0101957   | 1.46525 |     0.4915 |                    3 |
    | DEFAULT_581b3_00007 | RUNNING    | 172.17.0.2:1435 |           16 |  256 |  256 | 0.00980314  | 1.25378 |     0.5599 |                    3 |
    | DEFAULT_581b3_00009 | RUNNING    |                 |            2 |   16 |    4 | 0.000280285 |         |            |                      |
    | DEFAULT_581b3_00000 | TERMINATED |                 |            8 |  256 |    8 | 0.00075324  | 1.80203 |     0.3316 |                    1 |
    | DEFAULT_581b3_00002 | TERMINATED |                 |            4 |  256 |   16 | 0.000163494 | 1.90823 |     0.3037 |                    1 |
    | DEFAULT_581b3_00005 | TERMINATED |                 |            4 |  128 |   16 | 0.00965146  | 1.88642 |     0.2907 |                    1 |
    | DEFAULT_581b3_00008 | TERMINATED |                 |            8 |   64 |   16 | 0.0396223   | 2.31095 |     0.0983 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_581b3_00004:
      accuracy: 0.4956
      date: 2021-03-25_17-35-57
      done: false
      experiment_id: 385573d6552542689c001db95b0bb0e7
      hostname: 6a871f235667
      iterations_since_restore: 4
      loss: 1.4290120928764343
      node_ip: 172.17.0.2
      pid: 1427
      should_checkpoint: true
      time_since_restore: 90.74369382858276
      time_this_iter_s: 20.04753351211548
      time_total_s: 90.74369382858276
      timestamp: 1616693757
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: 581b3_00004
  
    [2m[36m(pid=1435)[0m [4,  2000] loss: 1.182
    Result for DEFAULT_581b3_00006:
      accuracy: 0.5246
      date: 2021-03-25_17-35-59
      done: false
      experiment_id: dfa2a83437cf4b3d862a0edadd4dfc37
      hostname: 6a871f235667
      iterations_since_restore: 4
      loss: 1.3696549069404602
      node_ip: 172.17.0.2
      pid: 1475
      should_checkpoint: true
      time_since_restore: 92.1226851940155
      time_this_iter_s: 20.256935119628906
      time_total_s: 92.1226851940155
      timestamp: 1616693759
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: 581b3_00006
  
    [2m[36m(pid=1420)[0m [1, 20000] loss: 0.195
    Result for DEFAULT_581b3_00007:
      accuracy: 0.5556
      date: 2021-03-25_17-36-04
      done: false
      experiment_id: 2a8b5c759e61410bb9c1dd4dea517782
      hostname: 6a871f235667
      iterations_since_restore: 4
      loss: 1.2872241582870483
      node_ip: 172.17.0.2
      pid: 1435
      should_checkpoint: true
      time_since_restore: 97.49731230735779
      time_this_iter_s: 21.28313398361206
      time_total_s: 97.49731230735779
      timestamp: 1616693764
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: 581b3_00007
  
    == Status ==
    Memory usage on this node: 7.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=4
    Bracket: Iter 8.000: None | Iter 4.000: -1.3993334999084472 | Iter 2.000: -1.4709348968982696 | Iter 1.000: -1.720345746445656
    Resources requested: 12/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_581b3_00001 | RUNNING    |                 |            2 |   16 |    4 | 0.0367963   |         |            |                      |
    | DEFAULT_581b3_00003 | RUNNING    | 172.17.0.2:1428 |           16 |    4 |   32 | 0.00958168  | 1.55761 |     0.4215 |                    4 |
    | DEFAULT_581b3_00004 | RUNNING    | 172.17.0.2:1427 |           16 |   16 |    8 | 0.00999627  | 1.42901 |     0.4956 |                    4 |
    | DEFAULT_581b3_00006 | RUNNING    | 172.17.0.2:1475 |           16 |  128 |   16 | 0.0101957   | 1.36965 |     0.5246 |                    4 |
    | DEFAULT_581b3_00007 | RUNNING    | 172.17.0.2:1435 |           16 |  256 |  256 | 0.00980314  | 1.28722 |     0.5556 |                    4 |
    | DEFAULT_581b3_00009 | RUNNING    |                 |            2 |   16 |    4 | 0.000280285 |         |            |                      |
    | DEFAULT_581b3_00000 | TERMINATED |                 |            8 |  256 |    8 | 0.00075324  | 1.80203 |     0.3316 |                    1 |
    | DEFAULT_581b3_00002 | TERMINATED |                 |            4 |  256 |   16 | 0.000163494 | 1.90823 |     0.3037 |                    1 |
    | DEFAULT_581b3_00005 | TERMINATED |                 |            4 |  128 |   16 | 0.00965146  | 1.88642 |     0.2907 |                    1 |
    | DEFAULT_581b3_00008 | TERMINATED |                 |            8 |   64 |   16 | 0.0396223   | 2.31095 |     0.0983 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1426)[0m [1, 20000] loss: 0.235
    [2m[36m(pid=1428)[0m [5,  2000] loss: 1.550
    [2m[36m(pid=1427)[0m [5,  2000] loss: 1.399
    [2m[36m(pid=1475)[0m [5,  2000] loss: 1.278
    Result for DEFAULT_581b3_00009:
      accuracy: 0.2352
      date: 2021-03-25_17-36-15
      done: true
      experiment_id: 21bce42411544829861fd3d142496753
      hostname: 6a871f235667
      iterations_since_restore: 1
      loss: 1.9299498519659042
      node_ip: 172.17.0.2
      pid: 1420
      should_checkpoint: true
      time_since_restore: 108.37722110748291
      time_this_iter_s: 108.37722110748291
      time_total_s: 108.37722110748291
      timestamp: 1616693775
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 581b3_00009
  
    == Status ==
    Memory usage on this node: 7.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: None | Iter 4.000: -1.3993334999084472 | Iter 2.000: -1.4709348968982696 | Iter 1.000: -1.8020302513599395
    Resources requested: 12/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_581b3_00001 | RUNNING    |                 |            2 |   16 |    4 | 0.0367963   |         |            |                      |
    | DEFAULT_581b3_00003 | RUNNING    | 172.17.0.2:1428 |           16 |    4 |   32 | 0.00958168  | 1.55761 |     0.4215 |                    4 |
    | DEFAULT_581b3_00004 | RUNNING    | 172.17.0.2:1427 |           16 |   16 |    8 | 0.00999627  | 1.42901 |     0.4956 |                    4 |
    | DEFAULT_581b3_00006 | RUNNING    | 172.17.0.2:1475 |           16 |  128 |   16 | 0.0101957   | 1.36965 |     0.5246 |                    4 |
    | DEFAULT_581b3_00007 | RUNNING    | 172.17.0.2:1435 |           16 |  256 |  256 | 0.00980314  | 1.28722 |     0.5556 |                    4 |
    | DEFAULT_581b3_00009 | RUNNING    | 172.17.0.2:1420 |            2 |   16 |    4 | 0.000280285 | 1.92995 |     0.2352 |                    1 |
    | DEFAULT_581b3_00000 | TERMINATED |                 |            8 |  256 |    8 | 0.00075324  | 1.80203 |     0.3316 |                    1 |
    | DEFAULT_581b3_00002 | TERMINATED |                 |            4 |  256 |   16 | 0.000163494 | 1.90823 |     0.3037 |                    1 |
    | DEFAULT_581b3_00005 | TERMINATED |                 |            4 |  128 |   16 | 0.00965146  | 1.88642 |     0.2907 |                    1 |
    | DEFAULT_581b3_00008 | TERMINATED |                 |            8 |   64 |   16 | 0.0396223   | 2.31095 |     0.0983 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_581b3_00003:
      accuracy: 0.413
      date: 2021-03-25_17-36-16
      done: false
      experiment_id: 9d522cd5382541beb77448849654b6a3
      hostname: 6a871f235667
      iterations_since_restore: 5
      loss: 1.5829447763442994
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 109.6900224685669
      time_this_iter_s: 20.030643463134766
      time_total_s: 109.6900224685669
      timestamp: 1616693776
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: 581b3_00003
  
    Result for DEFAULT_581b3_00001:
      accuracy: 0.1002
      date: 2021-03-25_17-36-17
      done: true
      experiment_id: 81bfbbdade964438b6c47089f64c0dce
      hostname: 6a871f235667
      iterations_since_restore: 1
      loss: 2.3431051057338714
      node_ip: 172.17.0.2
      pid: 1426
      should_checkpoint: true
      time_since_restore: 110.52772235870361
      time_this_iter_s: 110.52772235870361
      time_total_s: 110.52772235870361
      timestamp: 1616693777
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 581b3_00001
  
    Result for DEFAULT_581b3_00004:
      accuracy: 0.476
      date: 2021-03-25_17-36-18
      done: false
      experiment_id: 385573d6552542689c001db95b0bb0e7
      hostname: 6a871f235667
      iterations_since_restore: 5
      loss: 1.4976557258605958
      node_ip: 172.17.0.2
      pid: 1427
      should_checkpoint: true
      time_since_restore: 110.9817488193512
      time_this_iter_s: 20.238054990768433
      time_total_s: 110.9817488193512
      timestamp: 1616693778
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: 581b3_00004
  
    Result for DEFAULT_581b3_00006:
      accuracy: 0.5424
      date: 2021-03-25_17-36-19
      done: false
      experiment_id: dfa2a83437cf4b3d862a0edadd4dfc37
      hostname: 6a871f235667
      iterations_since_restore: 5
      loss: 1.3763409925937653
      node_ip: 172.17.0.2
      pid: 1475
      should_checkpoint: true
      time_since_restore: 112.66842222213745
      time_this_iter_s: 20.54573702812195
      time_total_s: 112.66842222213745
      timestamp: 1616693779
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: 581b3_00006
  
    [2m[36m(pid=1435)[0m [5,  2000] loss: 1.125
    Result for DEFAULT_581b3_00007:
      accuracy: 0.5811
      date: 2021-03-25_17-36-25
      done: false
      experiment_id: 2a8b5c759e61410bb9c1dd4dea517782
      hostname: 6a871f235667
      iterations_since_restore: 5
      loss: 1.2395566887378693
      node_ip: 172.17.0.2
      pid: 1435
      should_checkpoint: true
      time_since_restore: 118.924236536026
      time_this_iter_s: 21.426924228668213
      time_total_s: 118.924236536026
      timestamp: 1616693785
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: 581b3_00007
  
    == Status ==
    Memory usage on this node: 6.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: None | Iter 4.000: -1.3993334999084472 | Iter 2.000: -1.4709348968982696 | Iter 1.000: -1.8442263306736946
    Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_581b3_00003 | RUNNING    | 172.17.0.2:1428 |           16 |    4 |   32 | 0.00958168  | 1.58294 |     0.413  |                    5 |
    | DEFAULT_581b3_00004 | RUNNING    | 172.17.0.2:1427 |           16 |   16 |    8 | 0.00999627  | 1.49766 |     0.476  |                    5 |
    | DEFAULT_581b3_00006 | RUNNING    | 172.17.0.2:1475 |           16 |  128 |   16 | 0.0101957   | 1.37634 |     0.5424 |                    5 |
    | DEFAULT_581b3_00007 | RUNNING    | 172.17.0.2:1435 |           16 |  256 |  256 | 0.00980314  | 1.23956 |     0.5811 |                    5 |
    | DEFAULT_581b3_00000 | TERMINATED |                 |            8 |  256 |    8 | 0.00075324  | 1.80203 |     0.3316 |                    1 |
    | DEFAULT_581b3_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.0367963   | 2.34311 |     0.1002 |                    1 |
    | DEFAULT_581b3_00002 | TERMINATED |                 |            4 |  256 |   16 | 0.000163494 | 1.90823 |     0.3037 |                    1 |
    | DEFAULT_581b3_00005 | TERMINATED |                 |            4 |  128 |   16 | 0.00965146  | 1.88642 |     0.2907 |                    1 |
    | DEFAULT_581b3_00008 | TERMINATED |                 |            8 |   64 |   16 | 0.0396223   | 2.31095 |     0.0983 |                    1 |
    | DEFAULT_581b3_00009 | TERMINATED |                 |            2 |   16 |    4 | 0.000280285 | 1.92995 |     0.2352 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1428)[0m [6,  2000] loss: 1.532
    [2m[36m(pid=1427)[0m [6,  2000] loss: 1.367
    [2m[36m(pid=1475)[0m [6,  2000] loss: 1.227
    Result for DEFAULT_581b3_00003:
      accuracy: 0.3997
      date: 2021-03-25_17-36-35
      done: false
      experiment_id: 9d522cd5382541beb77448849654b6a3
      hostname: 6a871f235667
      iterations_since_restore: 6
      loss: 1.693560751056671
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 128.5533745288849
      time_this_iter_s: 18.863352060317993
      time_total_s: 128.5533745288849
      timestamp: 1616693795
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: 581b3_00003
  
    == Status ==
    Memory usage on this node: 6.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: None | Iter 4.000: -1.3993334999084472 | Iter 2.000: -1.4709348968982696 | Iter 1.000: -1.8442263306736946
    Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_581b3_00003 | RUNNING    | 172.17.0.2:1428 |           16 |    4 |   32 | 0.00958168  | 1.69356 |     0.3997 |                    6 |
    | DEFAULT_581b3_00004 | RUNNING    | 172.17.0.2:1427 |           16 |   16 |    8 | 0.00999627  | 1.49766 |     0.476  |                    5 |
    | DEFAULT_581b3_00006 | RUNNING    | 172.17.0.2:1475 |           16 |  128 |   16 | 0.0101957   | 1.37634 |     0.5424 |                    5 |
    | DEFAULT_581b3_00007 | RUNNING    | 172.17.0.2:1435 |           16 |  256 |  256 | 0.00980314  | 1.23956 |     0.5811 |                    5 |
    | DEFAULT_581b3_00000 | TERMINATED |                 |            8 |  256 |    8 | 0.00075324  | 1.80203 |     0.3316 |                    1 |
    | DEFAULT_581b3_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.0367963   | 2.34311 |     0.1002 |                    1 |
    | DEFAULT_581b3_00002 | TERMINATED |                 |            4 |  256 |   16 | 0.000163494 | 1.90823 |     0.3037 |                    1 |
    | DEFAULT_581b3_00005 | TERMINATED |                 |            4 |  128 |   16 | 0.00965146  | 1.88642 |     0.2907 |                    1 |
    | DEFAULT_581b3_00008 | TERMINATED |                 |            8 |   64 |   16 | 0.0396223   | 2.31095 |     0.0983 |                    1 |
    | DEFAULT_581b3_00009 | TERMINATED |                 |            2 |   16 |    4 | 0.000280285 | 1.92995 |     0.2352 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_581b3_00004:
      accuracy: 0.4993
      date: 2021-03-25_17-36-36
      done: false
      experiment_id: 385573d6552542689c001db95b0bb0e7
      hostname: 6a871f235667
      iterations_since_restore: 6
      loss: 1.4252843453407287
      node_ip: 172.17.0.2
      pid: 1427
      should_checkpoint: true
      time_since_restore: 129.96603202819824
      time_this_iter_s: 18.984283208847046
      time_total_s: 129.96603202819824
      timestamp: 1616693796
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: 581b3_00004
  
    Result for DEFAULT_581b3_00006:
      accuracy: 0.5546
      date: 2021-03-25_17-36-39
      done: false
      experiment_id: dfa2a83437cf4b3d862a0edadd4dfc37
      hostname: 6a871f235667
      iterations_since_restore: 6
      loss: 1.2923138194084167
      node_ip: 172.17.0.2
      pid: 1475
      should_checkpoint: true
      time_since_restore: 132.134428024292
      time_this_iter_s: 19.46600580215454
      time_total_s: 132.134428024292
      timestamp: 1616693799
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: 581b3_00006
  
    [2m[36m(pid=1435)[0m [6,  2000] loss: 1.076
    Result for DEFAULT_581b3_00007:
      accuracy: 0.5696
      date: 2021-03-25_17-36-46
      done: false
      experiment_id: 2a8b5c759e61410bb9c1dd4dea517782
      hostname: 6a871f235667
      iterations_since_restore: 6
      loss: 1.301616648721695
      node_ip: 172.17.0.2
      pid: 1435
      should_checkpoint: true
      time_since_restore: 139.56098318099976
      time_this_iter_s: 20.636746644973755
      time_total_s: 139.56098318099976
      timestamp: 1616693806
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: 581b3_00007
  
    == Status ==
    Memory usage on this node: 6.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: None | Iter 4.000: -1.3993334999084472 | Iter 2.000: -1.4709348968982696 | Iter 1.000: -1.8442263306736946
    Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_581b3_00003 | RUNNING    | 172.17.0.2:1428 |           16 |    4 |   32 | 0.00958168  | 1.69356 |     0.3997 |                    6 |
    | DEFAULT_581b3_00004 | RUNNING    | 172.17.0.2:1427 |           16 |   16 |    8 | 0.00999627  | 1.42528 |     0.4993 |                    6 |
    | DEFAULT_581b3_00006 | RUNNING    | 172.17.0.2:1475 |           16 |  128 |   16 | 0.0101957   | 1.29231 |     0.5546 |                    6 |
    | DEFAULT_581b3_00007 | RUNNING    | 172.17.0.2:1435 |           16 |  256 |  256 | 0.00980314  | 1.30162 |     0.5696 |                    6 |
    | DEFAULT_581b3_00000 | TERMINATED |                 |            8 |  256 |    8 | 0.00075324  | 1.80203 |     0.3316 |                    1 |
    | DEFAULT_581b3_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.0367963   | 2.34311 |     0.1002 |                    1 |
    | DEFAULT_581b3_00002 | TERMINATED |                 |            4 |  256 |   16 | 0.000163494 | 1.90823 |     0.3037 |                    1 |
    | DEFAULT_581b3_00005 | TERMINATED |                 |            4 |  128 |   16 | 0.00965146  | 1.88642 |     0.2907 |                    1 |
    | DEFAULT_581b3_00008 | TERMINATED |                 |            8 |   64 |   16 | 0.0396223   | 2.31095 |     0.0983 |                    1 |
    | DEFAULT_581b3_00009 | TERMINATED |                 |            2 |   16 |    4 | 0.000280285 | 1.92995 |     0.2352 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1428)[0m [7,  2000] loss: 1.528
    [2m[36m(pid=1427)[0m [7,  2000] loss: 1.346
    [2m[36m(pid=1475)[0m [7,  2000] loss: 1.201
    Result for DEFAULT_581b3_00003:
      accuracy: 0.4145
      date: 2021-03-25_17-36-54
      done: false
      experiment_id: 9d522cd5382541beb77448849654b6a3
      hostname: 6a871f235667
      iterations_since_restore: 7
      loss: 1.5570699531555177
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 147.18340468406677
      time_this_iter_s: 18.630030155181885
      time_total_s: 147.18340468406677
      timestamp: 1616693814
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: 581b3_00003
  
    == Status ==
    Memory usage on this node: 6.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: None | Iter 4.000: -1.3993334999084472 | Iter 2.000: -1.4709348968982696 | Iter 1.000: -1.8442263306736946
    Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_581b3_00003 | RUNNING    | 172.17.0.2:1428 |           16 |    4 |   32 | 0.00958168  | 1.55707 |     0.4145 |                    7 |
    | DEFAULT_581b3_00004 | RUNNING    | 172.17.0.2:1427 |           16 |   16 |    8 | 0.00999627  | 1.42528 |     0.4993 |                    6 |
    | DEFAULT_581b3_00006 | RUNNING    | 172.17.0.2:1475 |           16 |  128 |   16 | 0.0101957   | 1.29231 |     0.5546 |                    6 |
    | DEFAULT_581b3_00007 | RUNNING    | 172.17.0.2:1435 |           16 |  256 |  256 | 0.00980314  | 1.30162 |     0.5696 |                    6 |
    | DEFAULT_581b3_00000 | TERMINATED |                 |            8 |  256 |    8 | 0.00075324  | 1.80203 |     0.3316 |                    1 |
    | DEFAULT_581b3_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.0367963   | 2.34311 |     0.1002 |                    1 |
    | DEFAULT_581b3_00002 | TERMINATED |                 |            4 |  256 |   16 | 0.000163494 | 1.90823 |     0.3037 |                    1 |
    | DEFAULT_581b3_00005 | TERMINATED |                 |            4 |  128 |   16 | 0.00965146  | 1.88642 |     0.2907 |                    1 |
    | DEFAULT_581b3_00008 | TERMINATED |                 |            8 |   64 |   16 | 0.0396223   | 2.31095 |     0.0983 |                    1 |
    | DEFAULT_581b3_00009 | TERMINATED |                 |            2 |   16 |    4 | 0.000280285 | 1.92995 |     0.2352 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_581b3_00004:
      accuracy: 0.5111
      date: 2021-03-25_17-36-55
      done: false
      experiment_id: 385573d6552542689c001db95b0bb0e7
      hostname: 6a871f235667
      iterations_since_restore: 7
      loss: 1.4242047765731811
      node_ip: 172.17.0.2
      pid: 1427
      should_checkpoint: true
      time_since_restore: 148.76270866394043
      time_this_iter_s: 18.796676635742188
      time_total_s: 148.76270866394043
      timestamp: 1616693815
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: 581b3_00004
  
    Result for DEFAULT_581b3_00006:
      accuracy: 0.5149
      date: 2021-03-25_17-36-58
      done: false
      experiment_id: dfa2a83437cf4b3d862a0edadd4dfc37
      hostname: 6a871f235667
      iterations_since_restore: 7
      loss: 1.427619086933136
      node_ip: 172.17.0.2
      pid: 1475
      should_checkpoint: true
      time_since_restore: 151.61860585212708
      time_this_iter_s: 19.484177827835083
      time_total_s: 151.61860585212708
      timestamp: 1616693818
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: 581b3_00006
  
    [2m[36m(pid=1435)[0m [7,  2000] loss: 1.030
    Result for DEFAULT_581b3_00007:
      accuracy: 0.5884
      date: 2021-03-25_17-37-07
      done: false
      experiment_id: 2a8b5c759e61410bb9c1dd4dea517782
      hostname: 6a871f235667
      iterations_since_restore: 7
      loss: 1.2536196328163147
      node_ip: 172.17.0.2
      pid: 1435
      should_checkpoint: true
      time_since_restore: 160.04375505447388
      time_this_iter_s: 20.48277187347412
      time_total_s: 160.04375505447388
      timestamp: 1616693827
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: 581b3_00007
  
    == Status ==
    Memory usage on this node: 6.6/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: None | Iter 4.000: -1.3993334999084472 | Iter 2.000: -1.4709348968982696 | Iter 1.000: -1.8442263306736946
    Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_581b3_00003 | RUNNING    | 172.17.0.2:1428 |           16 |    4 |   32 | 0.00958168  | 1.55707 |     0.4145 |                    7 |
    | DEFAULT_581b3_00004 | RUNNING    | 172.17.0.2:1427 |           16 |   16 |    8 | 0.00999627  | 1.4242  |     0.5111 |                    7 |
    | DEFAULT_581b3_00006 | RUNNING    | 172.17.0.2:1475 |           16 |  128 |   16 | 0.0101957   | 1.42762 |     0.5149 |                    7 |
    | DEFAULT_581b3_00007 | RUNNING    | 172.17.0.2:1435 |           16 |  256 |  256 | 0.00980314  | 1.25362 |     0.5884 |                    7 |
    | DEFAULT_581b3_00000 | TERMINATED |                 |            8 |  256 |    8 | 0.00075324  | 1.80203 |     0.3316 |                    1 |
    | DEFAULT_581b3_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.0367963   | 2.34311 |     0.1002 |                    1 |
    | DEFAULT_581b3_00002 | TERMINATED |                 |            4 |  256 |   16 | 0.000163494 | 1.90823 |     0.3037 |                    1 |
    | DEFAULT_581b3_00005 | TERMINATED |                 |            4 |  128 |   16 | 0.00965146  | 1.88642 |     0.2907 |                    1 |
    | DEFAULT_581b3_00008 | TERMINATED |                 |            8 |   64 |   16 | 0.0396223   | 2.31095 |     0.0983 |                    1 |
    | DEFAULT_581b3_00009 | TERMINATED |                 |            2 |   16 |    4 | 0.000280285 | 1.92995 |     0.2352 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1428)[0m [8,  2000] loss: 1.547
    [2m[36m(pid=1427)[0m [8,  2000] loss: 1.338
    [2m[36m(pid=1475)[0m [8,  2000] loss: 1.168
    Result for DEFAULT_581b3_00003:
      accuracy: 0.3576
      date: 2021-03-25_17-37-12
      done: false
      experiment_id: 9d522cd5382541beb77448849654b6a3
      hostname: 6a871f235667
      iterations_since_restore: 8
      loss: 1.714107488822937
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 165.95912909507751
      time_this_iter_s: 18.775724411010742
      time_total_s: 165.95912909507751
      timestamp: 1616693832
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: 581b3_00003
  
    == Status ==
    Memory usage on this node: 6.6/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: -1.714107488822937 | Iter 4.000: -1.3993334999084472 | Iter 2.000: -1.4709348968982696 | Iter 1.000: -1.8442263306736946
    Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_581b3_00003 | RUNNING    | 172.17.0.2:1428 |           16 |    4 |   32 | 0.00958168  | 1.71411 |     0.3576 |                    8 |
    | DEFAULT_581b3_00004 | RUNNING    | 172.17.0.2:1427 |           16 |   16 |    8 | 0.00999627  | 1.4242  |     0.5111 |                    7 |
    | DEFAULT_581b3_00006 | RUNNING    | 172.17.0.2:1475 |           16 |  128 |   16 | 0.0101957   | 1.42762 |     0.5149 |                    7 |
    | DEFAULT_581b3_00007 | RUNNING    | 172.17.0.2:1435 |           16 |  256 |  256 | 0.00980314  | 1.25362 |     0.5884 |                    7 |
    | DEFAULT_581b3_00000 | TERMINATED |                 |            8 |  256 |    8 | 0.00075324  | 1.80203 |     0.3316 |                    1 |
    | DEFAULT_581b3_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.0367963   | 2.34311 |     0.1002 |                    1 |
    | DEFAULT_581b3_00002 | TERMINATED |                 |            4 |  256 |   16 | 0.000163494 | 1.90823 |     0.3037 |                    1 |
    | DEFAULT_581b3_00005 | TERMINATED |                 |            4 |  128 |   16 | 0.00965146  | 1.88642 |     0.2907 |                    1 |
    | DEFAULT_581b3_00008 | TERMINATED |                 |            8 |   64 |   16 | 0.0396223   | 2.31095 |     0.0983 |                    1 |
    | DEFAULT_581b3_00009 | TERMINATED |                 |            2 |   16 |    4 | 0.000280285 | 1.92995 |     0.2352 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_581b3_00004:
      accuracy: 0.5321
      date: 2021-03-25_17-37-14
      done: false
      experiment_id: 385573d6552542689c001db95b0bb0e7
      hostname: 6a871f235667
      iterations_since_restore: 8
      loss: 1.3800307227134705
      node_ip: 172.17.0.2
      pid: 1427
      should_checkpoint: true
      time_since_restore: 167.9135241508484
      time_this_iter_s: 19.15081548690796
      time_total_s: 167.9135241508484
      timestamp: 1616693834
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: 581b3_00004
  
    Result for DEFAULT_581b3_00006:
      accuracy: 0.5479
      date: 2021-03-25_17-37-18
      done: false
      experiment_id: dfa2a83437cf4b3d862a0edadd4dfc37
      hostname: 6a871f235667
      iterations_since_restore: 8
      loss: 1.351604154396057
      node_ip: 172.17.0.2
      pid: 1475
      should_checkpoint: true
      time_since_restore: 171.14415454864502
      time_this_iter_s: 19.525548696517944
      time_total_s: 171.14415454864502
      timestamp: 1616693838
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: 581b3_00006
  
    == Status ==
    Memory usage on this node: 6.6/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: -1.3800307227134705 | Iter 4.000: -1.3993334999084472 | Iter 2.000: -1.4709348968982696 | Iter 1.000: -1.8442263306736946
    Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_581b3_00003 | RUNNING    | 172.17.0.2:1428 |           16 |    4 |   32 | 0.00958168  | 1.71411 |     0.3576 |                    8 |
    | DEFAULT_581b3_00004 | RUNNING    | 172.17.0.2:1427 |           16 |   16 |    8 | 0.00999627  | 1.38003 |     0.5321 |                    8 |
    | DEFAULT_581b3_00006 | RUNNING    | 172.17.0.2:1475 |           16 |  128 |   16 | 0.0101957   | 1.3516  |     0.5479 |                    8 |
    | DEFAULT_581b3_00007 | RUNNING    | 172.17.0.2:1435 |           16 |  256 |  256 | 0.00980314  | 1.25362 |     0.5884 |                    7 |
    | DEFAULT_581b3_00000 | TERMINATED |                 |            8 |  256 |    8 | 0.00075324  | 1.80203 |     0.3316 |                    1 |
    | DEFAULT_581b3_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.0367963   | 2.34311 |     0.1002 |                    1 |
    | DEFAULT_581b3_00002 | TERMINATED |                 |            4 |  256 |   16 | 0.000163494 | 1.90823 |     0.3037 |                    1 |
    | DEFAULT_581b3_00005 | TERMINATED |                 |            4 |  128 |   16 | 0.00965146  | 1.88642 |     0.2907 |                    1 |
    | DEFAULT_581b3_00008 | TERMINATED |                 |            8 |   64 |   16 | 0.0396223   | 2.31095 |     0.0983 |                    1 |
    | DEFAULT_581b3_00009 | TERMINATED |                 |            2 |   16 |    4 | 0.000280285 | 1.92995 |     0.2352 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1435)[0m [8,  2000] loss: 0.999
    [2m[36m(pid=1428)[0m [9,  2000] loss: 1.538
    Result for DEFAULT_581b3_00007:
      accuracy: 0.581
      date: 2021-03-25_17-37-27
      done: false
      experiment_id: 2a8b5c759e61410bb9c1dd4dea517782
      hostname: 6a871f235667
      iterations_since_restore: 8
      loss: 1.2846668633460998
      node_ip: 172.17.0.2
      pid: 1435
      should_checkpoint: true
      time_since_restore: 180.7236077785492
      time_this_iter_s: 20.679852724075317
      time_total_s: 180.7236077785492
      timestamp: 1616693847
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: 581b3_00007
  
    == Status ==
    Memory usage on this node: 6.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: -1.365817438554764 | Iter 4.000: -1.3993334999084472 | Iter 2.000: -1.4709348968982696 | Iter 1.000: -1.8442263306736946
    Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_581b3_00003 | RUNNING    | 172.17.0.2:1428 |           16 |    4 |   32 | 0.00958168  | 1.71411 |     0.3576 |                    8 |
    | DEFAULT_581b3_00004 | RUNNING    | 172.17.0.2:1427 |           16 |   16 |    8 | 0.00999627  | 1.38003 |     0.5321 |                    8 |
    | DEFAULT_581b3_00006 | RUNNING    | 172.17.0.2:1475 |           16 |  128 |   16 | 0.0101957   | 1.3516  |     0.5479 |                    8 |
    | DEFAULT_581b3_00007 | RUNNING    | 172.17.0.2:1435 |           16 |  256 |  256 | 0.00980314  | 1.28467 |     0.581  |                    8 |
    | DEFAULT_581b3_00000 | TERMINATED |                 |            8 |  256 |    8 | 0.00075324  | 1.80203 |     0.3316 |                    1 |
    | DEFAULT_581b3_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.0367963   | 2.34311 |     0.1002 |                    1 |
    | DEFAULT_581b3_00002 | TERMINATED |                 |            4 |  256 |   16 | 0.000163494 | 1.90823 |     0.3037 |                    1 |
    | DEFAULT_581b3_00005 | TERMINATED |                 |            4 |  128 |   16 | 0.00965146  | 1.88642 |     0.2907 |                    1 |
    | DEFAULT_581b3_00008 | TERMINATED |                 |            8 |   64 |   16 | 0.0396223   | 2.31095 |     0.0983 |                    1 |
    | DEFAULT_581b3_00009 | TERMINATED |                 |            2 |   16 |    4 | 0.000280285 | 1.92995 |     0.2352 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1427)[0m [9,  2000] loss: 1.331
    [2m[36m(pid=1475)[0m [9,  2000] loss: 1.164
    Result for DEFAULT_581b3_00003:
      accuracy: 0.386
      date: 2021-03-25_17-37-32
      done: false
      experiment_id: 9d522cd5382541beb77448849654b6a3
      hostname: 6a871f235667
      iterations_since_restore: 9
      loss: 1.6684722647666932
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 185.04973340034485
      time_this_iter_s: 19.090604305267334
      time_total_s: 185.04973340034485
      timestamp: 1616693852
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: 581b3_00003
  
    Result for DEFAULT_581b3_00004:
      accuracy: 0.4856
      date: 2021-03-25_17-37-33
      done: false
      experiment_id: 385573d6552542689c001db95b0bb0e7
      hostname: 6a871f235667
      iterations_since_restore: 9
      loss: 1.4855051098823548
      node_ip: 172.17.0.2
      pid: 1427
      should_checkpoint: true
      time_since_restore: 186.8476927280426
      time_this_iter_s: 18.934168577194214
      time_total_s: 186.8476927280426
      timestamp: 1616693853
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: 581b3_00004
  
    == Status ==
    Memory usage on this node: 6.8/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: -1.365817438554764 | Iter 4.000: -1.3993334999084472 | Iter 2.000: -1.4709348968982696 | Iter 1.000: -1.8442263306736946
    Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_581b3_00003 | RUNNING    | 172.17.0.2:1428 |           16 |    4 |   32 | 0.00958168  | 1.66847 |     0.386  |                    9 |
    | DEFAULT_581b3_00004 | RUNNING    | 172.17.0.2:1427 |           16 |   16 |    8 | 0.00999627  | 1.48551 |     0.4856 |                    9 |
    | DEFAULT_581b3_00006 | RUNNING    | 172.17.0.2:1475 |           16 |  128 |   16 | 0.0101957   | 1.3516  |     0.5479 |                    8 |
    | DEFAULT_581b3_00007 | RUNNING    | 172.17.0.2:1435 |           16 |  256 |  256 | 0.00980314  | 1.28467 |     0.581  |                    8 |
    | DEFAULT_581b3_00000 | TERMINATED |                 |            8 |  256 |    8 | 0.00075324  | 1.80203 |     0.3316 |                    1 |
    | DEFAULT_581b3_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.0367963   | 2.34311 |     0.1002 |                    1 |
    | DEFAULT_581b3_00002 | TERMINATED |                 |            4 |  256 |   16 | 0.000163494 | 1.90823 |     0.3037 |                    1 |
    | DEFAULT_581b3_00005 | TERMINATED |                 |            4 |  128 |   16 | 0.00965146  | 1.88642 |     0.2907 |                    1 |
    | DEFAULT_581b3_00008 | TERMINATED |                 |            8 |   64 |   16 | 0.0396223   | 2.31095 |     0.0983 |                    1 |
    | DEFAULT_581b3_00009 | TERMINATED |                 |            2 |   16 |    4 | 0.000280285 | 1.92995 |     0.2352 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_581b3_00006:
      accuracy: 0.5546
      date: 2021-03-25_17-37-37
      done: false
      experiment_id: dfa2a83437cf4b3d862a0edadd4dfc37
      hostname: 6a871f235667
      iterations_since_restore: 9
      loss: 1.3512321058273316
      node_ip: 172.17.0.2
      pid: 1475
      should_checkpoint: true
      time_since_restore: 190.61241388320923
      time_this_iter_s: 19.46825933456421
      time_total_s: 190.61241388320923
      timestamp: 1616693857
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: 581b3_00006
  
    [2m[36m(pid=1435)[0m [9,  2000] loss: 0.975
    [2m[36m(pid=1428)[0m [10,  2000] loss: 1.532
    [2m[36m(pid=1427)[0m [10,  2000] loss: 1.320
    Result for DEFAULT_581b3_00007:
      accuracy: 0.5638
      date: 2021-03-25_17-37-48
      done: false
      experiment_id: 2a8b5c759e61410bb9c1dd4dea517782
      hostname: 6a871f235667
      iterations_since_restore: 9
      loss: 1.3280994791030885
      node_ip: 172.17.0.2
      pid: 1435
      should_checkpoint: true
      time_since_restore: 201.45453119277954
      time_this_iter_s: 20.730923414230347
      time_total_s: 201.45453119277954
      timestamp: 1616693868
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: 581b3_00007
  
    == Status ==
    Memory usage on this node: 6.8/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: -1.365817438554764 | Iter 4.000: -1.3993334999084472 | Iter 2.000: -1.4709348968982696 | Iter 1.000: -1.8442263306736946
    Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_581b3_00003 | RUNNING    | 172.17.0.2:1428 |           16 |    4 |   32 | 0.00958168  | 1.66847 |     0.386  |                    9 |
    | DEFAULT_581b3_00004 | RUNNING    | 172.17.0.2:1427 |           16 |   16 |    8 | 0.00999627  | 1.48551 |     0.4856 |                    9 |
    | DEFAULT_581b3_00006 | RUNNING    | 172.17.0.2:1475 |           16 |  128 |   16 | 0.0101957   | 1.35123 |     0.5546 |                    9 |
    | DEFAULT_581b3_00007 | RUNNING    | 172.17.0.2:1435 |           16 |  256 |  256 | 0.00980314  | 1.3281  |     0.5638 |                    9 |
    | DEFAULT_581b3_00000 | TERMINATED |                 |            8 |  256 |    8 | 0.00075324  | 1.80203 |     0.3316 |                    1 |
    | DEFAULT_581b3_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.0367963   | 2.34311 |     0.1002 |                    1 |
    | DEFAULT_581b3_00002 | TERMINATED |                 |            4 |  256 |   16 | 0.000163494 | 1.90823 |     0.3037 |                    1 |
    | DEFAULT_581b3_00005 | TERMINATED |                 |            4 |  128 |   16 | 0.00965146  | 1.88642 |     0.2907 |                    1 |
    | DEFAULT_581b3_00008 | TERMINATED |                 |            8 |   64 |   16 | 0.0396223   | 2.31095 |     0.0983 |                    1 |
    | DEFAULT_581b3_00009 | TERMINATED |                 |            2 |   16 |    4 | 0.000280285 | 1.92995 |     0.2352 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_581b3_00003:
      accuracy: 0.4299
      date: 2021-03-25_17-37-50
      done: true
      experiment_id: 9d522cd5382541beb77448849654b6a3
      hostname: 6a871f235667
      iterations_since_restore: 10
      loss: 1.6311509662628174
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 203.7607443332672
      time_this_iter_s: 18.711010932922363
      time_total_s: 203.7607443332672
      timestamp: 1616693870
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: 581b3_00003
  
    [2m[36m(pid=1475)[0m [10,  2000] loss: 1.139
    Result for DEFAULT_581b3_00004:
      accuracy: 0.5155
      date: 2021-03-25_17-37-52
      done: true
      experiment_id: 385573d6552542689c001db95b0bb0e7
      hostname: 6a871f235667
      iterations_since_restore: 10
      loss: 1.3754941591262817
      node_ip: 172.17.0.2
      pid: 1427
      should_checkpoint: true
      time_since_restore: 205.7066352367401
      time_this_iter_s: 18.85894250869751
      time_total_s: 205.7066352367401
      timestamp: 1616693872
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: 581b3_00004
  
    Result for DEFAULT_581b3_00006:
      accuracy: 0.5585
      date: 2021-03-25_17-37-56
      done: true
      experiment_id: dfa2a83437cf4b3d862a0edadd4dfc37
      hostname: 6a871f235667
      iterations_since_restore: 10
      loss: 1.331880284309387
      node_ip: 172.17.0.2
      pid: 1475
      should_checkpoint: true
      time_since_restore: 209.78250074386597
      time_this_iter_s: 19.17008686065674
      time_total_s: 209.78250074386597
      timestamp: 1616693876
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: 581b3_00006
  
    == Status ==
    Memory usage on this node: 5.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=9
    Bracket: Iter 8.000: -1.365817438554764 | Iter 4.000: -1.3993334999084472 | Iter 2.000: -1.4709348968982696 | Iter 1.000: -1.8442263306736946
    Resources requested: 4/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_581b3_00006 | RUNNING    | 172.17.0.2:1475 |           16 |  128 |   16 | 0.0101957   | 1.33188 |     0.5585 |                   10 |
    | DEFAULT_581b3_00007 | RUNNING    | 172.17.0.2:1435 |           16 |  256 |  256 | 0.00980314  | 1.3281  |     0.5638 |                    9 |
    | DEFAULT_581b3_00000 | TERMINATED |                 |            8 |  256 |    8 | 0.00075324  | 1.80203 |     0.3316 |                    1 |
    | DEFAULT_581b3_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.0367963   | 2.34311 |     0.1002 |                    1 |
    | DEFAULT_581b3_00002 | TERMINATED |                 |            4 |  256 |   16 | 0.000163494 | 1.90823 |     0.3037 |                    1 |
    | DEFAULT_581b3_00003 | TERMINATED |                 |           16 |    4 |   32 | 0.00958168  | 1.63115 |     0.4299 |                   10 |
    | DEFAULT_581b3_00004 | TERMINATED |                 |           16 |   16 |    8 | 0.00999627  | 1.37549 |     0.5155 |                   10 |
    | DEFAULT_581b3_00005 | TERMINATED |                 |            4 |  128 |   16 | 0.00965146  | 1.88642 |     0.2907 |                    1 |
    | DEFAULT_581b3_00008 | TERMINATED |                 |            8 |   64 |   16 | 0.0396223   | 2.31095 |     0.0983 |                    1 |
    | DEFAULT_581b3_00009 | TERMINATED |                 |            2 |   16 |    4 | 0.000280285 | 1.92995 |     0.2352 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1435)[0m [10,  2000] loss: 0.964
    Result for DEFAULT_581b3_00007:
      accuracy: 0.5758
      date: 2021-03-25_17-38-08
      done: true
      experiment_id: 2a8b5c759e61410bb9c1dd4dea517782
      hostname: 6a871f235667
      iterations_since_restore: 10
      loss: 1.3521747308254242
      node_ip: 172.17.0.2
      pid: 1435
      should_checkpoint: true
      time_since_restore: 221.15753984451294
      time_this_iter_s: 19.7030086517334
      time_total_s: 221.15753984451294
      timestamp: 1616693888
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: 581b3_00007
  
    == Status ==
    Memory usage on this node: 4.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=10
    Bracket: Iter 8.000: -1.365817438554764 | Iter 4.000: -1.3993334999084472 | Iter 2.000: -1.4709348968982696 | Iter 1.000: -1.8442263306736946
    Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_581b3_00007 | RUNNING    | 172.17.0.2:1435 |           16 |  256 |  256 | 0.00980314  | 1.35217 |     0.5758 |                   10 |
    | DEFAULT_581b3_00000 | TERMINATED |                 |            8 |  256 |    8 | 0.00075324  | 1.80203 |     0.3316 |                    1 |
    | DEFAULT_581b3_00001 | TERMINATED |                 |            2 |   16 |    4 | 0.0367963   | 2.34311 |     0.1002 |                    1 |
    | DEFAULT_581b3_00002 | TERMINATED |                 |            4 |  256 |   16 | 0.000163494 | 1.90823 |     0.3037 |                    1 |
    | DEFAULT_581b3_00003 | TERMINATED |                 |           16 |    4 |   32 | 0.00958168  | 1.63115 |     0.4299 |                   10 |
    | DEFAULT_581b3_00004 | TERMINATED |                 |           16 |   16 |    8 | 0.00999627  | 1.37549 |     0.5155 |                   10 |
    | DEFAULT_581b3_00005 | TERMINATED |                 |            4 |  128 |   16 | 0.00965146  | 1.88642 |     0.2907 |                    1 |
    | DEFAULT_581b3_00006 | TERMINATED |                 |           16 |  128 |   16 | 0.0101957   | 1.33188 |     0.5585 |                   10 |
    | DEFAULT_581b3_00008 | TERMINATED |                 |            8 |   64 |   16 | 0.0396223   | 2.31095 |     0.0983 |                    1 |
    | DEFAULT_581b3_00009 | TERMINATED |                 |            2 |   16 |    4 | 0.000280285 | 1.92995 |     0.2352 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    == Status ==
    Memory usage on this node: 4.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=10
    Bracket: Iter 8.000: -1.365817438554764 | Iter 4.000: -1.3993334999084472 | Iter 2.000: -1.4709348968982696 | Iter 1.000: -1.8442263306736946
    Resources requested: 0/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-03-25_17-34-25
    Number of trials: 10/10 (10 TERMINATED)
    +---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc   |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_581b3_00000 | TERMINATED |       |            8 |  256 |    8 | 0.00075324  | 1.80203 |     0.3316 |                    1 |
    | DEFAULT_581b3_00001 | TERMINATED |       |            2 |   16 |    4 | 0.0367963   | 2.34311 |     0.1002 |                    1 |
    | DEFAULT_581b3_00002 | TERMINATED |       |            4 |  256 |   16 | 0.000163494 | 1.90823 |     0.3037 |                    1 |
    | DEFAULT_581b3_00003 | TERMINATED |       |           16 |    4 |   32 | 0.00958168  | 1.63115 |     0.4299 |                   10 |
    | DEFAULT_581b3_00004 | TERMINATED |       |           16 |   16 |    8 | 0.00999627  | 1.37549 |     0.5155 |                   10 |
    | DEFAULT_581b3_00005 | TERMINATED |       |            4 |  128 |   16 | 0.00965146  | 1.88642 |     0.2907 |                    1 |
    | DEFAULT_581b3_00006 | TERMINATED |       |           16 |  128 |   16 | 0.0101957   | 1.33188 |     0.5585 |                   10 |
    | DEFAULT_581b3_00007 | TERMINATED |       |           16 |  256 |  256 | 0.00980314  | 1.35217 |     0.5758 |                   10 |
    | DEFAULT_581b3_00008 | TERMINATED |       |            8 |   64 |   16 | 0.0396223   | 2.31095 |     0.0983 |                    1 |
    | DEFAULT_581b3_00009 | TERMINATED |       |            2 |   16 |    4 | 0.000280285 | 1.92995 |     0.2352 |                    1 |
    +---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+


    Best trial config: {'l1': 128, 'l2': 16, 'lr': 0.010195717798352039, 'batch_size': 16}
    Best trial final validation loss: 1.331880284309387
    Best trial final validation accuracy: 0.5585
    Files already downloaded and verified
    Files already downloaded and verified
    Best trial test set accuracy: 0.5583


If you run the code, an example output could look like this:

.. code-block::

    Number of trials: 10 (10 TERMINATED)
    +-----+------+------+-------------+--------------+---------+------------+--------------------+
    | ... |   l1 |   l2 |          lr |   batch_size |    loss |   accuracy | training_iteration |
    |-----+------+------+-------------+--------------+---------+------------+--------------------|
    | ... |   64 |    4 | 0.00011629  |            2 | 1.87273 |     0.244  |                  2 |
    | ... |   32 |   64 | 0.000339763 |            8 | 1.23603 |     0.567  |                  8 |
    | ... |    8 |   16 | 0.00276249  |           16 | 1.1815  |     0.5836 |                 10 |
    | ... |    4 |   64 | 0.000648721 |            4 | 1.31131 |     0.5224 |                  8 |
    | ... |   32 |   16 | 0.000340753 |            8 | 1.26454 |     0.5444 |                  8 |
    | ... |    8 |    4 | 0.000699775 |            8 | 1.99594 |     0.1983 |                  2 |
    | ... |  256 |    8 | 0.0839654   |           16 | 2.3119  |     0.0993 |                  1 |
    | ... |   16 |  128 | 0.0758154   |           16 | 2.33575 |     0.1327 |                  1 |
    | ... |   16 |    8 | 0.0763312   |           16 | 2.31129 |     0.1042 |                  4 |
    | ... |  128 |   16 | 0.000124903 |            4 | 2.26917 |     0.1945 |                  1 |
    +-----+------+------+-------------+--------------+---------+------------+--------------------+


    Best trial config: {'l1': 8, 'l2': 16, 'lr': 0.00276249, 'batch_size': 16, 'data_dir': '...'}
    Best trial final validation loss: 1.181501
    Best trial final validation accuracy: 0.5836
    Best trial test set accuracy: 0.5806

Most trials have been stopped early in order to avoid wasting resources.
The best performing trial achieved a validation accuracy of about 58%, which could
be confirmed on the test set.

So that's it! You can now tune the parameters of your PyTorch models.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 4 minutes  5.032 seconds)


.. _sphx_glr_download_beginner_hyperparameter_tuning_tutorial.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download

     :download:`Download Python source code: hyperparameter_tuning_tutorial.py <hyperparameter_tuning_tutorial.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: hyperparameter_tuning_tutorial.ipynb <hyperparameter_tuning_tutorial.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.readthedocs.io>`_
