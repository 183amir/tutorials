.. note::
    :class: sphx-glr-download-link-note

    Click :ref:`here <sphx_glr_download_beginner_hyperparameter_tuning_tutorial.py>` to download the full example code
.. rst-class:: sphx-glr-example-title

.. _sphx_glr_beginner_hyperparameter_tuning_tutorial.py:


Hyperparameter tuning with Ray Tune
===================================

Hyperparameter tuning can make the difference between an average model and a highly
accurate one. Often simple things like choosing a different learning rate or changing
a network layer size can have a dramatic impact on your model performance.

Fortunately, there are tools that help with finding the best combination of parameters.
`Ray Tune <https://docs.ray.io/en/latest/tune.html>`_ is an industry standard tool for
distributed hyperparameter tuning. Ray Tune includes the latest hyperparameter search
algorithms, integrates with TensorBoard and other analysis libraries, and natively
supports distributed training through `Ray's distributed machine learning engine
<https://ray.io/>`_.

In this tutorial, we will show you how to integrate Ray Tune into your PyTorch
training workflow. We will extend `this tutorial from the PyTorch documentation
<https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html>`_ for training
a CIFAR10 image classifier.

As you will see, we only need to add some slight modifications. In particular, we
need to

1. wrap data loading and training in functions,
2. make some network parameters configurable,
3. add checkpointing (optional),
4. and define the search space for the model tuning

|

To run this tutorial, please make sure the following packages are
installed:

-  ``ray[tune]``: Distributed hyperparameter tuning library
-  ``torchvision``: For the data transformers

Setup / Imports
---------------
Let's start with the imports:


.. code-block:: default

    from functools import partial
    import numpy as np
    import os
    import torch
    import torch.nn as nn
    import torch.nn.functional as F
    import torch.optim as optim
    from torch.utils.data import random_split
    import torchvision
    import torchvision.transforms as transforms
    from ray import tune
    from ray.tune import CLIReporter
    from ray.tune.schedulers import ASHAScheduler







Most of the imports are needed for building the PyTorch model. Only the last three
imports are for Ray Tune.

Data loaders
------------
We wrap the data loaders in their own function and pass a global data directory.
This way we can share a data directory between different trials.


.. code-block:: default



    def load_data(data_dir="./data"):
        transform = transforms.Compose([
            transforms.ToTensor(),
            transforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5))
        ])

        trainset = torchvision.datasets.CIFAR10(
            root=data_dir, train=True, download=True, transform=transform)

        testset = torchvision.datasets.CIFAR10(
            root=data_dir, train=False, download=True, transform=transform)

        return trainset, testset







Configurable neural network
---------------------------
We can only tune those parameters that are configurable. In this example, we can specify
the layer sizes of the fully connected layers:


.. code-block:: default



    class Net(nn.Module):
        def __init__(self, l1=120, l2=84):
            super(Net, self).__init__()
            self.conv1 = nn.Conv2d(3, 6, 5)
            self.pool = nn.MaxPool2d(2, 2)
            self.conv2 = nn.Conv2d(6, 16, 5)
            self.fc1 = nn.Linear(16 * 5 * 5, l1)
            self.fc2 = nn.Linear(l1, l2)
            self.fc3 = nn.Linear(l2, 10)

        def forward(self, x):
            x = self.pool(F.relu(self.conv1(x)))
            x = self.pool(F.relu(self.conv2(x)))
            x = x.view(-1, 16 * 5 * 5)
            x = F.relu(self.fc1(x))
            x = F.relu(self.fc2(x))
            x = self.fc3(x)
            return x







The train function
------------------
Now it gets interesting, because we introduce some changes to the example `from the PyTorch
documentation <https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html>`_.

We wrap the training script in a function ``train_cifar(config, checkpoint_dir=None, data_dir=None)``.
As you can guess, the ``config`` parameter will receive the hyperparameters we would like to
train with. The ``checkpoint_dir`` parameter is used to restore checkpoints. The ``data_dir`` specifies
the directory where we load and store the data, so multiple runs can share the same data source.

.. code-block:: python

    net = Net(config["l1"], config["l2"])

    if checkpoint_dir:
        model_state, optimizer_state = torch.load(
            os.path.join(checkpoint_dir, "checkpoint"))
        net.load_state_dict(model_state)
        optimizer.load_state_dict(optimizer_state)

The learning rate of the optimizer is made configurable, too:

.. code-block:: python

    optimizer = optim.SGD(net.parameters(), lr=config["lr"], momentum=0.9)

We also split the training data into a training and validation subset. We thus train on
80% of the data and calculate the validation loss on the remaining 20%. The batch sizes
with which we iterate through the training and test sets are configurable as well.

Adding (multi) GPU support with DataParallel
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Image classification benefits largely from GPUs. Luckily, we can continue to use
PyTorch's abstractions in Ray Tune. Thus, we can wrap our model in ``nn.DataParallel``
to support data parallel training on multiple GPUs:

.. code-block:: python

    device = "cpu"
    if torch.cuda.is_available():
        device = "cuda:0"
        if torch.cuda.device_count() > 1:
            net = nn.DataParallel(net)
    net.to(device)

By using a ``device`` variable we make sure that training also works when we have
no GPUs available. PyTorch requires us to send our data to the GPU memory explicitly,
like this:

.. code-block:: python

    for i, data in enumerate(trainloader, 0):
        inputs, labels = data
        inputs, labels = inputs.to(device), labels.to(device)

The code now supports training on CPUs, on a single GPU, and on multiple GPUs. Notably, Ray
also supports `fractional GPUs <https://docs.ray.io/en/master/using-ray-with-gpus.html#fractional-gpus>`_
so we can share GPUs among trials, as long as the model still fits on the GPU memory. We'll come back
to that later.

Communicating with Ray Tune
~~~~~~~~~~~~~~~~~~~~~~~~~~~

The most interesting part is the communication with Ray Tune:

.. code-block:: python

    with tune.checkpoint_dir(epoch) as checkpoint_dir:
        path = os.path.join(checkpoint_dir, "checkpoint")
        torch.save((net.state_dict(), optimizer.state_dict()), path)

    tune.report(loss=(val_loss / val_steps), accuracy=correct / total)

Here we first save a checkpoint and then report some metrics back to Ray Tune. Specifically,
we send the validation loss and accuracy back to Ray Tune. Ray Tune can then use these metrics
to decide which hyperparameter configuration lead to the best results. These metrics
can also be used to stop bad performing trials early in order to avoid wasting
resources on those trials.

The checkpoint saving is optional, however, it is necessary if we wanted to use advanced
schedulers like
`Population Based Training <https://docs.ray.io/en/master/tune/tutorials/tune-advanced-tutorial.html>`_.
Also, by saving the checkpoint we can later load the trained models and validate them
on a test set.

Full training function
~~~~~~~~~~~~~~~~~~~~~~

The full code example looks like this:


.. code-block:: default



    def train_cifar(config, checkpoint_dir=None, data_dir=None):
        net = Net(config["l1"], config["l2"])

        device = "cpu"
        if torch.cuda.is_available():
            device = "cuda:0"
            if torch.cuda.device_count() > 1:
                net = nn.DataParallel(net)
        net.to(device)

        criterion = nn.CrossEntropyLoss()
        optimizer = optim.SGD(net.parameters(), lr=config["lr"], momentum=0.9)

        if checkpoint_dir:
            model_state, optimizer_state = torch.load(
                os.path.join(checkpoint_dir, "checkpoint"))
            net.load_state_dict(model_state)
            optimizer.load_state_dict(optimizer_state)

        trainset, testset = load_data(data_dir)

        test_abs = int(len(trainset) * 0.8)
        train_subset, val_subset = random_split(
            trainset, [test_abs, len(trainset) - test_abs])

        trainloader = torch.utils.data.DataLoader(
            train_subset,
            batch_size=int(config["batch_size"]),
            shuffle=True,
            num_workers=8)
        valloader = torch.utils.data.DataLoader(
            val_subset,
            batch_size=int(config["batch_size"]),
            shuffle=True,
            num_workers=8)

        for epoch in range(10):  # loop over the dataset multiple times
            running_loss = 0.0
            epoch_steps = 0
            for i, data in enumerate(trainloader, 0):
                # get the inputs; data is a list of [inputs, labels]
                inputs, labels = data
                inputs, labels = inputs.to(device), labels.to(device)

                # zero the parameter gradients
                optimizer.zero_grad()

                # forward + backward + optimize
                outputs = net(inputs)
                loss = criterion(outputs, labels)
                loss.backward()
                optimizer.step()

                # print statistics
                running_loss += loss.item()
                epoch_steps += 1
                if i % 2000 == 1999:  # print every 2000 mini-batches
                    print("[%d, %5d] loss: %.3f" % (epoch + 1, i + 1,
                                                    running_loss / epoch_steps))
                    running_loss = 0.0

            # Validation loss
            val_loss = 0.0
            val_steps = 0
            total = 0
            correct = 0
            for i, data in enumerate(valloader, 0):
                with torch.no_grad():
                    inputs, labels = data
                    inputs, labels = inputs.to(device), labels.to(device)

                    outputs = net(inputs)
                    _, predicted = torch.max(outputs.data, 1)
                    total += labels.size(0)
                    correct += (predicted == labels).sum().item()

                    loss = criterion(outputs, labels)
                    val_loss += loss.cpu().numpy()
                    val_steps += 1

            with tune.checkpoint_dir(epoch) as checkpoint_dir:
                path = os.path.join(checkpoint_dir, "checkpoint")
                torch.save((net.state_dict(), optimizer.state_dict()), path)

            tune.report(loss=(val_loss / val_steps), accuracy=correct / total)
        print("Finished Training")







As you can see, most of the code is adapted directly from the original example.

Test set accuracy
-----------------
Commonly the performance of a machine learning model is tested on a hold-out test
set with data that has not been used for training the model. We also wrap this in a
function:


.. code-block:: default



    def test_accuracy(net, device="cpu"):
        trainset, testset = load_data()

        testloader = torch.utils.data.DataLoader(
            testset, batch_size=4, shuffle=False, num_workers=2)

        correct = 0
        total = 0
        with torch.no_grad():
            for data in testloader:
                images, labels = data
                images, labels = images.to(device), labels.to(device)
                outputs = net(images)
                _, predicted = torch.max(outputs.data, 1)
                total += labels.size(0)
                correct += (predicted == labels).sum().item()

        return correct / total







The function also expects a ``device`` parameter, so we can do the
test set validation on a GPU.

Configuring the search space
----------------------------
Lastly, we need to define Ray Tune's search space. Here is an example:

.. code-block:: python

    config = {
        "l1": tune.sample_from(lambda _: 2**np.random.randint(2, 9)),
        "l2": tune.sample_from(lambda _: 2**np.random.randint(2, 9)),
        "lr": tune.loguniform(1e-4, 1e-1),
        "batch_size": tune.choice([2, 4, 8, 16])
    }

The ``tune.sample_from()`` function makes it possible to define your own sample
methods to obtain hyperparameters. In this example, the ``l1`` and ``l2`` parameters
should be powers of 2 between 4 and 256, so either 4, 8, 16, 32, 64, 128, or 256.
The ``lr`` (learning rate) should be uniformly sampled between 0.0001 and 0.1. Lastly,
the batch size is a choice between 2, 4, 8, and 16.

At each trial, Ray Tune will now randomly sample a combination of parameters from these
search spaces. It will then train a number of models in parallel and find the best
performing one among these. We also use the ``ASHAScheduler`` which will terminate bad
performing trials early.

We wrap the ``train_cifar`` function with ``functools.partial`` to set the constant
``data_dir`` parameter. We can also tell Ray Tune what resources should be
available for each trial:

.. code-block:: python

    gpus_per_trial = 2
    # ...
    result = tune.run(
        partial(train_cifar, data_dir=data_dir),
        resources_per_trial={"cpu": 8, "gpu": gpus_per_trial},
        config=config,
        num_samples=num_samples,
        scheduler=scheduler,
        progress_reporter=reporter,
        checkpoint_at_end=True)

You can specify the number of CPUs, which are then available e.g.
to increase the ``num_workers`` of the PyTorch ``DataLoader`` instances. The selected
number of GPUs are made visible to PyTorch in each trial. Trials do not have access to
GPUs that haven't been requested for them - so you don't have to care about two trials
using the same set of resources.

Here we can also specify fractional GPUs, so something like ``gpus_per_trial=0.5`` is
completely valid. The trials will then share GPUs among each other.
You just have to make sure that the models still fit in the GPU memory.

After training the models, we will find the best performing one and load the trained
network from the checkpoint file. We then obtain the test set accuracy and report
everything by printing.

The full main function looks like this:


.. code-block:: default



    def main(num_samples=10, max_num_epochs=10, gpus_per_trial=2):
        data_dir = os.path.abspath("./data")
        load_data(data_dir)
        config = {
            "l1": tune.sample_from(lambda _: 2 ** np.random.randint(2, 9)),
            "l2": tune.sample_from(lambda _: 2 ** np.random.randint(2, 9)),
            "lr": tune.loguniform(1e-4, 1e-1),
            "batch_size": tune.choice([2, 4, 8, 16])
        }
        scheduler = ASHAScheduler(
            metric="loss",
            mode="min",
            max_t=max_num_epochs,
            grace_period=1,
            reduction_factor=2)
        reporter = CLIReporter(
            # parameter_columns=["l1", "l2", "lr", "batch_size"],
            metric_columns=["loss", "accuracy", "training_iteration"])
        result = tune.run(
            partial(train_cifar, data_dir=data_dir),
            resources_per_trial={"cpu": 2, "gpu": gpus_per_trial},
            config=config,
            num_samples=num_samples,
            scheduler=scheduler,
            progress_reporter=reporter)

        best_trial = result.get_best_trial("loss", "min", "last")
        print("Best trial config: {}".format(best_trial.config))
        print("Best trial final validation loss: {}".format(
            best_trial.last_result["loss"]))
        print("Best trial final validation accuracy: {}".format(
            best_trial.last_result["accuracy"]))

        best_trained_model = Net(best_trial.config["l1"], best_trial.config["l2"])
        device = "cpu"
        if torch.cuda.is_available():
            device = "cuda:0"
            if gpus_per_trial > 1:
                best_trained_model = nn.DataParallel(best_trained_model)
        best_trained_model.to(device)

        best_checkpoint_dir = best_trial.checkpoint.value
        model_state, optimizer_state = torch.load(os.path.join(
            best_checkpoint_dir, "checkpoint"))
        best_trained_model.load_state_dict(model_state)

        test_acc = test_accuracy(best_trained_model, device)
        print("Best trial test set accuracy: {}".format(test_acc))


    if __name__ == "__main__":
        # You can change the number of GPUs per trial here:
        main(num_samples=10, max_num_epochs=10, gpus_per_trial=0)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz
    Extracting /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data
    Files already downloaded and verified
    == Status ==
    Memory usage on this node: 4.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=0
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: None
    Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 1/10 (1 RUNNING)
    +---------------------+----------+-------+--------------+------+------+-----------+
    | Trial name          | status   | loc   |   batch_size |   l1 |   l2 |        lr |
    |---------------------+----------+-------+--------------+------+------+-----------|
    | DEFAULT_83a82_00000 | RUNNING  |       |            8 |   32 |  256 | 0.0185408 |
    +---------------------+----------+-------+--------------+------+------+-----------+


    [2m[36m(pid=1424)[0m Files already downloaded and verified
    [2m[36m(pid=1426)[0m Files already downloaded and verified
    [2m[36m(pid=1428)[0m Files already downloaded and verified
    [2m[36m(pid=1470)[0m Files already downloaded and verified
    [2m[36m(pid=1480)[0m Files already downloaded and verified
    [2m[36m(pid=1450)[0m Files already downloaded and verified
    [2m[36m(pid=1445)[0m Files already downloaded and verified
    [2m[36m(pid=1435)[0m Files already downloaded and verified
    [2m[36m(pid=1442)[0m Files already downloaded and verified
    [2m[36m(pid=1425)[0m Files already downloaded and verified
    [2m[36m(pid=1424)[0m Files already downloaded and verified
    [2m[36m(pid=1426)[0m Files already downloaded and verified
    [2m[36m(pid=1428)[0m Files already downloaded and verified
    [2m[36m(pid=1470)[0m Files already downloaded and verified
    [2m[36m(pid=1480)[0m Files already downloaded and verified
    [2m[36m(pid=1450)[0m Files already downloaded and verified
    [2m[36m(pid=1445)[0m Files already downloaded and verified
    [2m[36m(pid=1442)[0m Files already downloaded and verified
    [2m[36m(pid=1435)[0m Files already downloaded and verified
    [2m[36m(pid=1425)[0m Files already downloaded and verified
    [2m[36m(pid=1470)[0m [1,  2000] loss: 2.121
    [2m[36m(pid=1450)[0m [1,  2000] loss: 2.302
    [2m[36m(pid=1445)[0m [1,  2000] loss: 2.257
    [2m[36m(pid=1426)[0m [1,  2000] loss: 2.109
    [2m[36m(pid=1442)[0m [1,  2000] loss: 2.308
    [2m[36m(pid=1425)[0m [1,  2000] loss: 2.035
    [2m[36m(pid=1424)[0m [1,  2000] loss: 2.235
    [2m[36m(pid=1428)[0m [1,  2000] loss: 1.821
    [2m[36m(pid=1435)[0m [1,  2000] loss: 1.985
    [2m[36m(pid=1480)[0m [1,  2000] loss: 2.298
    [2m[36m(pid=1470)[0m [1,  4000] loss: 0.935
    [2m[36m(pid=1450)[0m [1,  4000] loss: 1.150
    [2m[36m(pid=1445)[0m [1,  4000] loss: 0.996
    Result for DEFAULT_83a82_00007:
      accuracy: 0.4291
      date: 2021-04-20_03-14-55
      done: false
      experiment_id: 8e3d61e0ffe2422c9053ba190cb9370c
      hostname: c531aa93f18a
      iterations_since_restore: 1
      loss: 1.542469201183319
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 27.083168268203735
      time_this_iter_s: 27.083168268203735
      time_total_s: 27.083168268203735
      timestamp: 1618888495
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 83a82_00007
  
    == Status ==
    Memory usage on this node: 9.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=0
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -1.542469201183319
    Resources requested: 20/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (10 RUNNING)
    +---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status   | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00000 | RUNNING  |                 |            8 |   32 |  256 | 0.0185408   |         |            |                      |
    | DEFAULT_83a82_00001 | RUNNING  |                 |            2 |   64 |   64 | 0.00194273  |         |            |                      |
    | DEFAULT_83a82_00002 | RUNNING  |                 |            2 |  128 |  256 | 0.000709167 |         |            |                      |
    | DEFAULT_83a82_00003 | RUNNING  |                 |            8 |    8 |   64 | 0.045707    |         |            |                      |
    | DEFAULT_83a82_00004 | RUNNING  |                 |            4 |  256 |   16 | 0.00955948  |         |            |                      |
    | DEFAULT_83a82_00005 | RUNNING  |                 |            2 |   64 |   64 | 0.000171127 |         |            |                      |
    | DEFAULT_83a82_00006 | RUNNING  |                 |           16 |  128 |   64 | 0.00258565  |         |            |                      |
    | DEFAULT_83a82_00007 | RUNNING  | 172.17.0.2:1428 |           16 |   64 |   16 | 0.00850861  | 1.54247 |     0.4291 |                    1 |
    | DEFAULT_83a82_00008 | RUNNING  |                 |            8 |   64 |  256 | 0.000790146 |         |            |                      |
    | DEFAULT_83a82_00009 | RUNNING  |                 |           16 |    4 |  128 | 0.000480011 |         |            |                      |
    +---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1426)[0m [1,  4000] loss: 0.988
    Result for DEFAULT_83a82_00006:
      accuracy: 0.3945
      date: 2021-04-20_03-14-56
      done: true
      experiment_id: bb31ed29c10942ee8754b2c0d37924ef
      hostname: c531aa93f18a
      iterations_since_restore: 1
      loss: 1.6681244615554809
      node_ip: 172.17.0.2
      pid: 1435
      should_checkpoint: true
      time_since_restore: 27.435827016830444
      time_this_iter_s: 27.435827016830444
      time_total_s: 27.435827016830444
      timestamp: 1618888496
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 83a82_00006
  
    Result for DEFAULT_83a82_00009:
      accuracy: 0.1643
      date: 2021-04-20_03-14-56
      done: true
      experiment_id: 98b0efb5e6dd430894d07d5d2d698616
      hostname: c531aa93f18a
      iterations_since_restore: 1
      loss: 2.2295412757873536
      node_ip: 172.17.0.2
      pid: 1480
      should_checkpoint: true
      time_since_restore: 27.475823879241943
      time_this_iter_s: 27.475823879241943
      time_total_s: 27.475823879241943
      timestamp: 1618888496
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 83a82_00009
  
    [2m[36m(pid=1442)[0m [1,  4000] loss: 1.158
    [2m[36m(pid=1425)[0m [1,  4000] loss: 0.973
    [2m[36m(pid=1424)[0m [1,  4000] loss: 0.914
    [2m[36m(pid=1470)[0m [1,  6000] loss: 0.583
    [2m[36m(pid=1450)[0m [1,  6000] loss: 0.765
    [2m[36m(pid=1445)[0m [1,  6000] loss: 0.595
    [2m[36m(pid=1426)[0m [1,  6000] loss: 0.645
    Result for DEFAULT_83a82_00003:
      accuracy: 0.0974
      date: 2021-04-20_03-15-07
      done: true
      experiment_id: f1c705adcca643919f374e0417426f54
      hostname: c531aa93f18a
      iterations_since_restore: 1
      loss: 2.3058934909820556
      node_ip: 172.17.0.2
      pid: 1442
      should_checkpoint: true
      time_since_restore: 38.82278275489807
      time_this_iter_s: 38.82278275489807
      time_total_s: 38.82278275489807
      timestamp: 1618888507
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 83a82_00003
  
    == Status ==
    Memory usage on this node: 8.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=3
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -1.9488328686714174
    Resources requested: 16/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00000 | RUNNING    |                 |            8 |   32 |  256 | 0.0185408   |         |            |                      |
    | DEFAULT_83a82_00001 | RUNNING    |                 |            2 |   64 |   64 | 0.00194273  |         |            |                      |
    | DEFAULT_83a82_00002 | RUNNING    |                 |            2 |  128 |  256 | 0.000709167 |         |            |                      |
    | DEFAULT_83a82_00003 | RUNNING    | 172.17.0.2:1442 |            8 |    8 |   64 | 0.045707    | 2.30589 |     0.0974 |                    1 |
    | DEFAULT_83a82_00004 | RUNNING    |                 |            4 |  256 |   16 | 0.00955948  |         |            |                      |
    | DEFAULT_83a82_00005 | RUNNING    |                 |            2 |   64 |   64 | 0.000171127 |         |            |                      |
    | DEFAULT_83a82_00007 | RUNNING    | 172.17.0.2:1428 |           16 |   64 |   16 | 0.00850861  | 1.54247 |     0.4291 |                    1 |
    | DEFAULT_83a82_00008 | RUNNING    |                 |            8 |   64 |  256 | 0.000790146 |         |            |                      |
    | DEFAULT_83a82_00006 | TERMINATED |                 |           16 |  128 |   64 | 0.00258565  | 1.66812 |     0.3945 |                    1 |
    | DEFAULT_83a82_00009 | TERMINATED |                 |           16 |    4 |  128 | 0.000480011 | 2.22954 |     0.1643 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_83a82_00000:
      accuracy: 0.2617
      date: 2021-04-20_03-15-08
      done: true
      experiment_id: 47a1170292524207ad28dcba148e94d5
      hostname: c531aa93f18a
      iterations_since_restore: 1
      loss: 1.9510039323806763
      node_ip: 172.17.0.2
      pid: 1425
      should_checkpoint: true
      time_since_restore: 39.47302055358887
      time_this_iter_s: 39.47302055358887
      time_total_s: 39.47302055358887
      timestamp: 1618888508
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 83a82_00000
  
    Result for DEFAULT_83a82_00008:
      accuracy: 0.4137
      date: 2021-04-20_03-15-08
      done: false
      experiment_id: ad343400d7034fa88f941da16daa4ef7
      hostname: c531aa93f18a
      iterations_since_restore: 1
      loss: 1.590196353006363
      node_ip: 172.17.0.2
      pid: 1424
      should_checkpoint: true
      time_since_restore: 40.216299295425415
      time_this_iter_s: 40.216299295425415
      time_total_s: 40.216299295425415
      timestamp: 1618888508
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 83a82_00008
  
    [2m[36m(pid=1428)[0m [2,  2000] loss: 1.458
    [2m[36m(pid=1470)[0m [1,  8000] loss: 0.426
    [2m[36m(pid=1450)[0m [1,  8000] loss: 0.568
    [2m[36m(pid=1445)[0m [1,  8000] loss: 0.422
    Result for DEFAULT_83a82_00007:
      accuracy: 0.5069
      date: 2021-04-20_03-15-16
      done: false
      experiment_id: 8e3d61e0ffe2422c9053ba190cb9370c
      hostname: c531aa93f18a
      iterations_since_restore: 2
      loss: 1.3765839880943298
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 47.62844204902649
      time_this_iter_s: 20.545273780822754
      time_total_s: 47.62844204902649
      timestamp: 1618888516
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 83a82_00007
  
    == Status ==
    Memory usage on this node: 7.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=4
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.3765839880943298 | Iter 1.000: -1.8095641969680787
    Resources requested: 12/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00001 | RUNNING    |                 |            2 |   64 |   64 | 0.00194273  |         |            |                      |
    | DEFAULT_83a82_00002 | RUNNING    |                 |            2 |  128 |  256 | 0.000709167 |         |            |                      |
    | DEFAULT_83a82_00004 | RUNNING    |                 |            4 |  256 |   16 | 0.00955948  |         |            |                      |
    | DEFAULT_83a82_00005 | RUNNING    |                 |            2 |   64 |   64 | 0.000171127 |         |            |                      |
    | DEFAULT_83a82_00007 | RUNNING    | 172.17.0.2:1428 |           16 |   64 |   16 | 0.00850861  | 1.37658 |     0.5069 |                    2 |
    | DEFAULT_83a82_00008 | RUNNING    | 172.17.0.2:1424 |            8 |   64 |  256 | 0.000790146 | 1.5902  |     0.4137 |                    1 |
    | DEFAULT_83a82_00000 | TERMINATED |                 |            8 |   32 |  256 | 0.0185408   | 1.951   |     0.2617 |                    1 |
    | DEFAULT_83a82_00003 | TERMINATED |                 |            8 |    8 |   64 | 0.045707    | 2.30589 |     0.0974 |                    1 |
    | DEFAULT_83a82_00006 | TERMINATED |                 |           16 |  128 |   64 | 0.00258565  | 1.66812 |     0.3945 |                    1 |
    | DEFAULT_83a82_00009 | TERMINATED |                 |           16 |    4 |  128 | 0.000480011 | 2.22954 |     0.1643 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1426)[0m [1,  8000] loss: 0.483
    [2m[36m(pid=1470)[0m [1, 10000] loss: 0.333
    [2m[36m(pid=1424)[0m [2,  2000] loss: 1.574
    [2m[36m(pid=1450)[0m [1, 10000] loss: 0.436
    [2m[36m(pid=1445)[0m [1, 10000] loss: 0.325
    [2m[36m(pid=1426)[0m [1, 10000] loss: 0.388
    [2m[36m(pid=1470)[0m [1, 12000] loss: 0.269
    [2m[36m(pid=1450)[0m [1, 12000] loss: 0.344
    [2m[36m(pid=1428)[0m [3,  2000] loss: 1.337
    [2m[36m(pid=1445)[0m [1, 12000] loss: 0.264
    [2m[36m(pid=1424)[0m [2,  4000] loss: 0.743
    Result for DEFAULT_83a82_00004:
      accuracy: 0.301
      date: 2021-04-20_03-15-33
      done: true
      experiment_id: dbb7aa252a7e4847a023f3a973599f8f
      hostname: c531aa93f18a
      iterations_since_restore: 1
      loss: 1.9030191129684448
      node_ip: 172.17.0.2
      pid: 1426
      should_checkpoint: true
      time_since_restore: 64.34403491020203
      time_this_iter_s: 64.34403491020203
      time_total_s: 64.34403491020203
      timestamp: 1618888533
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 83a82_00004
  
    == Status ==
    Memory usage on this node: 7.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.3765839880943298 | Iter 1.000: -1.9030191129684448
    Resources requested: 12/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00001 | RUNNING    |                 |            2 |   64 |   64 | 0.00194273  |         |            |                      |
    | DEFAULT_83a82_00002 | RUNNING    |                 |            2 |  128 |  256 | 0.000709167 |         |            |                      |
    | DEFAULT_83a82_00004 | RUNNING    | 172.17.0.2:1426 |            4 |  256 |   16 | 0.00955948  | 1.90302 |     0.301  |                    1 |
    | DEFAULT_83a82_00005 | RUNNING    |                 |            2 |   64 |   64 | 0.000171127 |         |            |                      |
    | DEFAULT_83a82_00007 | RUNNING    | 172.17.0.2:1428 |           16 |   64 |   16 | 0.00850861  | 1.37658 |     0.5069 |                    2 |
    | DEFAULT_83a82_00008 | RUNNING    | 172.17.0.2:1424 |            8 |   64 |  256 | 0.000790146 | 1.5902  |     0.4137 |                    1 |
    | DEFAULT_83a82_00000 | TERMINATED |                 |            8 |   32 |  256 | 0.0185408   | 1.951   |     0.2617 |                    1 |
    | DEFAULT_83a82_00003 | TERMINATED |                 |            8 |    8 |   64 | 0.045707    | 2.30589 |     0.0974 |                    1 |
    | DEFAULT_83a82_00006 | TERMINATED |                 |           16 |  128 |   64 | 0.00258565  | 1.66812 |     0.3945 |                    1 |
    | DEFAULT_83a82_00009 | TERMINATED |                 |           16 |    4 |  128 | 0.000480011 | 2.22954 |     0.1643 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1470)[0m [1, 14000] loss: 0.228
    Result for DEFAULT_83a82_00007:
      accuracy: 0.536
      date: 2021-04-20_03-15-35
      done: false
      experiment_id: 8e3d61e0ffe2422c9053ba190cb9370c
      hostname: c531aa93f18a
      iterations_since_restore: 3
      loss: 1.318748707485199
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 67.30464243888855
      time_this_iter_s: 19.67620038986206
      time_total_s: 67.30464243888855
      timestamp: 1618888535
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: 83a82_00007
  
    [2m[36m(pid=1450)[0m [1, 14000] loss: 0.284
    [2m[36m(pid=1445)[0m [1, 14000] loss: 0.222
    Result for DEFAULT_83a82_00008:
      accuracy: 0.4939
      date: 2021-04-20_03-15-40
      done: true
      experiment_id: ad343400d7034fa88f941da16daa4ef7
      hostname: c531aa93f18a
      iterations_since_restore: 2
      loss: 1.4147543246269225
      node_ip: 172.17.0.2
      pid: 1424
      should_checkpoint: true
      time_since_restore: 71.86769151687622
      time_this_iter_s: 31.651392221450806
      time_total_s: 71.86769151687622
      timestamp: 1618888540
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 83a82_00008
  
    == Status ==
    Memory usage on this node: 6.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.395669156360626 | Iter 1.000: -1.9030191129684448
    Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00001 | RUNNING    |                 |            2 |   64 |   64 | 0.00194273  |         |            |                      |
    | DEFAULT_83a82_00002 | RUNNING    |                 |            2 |  128 |  256 | 0.000709167 |         |            |                      |
    | DEFAULT_83a82_00005 | RUNNING    |                 |            2 |   64 |   64 | 0.000171127 |         |            |                      |
    | DEFAULT_83a82_00007 | RUNNING    | 172.17.0.2:1428 |           16 |   64 |   16 | 0.00850861  | 1.31875 |     0.536  |                    3 |
    | DEFAULT_83a82_00008 | RUNNING    | 172.17.0.2:1424 |            8 |   64 |  256 | 0.000790146 | 1.41475 |     0.4939 |                    2 |
    | DEFAULT_83a82_00000 | TERMINATED |                 |            8 |   32 |  256 | 0.0185408   | 1.951   |     0.2617 |                    1 |
    | DEFAULT_83a82_00003 | TERMINATED |                 |            8 |    8 |   64 | 0.045707    | 2.30589 |     0.0974 |                    1 |
    | DEFAULT_83a82_00004 | TERMINATED |                 |            4 |  256 |   16 | 0.00955948  | 1.90302 |     0.301  |                    1 |
    | DEFAULT_83a82_00006 | TERMINATED |                 |           16 |  128 |   64 | 0.00258565  | 1.66812 |     0.3945 |                    1 |
    | DEFAULT_83a82_00009 | TERMINATED |                 |           16 |    4 |  128 | 0.000480011 | 2.22954 |     0.1643 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1470)[0m [1, 16000] loss: 0.198
    [2m[36m(pid=1450)[0m [1, 16000] loss: 0.241
    [2m[36m(pid=1445)[0m [1, 16000] loss: 0.191
    [2m[36m(pid=1428)[0m [4,  2000] loss: 1.271
    [2m[36m(pid=1470)[0m [1, 18000] loss: 0.171
    [2m[36m(pid=1450)[0m [1, 18000] loss: 0.204
    Result for DEFAULT_83a82_00007:
      accuracy: 0.5581
      date: 2021-04-20_03-15-54
      done: false
      experiment_id: 8e3d61e0ffe2422c9053ba190cb9370c
      hostname: c531aa93f18a
      iterations_since_restore: 4
      loss: 1.2669007039546967
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 86.21500635147095
      time_this_iter_s: 18.910363912582397
      time_total_s: 86.21500635147095
      timestamp: 1618888554
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: 83a82_00007
  
    == Status ==
    Memory usage on this node: 6.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: None | Iter 4.000: -1.2669007039546967 | Iter 2.000: -1.395669156360626 | Iter 1.000: -1.9030191129684448
    Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00001 | RUNNING    |                 |            2 |   64 |   64 | 0.00194273  |         |            |                      |
    | DEFAULT_83a82_00002 | RUNNING    |                 |            2 |  128 |  256 | 0.000709167 |         |            |                      |
    | DEFAULT_83a82_00005 | RUNNING    |                 |            2 |   64 |   64 | 0.000171127 |         |            |                      |
    | DEFAULT_83a82_00007 | RUNNING    | 172.17.0.2:1428 |           16 |   64 |   16 | 0.00850861  | 1.2669  |     0.5581 |                    4 |
    | DEFAULT_83a82_00000 | TERMINATED |                 |            8 |   32 |  256 | 0.0185408   | 1.951   |     0.2617 |                    1 |
    | DEFAULT_83a82_00003 | TERMINATED |                 |            8 |    8 |   64 | 0.045707    | 2.30589 |     0.0974 |                    1 |
    | DEFAULT_83a82_00004 | TERMINATED |                 |            4 |  256 |   16 | 0.00955948  | 1.90302 |     0.301  |                    1 |
    | DEFAULT_83a82_00006 | TERMINATED |                 |           16 |  128 |   64 | 0.00258565  | 1.66812 |     0.3945 |                    1 |
    | DEFAULT_83a82_00008 | TERMINATED |                 |            8 |   64 |  256 | 0.000790146 | 1.41475 |     0.4939 |                    2 |
    | DEFAULT_83a82_00009 | TERMINATED |                 |           16 |    4 |  128 | 0.000480011 | 2.22954 |     0.1643 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1445)[0m [1, 18000] loss: 0.164
    [2m[36m(pid=1470)[0m [1, 20000] loss: 0.155
    [2m[36m(pid=1450)[0m [1, 20000] loss: 0.178
    [2m[36m(pid=1445)[0m [1, 20000] loss: 0.149
    [2m[36m(pid=1428)[0m [5,  2000] loss: 1.233
    Result for DEFAULT_83a82_00001:
      accuracy: 0.4426
      date: 2021-04-20_03-16-10
      done: false
      experiment_id: cf4817101a6d44c38d8100d4cf37a4ad
      hostname: c531aa93f18a
      iterations_since_restore: 1
      loss: 1.5193329287976027
      node_ip: 172.17.0.2
      pid: 1470
      should_checkpoint: true
      time_since_restore: 101.50217890739441
      time_this_iter_s: 101.50217890739441
      time_total_s: 101.50217890739441
      timestamp: 1618888570
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 83a82_00001
  
    == Status ==
    Memory usage on this node: 6.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: None | Iter 4.000: -1.2669007039546967 | Iter 2.000: -1.395669156360626 | Iter 1.000: -1.7855717872619628
    Resources requested: 8/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00001 | RUNNING    | 172.17.0.2:1470 |            2 |   64 |   64 | 0.00194273  | 1.51933 |     0.4426 |                    1 |
    | DEFAULT_83a82_00002 | RUNNING    |                 |            2 |  128 |  256 | 0.000709167 |         |            |                      |
    | DEFAULT_83a82_00005 | RUNNING    |                 |            2 |   64 |   64 | 0.000171127 |         |            |                      |
    | DEFAULT_83a82_00007 | RUNNING    | 172.17.0.2:1428 |           16 |   64 |   16 | 0.00850861  | 1.2669  |     0.5581 |                    4 |
    | DEFAULT_83a82_00000 | TERMINATED |                 |            8 |   32 |  256 | 0.0185408   | 1.951   |     0.2617 |                    1 |
    | DEFAULT_83a82_00003 | TERMINATED |                 |            8 |    8 |   64 | 0.045707    | 2.30589 |     0.0974 |                    1 |
    | DEFAULT_83a82_00004 | TERMINATED |                 |            4 |  256 |   16 | 0.00955948  | 1.90302 |     0.301  |                    1 |
    | DEFAULT_83a82_00006 | TERMINATED |                 |           16 |  128 |   64 | 0.00258565  | 1.66812 |     0.3945 |                    1 |
    | DEFAULT_83a82_00008 | TERMINATED |                 |            8 |   64 |  256 | 0.000790146 | 1.41475 |     0.4939 |                    2 |
    | DEFAULT_83a82_00009 | TERMINATED |                 |           16 |    4 |  128 | 0.000480011 | 2.22954 |     0.1643 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_83a82_00005:
      accuracy: 0.3054
      date: 2021-04-20_03-16-12
      done: true
      experiment_id: 804ea17b888c4ccd9837af71d7256a27
      hostname: c531aa93f18a
      iterations_since_restore: 1
      loss: 1.9278167250394822
      node_ip: 172.17.0.2
      pid: 1450
      should_checkpoint: true
      time_since_restore: 103.45157504081726
      time_this_iter_s: 103.45157504081726
      time_total_s: 103.45157504081726
      timestamp: 1618888572
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 83a82_00005
  
    Result for DEFAULT_83a82_00007:
      accuracy: 0.5508
      date: 2021-04-20_03-16-13
      done: false
      experiment_id: 8e3d61e0ffe2422c9053ba190cb9370c
      hostname: c531aa93f18a
      iterations_since_restore: 5
      loss: 1.2933750185966493
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 105.23869848251343
      time_this_iter_s: 19.02369213104248
      time_total_s: 105.23869848251343
      timestamp: 1618888573
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: 83a82_00007
  
    Result for DEFAULT_83a82_00002:
      accuracy: 0.4856
      date: 2021-04-20_03-16-15
      done: false
      experiment_id: 69fa429ab6aa492c951d8b52391e0de9
      hostname: c531aa93f18a
      iterations_since_restore: 1
      loss: 1.4470756860256195
      node_ip: 172.17.0.2
      pid: 1445
      should_checkpoint: true
      time_since_restore: 106.48462390899658
      time_this_iter_s: 106.48462390899658
      time_total_s: 106.48462390899658
      timestamp: 1618888575
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 83a82_00002
  
    [2m[36m(pid=1470)[0m [2,  2000] loss: 1.513
    [2m[36m(pid=1445)[0m [2,  2000] loss: 1.409
    [2m[36m(pid=1470)[0m [2,  4000] loss: 0.774
    [2m[36m(pid=1428)[0m [6,  2000] loss: 1.191
    [2m[36m(pid=1445)[0m [2,  4000] loss: 0.693
    Result for DEFAULT_83a82_00007:
      accuracy: 0.5342
      date: 2021-04-20_03-16-32
      done: false
      experiment_id: 8e3d61e0ffe2422c9053ba190cb9370c
      hostname: c531aa93f18a
      iterations_since_restore: 6
      loss: 1.3402307774543762
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 123.74581408500671
      time_this_iter_s: 18.507115602493286
      time_total_s: 123.74581408500671
      timestamp: 1618888592
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: 83a82_00007
  
    == Status ==
    Memory usage on this node: 5.6/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: None | Iter 4.000: -1.2669007039546967 | Iter 2.000: -1.395669156360626 | Iter 1.000: -1.7855717872619628
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00001 | RUNNING    | 172.17.0.2:1470 |            2 |   64 |   64 | 0.00194273  | 1.51933 |     0.4426 |                    1 |
    | DEFAULT_83a82_00002 | RUNNING    | 172.17.0.2:1445 |            2 |  128 |  256 | 0.000709167 | 1.44708 |     0.4856 |                    1 |
    | DEFAULT_83a82_00007 | RUNNING    | 172.17.0.2:1428 |           16 |   64 |   16 | 0.00850861  | 1.34023 |     0.5342 |                    6 |
    | DEFAULT_83a82_00000 | TERMINATED |                 |            8 |   32 |  256 | 0.0185408   | 1.951   |     0.2617 |                    1 |
    | DEFAULT_83a82_00003 | TERMINATED |                 |            8 |    8 |   64 | 0.045707    | 2.30589 |     0.0974 |                    1 |
    | DEFAULT_83a82_00004 | TERMINATED |                 |            4 |  256 |   16 | 0.00955948  | 1.90302 |     0.301  |                    1 |
    | DEFAULT_83a82_00005 | TERMINATED |                 |            2 |   64 |   64 | 0.000171127 | 1.92782 |     0.3054 |                    1 |
    | DEFAULT_83a82_00006 | TERMINATED |                 |           16 |  128 |   64 | 0.00258565  | 1.66812 |     0.3945 |                    1 |
    | DEFAULT_83a82_00008 | TERMINATED |                 |            8 |   64 |  256 | 0.000790146 | 1.41475 |     0.4939 |                    2 |
    | DEFAULT_83a82_00009 | TERMINATED |                 |           16 |    4 |  128 | 0.000480011 | 2.22954 |     0.1643 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1470)[0m [2,  6000] loss: 0.508
    [2m[36m(pid=1445)[0m [2,  6000] loss: 0.457
    [2m[36m(pid=1470)[0m [2,  8000] loss: 0.375
    [2m[36m(pid=1428)[0m [7,  2000] loss: 1.162
    [2m[36m(pid=1445)[0m [2,  8000] loss: 0.342
    [2m[36m(pid=1470)[0m [2, 10000] loss: 0.301
    Result for DEFAULT_83a82_00007:
      accuracy: 0.5421
      date: 2021-04-20_03-16-50
      done: false
      experiment_id: 8e3d61e0ffe2422c9053ba190cb9370c
      hostname: c531aa93f18a
      iterations_since_restore: 7
      loss: 1.3294336249351502
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 142.15591740608215
      time_this_iter_s: 18.41010332107544
      time_total_s: 142.15591740608215
      timestamp: 1618888610
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: 83a82_00007
  
    == Status ==
    Memory usage on this node: 5.6/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: None | Iter 4.000: -1.2669007039546967 | Iter 2.000: -1.395669156360626 | Iter 1.000: -1.7855717872619628
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00001 | RUNNING    | 172.17.0.2:1470 |            2 |   64 |   64 | 0.00194273  | 1.51933 |     0.4426 |                    1 |
    | DEFAULT_83a82_00002 | RUNNING    | 172.17.0.2:1445 |            2 |  128 |  256 | 0.000709167 | 1.44708 |     0.4856 |                    1 |
    | DEFAULT_83a82_00007 | RUNNING    | 172.17.0.2:1428 |           16 |   64 |   16 | 0.00850861  | 1.32943 |     0.5421 |                    7 |
    | DEFAULT_83a82_00000 | TERMINATED |                 |            8 |   32 |  256 | 0.0185408   | 1.951   |     0.2617 |                    1 |
    | DEFAULT_83a82_00003 | TERMINATED |                 |            8 |    8 |   64 | 0.045707    | 2.30589 |     0.0974 |                    1 |
    | DEFAULT_83a82_00004 | TERMINATED |                 |            4 |  256 |   16 | 0.00955948  | 1.90302 |     0.301  |                    1 |
    | DEFAULT_83a82_00005 | TERMINATED |                 |            2 |   64 |   64 | 0.000171127 | 1.92782 |     0.3054 |                    1 |
    | DEFAULT_83a82_00006 | TERMINATED |                 |           16 |  128 |   64 | 0.00258565  | 1.66812 |     0.3945 |                    1 |
    | DEFAULT_83a82_00008 | TERMINATED |                 |            8 |   64 |  256 | 0.000790146 | 1.41475 |     0.4939 |                    2 |
    | DEFAULT_83a82_00009 | TERMINATED |                 |           16 |    4 |  128 | 0.000480011 | 2.22954 |     0.1643 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1445)[0m [2, 10000] loss: 0.269
    [2m[36m(pid=1470)[0m [2, 12000] loss: 0.253
    [2m[36m(pid=1445)[0m [2, 12000] loss: 0.224
    [2m[36m(pid=1470)[0m [2, 14000] loss: 0.214
    [2m[36m(pid=1428)[0m [8,  2000] loss: 1.141
    Result for DEFAULT_83a82_00007:
      accuracy: 0.5657
      date: 2021-04-20_03-17-09
      done: false
      experiment_id: 8e3d61e0ffe2422c9053ba190cb9370c
      hostname: c531aa93f18a
      iterations_since_restore: 8
      loss: 1.306873088645935
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 160.84678602218628
      time_this_iter_s: 18.690868616104126
      time_total_s: 160.84678602218628
      timestamp: 1618888629
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: 83a82_00007
  
    == Status ==
    Memory usage on this node: 5.6/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: -1.306873088645935 | Iter 4.000: -1.2669007039546967 | Iter 2.000: -1.395669156360626 | Iter 1.000: -1.7855717872619628
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00001 | RUNNING    | 172.17.0.2:1470 |            2 |   64 |   64 | 0.00194273  | 1.51933 |     0.4426 |                    1 |
    | DEFAULT_83a82_00002 | RUNNING    | 172.17.0.2:1445 |            2 |  128 |  256 | 0.000709167 | 1.44708 |     0.4856 |                    1 |
    | DEFAULT_83a82_00007 | RUNNING    | 172.17.0.2:1428 |           16 |   64 |   16 | 0.00850861  | 1.30687 |     0.5657 |                    8 |
    | DEFAULT_83a82_00000 | TERMINATED |                 |            8 |   32 |  256 | 0.0185408   | 1.951   |     0.2617 |                    1 |
    | DEFAULT_83a82_00003 | TERMINATED |                 |            8 |    8 |   64 | 0.045707    | 2.30589 |     0.0974 |                    1 |
    | DEFAULT_83a82_00004 | TERMINATED |                 |            4 |  256 |   16 | 0.00955948  | 1.90302 |     0.301  |                    1 |
    | DEFAULT_83a82_00005 | TERMINATED |                 |            2 |   64 |   64 | 0.000171127 | 1.92782 |     0.3054 |                    1 |
    | DEFAULT_83a82_00006 | TERMINATED |                 |           16 |  128 |   64 | 0.00258565  | 1.66812 |     0.3945 |                    1 |
    | DEFAULT_83a82_00008 | TERMINATED |                 |            8 |   64 |  256 | 0.000790146 | 1.41475 |     0.4939 |                    2 |
    | DEFAULT_83a82_00009 | TERMINATED |                 |           16 |    4 |  128 | 0.000480011 | 2.22954 |     0.1643 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1445)[0m [2, 14000] loss: 0.185
    [2m[36m(pid=1470)[0m [2, 16000] loss: 0.187
    [2m[36m(pid=1470)[0m [2, 18000] loss: 0.168
    [2m[36m(pid=1445)[0m [2, 16000] loss: 0.166
    [2m[36m(pid=1428)[0m [9,  2000] loss: 1.132
    [2m[36m(pid=1470)[0m [2, 20000] loss: 0.148
    [2m[36m(pid=1445)[0m [2, 18000] loss: 0.143
    Result for DEFAULT_83a82_00007:
      accuracy: 0.5684
      date: 2021-04-20_03-17-27
      done: false
      experiment_id: 8e3d61e0ffe2422c9053ba190cb9370c
      hostname: c531aa93f18a
      iterations_since_restore: 9
      loss: 1.2724814005851746
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 179.1503188610077
      time_this_iter_s: 18.30353283882141
      time_total_s: 179.1503188610077
      timestamp: 1618888647
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: 83a82_00007
  
    == Status ==
    Memory usage on this node: 5.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: -1.306873088645935 | Iter 4.000: -1.2669007039546967 | Iter 2.000: -1.395669156360626 | Iter 1.000: -1.7855717872619628
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00001 | RUNNING    | 172.17.0.2:1470 |            2 |   64 |   64 | 0.00194273  | 1.51933 |     0.4426 |                    1 |
    | DEFAULT_83a82_00002 | RUNNING    | 172.17.0.2:1445 |            2 |  128 |  256 | 0.000709167 | 1.44708 |     0.4856 |                    1 |
    | DEFAULT_83a82_00007 | RUNNING    | 172.17.0.2:1428 |           16 |   64 |   16 | 0.00850861  | 1.27248 |     0.5684 |                    9 |
    | DEFAULT_83a82_00000 | TERMINATED |                 |            8 |   32 |  256 | 0.0185408   | 1.951   |     0.2617 |                    1 |
    | DEFAULT_83a82_00003 | TERMINATED |                 |            8 |    8 |   64 | 0.045707    | 2.30589 |     0.0974 |                    1 |
    | DEFAULT_83a82_00004 | TERMINATED |                 |            4 |  256 |   16 | 0.00955948  | 1.90302 |     0.301  |                    1 |
    | DEFAULT_83a82_00005 | TERMINATED |                 |            2 |   64 |   64 | 0.000171127 | 1.92782 |     0.3054 |                    1 |
    | DEFAULT_83a82_00006 | TERMINATED |                 |           16 |  128 |   64 | 0.00258565  | 1.66812 |     0.3945 |                    1 |
    | DEFAULT_83a82_00008 | TERMINATED |                 |            8 |   64 |  256 | 0.000790146 | 1.41475 |     0.4939 |                    2 |
    | DEFAULT_83a82_00009 | TERMINATED |                 |           16 |    4 |  128 | 0.000480011 | 2.22954 |     0.1643 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1445)[0m [2, 20000] loss: 0.129
    Result for DEFAULT_83a82_00001:
      accuracy: 0.462
      date: 2021-04-20_03-17-37
      done: true
      experiment_id: cf4817101a6d44c38d8100d4cf37a4ad
      hostname: c531aa93f18a
      iterations_since_restore: 2
      loss: 1.492851930546388
      node_ip: 172.17.0.2
      pid: 1470
      should_checkpoint: true
      time_since_restore: 188.73731184005737
      time_this_iter_s: 87.23513293266296
      time_total_s: 188.73731184005737
      timestamp: 1618888657
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 83a82_00001
  
    == Status ==
    Memory usage on this node: 5.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=8
    Bracket: Iter 8.000: -1.306873088645935 | Iter 4.000: -1.2669007039546967 | Iter 2.000: -1.4147543246269225 | Iter 1.000: -1.7855717872619628
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00001 | RUNNING    | 172.17.0.2:1470 |            2 |   64 |   64 | 0.00194273  | 1.49285 |     0.462  |                    2 |
    | DEFAULT_83a82_00002 | RUNNING    | 172.17.0.2:1445 |            2 |  128 |  256 | 0.000709167 | 1.44708 |     0.4856 |                    1 |
    | DEFAULT_83a82_00007 | RUNNING    | 172.17.0.2:1428 |           16 |   64 |   16 | 0.00850861  | 1.27248 |     0.5684 |                    9 |
    | DEFAULT_83a82_00000 | TERMINATED |                 |            8 |   32 |  256 | 0.0185408   | 1.951   |     0.2617 |                    1 |
    | DEFAULT_83a82_00003 | TERMINATED |                 |            8 |    8 |   64 | 0.045707    | 2.30589 |     0.0974 |                    1 |
    | DEFAULT_83a82_00004 | TERMINATED |                 |            4 |  256 |   16 | 0.00955948  | 1.90302 |     0.301  |                    1 |
    | DEFAULT_83a82_00005 | TERMINATED |                 |            2 |   64 |   64 | 0.000171127 | 1.92782 |     0.3054 |                    1 |
    | DEFAULT_83a82_00006 | TERMINATED |                 |           16 |  128 |   64 | 0.00258565  | 1.66812 |     0.3945 |                    1 |
    | DEFAULT_83a82_00008 | TERMINATED |                 |            8 |   64 |  256 | 0.000790146 | 1.41475 |     0.4939 |                    2 |
    | DEFAULT_83a82_00009 | TERMINATED |                 |           16 |    4 |  128 | 0.000480011 | 2.22954 |     0.1643 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1428)[0m [10,  2000] loss: 1.098
    Result for DEFAULT_83a82_00002:
      accuracy: 0.5318
      date: 2021-04-20_03-17-46
      done: false
      experiment_id: 69fa429ab6aa492c951d8b52391e0de9
      hostname: c531aa93f18a
      iterations_since_restore: 2
      loss: 1.3184103769491193
      node_ip: 172.17.0.2
      pid: 1445
      should_checkpoint: true
      time_since_restore: 197.44720721244812
      time_this_iter_s: 90.96258330345154
      time_total_s: 197.44720721244812
      timestamp: 1618888666
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 83a82_00002
  
    == Status ==
    Memory usage on this node: 5.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=8
    Bracket: Iter 8.000: -1.306873088645935 | Iter 4.000: -1.2669007039546967 | Iter 2.000: -1.395669156360626 | Iter 1.000: -1.7855717872619628
    Resources requested: 4/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00002 | RUNNING    | 172.17.0.2:1445 |            2 |  128 |  256 | 0.000709167 | 1.31841 |     0.5318 |                    2 |
    | DEFAULT_83a82_00007 | RUNNING    | 172.17.0.2:1428 |           16 |   64 |   16 | 0.00850861  | 1.27248 |     0.5684 |                    9 |
    | DEFAULT_83a82_00000 | TERMINATED |                 |            8 |   32 |  256 | 0.0185408   | 1.951   |     0.2617 |                    1 |
    | DEFAULT_83a82_00001 | TERMINATED |                 |            2 |   64 |   64 | 0.00194273  | 1.49285 |     0.462  |                    2 |
    | DEFAULT_83a82_00003 | TERMINATED |                 |            8 |    8 |   64 | 0.045707    | 2.30589 |     0.0974 |                    1 |
    | DEFAULT_83a82_00004 | TERMINATED |                 |            4 |  256 |   16 | 0.00955948  | 1.90302 |     0.301  |                    1 |
    | DEFAULT_83a82_00005 | TERMINATED |                 |            2 |   64 |   64 | 0.000171127 | 1.92782 |     0.3054 |                    1 |
    | DEFAULT_83a82_00006 | TERMINATED |                 |           16 |  128 |   64 | 0.00258565  | 1.66812 |     0.3945 |                    1 |
    | DEFAULT_83a82_00008 | TERMINATED |                 |            8 |   64 |  256 | 0.000790146 | 1.41475 |     0.4939 |                    2 |
    | DEFAULT_83a82_00009 | TERMINATED |                 |           16 |    4 |  128 | 0.000480011 | 2.22954 |     0.1643 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_83a82_00007:
      accuracy: 0.5781
      date: 2021-04-20_03-17-46
      done: true
      experiment_id: 8e3d61e0ffe2422c9053ba190cb9370c
      hostname: c531aa93f18a
      iterations_since_restore: 10
      loss: 1.2707182452201844
      node_ip: 172.17.0.2
      pid: 1428
      should_checkpoint: true
      time_since_restore: 197.81025290489197
      time_this_iter_s: 18.659934043884277
      time_total_s: 197.81025290489197
      timestamp: 1618888666
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: 83a82_00007
  
    [2m[36m(pid=1445)[0m [3,  2000] loss: 1.227
    [2m[36m(pid=1445)[0m [3,  4000] loss: 0.604
    [2m[36m(pid=1445)[0m [3,  6000] loss: 0.414
    [2m[36m(pid=1445)[0m [3,  8000] loss: 0.298
    [2m[36m(pid=1445)[0m [3, 10000] loss: 0.241
    [2m[36m(pid=1445)[0m [3, 12000] loss: 0.200
    [2m[36m(pid=1445)[0m [3, 14000] loss: 0.172
    [2m[36m(pid=1445)[0m [3, 16000] loss: 0.147
    [2m[36m(pid=1445)[0m [3, 18000] loss: 0.134
    [2m[36m(pid=1445)[0m [3, 20000] loss: 0.118
    Result for DEFAULT_83a82_00002:
      accuracy: 0.5752
      date: 2021-04-20_03-19-14
      done: false
      experiment_id: 69fa429ab6aa492c951d8b52391e0de9
      hostname: c531aa93f18a
      iterations_since_restore: 3
      loss: 1.1998079957683339
      node_ip: 172.17.0.2
      pid: 1445
      should_checkpoint: true
      time_since_restore: 285.56450295448303
      time_this_iter_s: 88.11729574203491
      time_total_s: 285.56450295448303
      timestamp: 1618888754
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: 83a82_00002
  
    == Status ==
    Memory usage on this node: 4.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=9
    Bracket: Iter 8.000: -1.306873088645935 | Iter 4.000: -1.2669007039546967 | Iter 2.000: -1.395669156360626 | Iter 1.000: -1.7855717872619628
    Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00002 | RUNNING    | 172.17.0.2:1445 |            2 |  128 |  256 | 0.000709167 | 1.19981 |     0.5752 |                    3 |
    | DEFAULT_83a82_00000 | TERMINATED |                 |            8 |   32 |  256 | 0.0185408   | 1.951   |     0.2617 |                    1 |
    | DEFAULT_83a82_00001 | TERMINATED |                 |            2 |   64 |   64 | 0.00194273  | 1.49285 |     0.462  |                    2 |
    | DEFAULT_83a82_00003 | TERMINATED |                 |            8 |    8 |   64 | 0.045707    | 2.30589 |     0.0974 |                    1 |
    | DEFAULT_83a82_00004 | TERMINATED |                 |            4 |  256 |   16 | 0.00955948  | 1.90302 |     0.301  |                    1 |
    | DEFAULT_83a82_00005 | TERMINATED |                 |            2 |   64 |   64 | 0.000171127 | 1.92782 |     0.3054 |                    1 |
    | DEFAULT_83a82_00006 | TERMINATED |                 |           16 |  128 |   64 | 0.00258565  | 1.66812 |     0.3945 |                    1 |
    | DEFAULT_83a82_00007 | TERMINATED |                 |           16 |   64 |   16 | 0.00850861  | 1.27072 |     0.5781 |                   10 |
    | DEFAULT_83a82_00008 | TERMINATED |                 |            8 |   64 |  256 | 0.000790146 | 1.41475 |     0.4939 |                    2 |
    | DEFAULT_83a82_00009 | TERMINATED |                 |           16 |    4 |  128 | 0.000480011 | 2.22954 |     0.1643 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1445)[0m [4,  2000] loss: 1.079
    [2m[36m(pid=1445)[0m [4,  4000] loss: 0.553
    [2m[36m(pid=1445)[0m [4,  6000] loss: 0.364
    [2m[36m(pid=1445)[0m [4,  8000] loss: 0.277
    [2m[36m(pid=1445)[0m [4, 10000] loss: 0.221
    [2m[36m(pid=1445)[0m [4, 12000] loss: 0.186
    [2m[36m(pid=1445)[0m [4, 14000] loss: 0.161
    [2m[36m(pid=1445)[0m [4, 16000] loss: 0.137
    [2m[36m(pid=1445)[0m [4, 18000] loss: 0.123
    [2m[36m(pid=1445)[0m [4, 20000] loss: 0.110
    Result for DEFAULT_83a82_00002:
      accuracy: 0.579
      date: 2021-04-20_03-20-42
      done: false
      experiment_id: 69fa429ab6aa492c951d8b52391e0de9
      hostname: c531aa93f18a
      iterations_since_restore: 4
      loss: 1.207616167040219
      node_ip: 172.17.0.2
      pid: 1445
      should_checkpoint: true
      time_since_restore: 373.8934111595154
      time_this_iter_s: 88.32890820503235
      time_total_s: 373.8934111595154
      timestamp: 1618888842
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: 83a82_00002
  
    == Status ==
    Memory usage on this node: 4.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=9
    Bracket: Iter 8.000: -1.306873088645935 | Iter 4.000: -1.2372584354974578 | Iter 2.000: -1.395669156360626 | Iter 1.000: -1.7855717872619628
    Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00002 | RUNNING    | 172.17.0.2:1445 |            2 |  128 |  256 | 0.000709167 | 1.20762 |     0.579  |                    4 |
    | DEFAULT_83a82_00000 | TERMINATED |                 |            8 |   32 |  256 | 0.0185408   | 1.951   |     0.2617 |                    1 |
    | DEFAULT_83a82_00001 | TERMINATED |                 |            2 |   64 |   64 | 0.00194273  | 1.49285 |     0.462  |                    2 |
    | DEFAULT_83a82_00003 | TERMINATED |                 |            8 |    8 |   64 | 0.045707    | 2.30589 |     0.0974 |                    1 |
    | DEFAULT_83a82_00004 | TERMINATED |                 |            4 |  256 |   16 | 0.00955948  | 1.90302 |     0.301  |                    1 |
    | DEFAULT_83a82_00005 | TERMINATED |                 |            2 |   64 |   64 | 0.000171127 | 1.92782 |     0.3054 |                    1 |
    | DEFAULT_83a82_00006 | TERMINATED |                 |           16 |  128 |   64 | 0.00258565  | 1.66812 |     0.3945 |                    1 |
    | DEFAULT_83a82_00007 | TERMINATED |                 |           16 |   64 |   16 | 0.00850861  | 1.27072 |     0.5781 |                   10 |
    | DEFAULT_83a82_00008 | TERMINATED |                 |            8 |   64 |  256 | 0.000790146 | 1.41475 |     0.4939 |                    2 |
    | DEFAULT_83a82_00009 | TERMINATED |                 |           16 |    4 |  128 | 0.000480011 | 2.22954 |     0.1643 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1445)[0m [5,  2000] loss: 1.005
    [2m[36m(pid=1445)[0m [5,  4000] loss: 0.498
    [2m[36m(pid=1445)[0m [5,  6000] loss: 0.345
    [2m[36m(pid=1445)[0m [5,  8000] loss: 0.256
    [2m[36m(pid=1445)[0m [5, 10000] loss: 0.212
    [2m[36m(pid=1445)[0m [5, 12000] loss: 0.170
    [2m[36m(pid=1445)[0m [5, 14000] loss: 0.147
    [2m[36m(pid=1445)[0m [5, 16000] loss: 0.131
    [2m[36m(pid=1445)[0m [5, 18000] loss: 0.115
    [2m[36m(pid=1445)[0m [5, 20000] loss: 0.106
    Result for DEFAULT_83a82_00002:
      accuracy: 0.6057
      date: 2021-04-20_03-22-10
      done: false
      experiment_id: 69fa429ab6aa492c951d8b52391e0de9
      hostname: c531aa93f18a
      iterations_since_restore: 5
      loss: 1.1469761278680817
      node_ip: 172.17.0.2
      pid: 1445
      should_checkpoint: true
      time_since_restore: 462.00133204460144
      time_this_iter_s: 88.10792088508606
      time_total_s: 462.00133204460144
      timestamp: 1618888930
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: 83a82_00002
  
    == Status ==
    Memory usage on this node: 4.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=9
    Bracket: Iter 8.000: -1.306873088645935 | Iter 4.000: -1.2372584354974578 | Iter 2.000: -1.395669156360626 | Iter 1.000: -1.7855717872619628
    Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00002 | RUNNING    | 172.17.0.2:1445 |            2 |  128 |  256 | 0.000709167 | 1.14698 |     0.6057 |                    5 |
    | DEFAULT_83a82_00000 | TERMINATED |                 |            8 |   32 |  256 | 0.0185408   | 1.951   |     0.2617 |                    1 |
    | DEFAULT_83a82_00001 | TERMINATED |                 |            2 |   64 |   64 | 0.00194273  | 1.49285 |     0.462  |                    2 |
    | DEFAULT_83a82_00003 | TERMINATED |                 |            8 |    8 |   64 | 0.045707    | 2.30589 |     0.0974 |                    1 |
    | DEFAULT_83a82_00004 | TERMINATED |                 |            4 |  256 |   16 | 0.00955948  | 1.90302 |     0.301  |                    1 |
    | DEFAULT_83a82_00005 | TERMINATED |                 |            2 |   64 |   64 | 0.000171127 | 1.92782 |     0.3054 |                    1 |
    | DEFAULT_83a82_00006 | TERMINATED |                 |           16 |  128 |   64 | 0.00258565  | 1.66812 |     0.3945 |                    1 |
    | DEFAULT_83a82_00007 | TERMINATED |                 |           16 |   64 |   16 | 0.00850861  | 1.27072 |     0.5781 |                   10 |
    | DEFAULT_83a82_00008 | TERMINATED |                 |            8 |   64 |  256 | 0.000790146 | 1.41475 |     0.4939 |                    2 |
    | DEFAULT_83a82_00009 | TERMINATED |                 |           16 |    4 |  128 | 0.000480011 | 2.22954 |     0.1643 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1445)[0m [6,  2000] loss: 0.911
    [2m[36m(pid=1445)[0m [6,  4000] loss: 0.465
    [2m[36m(pid=1445)[0m [6,  6000] loss: 0.321
    [2m[36m(pid=1445)[0m [6,  8000] loss: 0.240
    [2m[36m(pid=1445)[0m [6, 10000] loss: 0.194
    [2m[36m(pid=1445)[0m [6, 12000] loss: 0.158
    [2m[36m(pid=1445)[0m [6, 14000] loss: 0.142
    [2m[36m(pid=1445)[0m [6, 16000] loss: 0.124
    [2m[36m(pid=1445)[0m [6, 18000] loss: 0.111
    [2m[36m(pid=1445)[0m [6, 20000] loss: 0.102
    Result for DEFAULT_83a82_00002:
      accuracy: 0.6042
      date: 2021-04-20_03-23-39
      done: false
      experiment_id: 69fa429ab6aa492c951d8b52391e0de9
      hostname: c531aa93f18a
      iterations_since_restore: 6
      loss: 1.1361194677672684
      node_ip: 172.17.0.2
      pid: 1445
      should_checkpoint: true
      time_since_restore: 550.4800713062286
      time_this_iter_s: 88.4787392616272
      time_total_s: 550.4800713062286
      timestamp: 1618889019
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: 83a82_00002
  
    == Status ==
    Memory usage on this node: 4.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=9
    Bracket: Iter 8.000: -1.306873088645935 | Iter 4.000: -1.2372584354974578 | Iter 2.000: -1.395669156360626 | Iter 1.000: -1.7855717872619628
    Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00002 | RUNNING    | 172.17.0.2:1445 |            2 |  128 |  256 | 0.000709167 | 1.13612 |     0.6042 |                    6 |
    | DEFAULT_83a82_00000 | TERMINATED |                 |            8 |   32 |  256 | 0.0185408   | 1.951   |     0.2617 |                    1 |
    | DEFAULT_83a82_00001 | TERMINATED |                 |            2 |   64 |   64 | 0.00194273  | 1.49285 |     0.462  |                    2 |
    | DEFAULT_83a82_00003 | TERMINATED |                 |            8 |    8 |   64 | 0.045707    | 2.30589 |     0.0974 |                    1 |
    | DEFAULT_83a82_00004 | TERMINATED |                 |            4 |  256 |   16 | 0.00955948  | 1.90302 |     0.301  |                    1 |
    | DEFAULT_83a82_00005 | TERMINATED |                 |            2 |   64 |   64 | 0.000171127 | 1.92782 |     0.3054 |                    1 |
    | DEFAULT_83a82_00006 | TERMINATED |                 |           16 |  128 |   64 | 0.00258565  | 1.66812 |     0.3945 |                    1 |
    | DEFAULT_83a82_00007 | TERMINATED |                 |           16 |   64 |   16 | 0.00850861  | 1.27072 |     0.5781 |                   10 |
    | DEFAULT_83a82_00008 | TERMINATED |                 |            8 |   64 |  256 | 0.000790146 | 1.41475 |     0.4939 |                    2 |
    | DEFAULT_83a82_00009 | TERMINATED |                 |           16 |    4 |  128 | 0.000480011 | 2.22954 |     0.1643 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1445)[0m [7,  2000] loss: 0.856
    [2m[36m(pid=1445)[0m [7,  4000] loss: 0.446
    [2m[36m(pid=1445)[0m [7,  6000] loss: 0.308
    [2m[36m(pid=1445)[0m [7,  8000] loss: 0.226
    [2m[36m(pid=1445)[0m [7, 10000] loss: 0.186
    [2m[36m(pid=1445)[0m [7, 12000] loss: 0.151
    [2m[36m(pid=1445)[0m [7, 14000] loss: 0.135
    [2m[36m(pid=1445)[0m [7, 16000] loss: 0.119
    [2m[36m(pid=1445)[0m [7, 18000] loss: 0.104
    [2m[36m(pid=1445)[0m [7, 20000] loss: 0.097
    Result for DEFAULT_83a82_00002:
      accuracy: 0.6135
      date: 2021-04-20_03-25-07
      done: false
      experiment_id: 69fa429ab6aa492c951d8b52391e0de9
      hostname: c531aa93f18a
      iterations_since_restore: 7
      loss: 1.1208166421798043
      node_ip: 172.17.0.2
      pid: 1445
      should_checkpoint: true
      time_since_restore: 638.6041784286499
      time_this_iter_s: 88.12410712242126
      time_total_s: 638.6041784286499
      timestamp: 1618889107
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: 83a82_00002
  
    == Status ==
    Memory usage on this node: 4.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=9
    Bracket: Iter 8.000: -1.306873088645935 | Iter 4.000: -1.2372584354974578 | Iter 2.000: -1.395669156360626 | Iter 1.000: -1.7855717872619628
    Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00002 | RUNNING    | 172.17.0.2:1445 |            2 |  128 |  256 | 0.000709167 | 1.12082 |     0.6135 |                    7 |
    | DEFAULT_83a82_00000 | TERMINATED |                 |            8 |   32 |  256 | 0.0185408   | 1.951   |     0.2617 |                    1 |
    | DEFAULT_83a82_00001 | TERMINATED |                 |            2 |   64 |   64 | 0.00194273  | 1.49285 |     0.462  |                    2 |
    | DEFAULT_83a82_00003 | TERMINATED |                 |            8 |    8 |   64 | 0.045707    | 2.30589 |     0.0974 |                    1 |
    | DEFAULT_83a82_00004 | TERMINATED |                 |            4 |  256 |   16 | 0.00955948  | 1.90302 |     0.301  |                    1 |
    | DEFAULT_83a82_00005 | TERMINATED |                 |            2 |   64 |   64 | 0.000171127 | 1.92782 |     0.3054 |                    1 |
    | DEFAULT_83a82_00006 | TERMINATED |                 |           16 |  128 |   64 | 0.00258565  | 1.66812 |     0.3945 |                    1 |
    | DEFAULT_83a82_00007 | TERMINATED |                 |           16 |   64 |   16 | 0.00850861  | 1.27072 |     0.5781 |                   10 |
    | DEFAULT_83a82_00008 | TERMINATED |                 |            8 |   64 |  256 | 0.000790146 | 1.41475 |     0.4939 |                    2 |
    | DEFAULT_83a82_00009 | TERMINATED |                 |           16 |    4 |  128 | 0.000480011 | 2.22954 |     0.1643 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1445)[0m [8,  2000] loss: 0.806
    [2m[36m(pid=1445)[0m [8,  4000] loss: 0.421
    [2m[36m(pid=1445)[0m [8,  6000] loss: 0.271
    [2m[36m(pid=1445)[0m [8,  8000] loss: 0.216
    [2m[36m(pid=1445)[0m [8, 10000] loss: 0.170
    [2m[36m(pid=1445)[0m [8, 12000] loss: 0.151
    [2m[36m(pid=1445)[0m [8, 14000] loss: 0.132
    [2m[36m(pid=1445)[0m [8, 16000] loss: 0.111
    [2m[36m(pid=1445)[0m [8, 18000] loss: 0.105
    [2m[36m(pid=1445)[0m [8, 20000] loss: 0.093
    Result for DEFAULT_83a82_00002:
      accuracy: 0.6051
      date: 2021-04-20_03-26-34
      done: false
      experiment_id: 69fa429ab6aa492c951d8b52391e0de9
      hostname: c531aa93f18a
      iterations_since_restore: 8
      loss: 1.157953185341443
      node_ip: 172.17.0.2
      pid: 1445
      should_checkpoint: true
      time_since_restore: 725.675714969635
      time_this_iter_s: 87.07153654098511
      time_total_s: 725.675714969635
      timestamp: 1618889194
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: 83a82_00002
  
    == Status ==
    Memory usage on this node: 4.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=9
    Bracket: Iter 8.000: -1.232413136993689 | Iter 4.000: -1.2372584354974578 | Iter 2.000: -1.395669156360626 | Iter 1.000: -1.7855717872619628
    Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00002 | RUNNING    | 172.17.0.2:1445 |            2 |  128 |  256 | 0.000709167 | 1.15795 |     0.6051 |                    8 |
    | DEFAULT_83a82_00000 | TERMINATED |                 |            8 |   32 |  256 | 0.0185408   | 1.951   |     0.2617 |                    1 |
    | DEFAULT_83a82_00001 | TERMINATED |                 |            2 |   64 |   64 | 0.00194273  | 1.49285 |     0.462  |                    2 |
    | DEFAULT_83a82_00003 | TERMINATED |                 |            8 |    8 |   64 | 0.045707    | 2.30589 |     0.0974 |                    1 |
    | DEFAULT_83a82_00004 | TERMINATED |                 |            4 |  256 |   16 | 0.00955948  | 1.90302 |     0.301  |                    1 |
    | DEFAULT_83a82_00005 | TERMINATED |                 |            2 |   64 |   64 | 0.000171127 | 1.92782 |     0.3054 |                    1 |
    | DEFAULT_83a82_00006 | TERMINATED |                 |           16 |  128 |   64 | 0.00258565  | 1.66812 |     0.3945 |                    1 |
    | DEFAULT_83a82_00007 | TERMINATED |                 |           16 |   64 |   16 | 0.00850861  | 1.27072 |     0.5781 |                   10 |
    | DEFAULT_83a82_00008 | TERMINATED |                 |            8 |   64 |  256 | 0.000790146 | 1.41475 |     0.4939 |                    2 |
    | DEFAULT_83a82_00009 | TERMINATED |                 |           16 |    4 |  128 | 0.000480011 | 2.22954 |     0.1643 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1445)[0m [9,  2000] loss: 0.762
    [2m[36m(pid=1445)[0m [9,  4000] loss: 0.408
    [2m[36m(pid=1445)[0m [9,  6000] loss: 0.272
    [2m[36m(pid=1445)[0m [9,  8000] loss: 0.207
    [2m[36m(pid=1445)[0m [9, 10000] loss: 0.166
    [2m[36m(pid=1445)[0m [9, 12000] loss: 0.138
    [2m[36m(pid=1445)[0m [9, 14000] loss: 0.125
    [2m[36m(pid=1445)[0m [9, 16000] loss: 0.108
    [2m[36m(pid=1445)[0m [9, 18000] loss: 0.095
    [2m[36m(pid=1445)[0m [9, 20000] loss: 0.091
    Result for DEFAULT_83a82_00002:
      accuracy: 0.5965
      date: 2021-04-20_03-28-00
      done: false
      experiment_id: 69fa429ab6aa492c951d8b52391e0de9
      hostname: c531aa93f18a
      iterations_since_restore: 9
      loss: 1.2071819953683967
      node_ip: 172.17.0.2
      pid: 1445
      should_checkpoint: true
      time_since_restore: 812.3355479240417
      time_this_iter_s: 86.65983295440674
      time_total_s: 812.3355479240417
      timestamp: 1618889280
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: 83a82_00002
  
    == Status ==
    Memory usage on this node: 4.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=9
    Bracket: Iter 8.000: -1.232413136993689 | Iter 4.000: -1.2372584354974578 | Iter 2.000: -1.395669156360626 | Iter 1.000: -1.7855717872619628
    Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00002 | RUNNING    | 172.17.0.2:1445 |            2 |  128 |  256 | 0.000709167 | 1.20718 |     0.5965 |                    9 |
    | DEFAULT_83a82_00000 | TERMINATED |                 |            8 |   32 |  256 | 0.0185408   | 1.951   |     0.2617 |                    1 |
    | DEFAULT_83a82_00001 | TERMINATED |                 |            2 |   64 |   64 | 0.00194273  | 1.49285 |     0.462  |                    2 |
    | DEFAULT_83a82_00003 | TERMINATED |                 |            8 |    8 |   64 | 0.045707    | 2.30589 |     0.0974 |                    1 |
    | DEFAULT_83a82_00004 | TERMINATED |                 |            4 |  256 |   16 | 0.00955948  | 1.90302 |     0.301  |                    1 |
    | DEFAULT_83a82_00005 | TERMINATED |                 |            2 |   64 |   64 | 0.000171127 | 1.92782 |     0.3054 |                    1 |
    | DEFAULT_83a82_00006 | TERMINATED |                 |           16 |  128 |   64 | 0.00258565  | 1.66812 |     0.3945 |                    1 |
    | DEFAULT_83a82_00007 | TERMINATED |                 |           16 |   64 |   16 | 0.00850861  | 1.27072 |     0.5781 |                   10 |
    | DEFAULT_83a82_00008 | TERMINATED |                 |            8 |   64 |  256 | 0.000790146 | 1.41475 |     0.4939 |                    2 |
    | DEFAULT_83a82_00009 | TERMINATED |                 |           16 |    4 |  128 | 0.000480011 | 2.22954 |     0.1643 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1445)[0m [10,  2000] loss: 0.733
    [2m[36m(pid=1445)[0m [10,  4000] loss: 0.370
    [2m[36m(pid=1445)[0m [10,  6000] loss: 0.266
    [2m[36m(pid=1445)[0m [10,  8000] loss: 0.198
    [2m[36m(pid=1445)[0m [10, 10000] loss: 0.160
    [2m[36m(pid=1445)[0m [10, 12000] loss: 0.142
    [2m[36m(pid=1445)[0m [10, 14000] loss: 0.121
    [2m[36m(pid=1445)[0m [10, 16000] loss: 0.104
    [2m[36m(pid=1445)[0m [10, 18000] loss: 0.096
    [2m[36m(pid=1445)[0m [10, 20000] loss: 0.083
    Result for DEFAULT_83a82_00002:
      accuracy: 0.6128
      date: 2021-04-20_03-29-27
      done: true
      experiment_id: 69fa429ab6aa492c951d8b52391e0de9
      hostname: c531aa93f18a
      iterations_since_restore: 10
      loss: 1.2376869106162183
      node_ip: 172.17.0.2
      pid: 1445
      should_checkpoint: true
      time_since_restore: 899.1972815990448
      time_this_iter_s: 86.86173367500305
      time_total_s: 899.1972815990448
      timestamp: 1618889367
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: 83a82_00002
  
    == Status ==
    Memory usage on this node: 4.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=10
    Bracket: Iter 8.000: -1.232413136993689 | Iter 4.000: -1.2372584354974578 | Iter 2.000: -1.395669156360626 | Iter 1.000: -1.7855717872619628
    Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00002 | RUNNING    | 172.17.0.2:1445 |            2 |  128 |  256 | 0.000709167 | 1.23769 |     0.6128 |                   10 |
    | DEFAULT_83a82_00000 | TERMINATED |                 |            8 |   32 |  256 | 0.0185408   | 1.951   |     0.2617 |                    1 |
    | DEFAULT_83a82_00001 | TERMINATED |                 |            2 |   64 |   64 | 0.00194273  | 1.49285 |     0.462  |                    2 |
    | DEFAULT_83a82_00003 | TERMINATED |                 |            8 |    8 |   64 | 0.045707    | 2.30589 |     0.0974 |                    1 |
    | DEFAULT_83a82_00004 | TERMINATED |                 |            4 |  256 |   16 | 0.00955948  | 1.90302 |     0.301  |                    1 |
    | DEFAULT_83a82_00005 | TERMINATED |                 |            2 |   64 |   64 | 0.000171127 | 1.92782 |     0.3054 |                    1 |
    | DEFAULT_83a82_00006 | TERMINATED |                 |           16 |  128 |   64 | 0.00258565  | 1.66812 |     0.3945 |                    1 |
    | DEFAULT_83a82_00007 | TERMINATED |                 |           16 |   64 |   16 | 0.00850861  | 1.27072 |     0.5781 |                   10 |
    | DEFAULT_83a82_00008 | TERMINATED |                 |            8 |   64 |  256 | 0.000790146 | 1.41475 |     0.4939 |                    2 |
    | DEFAULT_83a82_00009 | TERMINATED |                 |           16 |    4 |  128 | 0.000480011 | 2.22954 |     0.1643 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    == Status ==
    Memory usage on this node: 4.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=10
    Bracket: Iter 8.000: -1.232413136993689 | Iter 4.000: -1.2372584354974578 | Iter 2.000: -1.395669156360626 | Iter 1.000: -1.7855717872619628
    Resources requested: 0/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects (0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-04-20_03-14-27
    Number of trials: 10/10 (10 TERMINATED)
    +---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc   |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_83a82_00000 | TERMINATED |       |            8 |   32 |  256 | 0.0185408   | 1.951   |     0.2617 |                    1 |
    | DEFAULT_83a82_00001 | TERMINATED |       |            2 |   64 |   64 | 0.00194273  | 1.49285 |     0.462  |                    2 |
    | DEFAULT_83a82_00002 | TERMINATED |       |            2 |  128 |  256 | 0.000709167 | 1.23769 |     0.6128 |                   10 |
    | DEFAULT_83a82_00003 | TERMINATED |       |            8 |    8 |   64 | 0.045707    | 2.30589 |     0.0974 |                    1 |
    | DEFAULT_83a82_00004 | TERMINATED |       |            4 |  256 |   16 | 0.00955948  | 1.90302 |     0.301  |                    1 |
    | DEFAULT_83a82_00005 | TERMINATED |       |            2 |   64 |   64 | 0.000171127 | 1.92782 |     0.3054 |                    1 |
    | DEFAULT_83a82_00006 | TERMINATED |       |           16 |  128 |   64 | 0.00258565  | 1.66812 |     0.3945 |                    1 |
    | DEFAULT_83a82_00007 | TERMINATED |       |           16 |   64 |   16 | 0.00850861  | 1.27072 |     0.5781 |                   10 |
    | DEFAULT_83a82_00008 | TERMINATED |       |            8 |   64 |  256 | 0.000790146 | 1.41475 |     0.4939 |                    2 |
    | DEFAULT_83a82_00009 | TERMINATED |       |           16 |    4 |  128 | 0.000480011 | 2.22954 |     0.1643 |                    1 |
    +---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+


    Best trial config: {'l1': 128, 'l2': 256, 'lr': 0.0007091667726347142, 'batch_size': 2}
    Best trial final validation loss: 1.2376869106162183
    Best trial final validation accuracy: 0.6128
    Files already downloaded and verified
    Files already downloaded and verified
    Best trial test set accuracy: 0.6124


If you run the code, an example output could look like this:

.. code-block::

    Number of trials: 10 (10 TERMINATED)
    +-----+------+------+-------------+--------------+---------+------------+--------------------+
    | ... |   l1 |   l2 |          lr |   batch_size |    loss |   accuracy | training_iteration |
    |-----+------+------+-------------+--------------+---------+------------+--------------------|
    | ... |   64 |    4 | 0.00011629  |            2 | 1.87273 |     0.244  |                  2 |
    | ... |   32 |   64 | 0.000339763 |            8 | 1.23603 |     0.567  |                  8 |
    | ... |    8 |   16 | 0.00276249  |           16 | 1.1815  |     0.5836 |                 10 |
    | ... |    4 |   64 | 0.000648721 |            4 | 1.31131 |     0.5224 |                  8 |
    | ... |   32 |   16 | 0.000340753 |            8 | 1.26454 |     0.5444 |                  8 |
    | ... |    8 |    4 | 0.000699775 |            8 | 1.99594 |     0.1983 |                  2 |
    | ... |  256 |    8 | 0.0839654   |           16 | 2.3119  |     0.0993 |                  1 |
    | ... |   16 |  128 | 0.0758154   |           16 | 2.33575 |     0.1327 |                  1 |
    | ... |   16 |    8 | 0.0763312   |           16 | 2.31129 |     0.1042 |                  4 |
    | ... |  128 |   16 | 0.000124903 |            4 | 2.26917 |     0.1945 |                  1 |
    +-----+------+------+-------------+--------------+---------+------------+--------------------+


    Best trial config: {'l1': 8, 'l2': 16, 'lr': 0.00276249, 'batch_size': 16, 'data_dir': '...'}
    Best trial final validation loss: 1.181501
    Best trial final validation accuracy: 0.5836
    Best trial test set accuracy: 0.5806

Most trials have been stopped early in order to avoid wasting resources.
The best performing trial achieved a validation accuracy of about 58%, which could
be confirmed on the test set.

So that's it! You can now tune the parameters of your PyTorch models.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 15 minutes  21.807 seconds)


.. _sphx_glr_download_beginner_hyperparameter_tuning_tutorial.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download

     :download:`Download Python source code: hyperparameter_tuning_tutorial.py <hyperparameter_tuning_tutorial.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: hyperparameter_tuning_tutorial.ipynb <hyperparameter_tuning_tutorial.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.readthedocs.io>`_
